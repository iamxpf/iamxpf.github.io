<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>åºåˆ—æ¨¡å‹RNNâ€”â€”ä½¿ç”¨è¯åµŒå…¥æ­å»ºNLPç³»ç»Ÿ</title>
    <url>/blogs/rnn2/</url>
    <content><![CDATA[<h2 id="è¯åµŒå…¥"><a href="#è¯åµŒå…¥" class="headerlink" title="è¯åµŒå…¥"></a>è¯åµŒå…¥</h2><h3 id="ä»€ä¹ˆæ˜¯è¯åµŒå…¥"><a href="#ä»€ä¹ˆæ˜¯è¯åµŒå…¥" class="headerlink" title="ä»€ä¹ˆæ˜¯è¯åµŒå…¥"></a>ä»€ä¹ˆæ˜¯è¯åµŒå…¥</h3><p>ä»¥è¯çš„ç‰¹å¾æ¥è¡¨ç¤ºå„ä¸ªå•è¯ï¼Œå³å•è¯çš„é«˜ç»´åº¦ç‰¹å¾è¡¨ç¤ºã€‚</p><p>ä¸one-hotè¡¨ç¤ºè¯ç›¸æ¯”ï¼š</p><p>ï¼ˆ1ï¼‰èƒ½æ›´å¥½çš„åæ˜ è¯çš„ç‰¹å¾ï¼Œå¢å¼ºç›¸å…³è¯çš„æ³›åŒ–èƒ½åŠ›ï¼ˆä¾‹å¦‚å­¦ä¹ äº†orange juiceï¼Œåé¢ä¼šå¾ˆå®¹æ˜“æ ¹æ®appleæ¨æµ‹å‡ºapple juiceï¼Œå› ä¸ºappleå’Œorangeçš„ç‰¹å¾è¡¨ç¤ºå¾ˆåƒï¼‰ï¼Œè€Œä½¿ç”¨one-hotè¡¨ç¤ºï¼Œè¯ä¹‹å‰æ²¡æœ‰è”ç³»ï¼Œæ— æ³•æ³›åŒ–</p><a id="more"></a>


<p>ï¼ˆ2ï¼‰èŠ‚çº¦äº†è¡¨ç¤ºè¯å‘é‡æ‰€å çš„å†…å­˜ï¼Œone-hotè¡¨ç¤ºæ–¹æ³•ï¼Œæ¯ä¸ªè¯å‘é‡çš„å¤§å°å’Œå­—å…¸çš„å¤§å°ç›¸åŒï¼Œè¯åµŒå…¥æ–¹æ³•ä¸­æ¯ä¸ªè¯çš„å¤§å°å’Œç‰¹å¾ç»´åº¦ç›¸å…³ã€‚</p>
<p>ä½¿ç”¨t-SNEå¯ä»¥å°†é«˜ç»´åº¦çš„ç‰¹å¾å‘é‡æ˜ å°„åˆ°äºŒç»´ç©ºé—´ï¼Œå¯ä»¥æ›´å®¹æ˜“è§‚å¯Ÿå„ä¸ªå‘é‡ä¹‹é—´çš„è”ç³»ï¼Œé çš„æ›´è¿‘çš„è”ç³»æ›´ç´§å¯†ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨è¯åµŒå…¥"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨è¯åµŒå…¥" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨è¯åµŒå…¥"></a>ä¸ºä»€ä¹ˆä½¿ç”¨è¯åµŒå…¥</h3><p>è¯åµŒå…¥å¯ä»¥ç”¨åœ¨è¿ç§»å­¦ä¹ ä¸­ï¼Œç›®å‰çš„NLPé—®é¢˜ä¸­å·²æ ‡è®°çš„æ•°æ®é›†è¾ƒå°‘ï¼Œæ­¤æ—¶ä½¿ç”¨è¯åµŒå…¥å¯ä»¥å¾ˆå¿«é€Ÿåˆå‡†ç¡®çš„æ„å»ºNLPç³»ç»Ÿã€‚</p>
<p>ï¼ˆ1ï¼‰å…ˆä»å¤§é‡æ–‡æœ¬ä¸­å­¦ä¹ è¯åµŒå…¥ï¼ˆæˆ–è€…ä»ç½‘ä¸Šä¸‹è½½åˆ«äººè®­ç»ƒå¥½çš„è¯åµŒå…¥æ¨¡å‹ï¼‰    task A</p>
<p>ï¼ˆ2ï¼‰å°†è¯åµŒå…¥æ¨¡å‹è¿ç§»åˆ°å…·æœ‰å°‘é‡æ ‡è®°æ ·æœ¬çš„æ•°æ®é›†ä¸­     task B</p>
<p>ï¼ˆ3ï¼‰å¾®è°ƒï¼šå½“è‡ªå·±å·²æ ‡è®°çš„æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œå¯ä»¥å¯¹å·²æœ‰çš„è¯åµŒå…¥æ¨¡å‹è¿›è¡Œå¾®è°ƒ</p>
<p>è¿ç§»å­¦ä¹ åŸç†ï¼šå°†åœ¨task Aä¸­å­¦ä¹ çš„çŸ¥è¯†è¿ç§»åˆ°Bä¸­ï¼Œæ­¤æ—¶Aæ•°æ®é‡å¾ˆå¤§ï¼ŒBæ•°æ®é‡å¾ˆå°ï¼Œè®­ç»ƒå‡ºçš„æ¨¡å‹å³ä½¿åœ¨ä»¥åå‡ºç°äº†ä¸åœ¨Bä¸­çš„è¯çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å¾ˆå¥½çš„é¢„æµ‹ï¼Œå› ä¸ºæ‹¥æœ‰ä»å¾ˆå¤§æ•°æ®é‡ä¸­å­¦ä¹ åˆ°çš„çŸ¥è¯†ï¼ˆtask Aï¼‰</p>
<h2 id="æ­å»ºè¯åµŒå…¥æ¨¡å‹çš„æ–¹æ³•ï¼ˆWord2Vecï¼‰"><a href="#æ­å»ºè¯åµŒå…¥æ¨¡å‹çš„æ–¹æ³•ï¼ˆWord2Vecï¼‰" class="headerlink" title="æ­å»ºè¯åµŒå…¥æ¨¡å‹çš„æ–¹æ³•ï¼ˆWord2Vecï¼‰"></a>æ­å»ºè¯åµŒå…¥æ¨¡å‹çš„æ–¹æ³•ï¼ˆWord2Vecï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623162528.png" alt></p>
<p>æ€»ä½“æ€è·¯ï¼šå­¦ä¹ è¯åµŒå…¥æ¨¡å‹å³å­¦ä¹ åµŒå…¥çŸ©é˜µEï¼Œå°†æ¯ä¸ªè¯ä½¿ç”¨one-hotè¡¨ç¤ºä¸ºOxï¼Œå†ä¹˜ä»¥åµŒå…¥çŸ©é˜µEå³å¯å¾—åˆ°æ¯ä¸ªè¯çš„è¯åµŒå…¥è¡¨ç¤ºæ–¹æ³•ã€‚</p>
<p>æ–¹æ³•ï¼šé€šè¿‡é€‰æ‹©ä¸Šä¸‹æ–‡-ç›®æ ‡è¯å¯¹æ¥å­¦ä¹ è¯åµŒå…¥ã€‚</p>
<p>ï¼ˆ1ï¼‰å‰é¢çš„4ä¸ªå•è¯-é¢„æµ‹è¯</p>
<p>ï¼ˆ2ï¼‰å‰é¢çš„4ä¸ªå•è¯-é¢„æµ‹è¯-åé¢çš„4ä¸ªå•è¯</p>
<p>ï¼ˆ3ï¼‰å‰é¢çš„1ä¸ªå•è¯-é¢„æµ‹è¯</p>
<p>ï¼ˆ4ï¼‰ä¸é¢„æµ‹è¯å…³ç³»æœ€è¿‘çš„ä¸€ä¸ªå•è¯-é¢„æµ‹è¯</p>
<h3 id="skip-gramæ¨¡å‹"><a href="#skip-gramæ¨¡å‹" class="headerlink" title="skip gramæ¨¡å‹"></a>skip gramæ¨¡å‹</h3><p>ï¼ˆ1ï¼‰è®­ç»ƒé›†æ„å»º</p>
<p>ä¸Šä¸‹æ–‡-ç›®æ ‡è¯ï¼šä»»æ„é€‰æ‹©ä¸€ä¸ªè¯-é€‰æ‹©çš„è¯çš„å‰åè·ç¦»å†…éšæœºå†é€‰æ‹©ä¸€ä¸ªè¯</p>
<p>ï¼ˆ2ï¼‰æ¨¡å‹</p>
<p>Ox-&gt;E-&gt;ec-&gt;softmax-&gt;yhat</p>
<p>softmaxä¸­çš„æ¦‚ç‡ä¸ºç›®æ ‡è¯tå‡ºç°åœ¨è¯cä¸Šä¸‹æ–‡çš„æ¦‚ç‡ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623162639.png" alt></p>
<p>æŸå¤±å‡½æ•°ä¸ºï¼šL=-âˆ‘y * log(yhat)</p>
<p>å­˜åœ¨é—®é¢˜ï¼šè®¡ç®—æ¯ä¸ªè¯çš„æ¦‚ç‡éƒ½éœ€è¦å¯¹è¯æ±‡è¡¨ä¸­çš„è¯è¿›è¡Œæ±‚å’Œï¼Œæˆæœ¬é«˜</p>
<p>è§£å†³ï¼šé‡‡ç”¨åˆ†çº§softmaxæ ‘å½¢åˆ†ç±»å™¨ï¼Œå¸¸ç”¨è¯æ”¾åœ¨é¡¶éƒ¨ï¼Œéå¸¸ç”¨è¯æ”¾åœ¨æ ‘çš„æ·±å¤„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»å™¨ã€‚</p>
<p>å°†å¤šåˆ†ç±»é—®é¢˜è½¬æ¢ä¸ºå¤šä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚</p>
<h3 id="è´Ÿé‡‡æ ·"><a href="#è´Ÿé‡‡æ ·" class="headerlink" title="è´Ÿé‡‡æ ·"></a>è´Ÿé‡‡æ ·</h3><p>ï¼ˆ1ï¼‰è®­ç»ƒé›†æ„å»º</p>
<p>ä¸Šä¸‹æ–‡-ç›®æ ‡è¯ï¼šæ¯ç»„k+1ä¸ªè¯ï¼Œç»™å‡ºä¸€ç»„è¯åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€å¯¹ä¸Šä¸‹æ–‡-ç›®æ ‡è¯å¯¹</p>
<p>ç¬¬ä¸€ç»„è¯ï¼ˆæ­£æ ·æœ¬ï¼‰ï¼šå½“å‰è¯-åœ¨å¥å­ä¸­å‰åè·ç¦»å†…éšæœºé€‰æ‹©ä¸€ä¸ªè¯ï¼Œæ ‡ç­¾ä¸º1</p>
<p>å‰©ä½™k-1ä¸ªè¯ï¼ˆè´Ÿæ ·æœ¬ï¼‰ï¼šå½“å‰è¯-åœ¨å­—å…¸ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªè¯ï¼Œæ ‡ç­¾ä¸º0</p>
<p>ï¼ˆ2ï¼‰æ¨¡å‹</p>
<p>Ox-&gt;E-&gt;ec-&gt;äºŒåˆ†ç±»å™¨-&gt;yhat</p>
<p>æ¯æ¬¡è®­ç»ƒk+1ä¸ªï¼Œsoftmaxä¸­æ˜¯äºŒåˆ†ç±»é—®é¢˜ã€‚ </p>
<p>äºŒåˆ†ç±»ä¸­çš„æ¦‚ç‡ä¸ºç›®æ ‡è¯tå‡ºç°åœ¨è¯cä¸Šä¸‹æ–‡çš„æ¦‚ç‡ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623162745.png" alt></p>
<p>ï¼ˆ3ï¼‰å¦‚ä½•é€‰æ‹©è´Ÿæ ·æœ¬</p>
<p>å³è€ƒè™‘è¯å‡ºç°çš„æ¦‚ç‡åˆè€ƒè™‘è¯çš„åˆ†å¸ƒï¼Œä»¥è¯å‡ºç°æ¦‚ç‡çš„3/4é™¤ä»¥æ€»ä½“å¾—åˆ°çš„æ¦‚ç‡æ¥é€‰æ‹©è´Ÿæ ·æœ¬ï¼ˆå•ä¸€ä»¥æ¦‚ç‡ï¼Œå®¹æ˜“ä¸€ç›´é€‰æ‹©åˆ°the a ofç­‰è¯ï¼‰ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623162853.png" alt></p>
<h3 id="gloveå‘é‡"><a href="#gloveå‘é‡" class="headerlink" title="gloveå‘é‡"></a>gloveå‘é‡</h3><p>ï¼ˆ1ï¼‰è®­ç»ƒé›†æ„å»º</p>
<p>ä¸Šä¸‹æ–‡-ç›®æ ‡è¯ï¼šç”¨Xijè¡¨ç¤ºå•è¯iå‡ºç°åœ¨å•è¯jä¸Šä¸‹æ–‡çš„æ¬¡æ•°ï¼Œè¡¡é‡ä¸¤ä¸ªå•è¯å½¼æ­¤æ¥è¿‘é¢‘ç‡çš„è®¡æ•°å™¨</p>
<p>ï¼ˆ2ï¼‰æ¨¡å‹</p>
<p>æœ€å°åŒ–ä¸¤ä¸ªå•è¯ä¹‹å‰çš„è·ç¦»ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623162915.png" alt></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ‰ä»¥ä¸Šä¸‰ç§æ–¹æ³•æ­å»ºè¯åµŒå…¥æ¨¡å‹ï¼Œå¾—åˆ°ä»å¤§é‡æ–‡æœ¬ä¸­å­¦ä¹ åˆ°é¥¿è¯å‘é‡çŸ¥è¯†ã€‚</p>
<p>ä¸ºäº†å¿«é€Ÿæ­å»ºNLPç³»ç»Ÿï¼Œå¯ä»¥ä»ç½‘ä¸Šä¸‹è½½åˆ«äººå·²è®­ç»ƒå¥½çš„è¯åµŒå…¥ï¼Œç”¨æ­¤è¿›è¡Œç³»ç»Ÿæ­å»ºã€‚</p>
<h3 id="é‡‡ç”¨è¯åµŒå…¥è¿›è¡Œè¯çš„ç±»æ¯”"><a href="#é‡‡ç”¨è¯åµŒå…¥è¿›è¡Œè¯çš„ç±»æ¯”" class="headerlink" title="é‡‡ç”¨è¯åµŒå…¥è¿›è¡Œè¯çš„ç±»æ¯”"></a>é‡‡ç”¨è¯åµŒå…¥è¿›è¡Œè¯çš„ç±»æ¯”</h3><p>æè¿°ï¼šè§£å†³aä¸bç±»ä¼¼äºcä¸ï¼Ÿçš„é—®é¢˜</p>
<p>ï¼ˆ1ï¼‰å¯¼å…¥è¯åµŒå…¥</p>
<p>è¿™é‡Œçš„è¯åµŒå…¥é‡‡ç”¨gloveå‘é‡ï¼Œå¯¼å…¥è¯åµŒå…¥æ¨¡å‹ä¸­çš„æ‰€æœ‰å•è¯ï¼ŒåŠå•è¯å¯¹åº”çš„è¯åµŒå…¥å‘é‡è¡¨ç¤ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥è¯åµŒå…¥ä¸­çš„è¯æ±‡å’Œå¯¹åº”è¡¨</span></span><br><span class="line"><span class="comment">#wordä»£è¡¨å­—ç¬¦ word_to_vec_mapä»£è¡¨å‘é‡è¡¨</span></span><br><span class="line">word,word_to_vec_map=w2v_utils.read_glove_vecs(<span class="string">'./data/glove.6B.50d.txt'</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å®šä¹‰ç›¸ä¼¼åº¦åº¦é‡å‡½æ•°</p>
<p>è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦é‡‡ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ¥è¡¨ç¤ºï¼Œä½™å¼¦å€¼è¶Šå¤§ï¼Œå½“ç­‰äº1æ—¶ï¼Œæ­¤æ—¶è§’åº¦ä¸º0ï¼Œè¯´æ˜ä¸¤ä¸ªè¯æœ€ç›¸ä¼¼ï¼Œä½™å¼¦å€¼è¶Šå°ä¸¤ä¸ªè¯è¶Šä¸ç›¸ä¼¼ï¼Œæ ¹æ®è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦å®šä¹‰å‡½æ•°ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623170723.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.è®¡ç®—è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="comment">#é‡‡ç”¨ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cosine_similarity</span><span class="params">(u,v)</span>:</span></span><br><span class="line">	np_dot=np.dot(u,v)</span><br><span class="line">	linalg_u=np.linalg.norm(u)</span><br><span class="line">	linalg_v=np.linalg.norm(v)</span><br><span class="line">	linalg_uv=np.dot(linalg_u,linalg_v)</span><br><span class="line"></span><br><span class="line">	cos_sim=np.divide(np_dot,linalg_uv)</span><br><span class="line">	<span class="keyword">return</span> cos_sim</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰è¿›è¡Œè¯çš„ç±»æ¯”</p>
<p>ç›®æ ‡ï¼šea-ebâ‰ˆeb-e?ï¼Œä¸ºäº†è®©ç­‰å¼æˆç«‹å°±è¦ä½¿å¾—ç­‰å¼å‰åçš„å¼å­ä»£è¡¨çš„å‘é‡è¶Šç›¸ä¼¼ï¼Œå³ä½™å¼¦å€¼è¦æœ€å¤§</p>
<p>1Â° å°†è¾“å…¥çš„ä¸‰ä¸ªå•è¯è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º</p>
<p>2Â°å¯¹è¯æ±‡è¡¨ä¸­æ‰€æœ‰å•è¯è¿›è¡Œéå†ï¼Œè®¡ç®—ea-ebâ‰ˆeb-e?</p>
<p>3Â°é€‰æ‹©ä½™å¼¦å€¼æœ€å¤§çš„å³æœ€ç›¸ä¼¼æ—¶çš„å•è¯ä½œä¸ºæ¨å‡ºçš„å•è¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">complete_analogy</span><span class="params">(word_a,word_b,word_c,word_to_vec_map)</span>:</span></span><br><span class="line">	<span class="comment">#å› ä¸ºè¯åµŒå…¥æ¨¡å‹ä¸­å•è¯å‡ä¸ºå°å†™ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è½¬æ¢</span></span><br><span class="line">	word_a,word_b,word_c=word_a.lower(),word_b.lower(),word_c.lower()</span><br><span class="line">	<span class="comment">#å°†å•è¯è½¬æ¢ä¸ºå‘é‡è¿›è¡Œè¿ç®—</span></span><br><span class="line">	e_a,e_b,e_c=word_to_vec_map[word_a],word_to_vec_map[word_b],word_to_vec_map[word_c]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å¾—åˆ°å­—å…¸é‡Œæ‰€æœ‰å•è¯</span></span><br><span class="line">	words=word_to_vec_map.keys()</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ‰¾åˆ°æœ€ç›¸è¿‘çš„è·ç¦»</span></span><br><span class="line">	max_cosine_sim=<span class="number">-100</span></span><br><span class="line">	cosine_word=word_c</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">		<span class="keyword">if</span> word <span class="keyword">in</span> [word_a,word_b,word_c]:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="comment">#ä½™å¼¦ç›¸ä¼¼åº¦ï¼šè¶Šç›¸ä¼¼ï¼Œè§’åº¦è¶Šå°ï¼Œå€¼è¶Šå¤§</span></span><br><span class="line">		<span class="comment">#coså€¼ä¸º1çš„æ—¶å€™æœ€å¤§ï¼Œæ­¤æ—¶è§’åº¦ä¸º0</span></span><br><span class="line">		cosine_sim=cosine_similarity((e_a-e_b),(e_c-word_to_vec_map[word]))</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> cosine_sim&gt;max_cosine_sim:</span><br><span class="line">			max_cosine_sim=cosine_sim</span><br><span class="line">			cosine_word=word</span><br><span class="line">	<span class="keyword">return</span> cosine_word</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<p>è¾“å…¥ä¸€ç»„è¯ï¼Œè¿›è¡Œç±»æ¯”æ¨ç†ï¼š</p>
<blockquote>
<p>triads_to_try = [(â€˜italyâ€™, â€˜italianâ€™, â€˜spainâ€™), (â€˜indiaâ€™, â€˜delhiâ€™, â€˜japanâ€™), (â€˜manâ€™, â€˜womanâ€™, â€˜boyâ€™), (â€˜happyâ€™, â€˜babyâ€™, â€˜beautifulâ€™)]<br>for triad in triads_to_try:<br>    print (â€˜{} -&gt; {} &lt;====&gt; {} -&gt; {}â€™.format( * triad, complete_analogy( * triad,word_to_vec_map)))</p>
</blockquote>
<p>å¾—å‡ºç»“æœï¼š</p>
<blockquote>
<p>italy -&gt; italian &lt;====&gt; spain -&gt; spanish<br>india -&gt; delhi &lt;====&gt; japan -&gt; tokyo<br>man -&gt; woman &lt;====&gt; boy -&gt; girl<br>happy -&gt; baby &lt;====&gt; beautiful -&gt; newborn</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºç±»æ¯”å‡ºçš„è¯è·ç¦»æœ€ç›¸è¿‘ï¼Œå³ç›¸ä¼¼ã€‚</p>
<p>ï¼ˆ4ï¼‰æ¶ˆé™¤è¯åµŒå…¥ä¸­çš„åå·®ï¼ˆé€‰å­¦ï¼Œäº†è§£å³å¯ï¼‰</p>
<p>å› ä¸ºç¤¾ä¼šä¸­å­˜åœ¨å¹´é¾„ã€æ€§åˆ«ç­‰çš„æ­§è§†ï¼Œæ‰€ä»¥åœ¨å¤§é‡æ–‡æœ¬ä¸­å­¦ä¹ åˆ°çš„è¯åµŒå…¥å®¹æ˜“å­˜åœ¨åå·®ï¼Œå› æ­¤ä»ä»¥ä¸‹ä¸¤æ–¹é¢å¯ä»¥æ¶ˆé™¤å­˜åœ¨çš„åå·®ã€‚</p>
<p>ä»¥æ€§åˆ«æ­§è§†å¸¦æ¥çš„åå·®ä¸ºä¾‹å­</p>
<p>1Â°ä¸­å’Œæ­¥ï¼šæ²¡æœ‰æ˜ç¡®æ€§åˆ«å«ä¹‰çš„è¯</p>
<p>è®¾å•è¯wordçš„è¯åµŒå…¥ä¸ºeï¼Œæ¶ˆé™¤eå’Œgä¹‹é—´çš„åå·®ï¼Œå› ä¸ºeä¸æ€§åˆ«æ— å…³ï¼Œå³éœ€è¦å‡å°‘å…¶åˆ°éæ€§åˆ«è½´ä¸Šçš„è·ç¦»å·®ï¼Œå³å°†eæ²¿ç€gçš„æ–¹å‘å½’0å³å¯</p>
<p>å…¬å¼ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623171310.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#4.æ¶ˆé™¤è¯åµŒå…¥ä¸­çš„åå·®</span></span><br><span class="line"><span class="comment">#ä¸­å’Œæ­¥:æ²¡æœ‰æ˜ç¡®æ€§åˆ«çš„å•è¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neutralize</span><span class="params">(word,g,word_to_vec_map)</span>:</span></span><br><span class="line">	word=word.lower()</span><br><span class="line">	e=word_to_vec_map[word]</span><br><span class="line">	np_dot=np.dot(e,g)</span><br><span class="line">	<span class="comment">#squareæ±‚å¹³æ–¹</span></span><br><span class="line">	e_bias=np.multiply(np.divide(np_dot,np.square(np.linalg.norm(g))),g)</span><br><span class="line">	e_disbias=e-e_bias</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> e_disbias</span><br></pre></td></tr></table></figure>

<p>2Â°å‡è¡¡æ­¥ï¼šæœ‰æ˜ç¡®æ€§åˆ«å«ä¹‰çš„è¯</p>
<p>å°†å…·æœ‰æ˜ç¡®æ€§åˆ«å«ä¹‰çš„ä¸€å¯¹å•è¯ï¼Œä½¿å¾—ä»–ä»¬åˆ°éæ€§åˆ«è½´çš„è·ç¦»ç›¸ç­‰ï¼Œåªæœ‰æ€§åˆ«æ‰èƒ½å°†å…¶åŒºåˆ†ã€‚</p>
<p>å…¬å¼ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623171348.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å‡è¡¡æ­¥ï¼šæ˜ç¡®æ€§åˆ«çš„å•è¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">equalize</span><span class="params">(pairs,bias_axis,word_to_vec_map)</span>:</span></span><br><span class="line">	w1,w2=pairs</span><br><span class="line">	e_w1,e_w2=word_to_vec_map[w1],word_to_vec_map[w2]</span><br><span class="line">	mu=np.divide((e_w1+e_w2),<span class="number">2</span>)</span><br><span class="line">	mub=np.divide(np.multiply(np.dot(mu,bias_axis),bias_axis),np.square(np.linalg.norm(bias_axis)))</span><br><span class="line">	mu_orth=mu-mub</span><br><span class="line">	e_w1b=np.divide(np.multiply(np.dot(e_w1,bias_axis),bias_axis),np.square(np.linalg.norm(bias_axis)))</span><br><span class="line">	e_w2b=np.divide(np.multiply(np.dot(e_w2,bias_axis),bias_axis),np.square(np.linalg.norm(bias_axis)))</span><br><span class="line">	e_w1cor=np.multiply(np.sqrt(np.abs(<span class="number">1</span>-np.square(np.linalg.norm(mu_orth)))),np.divide(e_w1b-mub,np.abs((e_w1-mu_orth)-mub)))</span><br><span class="line">	e_w2cor=np.multiply(np.sqrt(np.abs(<span class="number">1</span>-np.square(np.linalg.norm(mu_orth)))),np.divide(e_w2b-mub,np.abs((e_w2-mu_orth)-mub)))</span><br><span class="line">	e1=e_w1cor+mu_orth</span><br><span class="line">	e2=e_w2cor+mu_orth</span><br><span class="line">	<span class="keyword">return</span> e1,e2</span><br></pre></td></tr></table></figure>

<h2 id="åˆ©ç”¨è¯åµŒå…¥æ­å»ºNLPç³»ç»Ÿ"><a href="#åˆ©ç”¨è¯åµŒå…¥æ­å»ºNLPç³»ç»Ÿ" class="headerlink" title="åˆ©ç”¨è¯åµŒå…¥æ­å»ºNLPç³»ç»Ÿ"></a>åˆ©ç”¨è¯åµŒå…¥æ­å»ºNLPç³»ç»Ÿ</h2><h3 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>åˆ©ç”¨å·²è®­ç»ƒçš„è¯åµŒå…¥æ¨¡å‹ï¼Œæ ¹æ®è¾“å…¥çš„å¥å­ï¼Œåˆ¤æ–­å¥å­ä»£è¡¨çš„emojiè¡¨æƒ…ï¼Œè®¾å®šemojiæ ‡ç­¾ä¸º5ä¸ªã€‚</p>
<h3 id="è¯åµŒå…¥ä¸æ•°æ®é›†"><a href="#è¯åµŒå…¥ä¸æ•°æ®é›†" class="headerlink" title="è¯åµŒå…¥ä¸æ•°æ®é›†"></a>è¯åµŒå…¥ä¸æ•°æ®é›†</h3><p>ï¼ˆ1ï¼‰å¯¼å…¥è¯åµŒå…¥</p>
<p>å°†å•è¯å’Œå•è¯ä»£è¡¨çš„golveå‘é‡ä½œä¸ºè¯¥æ¨¡å‹ä¸­çš„è¯åµŒå…¥ï¼Œå¹¶å°†æ¯ä¸ªå•è¯åœ¨å•è¯è¡¨ä¸­çš„ç´¢å¼•è¿›è¡Œå­˜å‚¨ã€‚num=len(word_to_vec_map[â€˜.â€™])</p>
<p>æ¯ä¸ªä½¿ç”¨è¯åµŒå…¥çš„è¯çš„ç»´åº¦ä¸º(num,1)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#0.å®šä¹‰è¯å‘é‡</span></span><br><span class="line">word_to_index, index_to_word, word_to_vec_map=emo_utils.read_glove_vecs(<span class="string">'./data/glove.6B.50d.txt'</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰è®­ç»ƒé›†</p>
<p>1Â°xï¼šä»è¡¨æ ¼ä¸­è¯»å–æ¯è¡Œçš„å¥å­æ„æˆå¥å­æ•°ç»„</p>
<p>2Â°yï¼šè¯»å…¥æ¯ä¸ªå¥å­çš„æ ‡ç­¾å€¼ï¼Œå› ä¸ºemojiæœ‰äº”ä¸ªæ ‡ç­¾ï¼Œè¿™é‡Œå°†yæ ‡ç­¾å€¼è½¬æ¢ä¸º1 * 5çš„ç‹¬çƒ­å‘é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥æ•°æ®</span></span><br><span class="line">X_train,Y_train=emo_utils.read_csv(<span class="string">'./data/train_emoji.csv'</span>)</span><br><span class="line">X_test,Y_test=emo_utils.read_csv(<span class="string">'./data/test.csv'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†yè½¬æ¢ä¸ºç‹¬çƒ­å‘é‡</span></span><br><span class="line">Y_oh_train=emo_utils.convert_to_one_hot(Y_train,C=<span class="number">5</span>)</span><br><span class="line">Y_oh_test=emo_utils.convert_to_one_hot(Y_test,C=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ç®€å•æ¨¡å‹"><a href="#ç®€å•æ¨¡å‹" class="headerlink" title="ç®€å•æ¨¡å‹"></a>ç®€å•æ¨¡å‹</h3><p>å°†å¥å­ä¸­æ¯ä¸ªå•è¯ä½¿ç”¨è¯åµŒå…¥è¡¨ç¤ºï¼Œæ¯ä¸ªè¯çš„ç»´åº¦ä¸ºï¼ˆnum,1ï¼‰ï¼Œå‡è®¾å¥å­ä¸­æœ‰kä¸ªå•è¯ï¼Œåˆ™å°†è¿™kä¸ªå•è¯çš„è¯åµŒå…¥ç«–å‘å †å èµ·æ¥ï¼Œå–å‡å€¼ï¼Œå†ç»è¿‡softmaxè¿›è¡Œé¢„æµ‹å¾—åˆ°ç»“æœã€‚</p>
<p>ç½‘ç»œæ¨¡å‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623163047.png" alt></p>
<p>softmaxç½‘ç»œä¼ æ’­</p>
<p>1Â°å®šä¹‰softmaxå±‚çš„æƒé‡å’Œåç½®é‡ï¼Œç”±äºè¾“å‡ºå€¼ä¸ºï¼ˆ1ï¼Œ5ï¼‰çš„ç‹¬çƒ­å‘é‡ï¼Œåç½®é‡bçš„ç»´åº¦ä¸ºï¼ˆn_y,1ï¼‰n_y=5ï¼Œæƒé‡wçš„ç»´åº¦ä¸ºï¼ˆn_h,n_yï¼‰ï¼Œå‡å€¼åavgçš„ç»´åº¦ä¸ºï¼ˆ50,ï¼‰ï¼Œn_h=50</p>
<p>w:ï¼ˆ50ï¼Œ5ï¼‰</p>
<p>b:ï¼ˆ5ï¼Œ1ï¼‰</p>
<p>2Â°åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œåˆ†åˆ«å¯¹æ‰€æœ‰å¥å­éå†ï¼Œå¾—åˆ°æ¯ä¸ªå•è¯è¯åµŒå…¥çš„å¹³å‡æ•°ï¼Œå†è¿›è¡Œæ­£å‘ä¼ æ’­ï¼Œè®¡ç®—æŸå¤±ï¼Œåå‘ä¼ æ’­ï¼Œè®¡ç®—æ¢¯åº¦</p>
<p>ç½‘ç»œç»“æ„ï¼šavg-&gt;linear-&gt;a-&gt;softmax-&gt;yhat</p>
<p>3Â°å¾—åˆ°å¥å­ä¸­æ¯ä¸ªå•è¯è¯åµŒå…¥çš„å¹³å‡æ•°ï¼šæ‹†åˆ†å¥å­ä¸­çš„å•è¯ï¼Œå¯¹æ‰€æœ‰å•è¯éå†ï¼Œå¾—åˆ°æ¯ä¸ªå•è¯çš„è¯åµŒå…¥å†é™¤ä»¥å•è¯æ€»æ•°ï¼Œå¾—åˆ°å¹³å‡å€¼ä½œä¸ºç½‘ç»œçš„è¾“å…¥</p>
<p>ï¼ˆ1ï¼‰å°†è¾“å…¥çš„å•è¯è½¬æ¢ä¸ºgloveå‘é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.å°†è¾“å…¥çš„å¥å­æ‹†åˆ†ä¸ºå•è¯å¹¶ç”¨gloveè¯å‘é‡ï¼Œå¹¶å¯¹å¥å­ä¸­æ¯ä¸ªå•è¯å–å¹³å‡å¾—åˆ°æ•´ä¸ªå¥å­ä»£è¡¨çš„å‘é‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sentence_to_avg</span><span class="params">(sentence,word_to_vec_map)</span>:</span></span><br><span class="line">	<span class="comment">#æ‹†åˆ†å¥å­</span></span><br><span class="line">	words=sentence.lower().split()</span><br><span class="line"></span><br><span class="line">	m=len(word_to_vec_map[<span class="string">'.'</span>])</span><br><span class="line">	add_sum=np.zeros((m,))</span><br><span class="line">	count=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">		add_sum+=word_to_vec_map[word]</span><br><span class="line">		count+=<span class="number">1</span></span><br><span class="line">	avg=add_sum/count</span><br><span class="line">	<span class="keyword">return</span> avg</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ­å»ºæ¨¡å‹ï¼Œå°†æ¯ä¸ªå¥å­ä»£è¡¨çš„å‘é‡è¾“å…¥softmaxå•å…ƒä¸­è¿›è¡Œè®­ç»ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.æ„å»ºæ¨¡å‹</span></span><br><span class="line"><span class="comment">#x:(m,1)   y: (m,1)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(X,Y,word_to_vec_map,learning_rate=<span class="number">0.01</span>,num_iteritions=<span class="number">400</span>)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"></span><br><span class="line">	m=Y.shape[<span class="number">0</span>]</span><br><span class="line">	n_y=<span class="number">5</span></span><br><span class="line">	n_h=len(word_to_vec_map[<span class="string">'.'</span>])</span><br><span class="line">	np.random.seed(<span class="number">1</span>)</span><br><span class="line">	W=np.random.randn(n_y,n_h)/np.sqrt(n_h)</span><br><span class="line">	b=np.zeros((n_y,))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#yå€¼è½¬æ¢ä¸ºç‹¬çƒ­å‘é‡</span></span><br><span class="line">	Y_oh=emo_utils.convert_to_one_hot(Y,C=n_y)</span><br><span class="line">	costs=[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ¯æ¬¡è¿­ä»£</span></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> range(num_iteritions):</span><br><span class="line">		<span class="comment">#æ‹†åˆ†æ¯ä¸ªå¥å­</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">			avg=sentence_to_avg(X[i],word_to_vec_map)</span><br><span class="line"></span><br><span class="line">			<span class="comment">#æ­£å‘ä¼ æ’­è®¡ç®—softmax åˆ©ç”¨å¾—åˆ°çš„å‡å€¼</span></span><br><span class="line">			z=np.dot(W,avg)+b</span><br><span class="line">			a=emo_utils.softmax(z)</span><br><span class="line">			cost=-np.sum(Y_oh[i]*np.log(a))</span><br><span class="line"></span><br><span class="line">			<span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">			dz=a-Y_oh[i]</span><br><span class="line">			dw=np.dot(dz.reshape(n_y,<span class="number">1</span>),avg.reshape(<span class="number">1</span>,n_h))</span><br><span class="line">			db=dz</span><br><span class="line"></span><br><span class="line">			W=W-learning_rate*dw</span><br><span class="line">			b=b-learning_rate*db</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> t%<span class="number">100</span>==<span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"ç¬¬"</span>+str(t)+<span class="string">"æ¬¡ï¼ŒæŸå¤±ä¸ºï¼š"</span>+str(cost))</span><br><span class="line">			costs.append(cost)</span><br><span class="line">			pred=emo_utils.predict(X,Y,W,b,word_to_vec_map)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pred,W,b</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ç»“æœ</p>
<p>å°†è®­ç»ƒé›†å’Œè¯åµŒå…¥æ¨¡å‹ä¼ å…¥ï¼Œå®šä¹‰å­¦ä¹ ç‡ä¸º0.01ï¼Œè¿­ä»£æ¬¡æ•°400æ¬¡ï¼Œæœ€ç»ˆå¾—åˆ°è®­ç»ƒå¥½çš„ç½‘ç»œå‚æ•°ï¼ˆw,bï¼‰ï¼Œä¼ å…¥è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¾—åˆ°å‡†ç¡®ç‡ä¸º</p>
<blockquote>
<p>pred, W, b = model(X_train, Y_train, word_to_vec_map)<br>print(â€œè®­ç»ƒé›†ï¼šâ€)<br>pred_train=emo_utils.predict(X_train,Y_train,W,b,word_to_vec_map)<br>print(â€œæµ‹è¯•é›†ï¼šâ€)<br>pred_test=emo_utils.predict(X_test,Y_test,W,b,word_to_vec_map)</p>
</blockquote>
<p>è®­ç»ƒé›†ï¼š<br>Accuracy: 0.9772727272727273<br>æµ‹è¯•é›†ï¼š<br>Accuracy: 0.8571428571428571</p>
<p>é€‰æ‹©ä¸€äº›å¥å­è½¬æ¢ä¸ºæ•°ç»„è¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°emojiè¡¨æƒ…ï¼Œå‘ç°you are not happyé¢„æµ‹ä¸º â¤ï¸ï¼Œå¯è§è¯¥æ¨¡å‹æ²¡æœ‰è€ƒè™‘è¯çš„é¡ºåºï¼Œåªæ ¹æ®happyå¾—åˆ°äº†é¢„æµ‹ï¼Œæ²¡æœ‰è€ƒè™‘å‰é¢çš„notï¼Œå› æ­¤é‡‡ç”¨è€ƒè™‘è¯åºçš„RNNæ¨¡å‹å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚</p>
<h3 id="RNNæ¨¡å‹"><a href="#RNNæ¨¡å‹" class="headerlink" title="RNNæ¨¡å‹"></a>RNNæ¨¡å‹</h3><p>ç½‘ç»œæ¨¡å‹</p>
<p>æ€»ä½“æ€è·¯ï¼šå°†æ¯ä¸ªå¥å­ä¹˜ä¸Šè¯åµŒå…¥çŸ©é˜µå¾—åˆ°ç‰¹å¾å‘é‡ï¼Œä½œä¸ºRNNçš„è¾“å…¥ï¼Œæ¯ä¸ªæ—¶åˆ»éƒ½è€ƒè™‘äº†ä¸Šä¸€ä¸ªé¡ºåºçš„è¾“å…¥ï¼Œæœ€ç»ˆçš„åˆ°è¾“å‡ºé¢„æµ‹å€¼ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623163134.png" alt></p>
<p>å®é™…ä¸­ç½‘ç»œç»“æ„ç¨æœ‰å˜åŒ–ï¼Œé‡‡ç”¨ä¸¤å±‚éšè—å±‚ï¼Œä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ¯å±‚çš„è¾“å‡ºéƒ½ä¼šç»è¿‡dropoutï¼Œéšæœºä¸¢å¼ƒä¸€äº›èŠ‚ç‚¹ï¼Œç¬¬ä¸€å±‚éšè—å±‚è¾“å…¥Txä¸ªæ•°æ®ï¼Œè¾“å‡ºTxä¸ªæ•°æ®ã€‚ç¬¬äºŒå±‚éšè—å±‚è¾“å…¥Txä¸ªæ•°æ®ï¼Œè¾“å‡º1ä¸ªæ•°æ®ï¼Œå³æœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200623194624.png" alt></p>
<p>1Â°æŒ‰ç…§æœ€å¤§é•¿åº¦çš„å¥å­å•è¯æ•°è¡¥0ï¼šç”±äºä¼ å…¥ç½‘ç»œçš„å•è¯æ•°é‡å›ºå®šï¼Œæ‰€ä»¥éœ€è¦è¡¥0</p>
<p>å¯¹mä¸ªå¥å­ï¼ŒæŒ‰ç…§max_lenå¤§å°ç”Ÿæˆï¼ˆm,max_lenï¼‰çš„è¡¥0åçš„å•è¯çŸ©é˜µï¼ˆä»¥å•è¯ä½ç½®ä½œä¸ºçŸ©é˜µçš„å€¼ï¼‰ï¼š</p>
<p>å¯¹æ¯ä¸ªå¥å­ï¼Œæ‹†åˆ†å…¶ä¸­å•è¯ï¼Œå¾—åˆ°æ¯ä¸ªå•è¯çš„ç´¢å¼•è¿›è¡Œå­˜å‚¨</p>
<p>2Â°å°†å•è¯çŸ©é˜µä¹˜ä»¥è¯åµŒå…¥çŸ©é˜µEå¾—åˆ°åµŒå…¥çš„ç‰¹å¾å‘é‡è¡¨ç¤ºeï¼šæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼š</p>
<p>æ ¹æ®æ¯ä¸ªå•è¯çš„ç´¢å¼•ä½ç½®å¾—åˆ°åœ¨è¯åµŒå…¥ä¸­çš„å‘é‡è¡¨ç¤ºï¼Œå¹¶å­˜å‚¨åœ¨åµŒå…¥çŸ©é˜µEä¸­ï¼›</p>
<p>åˆ©ç”¨keras.layerä¸­çš„Embeddingå±‚å¾—åˆ°æ¯ä¸ªå•è¯çš„è¯åµŒå…¥è¡¨ç¤ºï¼Œè¯¥å±‚ä¸éœ€è¦è®­ç»ƒï¼Œåˆ™è®¾ç½®trainable=Falseï¼Œè¾“å…¥è¯æ±‡è¡¨çš„å¤§å°ï¼Œè¾“å‡ºè¯åµŒå…¥å‘é‡çš„å¤§å°ï¼Œå»ºç«‹è¯¥å±‚ï¼Œå¹¶è®¾ç½®è¯¥å±‚çš„æƒé‡ä¸ºåµŒå…¥çŸ©é˜µEï¼Œæœ€ç»ˆèƒ½è¿”å›æ¯ä¸ªå•è¯çš„è¯åµŒå…¥ã€‚</p>
<p>æ³¨ï¼šæ­¤æ­¥éª¤æ˜¯æ ¹æ®Ox * E =ecï¼Œæ±‚å…¶ä¸­çš„Eï¼Œè€Œç®€å•æ¨¡å‹ä¸­æ˜¯ç›´æ¥ä½¿ç”¨äº†è¯å‘é‡ã€‚</p>
<p>3Â°æ­å»ºæ¨¡å‹ï¼š</p>
<p>æ ¹æ®è¾“å…¥çš„æœ€å¤§å•è¯çš„é•¿åº¦ï¼Œå®šä¹‰ç½‘ç»œçš„è¾“å…¥ï¼›</p>
<p>æ ¹æ®å·²ç»è®­ç»ƒçš„è¯å‘é‡å¾—åˆ°è¯åµŒå…¥çŸ©é˜µEï¼Œå°†ç½‘ç»œè¾“å…¥ä¼ å…¥å…¶ä¸­ï¼Œå¾—åˆ°è¯åµŒå…¥ï¼Œä½œä¸ºçœŸæ­£çš„è¾“å…¥LSTMå•å…ƒä¸­çš„æ•°æ®ï¼›</p>
<p>å®šä¹‰LSTM-&gt;Dropout-&gt;LSTM-&gt;Dropout-&gt;Dense-&gt;Activation(sotfmax)ï¼Œæœ€ç»ˆçš„åˆ°è¾“å‡º</p>
<p>ï¼ˆ1ï¼‰å¡«å……æ¯ä¸ªå¥å­ï¼šä»¥æœ€å¤§é•¿åº¦çš„å¥å­ä¸ºåŸºå‡†ï¼Œåœ¨æœ«å°¾è¿›è¡Œè¡¥0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é‡‡ç”¨RNNæ¨¡å‹æ„å»ºè€ƒè™‘è¯é¡ºåºçš„é¢„æµ‹ç½‘ç»œ</span></span><br><span class="line"><span class="comment">#1.å°†çŸ­çš„è¯æŒ‰ç…§æœ€é•¿çš„é•¿åº¦å¡«å……</span></span><br><span class="line"><span class="comment">#ä¼ å…¥å¥å­æ•°ç»„åŠå…¶ç´¢å¼•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sentences_to_indices</span><span class="params">(X,word_to_index,max_len)</span>:</span></span><br><span class="line">	m=X.shape[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">	X_indices=np.zeros((m,max_len))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		words=X[i].lower().split()</span><br><span class="line">		j=<span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">			X_indices[i,j]=word_to_index[word]</span><br><span class="line">			j=j+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> X_indices</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¾—åˆ°è¯åµŒå…¥çŸ©é˜µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#2.æ„å»ºembeddingå±‚ï¼Œæ„å»ºè¯å‘é‡çŸ©é˜µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pretrained_embedding_layer</span><span class="params">(word_to_vec_map,word_to_index)</span>:</span></span><br><span class="line">	vocab_size=len(word_to_index)+<span class="number">1</span> <span class="comment">#åŠ 1æ˜¯ä¸ºäº†è€ƒè™‘å¥å­æ²¡æœ‰åˆ°æœ€å¤§é•¿åº¦çš„0å‘é‡</span></span><br><span class="line">	em_size=len(word_to_vec_map[<span class="string">'.'</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ¯ä¸ªå•è¯çš„è¯å‘é‡è¿›è¡Œå †å </span></span><br><span class="line">	emb_matrix=np.zeros((vocab_size,em_size))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> word,index <span class="keyword">in</span> word_to_index.items():</span><br><span class="line">		emb_matrix[index,:]=word_to_vec_map[word]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è¾“å…¥è¯æ±‡è¡¨å¤§å°ï¼Œè¯å‘é‡ç»´åº¦,ä¸ç”¨è®­ç»ƒ</span></span><br><span class="line">	embedding_layer=Embedding(vocab_size,em_size,trainable=<span class="literal">False</span>)</span><br><span class="line">	embedding_layer.build((<span class="literal">None</span>,))</span><br><span class="line">	embedding_layer.set_weights([emb_matrix])</span><br><span class="line">	<span class="keyword">return</span> embedding_layer</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æ­å»ºæ¨¡å‹ï¼Œæ ¹æ®è¯åµŒå…¥çŸ©é˜µè¿›è¡Œä¸¤å±‚lstmä¼ æ’­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.æ­å»ºlstmæ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Emojifier_V2</span><span class="params">(input_shape,word_to_vec_map,word_to_index)</span>:</span></span><br><span class="line">	sentence_indices=Input(input_shape,dtype=<span class="string">'float32'</span>)</span><br><span class="line"></span><br><span class="line">	embedding_layer=pretrained_embedding_layer(word_to_vec_map,word_to_index)</span><br><span class="line"></span><br><span class="line">	embeddings=embedding_layer(sentence_indices)</span><br><span class="line"></span><br><span class="line">	X=LSTM(<span class="number">128</span>,return_sequences=<span class="literal">True</span>)(embeddings)</span><br><span class="line">	X=Dropout(<span class="number">0.5</span>)(X)</span><br><span class="line">	X=LSTM(<span class="number">128</span>,return_sequences=<span class="literal">False</span>)(X)</span><br><span class="line">	X=Dropout(<span class="number">0.5</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Dense(<span class="number">5</span>)(X)</span><br><span class="line">	X=Activation(activation=<span class="string">'softmax'</span>)(X)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	model=Model(inputs=sentence_indices,outputs=X)</span><br><span class="line">	<span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰ç»“æœ</p>
<p>ç»¼ä¸Šï¼Œå°†å¾—åˆ°çš„æ¨¡å‹è¿›è¡Œç¼–è¯‘ï¼ˆcompileï¼‰ï¼Œå°†è¾“å…¥çš„è®­ç»ƒé›†è¿›è¡Œè¡¥0ï¼Œè¾“å…¥æ¨¡å‹ä¸­ï¼ˆfitï¼‰ï¼ˆæŒ‡æ˜batch_size,epochsï¼Œåˆ™æ¨¡å‹è®­ç»ƒå®Œæ¯•ï¼Œå¾—åˆ°è®­ç»ƒé›†ç²¾åº¦æ¥è¿‘1ï¼š</p>
<blockquote>
<p>Epoch 50/50</p>
<p> 32/132 [======&gt;â€¦â€¦â€¦â€¦â€¦â€¦â€¦..] - ETA: 0s - loss: 0.2743 - accuracy: 0.9688<br>132/132 [==============================] - 0s 558us/step - loss: 0.1291 - accuracy: 0.9697</p>
<p>32/56 [================&gt;â€¦â€¦â€¦â€¦.] - ETA: 0s<br>56/56 [==============================] - 0s 2ms/step</p>
</blockquote>
<p>è¾“å…¥æµ‹è¯•é›†æ•°æ®ï¼ˆevaluateï¼‰ï¼Œå¾—åˆ°æ¨¡å‹é¢„æµ‹çš„æŸå¤±å’Œç²¾åº¦ä¸ºï¼š</p>
<blockquote>
<p>X_test_indices=sentences_to_indices(X_test,word_to_index,max_len)</p>
<p>loss,acc=model.evaluate(X_test_indices,Y_oh_test)</p>
<p>print(â€œtest accuracy:â€,acc)</p>
</blockquote>
<blockquote>
<p>test accuracy: 0.875</p>
</blockquote>
<p>è‡ªå·±å†™ä¸€äº›å¥å­è¿›è¡Œé¢„æµ‹ï¼Œå‘ç°not happyå¯ä»¥æ­£ç¡®è¿›è¡Œé¢„æµ‹äº†ï¼Œæ”¹å–„äº†ä¸Šé¢åŸºæœ¬æ¨¡å‹å‡ºç°çš„é—®é¢˜ï¼šé¢„æµ‹ç»“æœi am not happy ğŸ˜ï¼Œæ­£ç¡®ç‡ä¹Ÿæ¯”åŸºæœ¬æ¨¡å‹æé«˜äº†ã€‚</p>
<h3 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h3><p>ï¼ˆ1ï¼‰ç®€å•æ¨¡å‹ä¸­æ˜¯å°†è®­ç»ƒçš„è¯å‘é‡æ±‚å’Œå¾—åˆ°å‡å€¼ä½œä¸ºç½‘ç»œçš„è¾“å…¥ï¼Œè€ŒRNNæ¨¡å‹éœ€è¦å°†æ¯ä¸ªå¥å­è¡¥æˆä¸€æ ·é•¿ï¼Œé€šè¿‡è®­ç»ƒçš„è¯å‘é‡å¾—åˆ°ä¸€ä¸ªæ€»çš„åµŒå…¥çŸ©é˜µEï¼Œé€šè¿‡keraså¾—åˆ°æ¯ä¸ªå•è¯çš„è¯åµŒå…¥ï¼ˆä¸€ä¸ªä¸ªè¿›è¡Œè®¡ç®—çš„ï¼‰ï¼Œå¾—åˆ°çš„ç»“æœä½œä¸ºç½‘ç»œçš„è¾“å…¥ã€‚</p>
<p>ï¼ˆ2ï¼‰ç®€å•æ¨¡å‹æ²¡æœ‰è€ƒè™‘è¯åºï¼ŒRNNæ¨¡å‹è€ƒè™‘äº†è¯åºï¼Œæ‰€ä»¥é¢„æµ‹çš„æ—¶å€™å›å‡†ç¡®äº›ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å¾ªç¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åºåˆ—æ¨¡å‹RNNâ€”â€”æ„å»ºå³å…´æ¼”å¥çš„çˆµå£«éŸ³ä¹çš„LSTMæ¨¡å‹</title>
    <url>/blogs/rnn1Music/</url>
    <content><![CDATA[<p>ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±å’Œè·å¾—æ›´æ·±å±‚çš„è¿æ¥ï¼Œé‡‡ç”¨keras.layers.recurrentä¸­çš„LSTMæ¨¡å‹æ„å»ºç¥ç»å•å…ƒã€‚</p><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åˆ©ç”¨å·²æœ‰çš„éŸ³ä¹ç‰‡æ®µï¼Œæ­å»ºèƒ½å¤Ÿç”Ÿæˆå³å…´éŸ³ä¹çš„æ¨¡å‹ã€‚</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="å¯¼å…¥æ•°æ®"><a href="#å¯¼å…¥æ•°æ®" class="headerlink" title="å¯¼å…¥æ•°æ®"></a>å¯¼å…¥æ•°æ®</h3><p>å¯¼å…¥æœ¬åœ°çš„åŸå§‹éŸ³ä¹ï¼Œå¹¶ä»ä¸­æå–éŸ³èŠ‚å’ŒéŸ³è°ƒ</p><p>è¿™é‡Œçš„xçš„ç»´åº¦ä¸ºï¼ˆm,T_x,n_valuesï¼‰ï¼Œmä»£è¡¨æ ·æœ¬ä¸ªæ•°ï¼ŒT_xä»£è¡¨æ—¶é—´æ­¥ï¼Œn_valuesä»£è¡¨å­—å…¸å¤§å°ï¼Œæ¯ä¸ªæ ·æœ¬è¢«è¡¨ç¤ºæˆn_valueså¤§å°çš„ç‹¬çƒ­å‘é‡ï¼Œè¿™é‡Œéšè—å±‚å¤§å°è®¾ç½®ä¸º64ï¼Œå³n_a=64ã€‚</p><a id="more"></a>



<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥æ•°æ®</span></span><br><span class="line"><span class="comment">#x.shape: (60, 30, 78)</span></span><br><span class="line"><span class="comment">#y.shape (30, 60, 78)</span></span><br><span class="line"><span class="comment">#n_valuesä»£è¡¨å­—å…¸æ•°é‡ï¼Œindies_valuesä»£è¡¨å­—å…¸</span></span><br><span class="line">X,Y,n_values,indies_values=load_music_utils()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_music_utils</span><span class="params">()</span>:</span></span><br><span class="line">    chords, abstract_grammars = get_musical_data(<span class="string">'data/original_metheny.mid'</span>)</span><br><span class="line">    corpus, tones, tones_indices, indices_tones = get_corpus_data(abstract_grammars)</span><br><span class="line">    N_tones = len(set(corpus))</span><br><span class="line">    X, Y, N_tones = data_processing(corpus, tones_indices, <span class="number">60</span>, <span class="number">30</span>)   </span><br><span class="line">    <span class="keyword">return</span> (X, Y, N_tones, indices_tones)</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥æ•°æ®åå¾—åˆ°æ€»æ ·æœ¬ã€å®é™…è¾“å‡ºã€å­—å…¸çš„ä¸ªæ•°ã€å…·ä½“å­—å…¸çš„å†…å®¹ã€‚</p>
<h3 id="åˆ©ç”¨kerasæ­å»ºåŸºæœ¬ç¥ç»å•å…ƒ"><a href="#åˆ©ç”¨kerasæ­å»ºåŸºæœ¬ç¥ç»å•å…ƒ" class="headerlink" title="åˆ©ç”¨kerasæ­å»ºåŸºæœ¬ç¥ç»å•å…ƒ"></a>åˆ©ç”¨kerasæ­å»ºåŸºæœ¬ç¥ç»å•å…ƒ</h3><p>ï¼ˆ1ï¼‰é‡æ„æ¯ä¸ªæ—¶é—´æ­¥çš„x</p>
<p>ï¼ˆ2ï¼‰å®šä¹‰å•æ­¥ä¼ æ’­çš„ç¥ç»å•å…ƒLSTM</p>
<p>ï¼ˆ3ï¼‰å®šä¹‰æœ€ç»ˆè¾“å‡ºçš„é¢„æµ‹å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.åˆ©ç”¨kerasæ­å»ºlstmæ¨¡å‹</span></span><br><span class="line">n_a=<span class="number">64</span></span><br><span class="line">reshapor=Reshape((<span class="number">1</span>,n_values))</span><br><span class="line">LSTM_cell=LSTM(n_a,return_state=<span class="literal">True</span>)</span><br><span class="line">densor=Dense(n_values,activation=<span class="string">'softmax'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="æ­å»ºæ¨¡å‹"><a href="#æ­å»ºæ¨¡å‹" class="headerlink" title="æ­å»ºæ¨¡å‹"></a>æ­å»ºæ¨¡å‹</h3><p>ï¼ˆ0ï¼‰å®šä¹‰è¾“å…¥çš„Xï¼Œå½“å‰åˆå§‹çš„æ¿€æ´»å€¼çš„è®°å¿†ç»†èƒå€¼</p>
<p>ï¼ˆ1ï¼‰åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸‹</p>
<p>ï¼ˆ2ï¼‰åˆ›å»ºä¸€ä¸ªä¸´æ—¶å‡½æ•°ï¼Œæå–å‡ºé€‚å½“çš„ç‹¬çƒ­å‘é‡ä½œä¸ºkeras.layerså¯¹è±¡ï¼šx=Lambda(lambda x:X[:,t,])(X)</p>
<p>ï¼ˆ3ï¼‰é‡æ„å½“å‰æ—¶é—´æ­¥xå¤§å°</p>
<p>ï¼ˆ4ï¼‰è°ƒç”¨LSTM_cellï¼Œç»è¿‡ä¸€ä¸ªlstmå•å…ƒä¼ æ’­ï¼Œå¾—åˆ°æ¿€æ´»å€¼å’Œè®°å¿†ç»†èƒå€¼</p>
<p>ï¼ˆ5ï¼‰è°ƒç”¨densorï¼Œå¾—åˆ°è¾“å‡ºå€¼out</p>
<p>ï¼ˆ6ï¼‰å°†æ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºå€¼è¿›è¡Œä¿å­˜</p>
<p>ï¼ˆ7ï¼‰æœ€ç»ˆç”Ÿæˆæ¨¡å‹ï¼šmodel=Model(inputs=[X,a0,c0],outputs=outputs)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">djmodel</span><span class="params">(T_x,n_a,n_values)</span>:</span></span><br><span class="line">	<span class="comment">#å®šä¹‰è¾“å…¥æ•°æ®çš„ç»´åº¦</span></span><br><span class="line">	X=Input((T_x,n_values))</span><br><span class="line">	a0=Input(shape=(n_a,),name=<span class="string">'a0'</span>)</span><br><span class="line">	c0=Input(shape=(n_a,),name=<span class="string">'c0'</span>)</span><br><span class="line">	a=a0</span><br><span class="line">	c=c0</span><br><span class="line"></span><br><span class="line">	outputs=[]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> range(T_x):</span><br><span class="line">		x=Lambda(<span class="keyword">lambda</span> x:X[:,t,])(X)</span><br><span class="line">		x=reshapor(x)</span><br><span class="line"></span><br><span class="line">		a,_,c=LSTM_cell(x,initial_state=[a,c])</span><br><span class="line"></span><br><span class="line">		out=densor(a)</span><br><span class="line"></span><br><span class="line">		outputs.append(out)</span><br><span class="line">	model=Model(inputs=[X,a0,c0],outputs=outputs)</span><br><span class="line">	<span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–è¯‘å¹¶è®­ç»ƒæ¨¡å‹"><a href="#ç¼–è¯‘å¹¶è®­ç»ƒæ¨¡å‹" class="headerlink" title="ç¼–è¯‘å¹¶è®­ç»ƒæ¨¡å‹"></a>ç¼–è¯‘å¹¶è®­ç»ƒæ¨¡å‹</h3><p>ï¼ˆ1ï¼‰ç¼–è¯‘æ¨¡å‹ï¼ŒæŒ‡å®šä¼˜åŒ–ç®—æ³•ï¼ˆåŒ…å«å…¶é¤å®¿ï¼‰ã€æŸå¤±å’Œéœ€è¦æ‰“å°çš„å‡†ç¡®åº¦</p>
<p>ï¼ˆ2ï¼‰å®šä¹‰åˆå§‹ä¼ªæ¿€æ´»å€¼ï¼Œä¼ªè®°å¿†ç»†èƒï¼ˆé›¶å‘é‡ï¼‰</p>
<p>ï¼ˆ3ï¼‰å°†ä¹‹å‰çš„æ•°æ®é›†æ”¾å…¥æ¨¡å‹ä¸­è®­ç»ƒï¼Œå¹¶ä½¿ç”¨ecophsæŒ‡å®šè¿­ä»£æ¬¡æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¯‘æ¨¡å‹</span></span><br><span class="line">m,T_x,_=X.shape</span><br><span class="line">model=djmodel(T_x,n_a,n_values)</span><br><span class="line">opt=Adam(lr=<span class="number">0.01</span>,beta_1=<span class="number">0.9</span>,beta_2=<span class="number">0.99</span>,decay=<span class="number">0.01</span>)</span><br><span class="line">model.compile(optimizer=opt,loss=<span class="string">"categorical_crossentropy"</span>,metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"></span><br><span class="line">a0=np.zeros((m,n_a))</span><br><span class="line">c0=np.zeros((m,n_a))</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">start=time.clock()</span><br><span class="line">model.fit([X,a0,c0],list(Y),epochs=<span class="number">100</span>)</span><br><span class="line">end=time.clock()</span><br><span class="line">print(<span class="string">"æ¨¡å‹è®­ç»ƒæ—¶é—´ï¼š"</span>,end-start)</span><br></pre></td></tr></table></figure>

<h3 id="é‡‡æ ·å’Œé¢„æµ‹"><a href="#é‡‡æ ·å’Œé¢„æµ‹" class="headerlink" title="é‡‡æ ·å’Œé¢„æµ‹"></a>é‡‡æ ·å’Œé¢„æµ‹</h3><p>é‡‡æ ·</p>
<p>ï¼ˆ1ï¼‰é‡‡ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹çš„lstmå•å…ƒï¼Œdensorè¾“å‡ºå•å…ƒ</p>
<p>ï¼ˆ2ï¼‰å®šä¹‰åˆå§‹è¾“å…¥ã€ä¼ªæ¿€æ´»å€¼ï¼Œä¼ªè®°å¿†ç»†èƒï¼ˆé›¶å‘é‡ï¼‰</p>
<p>ï¼ˆ3ï¼‰lstmå•å…ƒï¼šåœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼Œæ ¹æ®lstmå•å…ƒå¾—å‡ºæ¿€æ´»å€¼å’Œè®°å¿†ç»†èƒå€¼</p>
<p>ï¼ˆ4ï¼‰densorå•å…ƒï¼šæ ¹æ®æ¿€æ´»å€¼å¾—åˆ°è¾“å‡ºï¼Œ</p>
<p>ï¼ˆ5ï¼‰å®šä¹‰ä¸€ä¸ªLambdaå±‚ï¼Œå°†è¾“å‡ºè½¬æ¢ä¸ºç‹¬çƒ­å‘é‡ï¼Œä½œä¸ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥ï¼š</p>
<blockquote>
<p>x=Lambda(one_hot)(out)</p>
<p>def one_hot(x):<br>    x = K.argmax(x)<br>    x = tf.one_hot(x, 78)<br>    x = RepeatVector(1)(x)<br>    return x</p>
</blockquote>
<p>æœ€ç»ˆå¾—åˆ°é‡‡æ ·åçš„æ¨¡å‹ç»“æœï¼Œé€šè¿‡è¾“å…¥çš„LSTM_cellå•å…ƒï¼Œdensorå•å…ƒï¼Œå­—å…¸é•¿åº¦ï¼Œéšè—å±‚å¤§å°ï¼Œè¾“å‡ºå€¼å¤§å°å¾—åˆ°é‡‡æ ·çš„ç»“æœã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é‡‡æ ·ä¸é¢„æµ‹</span></span><br><span class="line"><span class="comment">#é‡‡æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">music_inference_model</span><span class="params">(LSTM_cell,densor,n_values,n_a,T_y)</span>:</span></span><br><span class="line">	<span class="comment">#T_yæ—¶é—´æ­¥é•¿</span></span><br><span class="line">	x0=Input((<span class="number">1</span>,n_values))</span><br><span class="line">	a0=Input(shape=(n_a,),name=<span class="string">'a0'</span>)</span><br><span class="line">	c0=Input(shape=(n_a,),name=<span class="string">'c0'</span>)</span><br><span class="line">	a=a0</span><br><span class="line">	c=c0</span><br><span class="line">	x=x0</span><br><span class="line"></span><br><span class="line">	outputs=[]</span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> range(T_y):</span><br><span class="line">		a,_,c=LSTM_cell(x,initial_state=[a,c])</span><br><span class="line">		out=densor(a)</span><br><span class="line">		<span class="comment">#ä¸Šä¸€ä¸ªè¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªè¾“å‡ºå…¥</span></span><br><span class="line">		x=Lambda(one_hot)(out)</span><br><span class="line">		outputs.append(out)</span><br><span class="line">	inference_model=Model(inputs=[x0,a0,c0],outputs=outputs)</span><br><span class="line">	<span class="keyword">return</span> inference_model</span><br><span class="line"></span><br><span class="line">inference_model=music_inference_model(LSTM_cell,densor,n_values,n_a,T_y=<span class="number">50</span>)</span><br><span class="line">x_initializer=np.zeros((<span class="number">1</span>,<span class="number">1</span>,n_values))</span><br><span class="line">a_initializer=np.zeros((<span class="number">1</span>,n_a))</span><br><span class="line">c_initializer=np.zeros((<span class="number">1</span>,n_a))</span><br></pre></td></tr></table></figure>

<p>é¢„æµ‹</p>
<p>ï¼ˆ1ï¼‰æ ¹æ®é‡‡æ ·çš„æ¨¡å‹ï¼Œè¾“å…¥çš„æ ·æœ¬ï¼Œæ¿€æ´»å€¼ã€è®°å¿†å•å…ƒ</p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨é‡‡æ ·æ¨¡å‹é¢„æµ‹ï¼Œå¾—åˆ°è¾“å‡ºå€¼</p>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨argmaxå–æœ€å¤§çš„ç´¢å¼•</p>
<p>ï¼ˆ4ï¼‰æœ€ç»ˆå°†è¾“å‡ºè¡¨ç¤ºä¸ºç‹¬çƒ­å‘é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é¢„æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict_and_sanmple</span><span class="params">(inference_model,x_initializer=x_initializer,a_initializer=a_initializer,c_initializer=c_initializer)</span>:</span></span><br><span class="line">	<span class="comment">#æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">	pred=inference_model.predict([x_initializer,a_initializer,c_initializer])</span><br><span class="line">	<span class="comment">#å–æœ€å¤§å€¼</span></span><br><span class="line">	pred_value=np.argmax(pred,axis=<span class="number">-1</span>)</span><br><span class="line">	<span class="comment">#è½¬æ¢ä¸ºç‹¬çƒ­å‘é‡</span></span><br><span class="line">	one_hot=to_categorical(pred_value,num_classes=n_values)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> one_hot,pred_value</span><br><span class="line"></span><br><span class="line">results,indices=predict_and_sanmple(inference_model,x_initializer,a_initializer,c_initializer)</span><br><span class="line">print(<span class="string">"np.argmax(results[12]) ="</span>, np.argmax(results[<span class="number">12</span>]))</span><br><span class="line">print(<span class="string">"np.argmax(results[17]) ="</span>, np.argmax(results[<span class="number">17</span>]))</span><br><span class="line">print(<span class="string">"list(indices[12:18]) ="</span>, list(indices[<span class="number">12</span>:<span class="number">18</span>]))</span><br></pre></td></tr></table></figure>

<p>é¢„æµ‹ç»“æœï¼š</p>
<p>np.argmax(results[12]) = 72<br>np.argmax(results[17]) = 39<br>list(indices[12:18]) = [array([72]), array([39]), array([46]), array([57]), array([72]), array([39])]</p>
<h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p><code>out_stream=generate_music(inference_model)</code>ï¼Œåˆ©ç”¨å·²ç»ç”Ÿæˆçš„æ¨¡å‹å¾—åˆ°çš„é‡‡æ ·ç»“æœåœ¨æœ¬åœ°ç”Ÿæˆå³å…´çš„éŸ³ä¹ï¼Œåºåˆ—æ¨¡å‹ç”ŸæˆéŸ³ä¹å€¼ï¼Œé‡‡ç”¨é¢å¤–åº“å‡½æ•°ç”Ÿæˆmidiæ–‡ä»¶ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200619122826.png" alt></p>
<p>å¯ä»¥åˆ©ç”¨åœ¨çº¿midiè½¬mp3å·¥å…·ï¼š<a href="https://www.ofoct.com/audio-converter/convert-midi-to-mp3-or-wav-ogg-aac-wma.html" target="_blank" rel="external nofollow noopener noreferrer">https://www.ofoct.com/audio-converter/convert-midi-to-mp3-or-wav-ogg-aac-wma.html</a> è½¬æ¢æ–‡ä»¶æ ¼å¼ï¼Œå¹¶è¿›è¡Œè¯•å¬ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å¾ªç¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åºåˆ—æ¨¡å‹RNNâ€”â€”æ„å»ºå­—ç¬¦çº§è¯­è¨€æ¨¡å‹</title>
    <url>/blogs/rnn1DN/</url>
    <content><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>ï¼ˆ1ï¼‰å­—ç¬¦çº§è¯­è¨€æ¨¡å‹ï¼šæŒ‡æ¯ä¸ªå­—æ¯ï¼ˆå­—ç¬¦ï¼‰é‡‡ç”¨ä¸€ä¸ªç‹¬çƒ­å‘é‡è¡¨ç¤ºï¼Œå³æ¯ä¸ªæ—¶é—´æ­¥ä¸­è¾“å…¥çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œæ¥ä½¿ç”¨RNNæ„å»ºæ¨¡å‹ã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨å¤šå¯¹å¤šæ„å»ºä¸€ä¸ªèƒ½ç»™æé¾™å²›ä¸Šæé¾™å‘½åçš„è¯­è¨€æ¨¡å‹ã€‚</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="æ„å»ºå­—å…¸"><a href="#æ„å»ºå­—å…¸" class="headerlink" title="æ„å»ºå­—å…¸"></a>æ„å»ºå­—å…¸</h3><p>ï¼ˆ1ï¼‰æ‰“å¼€æ‰€æœ‰å¯ä»¥å‘½åçš„åå­—æ•°æ®é›†ï¼Œå°†åå­—å…¨éƒ¨è½¬æ¢ä¸ºå°å†™å­—æ¯</p><p>ï¼ˆ2ï¼‰æŒ‰ç…§å­—æ¯ï¼šç´¢å¼•å’Œç´¢å¼•ï¼šå­—æ¯å½¢å¼ç”Ÿæˆå­—å…¸å¯¹åº”è¡¨ï¼Œæ–¹ä¾¿æŸ¥æ‰¾å­—æ¯</p><a id="more"></a>



<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ•°æ®é›†å¤„ç†</span></span><br><span class="line"><span class="comment">#å¾—åˆ°ä¸é‡å¤çš„å­—å…¸</span></span><br><span class="line">data=open(<span class="string">'dinos.txt'</span>,<span class="string">'r'</span>).read()</span><br><span class="line">data=data.lower()</span><br><span class="line">char=list(set(data))</span><br><span class="line">data_size,vocab_size=len(data),len(char)</span><br><span class="line">print(data_size,vocab_size)</span><br><span class="line">ix_to_char=&#123;ix:char <span class="keyword">for</span> ix,char <span class="keyword">in</span> enumerate(sorted(char))&#125;</span><br><span class="line">char_to_ix=&#123;char:ix <span class="keyword">for</span> ix,char <span class="keyword">in</span> enumerate(sorted(char))&#125;</span><br><span class="line">print(char_to_ix)</span><br><span class="line">print(ix_to_char)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>19909 27<br>{â€˜\nâ€™: 0, â€˜aâ€™: 1, â€˜bâ€™: 2, â€˜câ€™: 3, â€˜dâ€™: 4, â€˜eâ€™: 5, â€˜fâ€™: 6, â€˜gâ€™: 7, â€˜hâ€™: 8, â€˜iâ€™: 9, â€˜jâ€™: 10, â€˜kâ€™: 11, â€˜lâ€™: 12, â€˜mâ€™: 13, â€˜nâ€™: 14, â€˜oâ€™: 15, â€˜pâ€™: 16, â€˜qâ€™: 17, â€˜râ€™: 18, â€˜sâ€™: 19, â€˜tâ€™: 20, â€˜uâ€™: 21, â€˜vâ€™: 22, â€˜wâ€™: 23, â€˜xâ€™: 24, â€˜yâ€™: 25, â€˜zâ€™: 26}<br>{0: â€˜\nâ€™, 1: â€˜aâ€™, 2: â€˜bâ€™, 3: â€˜câ€™, 4: â€˜dâ€™, 5: â€˜eâ€™, 6: â€˜fâ€™, 7: â€˜gâ€™, 8: â€˜hâ€™, 9: â€˜iâ€™, 10: â€˜jâ€™, 11: â€˜kâ€™, 12: â€˜lâ€™, 13: â€˜mâ€™, 14: â€˜nâ€™, 15: â€˜oâ€™, 16: â€˜pâ€™, 17: â€˜qâ€™, 18: â€˜râ€™, 19: â€˜sâ€™, 20: â€˜tâ€™, 21: â€˜uâ€™, 22: â€˜vâ€™, 23: â€˜wâ€™, 24: â€˜xâ€™, 25: â€˜yâ€™, 26: â€˜zâ€™}</p>
</blockquote>
<p>å¾—åˆ°19909ä¸ªåå­—ä¸­27ä¸ªä¸é‡å¤çš„å­—ç¬¦ï¼Œå°†å­—ç¬¦æŒ‰ç…§å­—å…¸é¡ºåºæ’åºï¼Œå›è½¦é”®åœ¨ç¬¬0ä¸ªï¼Œåé¢å­—ç¬¦ä¾æ¬¡æ’åˆ—ã€‚</p>
<h3 id="æ¢¯åº¦ä¿®å‰ª"><a href="#æ¢¯åº¦ä¿®å‰ª" class="headerlink" title="æ¢¯åº¦ä¿®å‰ª"></a>æ¢¯åº¦ä¿®å‰ª</h3><p>å°†æ¢¯åº¦ä¸­è¿‡å¤§æˆ–è€…è¿‡å°çš„æ¢¯åº¦ç›´æ¥è®¾ç½®ä¸ºæœ€å¤§å€¼å’Œæœ€å°å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ¢¯åº¦ä¿®å‰ª</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clip</span><span class="params">(gradients,maxValue)</span>:</span></span><br><span class="line">	dWax=gradients[<span class="string">"dWax"</span>]</span><br><span class="line">	dWaa=gradients[<span class="string">"dWaa"</span>]</span><br><span class="line">	dWya=gradients[<span class="string">"dWya"</span>]</span><br><span class="line"></span><br><span class="line">	db=gradients[<span class="string">"db"</span>]</span><br><span class="line">	dby=gradients[<span class="string">"dby"</span>]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> gradient <span class="keyword">in</span> [dWax,dWaa,dWya,db,dby]:</span><br><span class="line">		np.clip(gradient,-maxValue,maxValue,out=gradient)</span><br><span class="line">	gradients=&#123;<span class="string">'dWax'</span>:dWax,<span class="string">'dWaa'</span>:dWaa,<span class="string">'dWya'</span>:dWya,<span class="string">'db'</span>:db,<span class="string">'dby'</span>:dby&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gradients</span><br></pre></td></tr></table></figure>

<h3 id="é‡‡æ ·"><a href="#é‡‡æ ·" class="headerlink" title="é‡‡æ ·"></a>é‡‡æ ·</h3><p>é‡‡æ ·æ—¶ï¼Œå·²ç»å¾—åˆ°å½“å‰æ¨¡å‹çš„è®­ç»ƒå‚æ•°ï¼Œå°†å›è½¦é”®ä½œä¸ºé‡‡æ ·ç»“æŸçš„æ ‡å¿—</p>
<p>ï¼ˆ1ï¼‰å½“é‡‡æ ·æœªç»“æŸçš„æ—¶å€™</p>
<p>ï¼ˆ2ï¼‰è¾“å…¥ç‹¬çƒ­å‘é‡0å‘é‡å’Œç¬¬0å±‚çš„æ¿€æ´»å€¼ï¼Œæ ¹æ®RNNåŸºæœ¬å•å…ƒå…¬å¼ï¼Œå¾—åˆ°é¢„æµ‹å€¼y</p>
<p>ï¼ˆ3ï¼‰è¿›è¡Œéšæœºé‡‡æ ·ï¼ˆnp.random.choiceï¼‰é€‰æ‹©æœ€å¤§æ¦‚ç‡çš„ç´¢å¼•å€¼</p>
<p>ï¼ˆ4ï¼‰å°†é€‰ä¸­çš„å€¼è½¬æ¢ä¸ºæ–°çš„ç‹¬çƒ­å‘é‡ï¼Œä½œä¸ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥</p>
<p>ï¼ˆ5ï¼‰ä¸æ–­å¾ªç¯ï¼Œå½“åˆ°æœ«å°¾æ—¶å¾—åˆ°å½“å‰çš„é‡‡æ ·ç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#é‡‡æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sample</span><span class="params">(parameters,char_to_ix,seed)</span>:</span></span><br><span class="line">	Wax=parameters[<span class="string">'Wax'</span>]</span><br><span class="line">	Waa=parameters[<span class="string">'Waa'</span>]</span><br><span class="line">	b=parameters[<span class="string">'b'</span>]</span><br><span class="line">	Wya=parameters[<span class="string">'Wya'</span>]</span><br><span class="line">	by=parameters[<span class="string">'by'</span>]</span><br><span class="line"></span><br><span class="line">	vocab_size=by.shape[<span class="number">0</span>]</span><br><span class="line">	n_a=Waa.shape[<span class="number">1</span>]</span><br><span class="line">	a_prev=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#åˆ›é€ ç‹¬çƒ­å‘é‡</span></span><br><span class="line">	x=np.zeros((vocab_size,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	counter=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	idx=<span class="number">-1</span></span><br><span class="line">	indies=[]</span><br><span class="line">	check_character=char_to_ix[<span class="string">'\n'</span>]</span><br><span class="line">	<span class="keyword">while</span> idx!=check_character <span class="keyword">and</span> counter&lt;<span class="number">50</span>:</span><br><span class="line">		a=np.tanh(np.dot(Waa,a_prev)+np.dot(Wax,x)+b)</span><br><span class="line">		z=np.dot(Wya,a)+by</span><br><span class="line">		y=cu.softmax(z)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æŒ‰ç…§æ¦‚ç‡é‡‡æ ·</span></span><br><span class="line">		np.random.seed(seed+counter)</span><br><span class="line">		idx=np.random.choice(list(range(vocab_size)),p=y.ravel())</span><br><span class="line">		indies.append(idx)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æŒ‰ç…§é€‰æ‹©çš„ä½ç½®ç”Ÿæˆç‹¬çƒ­å‘é‡</span></span><br><span class="line">		x=np.zeros((vocab_size,<span class="number">1</span>))</span><br><span class="line">		x[idx]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#å°†ä¸Šä¸€ä¸ªé¢„æµ‹å€¼ç›´æ¥ä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥</span></span><br><span class="line">		a_prev=a</span><br><span class="line">		seed+=<span class="number">1</span></span><br><span class="line">		counter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> counter==<span class="number">50</span>:</span><br><span class="line">		indies.append(char_to_ix[<span class="string">'\n'</span>])</span><br><span class="line">	<span class="keyword">return</span> indies</span><br></pre></td></tr></table></figure>

<h3 id="æ­å»ºè¯­è¨€æ¨¡å‹ï¼ˆä¸€ä¸ªæ ·æœ¬ï¼‰"><a href="#æ­å»ºè¯­è¨€æ¨¡å‹ï¼ˆä¸€ä¸ªæ ·æœ¬ï¼‰" class="headerlink" title="æ­å»ºè¯­è¨€æ¨¡å‹ï¼ˆä¸€ä¸ªæ ·æœ¬ï¼‰"></a>æ­å»ºè¯­è¨€æ¨¡å‹ï¼ˆä¸€ä¸ªæ ·æœ¬ï¼‰</h3><p>ï¼ˆ1ï¼‰è¾“å…¥å½“å‰çš„æ ·æœ¬çš„æ‰€æœ‰å­—ç¬¦ï¼Œå®é™…è¾“å‡ºå€¼ï¼Œä¸Šä¸€å±‚çš„æ¿€æ´»å€¼ï¼Œå‚æ•°</p>
<p>ï¼ˆ2ï¼‰è¿›è¡Œä¸€æ¬¡RNNå‰å‘ä¼ æ’­ï¼Œå°†å½“å‰æ ·æœ¬æ‰€æœ‰å­—ç¬¦ä¸€ä¸€å¯¹åº”æ¯ä¸ªæ—¶é—´æ­¥ï¼Œå¾—åˆ°æŸå¤±å’Œç¼“å­˜</p>
<p>ï¼ˆ3ï¼‰è¿›è¡Œä¸€æ¬¡RNNåå‘ä¼ æ’­ï¼Œå¾—åˆ°æ¢¯åº¦å’Œæ¿€æ´»å€¼</p>
<p>ï¼ˆ4ï¼‰è¿›è¡Œä¸€æ¬¡æ¢¯åº¦æ›´æ–°ï¼Œå¾—åˆ°æ–°çš„æ¢¯åº¦</p>
<p>ï¼ˆ5ï¼‰å¯¹å¾—åˆ°çš„æ–°æ¢¯åº¦è¿›è¡Œä¿®å‰ªï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸</p>
<p>ï¼ˆ6ï¼‰æœ€ç»ˆè¿”å›å½“å‰æ ·æœ¬çš„æŸå¤±ï¼Œæ¢¯åº¦ï¼Œæœ€ç»ˆçš„æ¿€æ´»å€¼è¾“å‡ºå’Œå‚æ•°</p>
<p>tipsï¼šå½“å­—å…¸ä¸­å€¼è¢«æ”¹å˜ï¼Œæ— è®ºåœ¨å‡½æ•°å†…è¿˜æ˜¯å‡½æ•°å¤–éƒ½ä¼šå½±å“å­—å…¸ä¸­çš„å€¼ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥ä¸è¿”å›parameters</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ„å»ºè¯­è¨€æ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">optimize</span><span class="params">(x,y,a_prev,parameters,learning_rate=<span class="number">0.01</span>,maxValue=<span class="number">5</span>)</span>:</span></span><br><span class="line">	<span class="comment">#å‰å‘ä¼ æ’­</span></span><br><span class="line">	loss,cache=cu.rnn_forward(x,y,a_prev,parameters,vocab_size=<span class="number">27</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">	gradients,a=cu.rnn_backward(x,y,parameters,cache)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ä¿®å‰ªæ¢¯åº¦</span></span><br><span class="line">	gradients=clip(gradients,maxValue)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ›´æ–°å‚æ•°</span></span><br><span class="line">	parameters=cu.update_parameters(parameters,gradients,learning_rate)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> loss,gradients,a[len(x)<span class="number">-1</span>],parameters</span><br></pre></td></tr></table></figure>

<h3 id="ç”Ÿæˆæ¨¡å‹ï¼ˆæ‰€æœ‰æ ·æœ¬ï¼‰"><a href="#ç”Ÿæˆæ¨¡å‹ï¼ˆæ‰€æœ‰æ ·æœ¬ï¼‰" class="headerlink" title="ç”Ÿæˆæ¨¡å‹ï¼ˆæ‰€æœ‰æ ·æœ¬ï¼‰"></a>ç”Ÿæˆæ¨¡å‹ï¼ˆæ‰€æœ‰æ ·æœ¬ï¼‰</h3><p>ï¼ˆ1ï¼‰è¯»å…¥å½“å‰çš„æ•°æ®ï¼Œå¹¶æ‰“ä¹±</p>
<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–å‚æ•°å’ŒæŸå¤±</p>
<p>ï¼ˆ3ï¼‰åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæ¯æ¬¡éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬è¿›è¡ŒRNNæ¨¡å‹æ„å»º</p>
<p>éšæœºé€‰æ‹©æ ·æœ¬ï¼š</p>
<p>â€‹        index=i%len(examples)<br>â€‹        x=[None]+[char_to_ix[ch] for ch in examples[index]]<br>â€‹        y=x[1:]+[char_to_ix[â€˜\nâ€™]]</p>
<p>0<br>[None, 20, 21, 18, 9, 1, 19, 1, 21, 18, 21, 19]<br>[20, 21, 18, 9, 1, 19, 1, 21, 18, 21, 19, 0]</p>
<p>ä¸ºäº†ä¿è¯ï¼Œè¾“å…¥è¾“å‡ºä¸€æ ·é•¿ï¼Œè¿™é‡Œå°†xæœ€å‰é¢åŠ ä¸Šç©ºå­—ç¬¦ï¼Œè¾“å‡ºå€¼å–å®é™…åå­—å¹¶åŠ ä¸Šå›è½¦ç¬¦ä½œä¸ºç»“æŸã€‚</p>
<p>ï¼ˆ4ï¼‰æ ¹æ®æ¯æ¬¡é€‰æ‹©çš„ä¸€ä¸ªæ ·æœ¬ï¼Œè¿›è¡Œä¸€ä¸ªè¯­è¨€æ¨¡å‹æ„å»º</p>
<p>è¿™é‡Œé‡‡ç”¨å»¶è¿Ÿæ¥å¹³æ»‘æŸå¤±ï¼ŒåŠ é€Ÿè®­ç»ƒ</p>
<p>ï¼ˆ5ï¼‰æ¯2000æ¬¡è¿›è¡Œä¸€æ¬¡é‡‡æ ·è¿›è¡Œæ¨¡å‹é¢„æµ‹ï¼Œæœ€ç»ˆå¾—åˆ°æ¨¡å‹è®­ç»ƒçš„å‚æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿è¡Œç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(data,ix_to_char,char_to_ix,num_iterations=<span class="number">3500</span>,n_a=<span class="number">50</span>,vocab_size=<span class="number">27</span>,dinos_name=<span class="number">7</span>)</span>:</span></span><br><span class="line">	n_x,n_y=vocab_size,vocab_size</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è¯»å…¥å½“å‰æ ·æœ¬</span></span><br><span class="line">	<span class="keyword">with</span> open(<span class="string">'dinos.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">		examples=f.readlines()</span><br><span class="line">	examples=[x.lower().strip() <span class="keyword">for</span> x <span class="keyword">in</span> examples]</span><br><span class="line">	print(len(examples))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ‰“ä¹±æ ·æœ¬</span></span><br><span class="line">	np.random.seed(<span class="number">0</span>)</span><br><span class="line">	np.random.shuffle(examples)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–å‚æ•°å’ŒæŸå¤±</span></span><br><span class="line">	parameters=cu.initialize_parameters(n_a,n_x,n_y)</span><br><span class="line">	loss=cu.get_initial_loss(vocab_size,dinos_name)</span><br><span class="line"></span><br><span class="line">	a_prev=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è¿›è¡Œè¿­ä»£</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_iterations):</span><br><span class="line">		index=i%len(examples)</span><br><span class="line">		x=[<span class="literal">None</span>]+[char_to_ix[ch] <span class="keyword">for</span> ch <span class="keyword">in</span> examples[index]]</span><br><span class="line">		y=x[<span class="number">1</span>:]+[char_to_ix[<span class="string">'\n'</span>]]</span><br><span class="line"></span><br><span class="line">		<span class="comment">#å­—å…¸æ— è®ºåœ¨å‡½æ•°å†…æˆ–å‡½æ•°å¤–å‘ç”Ÿæ”¹å˜ï¼Œè¿™äº›æ”¹å˜éƒ½ä¼šä½œç”¨äºå­—å…¸</span></span><br><span class="line">		cur_loss,gradients,a_prev,parameters=optimize(x,y,a_prev,parameters)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#å¹³æ»‘æŸå¤±</span></span><br><span class="line">		loss=cu.smooth(loss,cur_loss)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æ¯2000æ¬¡è¿›è¡Œä¸€æ¬¡é‡‡æ ·</span></span><br><span class="line">		<span class="keyword">if</span> i%<span class="number">2000</span>==<span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"ç¬¬"</span>+str(i)+<span class="string">"æ¬¡ï¼ŒæŸå¤±ä¸º"</span>+str(loss))</span><br><span class="line">			seed=<span class="number">0</span></span><br><span class="line">			<span class="keyword">for</span> name <span class="keyword">in</span> range(dinos_name):</span><br><span class="line">				sample_indies=sample(parameters,char_to_ix,seed)</span><br><span class="line">				cu.print_sample(sample_indies,ix_to_char)</span><br><span class="line">				seed+=<span class="number">1</span></span><br><span class="line">			print(<span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ6ï¼‰ç»“æœ</p>
<p>è¾“å…¥å­—å…¸å¯¹åº”è¡¨å’Œè¿­ä»£æ¬¡æ•°ï¼Œè¿›è¡Œè®­ç»ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parameters = model(data, ix_to_char, char_to_ix, num_iterations=<span class="number">3500</span>)</span><br></pre></td></tr></table></figure>

<p>æ¨¡å‹è®­ç»ƒçš„ç»“æœï¼š</p>
<p>å¾—åˆ°æ¯2000æ¬¡çš„æŸå¤±å’Œå½“å‰é¢„æµ‹çš„7ä¸ªæé¾™çš„åå­—</p>
<blockquote>
<p>ç¬¬0æ¬¡ï¼ŒæŸå¤±ä¸º23.087336085484605<br>Nkzxwtdmfqoeyhsqwasjkjvu<br>Kneb<br>Kzxwtdmfqoeyhsqwasjkjvu<br>Neb<br>Zxwtdmfqoeyhsqwasjkjvu<br>Eb<br>Xwtdmfqoeyhsqwasjkjvu</p>
<p>ç¬¬2000æ¬¡ï¼ŒæŸå¤±ä¸º27.884160491415773<br>Liusskeomnolxeros<br>Hmdaairus<br>Hytroligoraurus<br>Lecalosapaus<br>Xusicikoraurus<br>Abalpsamantisaurus<br>Tpraneronxeros</p>
</blockquote>
<p>ä½¿ç”¨æ¨¡å‹è®­ç»ƒå‚æ•°è¿›è¡Œé¢„æµ‹ï¼š</p>
<p>æ ¹æ®éœ€è¦é¢„æµ‹çš„æé¾™çš„åå­—æ•°é‡è¿›è¡Œè¿­ä»£ï¼Œè¾“å…¥è®­ç»ƒå¥½çš„å‚æ•°å’Œå­—å…¸è¡¨å¾—åˆ°é¢„æµ‹ç´¢å¼•ï¼Œæ ¹æ®ç´¢å¼•ï¼šå­—å…¸å¾—åˆ°å¯¹åº”çš„åå­—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dinos_name=<span class="number">7</span></span><br><span class="line">seed=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> range(dinos_name):</span><br><span class="line">	sample_indies=sample(parameters,char_to_ix,seed)</span><br><span class="line">	cu.print_sample(sample_indies,ix_to_char)</span><br><span class="line">	seed+=<span class="number">1</span></span><br><span class="line">print(<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°é¢„æµ‹çš„æé¾™çš„åå­—ä¸ºï¼š</p>
<blockquote>
<p>Livusaton<br>Hola<br>Ivushandoraunpsacrophus<br>Lecakosaunus<br>Wusnchepokupros<br>Acalpsasaurus<br>Torandor</p>
</blockquote>
<h2 id="é™„ï¼šæ„é€ èå£«æ¯”äºšé£æ ¼çš„è¯­è¨€æ¨¡å‹"><a href="#é™„ï¼šæ„é€ èå£«æ¯”äºšé£æ ¼çš„è¯­è¨€æ¨¡å‹" class="headerlink" title="é™„ï¼šæ„é€ èå£«æ¯”äºšé£æ ¼çš„è¯­è¨€æ¨¡å‹"></a>é™„ï¼šæ„é€ èå£«æ¯”äºšé£æ ¼çš„è¯­è¨€æ¨¡å‹</h2><p>å¤§è‡´æ€è·¯ï¼š</p>
<p>ï¼ˆ1ï¼‰å¯¼å…¥èå£«æ¯”äºšçš„è¯—æ­Œï¼Œä½œä¸ºè®­ç»ƒæ ·æœ¬</p>
<p>ï¼ˆ2ï¼‰åˆ©ç”¨å·²æ­å»ºå¤§èå£«æ¯”äºšè¯—æ­Œæ¨¡å‹ï¼Œè¯¥æ¨¡å‹ä¸Šå·²è®­ç»ƒ1000æ¬¡ï¼Œåªéœ€è¦å¯¼å…¥ï¼Œå†è®­ç»ƒä¸€æ¬¡å³å¯ï¼Œå³å°†æ•°æ®å¯¼å…¥åˆ°æ¨¡å‹ä¸­ä½¿ç”¨ï¼Œå†æ ¹æ®è¾“å…¥çš„æ•°æ®åˆ©ç”¨ä¼šæ‰å‡½æ•°è¾“å…¥æ¨¡å‹ä¸­è¿›è¡Œè®­ç»ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">print_callback=LambdaCallback(on_epoch_end=on_epoch_end)</span><br><span class="line">model.fit(x,y,batch_size=<span class="number">128</span>,epochs=<span class="number">1</span>,callbacks=[print_callback])</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰è¯¥æ¨¡å‹éœ€è¦è¾“å…¥åˆå§‹æ¿€æ´»å€¼ï¼Œå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹ç»“æœ</p>
<p>è¿™é‡Œè¾“å…¥åˆå§‹å•è¯ä¸ºï¼šbajieï¼Œå¾—åˆ°ç”Ÿæˆçš„è¯—æ­Œå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Write the beginning of your poem, the Shakespeare machine will complete it. Your input is: bajie</p>
<p>Here is your poem: </p>
<p>bajienst fauch is the grace,<br>the roud by sorst then every where gise,<br>gave your lover wadese bust may o ficcle,<br>and ou may but would relaved be ta niell<br>live anbsad i forse itferse mads,<br> from ho strenst my grast of thight crors,<br>and to thop hersiang thises to hesp ather,<br>and ho my to thy filens express woldâ€™s faver,<br>do this bay of dowh i connied too,<br>my live the wherat be forse thishuror,<br>it som as wh</p>
</blockquote>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å¾ªç¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åºåˆ—æ¨¡å‹RNNâ€”â€”åŸºæœ¬ç½‘ç»œç»“æ„</title>
    <url>/blogs/rnn1/</url>
    <content><![CDATA[<h2 id="RNNåŸç†"><a href="#RNNåŸç†" class="headerlink" title="RNNåŸç†"></a>RNNåŸç†</h2><p>ï¼ˆ0ï¼‰æ ‡è®°ç¬¦å·å«ä¹‰</p><p>è¾“å…¥çš„æ ·æœ¬ä¸ºï¼ˆX,Yï¼‰ï¼Œå…¶ä¸­Xçš„ç»´åº¦ä¸ºï¼ˆmï¼ŒT_xï¼Œnï¼‰ï¼Œmä»£è¡¨æ ·æœ¬ä¸ªæ•°ï¼ŒT_xä»£è¡¨æ—¶é—´æ­¥ï¼Œnä»£è¡¨å­—å…¸é•¿åº¦ã€‚</p><p>RNNä¸­æ¯ä¸ªæ ·æœ¬é‡‡ç”¨ç‹¬çƒ­å‘é‡è¡¨ç¤ºï¼Œåœ¨è®­ç»ƒé›†ä¸­é€‰æ‹©ä¸é‡å¤æ•°æ®ä½œä¸ºå­—å…¸ï¼Œæ ¹æ®å­—å…¸æ„é€ æ¯ä¸ªç‹¬çƒ­å‘é‡ï¼ˆå½“å‰è¯åœ¨å­—å…¸ä¸­çš„ä½ç½®æ ‡ä¸º1ï¼Œå…¶ä½™æ ‡ä¸º0ï¼‰ã€‚</p><p>ï¼ˆ1ï¼‰ç½‘ç»œç»“æ„</p><p>RNNç½‘ç»œç»“æœå¦‚å›¾ï¼Œåœ¨tæ—¶åˆ»è¾“å…¥å½“å‰æ—¶åˆ»çš„xå€¼ï¼Œç»è¿‡éšè—å±‚ï¼Œé€šè¿‡è®¡ç®—å‰ä¸€å±‚çš„æ¿€æ´»å€¼å’Œè¾“å…¥å€¼xå¾—åˆ°é¢„æµ‹çš„yã€‚</p><a id="more"></a>




<p>æ¯ä¸ªæ—¶åˆ»çš„è¾“å‡ºå–å†³äºå½“å‰æ—¶åˆ»çš„è¾“å…¥å’Œå‰ä¸€ä¸ªæ—¶åˆ»çš„æ¿€æ´»å€¼ã€‚</p>
<p>1Â° å¤šå¯¹å¤šç»“æ„</p>
<p>å¾ˆå¤šè¾“å…¥å¯¹åº”å¾ˆå¤šè¾“å‡ºï¼Œå½“Tx=Tyï¼Œå³è¾“å…¥å’Œè¾“å‡ºæ•°é‡ç›¸åŒï¼Œä¾‹å¦‚å‘½åå®ä½“è¯†åˆ«ï¼ˆæ ¹æ®ä¸€ä¸ªå¥å­è¯†åˆ«å‡ºå…¶ä¸­çš„ä¸»è¯­ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618165122.png" alt></p>
<p>2Â° å¤šå¯¹å¤šç»“æ„</p>
<p>å¾ˆå¤šè¾“å…¥å¯¹åº”å¾ˆå¤šè¾“å‡ºï¼Œå½“Txä¸ç­‰äºTyï¼Œå³è¾“å…¥å’Œè¾“å‡ºæ•°é‡ä¸ç›¸åŒï¼Œä¾‹å¦‚æœºå™¨ç¿»è¯‘ã€‚</p>
<p>å› ä¸ºæœºå™¨ç¿»è¯‘éœ€è¦è€ƒè™‘æ•´ä¸ªå¥å­çš„å‰åè”ç³»ï¼Œæ‰€ä»¥è¦å°†xå…¨éƒ¨è¾“å…¥åæ‰èƒ½è¿›è¡Œé¢„æµ‹ã€‚å› æ­¤ï¼Œå‰åŠéƒ¨åˆ†æŒ‰ç…§æ—¶é—´æ­¥è¾“å…¥xï¼Œä½œä¸ºç¼–ç å™¨ï¼ŒååŠéƒ¨åˆ†è¾“å‡ºé¢„æµ‹çš„yï¼Œä½œä¸ºè§£ç å™¨ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618195021.png" alt></p>
<p>3Â° ä¸€å¯¹å¤šç»“æ„</p>
<p>è¾“å…¥éƒ¨åˆ†ç‰‡æ®µæˆ–è€…ä¸è¾“å…¥ï¼ˆ0å‘é‡ï¼‰ï¼Œè¾“å‡ºå½¢æˆçš„å®Œæ•´çš„è¾“å‡ºï¼Œä¾‹å¦‚ç”ŸæˆéŸ³ä¹ã€‚</p>
<p>æ ¹æ®è¾“å…¥çš„xå’Œæ¿€æ´»å€¼å¾—åˆ°é¢„æµ‹çš„yï¼Œä¸Šä¸€å±‚é¢„æµ‹çš„yä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618195910.png" alt></p>
<p>4Â° å¤šå¯¹ä¸€ç»“æ„</p>
<p>å¾ˆå¤šè¾“å…¥å¯¹åº”æœ‰ä¸ªè¾“å‡ºï¼Œä¾‹å¦‚æƒ…æ„Ÿåˆ†ç±»é—®é¢˜ï¼Œç»™ä¸€æ®µæ–‡å­—ï¼Œç»™å‡ºè¯„åˆ†ã€‚</p>
<p>æ¯æ¬¡è¾“å…¥ä¸€ä¸ªæ—¶é—´æ­¥çš„xï¼Œä½†ä¸è¾“å‡ºé¢„æµ‹å€¼ï¼Œå½“æ‰€æœ‰çš„xå‡æŒ‰ç…§æ—¶é—´æ­¥è¾“å…¥ä¹‹åï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªè¯„åˆ†ï¼Œè¯¥è¯„åˆ†ç»¼åˆè€ƒè™‘äº†ç­¾åæ‰€æœ‰çš„æ–‡å­—ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618200114.png" alt></p>
<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>ä»¥å¤šå¯¹å¤šä¸­ï¼ŒTx=Tyä¸ºä¾‹è¯´æ˜RNNçš„å‰å‘ä¼ æ’­ã€‚</p>
<p>åœ¨t=1çš„æ—¶é—´æ­¥ä¸‹ï¼š</p>
<p>1Â° æœ‰è¾“å…¥a&lt;0&gt;æ¿€æ´»å€¼ï¼ˆä¼ªæ¿€æ´»å€¼ï¼Œå¸¸è®¾ç½®ä¸º0ï¼‰ï¼Œå’Œæ—¶é—´æ­¥ä¸º1çš„xå€¼ï¼šx&lt;1&gt;ï¼Œå°†ä¸¤è€…ä¹˜ä»¥å¯¹åº”æƒé‡ï¼ŒåŠ ä¸Šåç½®é‡å¾—åˆ°çº¿æ€§å€¼ï¼Œå†ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼ˆtanh/Reluï¼‰ï¼Œå¾—åˆ°å½“å‰å•å…ƒè¾“å‡ºçš„æ¿€æ´»å€¼ã€‚</p>
<p>2Â° å°†æ¿€æ´»å€¼a&lt;1&gt;ä¹˜ä»¥å¯¹åº”æƒé‡ï¼ŒåŠ ä¸Šåç½®é‡å¾—åˆ°çº¿æ€§å€¼ï¼Œå†ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼ˆsoftmaxï¼‰,å¾—åˆ°æœ€ç»ˆé¢„æµ‹çš„æ—¶é—´æ­¥ä¸º1çš„yçš„é¢„æµ‹å€¼ã€‚</p>
<p>åé¢çš„ç¥ç»å…ƒæ­¥éª¤ç±»ä¼¼ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618165220.png" alt></p>
<p>ç¼–ç æ—¶ï¼Œé¦–å…ˆæ ¹æ®å‰å‘ä¼ æ’­å…¬å¼å¾—åˆ°ä¸€ä¸ªåŸºæœ¬RNNå•å…ƒå¤„ç†çš„ç»“æœï¼Œå°†å‰ä¸€ä¸ªå’Œå½“å‰æ¿€æ´»å€¼ï¼Œå½“å‰è¾“å…¥çš„xå’Œå‚æ•°å­˜æˆç¼“å­˜ï¼Œå°†å½“å‰è¾“å‡ºçš„æ¿€æ´»å€¼ã€é¢„æµ‹å€¼ã€ç¼“å­˜ä½œä¸ºæœ€ç»ˆçš„è¾“å‡ºã€‚</p>
<p>æ¥ç€ï¼ŒæŒ‰ç…§æ—¶é—´æ­¥ï¼Œä¼ å…¥å½“å‰è¾“å…¥å’Œä¸Šä¸€å±‚çš„æ¿€æ´»å€¼è¾“å‡ºï¼Œå¾—åˆ°æ‰€æœ‰æ—¶é—´æ­¥çš„æ¿€æ´»å€¼å’Œé¢„æµ‹å€¼ï¼Œæœ€ç»ˆå°†æ‰€æœ‰æ—¶é—´æ­¥çš„æ¿€æ´»å€¼å’Œé¢„æµ‹å€¼å’Œç¼“å­˜è¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ­å»ºæ ‡å‡†rnnå•å…ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rnn_cell_forward</span><span class="params">(xt,a_prev,parameters)</span>:</span></span><br><span class="line">	Wax=parameters[<span class="string">"Wax"</span>]</span><br><span class="line">	Waa=parameters[<span class="string">"Waa"</span>]</span><br><span class="line">	Wya=parameters[<span class="string">"Wya"</span>]</span><br><span class="line"></span><br><span class="line">	ba=parameters[<span class="string">"ba"</span>]</span><br><span class="line">	by=parameters[<span class="string">"by"</span>]</span><br><span class="line"></span><br><span class="line">	a_next=np.tanh(np.dot(Waa,a_prev)+np.dot(Wax,xt)+ba)</span><br><span class="line"></span><br><span class="line">	y_next=ru.softmax(np.dot(Wya,a_next)+by)</span><br><span class="line"></span><br><span class="line">	cache=(a_next,a_prev,xt,parameters)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> a_next,y_next,cache</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†æ‰€æœ‰æ ‡å‡†å•å…ƒè¿æ¥èµ·æ¥ï¼Œè¿›è¡Œå‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="comment">#è¿™é‡ŒTx=Ty</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rnn_forward</span><span class="params">(x,a0,parameters)</span>:</span></span><br><span class="line">	n_x,m,T_x=x.shape</span><br><span class="line">	Wya=parameters[<span class="string">"Wya"</span>]</span><br><span class="line">	n_y,n_a=Wya.shape</span><br><span class="line"></span><br><span class="line">	a_next=a0</span><br><span class="line">	a=np.zeros((n_a,m,T_x))</span><br><span class="line">	y_hat=np.zeros((n_y,m,T_x))</span><br><span class="line">	caches=[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> range(T_x):</span><br><span class="line">		a_next,y_next,cache=rnn_cell_forward(x[:,:,t],a_next,parameters)</span><br><span class="line"></span><br><span class="line">		a[:,:,t]=a_next</span><br><span class="line"></span><br><span class="line">		y_hat[:,:,t]=y_next</span><br><span class="line"></span><br><span class="line">		caches.append(cache)</span><br><span class="line">	caches=(caches,x)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> a,y_hat,caches</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰åå‘ä¼ æ’­</p>
<p>åå‘ä¼ æ’­éœ€è¦ä»æœ€åå¼€å§‹ï¼ˆfor t in reversed(range(T_x))ï¼‰ï¼Œæ±‚å¾—æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦ã€‚è®¡ç®—å’Œæ¿€æ´»å€¼å’Œè¾“å…¥å€¼ç›¸å…³çš„æ¢¯åº¦å³å¯ï¼Œé€šè¿‡æŸå¤±è°ƒæ•´ç›¸åº”æƒé‡å’Œåç½®é‡çš„å€¼ã€‚</p>
<p>æ ¹æ®å¯¹tanh(a)æ±‚å¯¼ç­‰äº(1-tanh^2) * daï¼Œæ˜“æ±‚å¾—Wax,Waa,xt,ba,a&lt; t-1 &gt;çš„æ¢¯åº¦å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170023.png" alt></p>
<p>ç¼–ç æ—¶ï¼Œä¹Ÿæ˜¯å…ˆå¾—å‡ºä¸€ä¸ªåŸºæœ¬ç¥ç»å…ƒçš„åå‘ä¼ æ’­è¿‡ç¨‹ï¼Œå†æ ¹æ®æ—¶é—´æ­¥ä»¥æ­¤ç±»æ¨å¾—åˆ°å…¶ä»–çš„ï¼Œå¹¶å°†æ¢¯åº¦ä¿®æ­£å¹¶è¿›è¡Œçˆ†ç²—ã€‚</p>
<p>æ³¨ï¼šå¯¹æ¿€æ´»å€¼çš„æ¨å¯¼ä¸€ç›´è¦å¾—åˆ°æœ€å¼€å§‹çš„æ¿€æ´»å€¼å³da0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ ‡å‡†rnnçš„åå‘ä¼ æ’­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å•ä¸ªå•å…ƒçš„åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rnn_cell_backward</span><span class="params">(da_next,cache)</span>:</span></span><br><span class="line">	a_next,a_prev,xt,parameters=cache</span><br><span class="line"></span><br><span class="line">	Wax=parameters[<span class="string">"Wax"</span>]</span><br><span class="line">	Waa=parameters[<span class="string">"Waa"</span>]</span><br><span class="line">	ba=parameters[<span class="string">"ba"</span>]</span><br><span class="line">	<span class="comment"># Wya=parameters["Wya"]</span></span><br><span class="line">	<span class="comment"># by=parameters["by"]</span></span><br><span class="line"></span><br><span class="line">	dtanh=(<span class="number">1</span>-np.square(a_next))*da_next</span><br><span class="line"></span><br><span class="line">	dxt=np.dot(Wax.T,dtanh)</span><br><span class="line">	dWax=np.dot(dtanh,xt.T)</span><br><span class="line">	</span><br><span class="line">	da_prev=np.dot(Waa.T,dtanh)</span><br><span class="line">	dWaa=np.dot(dtanh,a_prev.T)</span><br><span class="line"></span><br><span class="line">	dba=np.sum(dtanh,axis=<span class="number">-1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	<span class="comment"># dWya=np.dot(dy,dtanh.T)</span></span><br><span class="line">	<span class="comment"># dyb=np.sum(dtanh,axis=1,keepdims=True)</span></span><br><span class="line"></span><br><span class="line">	gradients=&#123;<span class="string">'dxt'</span>:dxt,<span class="string">'da_prev'</span>:da_prev,<span class="string">'dWaa'</span>:dWaa,<span class="string">'dWax'</span>:dWax,<span class="string">'dba'</span>:dba&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gradients</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸€ä¸ªåºåˆ—çš„åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rnn_backward</span><span class="params">(da,caches)</span>:</span></span><br><span class="line">	caches,x=caches</span><br><span class="line">	a1,a0,x1,parameters=caches[<span class="number">0</span>]</span><br><span class="line">	n_x,m=x1.shape</span><br><span class="line">	n_a,m,T_x=da.shape</span><br><span class="line"></span><br><span class="line">	dx=np.zeros((n_x,m,T_x))</span><br><span class="line">	dWaa=np.zeros((n_a,n_a))</span><br><span class="line">	dWax=np.zeros((n_a,n_x))</span><br><span class="line">	dba=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line">	da0=np.zeros((n_a,m))</span><br><span class="line">	da_prevt=np.zeros((n_a,m))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å€’åº</span></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> reversed(range(T_x)):</span><br><span class="line">		gradient=rnn_cell_backward(da[:,:,t]+da_prevt,caches[t])</span><br><span class="line">		dxt,da_prevt,dWaat,dWaxt,dbat=gradient[<span class="string">'dxt'</span>],gradient[<span class="string">'da_prev'</span>],gradient[<span class="string">'dWaa'</span>],gradient[<span class="string">'dWax'</span>],gradient[<span class="string">'dba'</span>]</span><br><span class="line"></span><br><span class="line">		dx[:,:,t]=dxt</span><br><span class="line">		dWaa+=dWaat</span><br><span class="line">		dWax+=dWaxt</span><br><span class="line">		dba+=dbat</span><br><span class="line">	da0=da_prevt</span><br><span class="line"></span><br><span class="line">	gradients=&#123;<span class="string">'dx'</span>:dx,<span class="string">'da0'</span>:da0,<span class="string">'dWaa'</span>:dWaa,<span class="string">'dWax'</span>:dWax,<span class="string">'dba'</span>:dba&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gradients</span><br></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬RNNç½‘ç»œå­˜åœ¨é—®é¢˜"><a href="#åŸºæœ¬RNNç½‘ç»œå­˜åœ¨é—®é¢˜" class="headerlink" title="åŸºæœ¬RNNç½‘ç»œå­˜åœ¨é—®é¢˜"></a>åŸºæœ¬RNNç½‘ç»œå­˜åœ¨é—®é¢˜</h2><p>å½“ç½‘ç»œæ·±åº¦å˜æ·±ï¼Œæƒé‡å°†ä»¥æŒ‡æ•°å½¢å¼æ‰©å¤§æˆ–å‡å°ï¼Œä¼šå‡ºç°ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<p>ï¼ˆ1ï¼‰æ¢¯åº¦çˆ†ç‚¸â€”â€”è§£å†³æ–¹æ³•ï¼šæ¢¯åº¦ä¿®å‰ª</p>
<p>å½“å‡ºç°æ¢¯åº¦çˆ†ç‚¸æ—¶ï¼Œåœ¨ä½¿ç”¨å½“å‰æ¢¯åº¦æ›´æ–°å‚æ•°ä¹‹åï¼Œå¯¹æ›´æ–°åçš„å‚æ•°åˆ¤æ–­æ˜¯å¦åœ¨[- æœ€å¤§å€¼ï¼Œæœ€å¤§å€¼]ä¹‹é—´ï¼ˆè¿™é‡Œçš„æœ€å¤§å€¼å’Œæœ€å°å€¼éœ€è¦ç”¨æˆ·ç»™å‡ºï¼‰ï¼Œå½“ä¸åœ¨æ—¶ï¼ŒæŒ‰ç…§æœ€å¤§å€¼å’Œæœ€å°å€¼è®¾ç½®ï¼Œè¿™æ ·ä¿è¯æ¢¯åº¦ä¸ä¼šå˜çš„å¾ˆå¤§ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ¢¯åº¦ä¿®å‰ª</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clip</span><span class="params">(gradients,maxValue)</span>:</span></span><br><span class="line">	dWax=gradients[<span class="string">"dWax"</span>]</span><br><span class="line">	dWaa=gradients[<span class="string">"dWaa"</span>]</span><br><span class="line">	dWya=gradients[<span class="string">"dWya"</span>]</span><br><span class="line"></span><br><span class="line">	db=gradients[<span class="string">"db"</span>]</span><br><span class="line">	dby=gradients[<span class="string">"dby"</span>]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> gradient <span class="keyword">in</span> [dWax,dWaa,dWya,db,dby]:</span><br><span class="line">		np.clip(gradient,-maxValue,maxValue,out=gradient)</span><br><span class="line">	gradients=&#123;<span class="string">'dWax'</span>:dWax,<span class="string">'dWaa'</span>:dWaa,<span class="string">'dWya'</span>:dWya,<span class="string">'db'</span>:db,<span class="string">'dby'</span>:dby&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gradients</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ¢¯åº¦æ¶ˆå¤±â€”â€”è§£å†³æ–¹æ³•ï¼šä¿®æ”¹ç½‘ç»œçš„åŸºæœ¬å•å…ƒ</p>
<p>é‡‡ç”¨GRUå•å…ƒæˆ–è€…LSTMå•å…ƒï¼Œèƒ½æ›´å¥½æ•æ‰æ·±å±‚è¿æ¥</p>
<h2 id="LSTMåŸç†"><a href="#LSTMåŸç†" class="headerlink" title="LSTMåŸç†"></a>LSTMåŸç†</h2><p>ï¼ˆ1ï¼‰ç½‘ç»œç»“æ„</p>
<p>LSTMå•å…ƒå’ŒåŸºæœ¬RNNå•å…ƒç±»ä¼¼ï¼Œä½†å…¶ä¸­åŠ å…¥äº†è®°å¿†ç»†èƒï¼Œæ¯ä¸ªç¥ç»å…ƒéƒ½ä¼šæœ‰ä¸€ä¸ªè®°å¿†ç»†èƒï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ–°è®°å¿†ç»†èƒå€¼ï¼Œè¿™æ ·ä¿è¯å³ä½¿å¾ˆæ·±ï¼Œåé¢çš„å€¼ä¹Ÿä¼šæœ‰å‰é¢ç¥ç»å…ƒçš„å€¼ã€‚</p>
<p>LSTMä¸­è®¾ç½®æ›´æ–°é—¨ï¼Œé—å¿˜é—¨ï¼Œæ ¹æ®æ›´æ–°é—¨å†³å®šä¿ç•™æ–°çš„è®°å¿†ç»†èƒçš„éƒ¨åˆ†ï¼Œæ ¹æ®é—å¿˜é—¨å†³å®šä¿ç•™å‰ä¸€ä¸ªè®°å¿†ç»†èƒçš„éƒ¨åˆ†ï¼Œé€šè¿‡è®°å¿†ç»†èƒè´¯ç©¿æ‰€æœ‰æ—¶é—´æ­¥ï¼Œä»è€Œè·å¾—æ›´è¿œçš„è¿æ¥ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170626.png" alt></p>
<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>1Â° è®°å¿†ç»†èƒæ ¹æ®å½“å‰æ—¶é—´æ­¥x&lt; t &gt;å’Œä¸Šä¸€ä¸ªè¾“å‡ºæ¿€æ´»å€¼å¾—å‡ºæ–°çš„è®°å¿†ç»†èƒ</p>
<p>2Â° å°†æ›´æ–°é—¨ã€é—å¿˜é—¨ã€è¾“å‡ºé—¨æŒ‰ç…§æƒé‡å¾—åˆ°æœ€æ–°çš„å€¼</p>
<p>3Â° æ ¹æ®æ›´æ–°é—¨ã€é—å¿˜é—¨å¾—åˆ°å½“å‰çš„è®°å¿†ç»†èƒ</p>
<p>4Â° æ ¹æ®è¾“å‡ºé—¨å’Œå½“å‰è®°å¿†ç»†èƒå¾·å¥¥æ¿€æ´»å€¼</p>
<p>5Â° æœ€ç»ˆç»è¿‡softmaxå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170550.png" alt></p>
<p>ç¼–ç åŒä¸Šé¢åŸºæœ¬RNNå•å…ƒï¼Œå¾—å‡ºå•ä¸€LSTMå•å…ƒçš„å‰å‘ä¼ æ’­ï¼Œå†å¯¹æ‰€æœ‰æ—¶é—´æ­¥æ±‚å¾—é¢„æµ‹å€¼ã€‚</p>
<p>æ³¨ï¼šè¿™é‡Œæœ‰ä¸ªå°æŠ€å·§ï¼Œå°†å‰ä¸€ä¸ªæ¿€æ´»å€¼a_prevå’Œå½“å‰xè¿›è¡Œå †å ï¼Œå‡å°‘å‚æ•°ä¸ªæ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åŠ å…¥LTSMè§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­å»ºå•ä¸ªlstmå•å…ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lstm_cell_forward</span><span class="params">(xt,a_prev,c_prev,parameters)</span>:</span></span><br><span class="line">	Wf=parameters[<span class="string">'Wf'</span>]</span><br><span class="line">	bf=parameters[<span class="string">'bf'</span>]</span><br><span class="line">	Wu=parameters[<span class="string">'Wu'</span>]</span><br><span class="line">	bu=parameters[<span class="string">'bu'</span>]</span><br><span class="line">	Wc=parameters[<span class="string">'Wc'</span>]</span><br><span class="line">	bc=parameters[<span class="string">'bc'</span>]</span><br><span class="line">	Wo=parameters[<span class="string">'Wo'</span>]</span><br><span class="line">	bo=parameters[<span class="string">'bo'</span>]</span><br><span class="line">	Wy=parameters[<span class="string">'Wy'</span>]</span><br><span class="line">	by=parameters[<span class="string">'by'</span>]</span><br><span class="line"></span><br><span class="line">	n_a,m=a_prev.shape</span><br><span class="line">	n_xt,m=xt.shape</span><br><span class="line"></span><br><span class="line">	ax_prev=np.zeros(((n_a+n_xt),m))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å°†a_prevå’Œxtå †å èµ·æ¥</span></span><br><span class="line">	ax_prev[:n_a,:]=a_prev</span><br><span class="line">	ax_prev[n_a:,:]=xt</span><br><span class="line"></span><br><span class="line">	<span class="comment">#é—å¿˜é—¨</span></span><br><span class="line">	ft=ru.sigmoid(np.dot(Wf,ax_prev)+bf)</span><br><span class="line">	<span class="comment">#æ›´æ–°é—¨</span></span><br><span class="line">	ut=ru.sigmoid(np.dot(Wu,ax_prev)+bu)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å€™é€‰å€¼</span></span><br><span class="line">	cct=np.tanh(np.dot(Wc,ax_prev)+bc)</span><br><span class="line">	<span class="comment">#è®°å¿†ç»†èƒ</span></span><br><span class="line">	c_next=ut*cct+ft*c_prev</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è¾“å‡ºé—¨</span></span><br><span class="line">	ot=ru.sigmoid(np.dot(Wo,ax_prev)+bo)</span><br><span class="line"></span><br><span class="line">	a_next=ot*np.tanh(c_next)</span><br><span class="line"></span><br><span class="line">	y_next=ru.softmax(np.dot(Wy,a_next)+by)</span><br><span class="line"></span><br><span class="line">	cache=(a_next,c_next,a_prev,c_prev,ft,ut,cct,ot,xt,parameters)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> a_next,c_next,y_next,cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#lstmçš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="comment">#c0ä½¿ç”¨0æ¥åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lstm_forward</span><span class="params">(x,a0,parameters)</span>:</span></span><br><span class="line">	caches=[]</span><br><span class="line"></span><br><span class="line">	n_x,m,T_x=x.shape</span><br><span class="line">	Wy=parameters[<span class="string">'Wy'</span>]</span><br><span class="line">	n_y,n_a=Wy.shape</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	a=np.zeros((n_a,m,T_x))</span><br><span class="line">	c=np.zeros((n_a,m,T_x))</span><br><span class="line">	y_hat=np.zeros((n_y,m,T_x))</span><br><span class="line"></span><br><span class="line">	a_next=a0</span><br><span class="line">	c_next=np.zeros((n_a,m))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> range(T_x):</span><br><span class="line">		a_next,c_next,y_next,cache=lstm_cell_forward(x[:,:,t],a_next,c_next,parameters)</span><br><span class="line"></span><br><span class="line">		a[:,:,t]=a_next</span><br><span class="line">		c[:,:,t]=c_next</span><br><span class="line">		y_hat[:,:,t]=y_next</span><br><span class="line"></span><br><span class="line">		caches.append(cache)</span><br><span class="line"></span><br><span class="line">	caches=(caches,x)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> a,y_hat,c,caches</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰åå‘ä¼ æ’­</p>
<p>åå‘ä»æœ€åå‰å‘æ±‚å¾—æ‰€æœ‰çš„æ¢¯åº¦å€¼ï¼ˆfor t in reversed(range(T_x))ï¼‰ï¼Œè¾“å‡ºå€¼yä¸­çš„æƒé‡ï¼Œåç½®é‡ä¸æ›´æ–°ã€‚</p>
<p>1Â° æ±‚ä¸‰ä¸ªé—¨å’Œè®°å¿†ç»†èƒçš„æ¢¯åº¦</p>
<p>è¾“å‡ºé—¨ï¼šæ ¹æ®æœ€ç»ˆè¾“å‡ºçš„æ¿€æ´»å€¼å…¬å¼ä»¥åŠå¯¹sigmoidçš„æ±‚å¯¼å¾—å‡º</p>
<p>è®°å¿†ç»†èƒå€™é€‰å€¼ã€æ›´æ–°é—¨ã€é—å¿˜é—¨ï¼šä¸€éƒ¨åˆ†å—æ±‚å½“å‰è®°å¿†ç»†èƒçš„å½±å“ï¼Œä¸€éƒ¨åˆ†å—æ±‚æ¿€æ´»å€¼çš„å½±å“</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170127.png" alt></p>
<p>2Â° å„ä¸ªæƒé‡ç³»æ•°çš„æ¢¯åº¦ï¼Œæ ¹æ®1ä¸­æ±‚å¾—çš„æ¢¯åº¦èƒ½å¾ˆå®¹æ˜“æ±‚åˆ°</p>
<p>åŒç†ï¼Œå„ä¸ªåç½®é‡æ¢¯åº¦ä¹Ÿå¯æ±‚å¾—</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170142.png" alt></p>
<p>3Â° ä¸Šä¸€ä¸ªæ¿€æ´»å€¼ï¼Œä¸Šä¸€ä¸ªè®°å¿†ç»†èƒå€™é€‰å€¼ï¼Œå½“å‰è¾“å…¥å€¼çš„æ¢¯åº¦</p>
<p>ä¸Šä¸€ä¸ªæ¿€æ´»å€¼å’Œè®°å¿†ç»†èƒå€™é€‰å€¼ã€æ›´æ–°é—¨ã€é—å¿˜é—¨ã€è¾“å‡ºé—¨å‡æœ‰è”ç³»ï¼Œæ‰€ä»¥å°†å„ä¸ªæ¢¯åº¦ç›¸åŠ </p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170213.png" alt></p>
<p>ä¸Šä¸€ä¸ªè®°å¿†ç»†èƒå€™é€‰å€¼ä¸€éƒ¨åˆ†å—æ±‚å½“å‰è®°å¿†ç»†èƒçš„å½±å“ï¼Œä¸€éƒ¨åˆ†å—æ±‚æ¿€æ´»å€¼çš„å½±å“</p>
<p>å½“å‰è¾“å…¥å€¼çš„æ¢¯åº¦å’Œè®°å¿†ç»†èƒå€™é€‰å€¼ã€æ›´æ–°é—¨ã€é—å¿˜é—¨ã€è¾“å‡ºé—¨å‡æœ‰è”ç³»ï¼Œæ‰€ä»¥å°†å„ä¸ªæ¢¯åº¦ç›¸åŠ </p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170231.png" alt></p>
<p>ç¼–ç åŒä¸Šé¢åŸºæœ¬RNNå•å…ƒï¼Œå¾—å‡ºå•ä¸€LSTMå•å…ƒçš„åå‘ä¼ æ’­ï¼Œå†å¯¹æ‰€æœ‰æ—¶é—´æ­¥æ±‚å¾—æ¢¯åº¦ã€‚</p>
<p>æ³¨ï¼šå‰å‘ä¼ æ’­ä¸­ç”¨çš„å°æŠ€å·§ï¼Œå°†å‰ä¸€ä¸ªæ¿€æ´»å€¼a_prevå’Œå½“å‰xè¿›è¡Œå †å ï¼Œå‡å°‘å‚æ•°ä¸ªæ•°ã€‚æ±‚æ¢¯åº¦çš„æ—¶å€™è¦å°†å€¼è¿›è¡Œæ‹†åˆ†æ±‚æ¢¯åº¦ï¼Œå³å°†æƒé‡å‰éƒ¨åˆ†ç”¨æ¥æ±‚a_prevï¼Œåéƒ¨åˆ†ç”¨äºæ±‚xtã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#lstmå•ä¸ªå•å…ƒçš„åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lstm_cell_backward</span><span class="params">(da_next,dc_next,cache)</span>:</span></span><br><span class="line">	a_next,c_next,a_prev,c_prev,ft,ut,cct,ot,xt,parameters=cache</span><br><span class="line">	n_a,m=a_next.shape</span><br><span class="line"></span><br><span class="line">	Wf=parameters[<span class="string">'Wf'</span>]</span><br><span class="line">	bf=parameters[<span class="string">'bf'</span>]</span><br><span class="line">	Wu=parameters[<span class="string">'Wu'</span>]</span><br><span class="line">	bu=parameters[<span class="string">'bu'</span>]</span><br><span class="line">	Wc=parameters[<span class="string">'Wc'</span>]</span><br><span class="line">	bc=parameters[<span class="string">'bc'</span>]</span><br><span class="line">	Wo=parameters[<span class="string">'Wo'</span>]</span><br><span class="line">	bo=parameters[<span class="string">'bo'</span>]</span><br><span class="line">	Wy=parameters[<span class="string">'Wy'</span>]</span><br><span class="line">	by=parameters[<span class="string">'by'</span>]</span><br><span class="line"></span><br><span class="line">	dot=da_next*np.tanh(c_next)*ot*(<span class="number">1</span>-ot)</span><br><span class="line">	dcct=(dc_next*ut+ot*(<span class="number">1</span>-np.square(np.tanh(c_next)))*ut*da_next)*(<span class="number">1</span>-np.square(cct))</span><br><span class="line">	dut=(dc_next*cct+ot*(<span class="number">1</span>-np.square(np.tanh(c_next)))*cct*da_next)*ut*(<span class="number">1</span>-ut)</span><br><span class="line">	dft=(dc_next*c_prev+ot*(<span class="number">1</span>-np.square(np.tanh(c_next)))*c_prev*da_next)*ft*(<span class="number">1</span>-ft)</span><br><span class="line"></span><br><span class="line">	concat=np.concatenate((a_prev,xt),axis=<span class="number">0</span>).T</span><br><span class="line"></span><br><span class="line">	dWf=np.dot(dft,concat)</span><br><span class="line">	dbf=np.sum(dft,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	dWu=np.dot(dut,concat)</span><br><span class="line">	dbu=np.sum(dut,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	dWc=np.dot(dcct,concat)</span><br><span class="line">	dbc=np.sum(dcct,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	dWo=np.dot(dot,concat)</span><br><span class="line">	dbo=np.sum(dot,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	da_prev=np.dot(Wf[:,:n_a].T,dft)+np.dot(Wu[:,:n_a].T,dut)+np.dot(Wc[:,:n_a].T,dcct)+np.dot(Wo[:,:n_a].T,dot)</span><br><span class="line">	dc_prev=dc_next*ft+ot*(<span class="number">1</span>-np.square(np.tanh(c_next)))*ft*da_next</span><br><span class="line">	dxt=np.dot(Wf[:,n_a:].T,dft)+np.dot(Wu[:,n_a:].T,dut)+np.dot(Wc[:,n_a:].T,dcct)+np.dot(Wo[:,n_a:].T,dot)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	gradients=&#123;<span class="string">'dxt'</span>:dxt,<span class="string">'da_prev'</span>:da_prev,<span class="string">'dc_prev'</span>:dc_prev,<span class="string">'dWf'</span>:dWf,<span class="string">'dbf'</span>:dbf,<span class="string">'dWu'</span>:dWu,<span class="string">'dbu'</span>:dbu,<span class="string">'dWc'</span>:dWc,<span class="string">'dbc'</span>:dbc,<span class="string">'dWo'</span>:dWo,<span class="string">'dbo'</span>:dbo&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gradients</span><br><span class="line"></span><br><span class="line"><span class="comment">#lstmä¸€ä¸ªæ—¶é—´åºåˆ—çš„åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lstm_backward</span><span class="params">(da,caches)</span>:</span></span><br><span class="line">	caches,x=caches</span><br><span class="line">	a_next1,c_next1,a_prev1,c_prev1,ft1,ut1,cct1,ot1,xt1,parameters=caches[<span class="number">0</span>]</span><br><span class="line">	n_a,m,T_x=da.shape</span><br><span class="line">	n_x,m=xt1.shape</span><br><span class="line">	n_c,m=c_next1.shape</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	dx=np.zeros((n_x,m,T_x))</span><br><span class="line">	da0=np.zeros((n_a,m))</span><br><span class="line"></span><br><span class="line">	dWf=np.zeros((n_a,n_a+n_x))</span><br><span class="line">	dWu=np.zeros((n_a,n_a+n_x))</span><br><span class="line">	dWc=np.zeros((n_a,n_a+n_x))</span><br><span class="line">	dWo=np.zeros((n_a,n_a+n_x))</span><br><span class="line">	dbf=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line">	dbu=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line">	dbc=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line">	dbo=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	da_prevt=np.zeros((n_a,m))</span><br><span class="line">	dc_prevt=np.zeros((n_c,m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> t <span class="keyword">in</span> reversed(range(T_x)):</span><br><span class="line">		gradient=lstm_cell_backward(da[:,:,t]+da_prevt,dc_prevt,caches[t])</span><br><span class="line">		dxt,da_prevt,dc_prevt,dWft,dbft,dWut,dbut,dWct,dbct,dWot,dbot=gradient[<span class="string">'dxt'</span>],gradient[<span class="string">'da_prev'</span>],gradient[<span class="string">'dc_prev'</span>],gradient[<span class="string">'dWf'</span>],gradient[<span class="string">'dbf'</span>],gradient[<span class="string">'dWu'</span>],gradient[<span class="string">'dbu'</span>],gradient[<span class="string">'dWc'</span>],gradient[<span class="string">'dbc'</span>],gradient[<span class="string">'dWo'</span>],gradient[<span class="string">'dbo'</span>]</span><br><span class="line">		dx[:,:,t]=dxt</span><br><span class="line">		dWf+=dWft</span><br><span class="line">		dbf+=dbft</span><br><span class="line">		dWu+=dWut</span><br><span class="line">		dbu+=dbut</span><br><span class="line">		dWc+=dWct</span><br><span class="line">		dWo+=dWot</span><br><span class="line">		dbo+=dbot</span><br><span class="line">	da0=da_prevt</span><br><span class="line">	<span class="comment"># dc0=dc_prevt</span></span><br><span class="line">	gradients=&#123;<span class="string">'dx'</span>:dx,<span class="string">'da0'</span>:da0,<span class="string">'dWf'</span>:dWf,<span class="string">'dbf'</span>:dbf,<span class="string">'dWu'</span>:dWu,<span class="string">'dbu'</span>:dbu,<span class="string">'dWc'</span>:dWc,<span class="string">'dbc'</span>:dbc,<span class="string">'dWo'</span>:dWo,<span class="string">'dbo'</span>:dbo&#125;</span><br><span class="line">	<span class="keyword">return</span> gradients</span><br></pre></td></tr></table></figure>

<h2 id="GRUåŸç†"><a href="#GRUåŸç†" class="headerlink" title="GRUåŸç†"></a>GRUåŸç†</h2><p>ï¼ˆ1ï¼‰ç½‘ç»œç»“æ„</p>
<p>GRUå¯ä»¥çœ‹æˆæ˜¯ç®€åŒ–ç‰ˆçš„LSTMï¼Œå»é™¤äº†é—å¿˜é—¨ï¼Œå¹¶ä¸”å°†æ¿€æ´»å€¼å°±ä½œä¸ºå½“å‰è®°å¿†ç»†èƒï¼Œç®€åŒ–ç¥ç»å•å…ƒã€‚</p>
<p>GRUä¸­åŒæ ·ä½¿ç”¨è®°å¿†ç»†èƒï¼Œå¹¶ä½¿ç”¨æ›´æ–°é—¨ï¼Œå½“å‰çš„æ–°çš„è®°å¿†ç»†èƒä½¿ç”¨æ›´æ–°é—¨ä¿ç•™æ–°çš„å€™é€‰å€¼ï¼Œä½¿ç”¨ï¼ˆ1-æ›´æ–°é—¨ï¼‰ä¿ç•™ä¹‹å‰çš„è®°å¿†ç»†èƒï¼Œå¹¶å°†å¾—åˆ°çš„æ–°è®°å¿†ç»†èƒä½œä¸ºæ¿€æ´»å€¼è¾“å‡ºï¼Œå¹¶ç»è¿‡softmaxå¾—åˆ°é¢„æµ‹å€¼yã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170407.png" alt></p>
<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>GRUé‡‡ç”¨a&lt; t &gt;=c&lt; t &gt;</p>
<p>1Â° å¾—åˆ°è®°å¿†ç»†èƒå€™é€‰å€¼ï¼Œä½¿ç”¨ç›¸å…³é—¨è¡¡é‡å‰ä¸€ä¸ªè®°å¿†ç»†èƒå’Œå½“å‰å€™é€‰å€¼çš„ç›¸å…³æ€§</p>
<p>2Â° è®¡ç®—æ›´æ–°é—¨ã€æ›´æ–°é—¨</p>
<p>3Â° æŒ‰ç…§æ›´æ–°é—¨æ¥è®¡ç®—æ–°çš„è®°å¿†ç»†èƒ</p>
<p>4Â° å°†è®°å¿†ç»†èƒæ–°çš„å€¼ä½œä¸ºæ¿€æ´»å€¼ï¼Œé‡‡ç”¨softmaxå¾—åˆ°é¢„æµ‹å€¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200618170430.png" alt></p>
<h2 id="é‡‡æ ·"><a href="#é‡‡æ ·" class="headerlink" title="é‡‡æ ·"></a>é‡‡æ ·</h2><p>ä½œç”¨ï¼šåˆæˆæ•°æ®ï¼Œå¾—åˆ°æ¯ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹å¹¶ä¼ é€’ç»™ä¸‹ä¸€ä¸ªç¥ç»å…ƒï¼Œä»è€Œå¾—åˆ°è®­ç»ƒæ¨¡å‹åçš„é¢„æµ‹ç»“æœã€‚</p>
<p>å½“æ¨¡å‹ç»è¿‡æ­å»ºã€ç¼–è¯‘ã€è®­ç»ƒä¹‹åï¼Œé€šè¿‡é‡‡æ ·å¾—åˆ°æ¨¡å‹å¯¹æ–°çš„æ•°æ®ï¼ˆæˆ–è€…ä¸è¾“å…¥æ•°æ®ï¼‰çš„é¢„æµ‹å€¼ã€‚</p>
<p>0Â° åˆå§‹é‡‡ç”¨é›¶å‘é‡ï¼ˆç‹¬çƒ­å‘é‡ï¼‰ä½œä¸ºåˆå§‹è¾“å…¥ï¼Œæ ¹æ®æ¨¡å‹è®­ç»ƒå¥½çš„å‚æ•°è¿›å…¥å¾ªç¯</p>
<p>1Â° æ ¹æ®RNNç½‘ç»œå‰å‘ä¼ æ’­å¾—åˆ°é¢„æµ‹å€¼y</p>
<p>2Â° æŒ‰ç…§éšæœºé‡‡æ ·çš„æ–¹å¼å–å…¶ä¸­ä¸€ä¸ªå€¼ä½œä¸ºé¢„æµ‹å€¼</p>
<p>3Â° æŒ‰ç…§å½“å‰é¢„æµ‹å€¼çš„ä½ç½®ï¼Œç”Ÿæˆç‹¬çƒ­å‘é‡ä½œä¸ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥</p>
<p>4Â° ä¸æ–­å¾ªç¯ï¼Œå°±å¾—åˆ°äº†åˆæˆæ•°æ®ï¼Œå³ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹é¢„æµ‹çš„ç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é‡‡æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sample</span><span class="params">(parameters,char_to_ix,seed)</span>:</span></span><br><span class="line">	Wax=parameters[<span class="string">'Wax'</span>]</span><br><span class="line">	Waa=parameters[<span class="string">'Waa'</span>]</span><br><span class="line">	b=parameters[<span class="string">'b'</span>]</span><br><span class="line">	Wya=parameters[<span class="string">'Wya'</span>]</span><br><span class="line">	by=parameters[<span class="string">'by'</span>]</span><br><span class="line"></span><br><span class="line">	vocab_size=by.shape[<span class="number">0</span>]</span><br><span class="line">	n_a=Waa.shape[<span class="number">1</span>]</span><br><span class="line">	a_prev=np.zeros((n_a,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#åˆ›é€ ç‹¬çƒ­å‘é‡</span></span><br><span class="line">	x=np.zeros((vocab_size,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	counter=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	idx=<span class="number">-1</span></span><br><span class="line">	indies=[]</span><br><span class="line">	check_character=char_to_ix[<span class="string">'\n'</span>]</span><br><span class="line">	<span class="keyword">while</span> idx!=check_character <span class="keyword">and</span> counter&lt;<span class="number">50</span>:</span><br><span class="line">		a=np.tanh(np.dot(Waa,a_prev)+np.dot(Wax,x)+b)</span><br><span class="line">		z=np.dot(Wya,a)+by</span><br><span class="line">		y=cu.softmax(z)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æŒ‰ç…§æ¦‚ç‡é‡‡æ ·</span></span><br><span class="line">		np.random.seed(seed+counter)</span><br><span class="line">		idx=np.random.choice(list(range(vocab_size)),p=y.ravel())</span><br><span class="line">		indies.append(idx)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æŒ‰ç…§é€‰æ‹©çš„ä½ç½®ç”Ÿæˆç‹¬çƒ­å‘é‡</span></span><br><span class="line">		x=np.zeros((vocab_size,<span class="number">1</span>))</span><br><span class="line">		x[idx]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#å°†ä¸Šä¸€ä¸ªé¢„æµ‹å€¼ç›´æ¥ä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥</span></span><br><span class="line">		a_prev=a</span><br><span class="line">		seed+=<span class="number">1</span></span><br><span class="line">		counter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> counter==<span class="number">50</span>:</span><br><span class="line">		indies.append(char_to_ix[<span class="string">'\n'</span>])</span><br><span class="line">	<span class="keyword">return</span> indies</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å¾ªç¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”ç¥ç»é£æ ¼è½¬æ¢</title>
    <url>/blogs/convNet5/</url>
    <content><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>å°†ä¸€ä¸ªå›¾åƒä½œä¸ºå†…å®¹å›¾åƒï¼Œå¦ä¸€å¹…å›¾ä½œä¸ºé£æ ¼å›¾åƒï¼Œä¸¤ä¸ªå›¾åƒç»è¿‡ç¥ç»ç½‘ç»œç”Ÿè¾°ä¸€ä¸ªæ–°çš„å›¾åƒï¼Œè¯¥å›¾åƒæ—¢æœ‰å‰ä¸€ä¸ªå›¾åƒçš„å†…å®¹ï¼Œåˆæœ‰åä¸€ä¸ªå›¾åƒçš„é£æ ¼ï¼Œè¿™ç§°ä¸ºç¥ç»é£æ ¼è½¬æ¢ã€‚</p><h2 id="æŸå¤±å‡½æ•°çš„ç¡®å®š"><a href="#æŸå¤±å‡½æ•°çš„ç¡®å®š" class="headerlink" title="æŸå¤±å‡½æ•°çš„ç¡®å®š"></a>æŸå¤±å‡½æ•°çš„ç¡®å®š</h2><p>ç¥ç»ç½‘ç»œæµ…å±‚å­¦ä¹ å›¾ç‰‡çš„ç‚¹ã€çº¿æˆ–è€…é¢œè‰²ç­‰åŸºç¡€ç‰¹å¾ï¼Œæ·±å±‚å­¦ä¹ å›¾ç‰‡ä¸­ç‰©ä½“æˆ–è€…æ›´å…·ä½“çš„ç‰¹å¾ã€‚</p><p>ç¥ç»é£æ ¼è½¬æ¢æ˜¯è®©åˆæˆçš„å›¾ç‰‡ä¸­çš„å†…å®¹æ›´æ¥è¿‘å†…å®¹å›¾ç‰‡ï¼Œé£æ ¼æ›´æ¥è¿‘é£æ ¼å›¾ç‰‡ï¼Œå³è®©åˆæˆçš„å›¾ç‰‡ä¸­çš„å†…å®¹å’Œå†…å®¹å›¾ç‰‡ç›¸æ¯”æŸå¤±æ›´å°ï¼Œè®©åˆæˆçš„å›¾ç‰‡ä¸­çš„é£æ ¼å’Œé£æ ¼å›¾ç‰‡ç›¸æ¯”æŸå¤±æ›´å°ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ€»æˆæœ¬æœ€å°ï¼Œé€šè¿‡æˆæœ¬å‡½æ•°è°ƒæ•´ç½‘ç»œçš„å‚æ•°ã€‚</p><a id="more"></a>


<p>å› æ­¤éœ€è¦å®šä¹‰ç½‘ç»œä¸­çš„å†…å®¹æŸå¤±å‡½æ•°ï¼Œé£æ ¼æŸå¤±å‡½æ•°ï¼Œæ€»æˆæœ¬å‡½æ•°ã€‚</p>
<h3 id="å†…å®¹æŸå¤±å‡½æ•°"><a href="#å†…å®¹æŸå¤±å‡½æ•°" class="headerlink" title="å†…å®¹æŸå¤±å‡½æ•°"></a>å†…å®¹æŸå¤±å‡½æ•°</h3><p>å°†æ¯å±‚çš„é€šé“æŒ‰ç…§é•¿å®½è¿›è¡Œå±•å¼€ï¼Œæ¯ä¸ªä½ç½®å’Œå†…å®¹å›¾ç‰‡çš„ç›¸åº”ä½ç½®ä¹‹é—´ä½¿ç”¨äºŒè€…ä¹‹å·®èŒƒæ•°æ±‚å†…å®¹ä¹‹é—´çš„å·®å¼‚ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200610105338.png" alt></p>
<p>å³å°†ä¸¤ä¸ªçŸ©é˜µå¯¹åº”å…ƒç´ ç›¸å‡å†æ±‚å¹³æ–¹</p>
<p>è¯´æ˜ï¼šï¼ˆ1ï¼‰æœ€ç»ˆå†…å®¹æŸå¤±å‡½æ•°å‰çš„ç³»æ•°å¯å®šä¹‰ä¸ºå½’ä¸€åŒ–1/2ï¼Œæˆ–è€…å…¶ä»–å€¼ã€‚ï¼ˆå› ä¸ºæœ€ç»ˆæˆæœ¬å‡½æ•°ä¼šé€šè¿‡alphaè°ƒæ•´ç³»æ•°ï¼‰</p>
<p>ï¼ˆ2ï¼‰è¿™é‡Œéœ€è¦å°†æ¿€æ´»å€¼ä¸­çš„é€šé“æ•°æ”¾åœ¨å‰é¢ï¼Œå› ä¸ºç½‘ç»œä¸­å¯¼å…¥æ¨¡å‹çš„æ—¶å€™æ˜¯å°†é€šé“æ”¾åœ¨æœ€å‰é¢å¤„ç†çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å†…å®¹å‡½æ•°æˆæœ¬</span></span><br><span class="line"><span class="comment">#è¾“å…¥å†…å®¹å›¾åƒå’Œåˆæˆå›¾åƒçš„æ¿€æ´»å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_content_cost</span><span class="params">(a_C,a_G)</span>:</span></span><br><span class="line">	m,n_h,n_w,n_c=a_G.get_shape().as_list()</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ä¿è¯é€šé“åœ¨å‰</span></span><br><span class="line">	a_C=tf.transpose(tf.reshape(a_C,(n_h*n_w,n_c)))</span><br><span class="line">	a_G=tf.transpose(tf.reshape(a_G,(n_h*n_w,n_c)))</span><br><span class="line">	C_G=tf.reduce_sum(tf.square(tf.subtract(a_C,a_G)))</span><br><span class="line"></span><br><span class="line">	content_cost=<span class="number">1</span>/(<span class="number">4</span>*n_h*n_w*n_c)*C_G</span><br><span class="line">	<span class="keyword">return</span> content_cost</span><br></pre></td></tr></table></figure>

<h3 id="é£æ ¼æŸå¤±å‡½æ•°"><a href="#é£æ ¼æŸå¤±å‡½æ•°" class="headerlink" title="é£æ ¼æŸå¤±å‡½æ•°"></a>é£æ ¼æŸå¤±å‡½æ•°</h3><p>ï¼ˆ1ï¼‰æ±‚å•å±‚çš„é£æ ¼å·®å¼‚</p>
<p>å¾—åˆ°å½“å‰å›¾ç‰‡æŒ‰ç…§é€šé“å±•å¼€çš„é£æ ¼çŸ©é˜µï¼ˆä½¿ç”¨ç›¸å…³ç³»æ•°è¡¡é‡ä¸åŒä½ç½®å‡ºç°ç›¸åº”é£æ ¼çš„æ¦‚ç‡ï¼‰ï¼Œå†æŒ‰ç…§èŒƒæ•°å®šä¹‰é£æ ¼ä¹‹é—´çš„å·®å¼‚ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200610110834.png" alt></p>
<p>1Â° æ±‚é£æ ¼çŸ©é˜µï¼šå³å°†å±•å¼€çš„å½“å‰é€šé“çš„çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜</p>
<p>2Â° æŒ‰ç…§èŒƒæ•°ï¼Œå°†é£æ ¼å›¾ç‰‡å’Œåˆæˆå›¾ç‰‡çš„é£æ ¼çŸ©é˜µæ±‚å·®ï¼Œå–å¹³æ–¹å¾—åˆ°èŒƒæ•°å€¼ï¼Œä»¥æ­¤ä½œä¸ºé£æ ¼çš„æŸå¤±ï¼Œå³é£æ ¼ä¹‹é—´çš„å·®å¼‚</p>
<p>ï¼ˆ2ï¼‰å°†å„å±‚çš„é£æ ¼å·®å¼‚åˆå¹¶</p>
<p>å¤šå±‚é£æ ¼åˆå¹¶çš„åŸå› ï¼šå¤šè€ƒè™‘å‡ å±‚çš„é£æ ¼èƒ½ä½¿å¾—ç»“æœæ›´å‡†ç¡®ï¼Œé€‰æ‹©çš„å±‚æ•°ï¼šstyle_layers=[(â€œconv1_1â€,0.2),(â€œconv2_1â€,0.2),(â€œconv3_1â€,0.2),(â€œconv4_1â€,0.2),(â€œconv5_1â€,0.2)]</p>
<p>æ–¹æ³•ï¼šéå†æ¯å±‚ï¼Œå¾—åˆ°æ¿€æ´»å€¼è¾“å…¥å•å±‚é£æ ¼æ±‚å·®å¼‚ï¼Œç´¯åŠ æ¯å±‚çš„é£æ ¼å·®å¼‚ï¼Œå¹¶ä¹˜ä¸Šæ¯å±‚çš„ç³»æ•°ï¼ˆè¡¡é‡æ¯å±‚çš„é£æ ¼æ‰€å çš„æ¯”é‡ï¼Œè¿™é‡Œæƒé‡å®šé‡é€‰æ‹©0.2ï¼‰ï¼Œæœ€ç»ˆæ„æˆæ€»ä½“é£æ ¼æŸå¤±å‡½æ•°</p>
<p>æ³¨ï¼šä¸ºä»€ä¹ˆå†…å®¹å‡½æ•°ä¸­æ²¡æœ‰ä½¿ç”¨å¤šå±‚åˆå¹¶ï¼Œå› ä¸ºæµ…å±‚ç½‘ç«™ä¸­åªå­¦ä¹ äº†å›¾å½¢çš„åŸºæœ¬æ ·å¼ï¼Œæ·±å±‚ç½‘ç»œæ‰å­¦ä¹ åˆ°çœŸæ­£çš„å›¾åƒå†…å®¹ã€‚ï¼ˆä¸ªäººçš„ç†è§£ï¼‰</p>
<p>è¯´æ˜ï¼šï¼ˆ1ï¼‰æœ€ç»ˆé£æ ¼æŸå¤±å‡½æ•°å‰çš„ç³»æ•°å¯å®šä¹‰ä¸ºå½’ä¸€åŒ–1/(2 * nh * nw * nc)^2ï¼Œæˆ–è€…å…¶ä»–å€¼ã€‚ï¼ˆå› ä¸ºæœ€ç»ˆæˆæœ¬å‡½æ•°ä¼šé€šè¿‡betaè°ƒæ•´ç³»æ•°ï¼‰</p>
<p>ï¼ˆ2ï¼‰è¿™é‡Œéœ€è¦å°†æ¿€æ´»å€¼ä¸­çš„é€šé“æ•°æ”¾åœ¨å‰é¢ï¼Œå› ä¸ºç½‘ç»œä¸­å¯¼å…¥æ¨¡å‹çš„æ—¶å€™æ˜¯å°†é€šé“æ”¾åœ¨æœ€å‰é¢å¤„ç†çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é£æ ¼å‡½æ•°æˆæœ¬</span></span><br><span class="line"><span class="comment">#çŸ©é˜µå†…å…ƒç´ ç›¸ä¹˜</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gram_matrix</span><span class="params">(A)</span>:</span></span><br><span class="line">	gram=tf.matmul(A,tf.transpose(A))</span><br><span class="line">	<span class="keyword">return</span> gram</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸä¸€å±‚çš„é£æ ¼å‡½æ•°æˆæœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_layer_style_cost</span><span class="params">(a_S,a_G)</span>:</span></span><br><span class="line">	m,n_h,n_w,n_c=a_G.get_shape().as_list()</span><br><span class="line"></span><br><span class="line">	a_S=tf.transpose(tf.reshape(a_S,(n_h*n_w,n_c)))</span><br><span class="line">	a_G=tf.transpose(tf.reshape(a_G,(n_h*n_w,n_c)))</span><br><span class="line"></span><br><span class="line">	a_Svalue=gram_matrix(a_S)</span><br><span class="line">	a_Gvalue=gram_matrix(a_G)</span><br><span class="line"></span><br><span class="line">	S_G=tf.reduce_sum(tf.square(tf.subtract(a_Svalue,a_Gvalue)))</span><br><span class="line"></span><br><span class="line">	style_layer_cost=<span class="number">1</span>/(<span class="number">4</span>*(n_c**<span class="number">2</span>)*((n_h*n_w))**<span class="number">2</span>)*S_G</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> style_layer_cost</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»ä¸åŒçš„å±‚å¾—åˆ°é£æ ¼å‡½æ•°æˆæœ¬è¿›è¡Œåˆå¹¶ï¼Œæ•ˆæœä¼šæ›´å¥½</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_style_cost</span><span class="params">(model,style_layers)</span>:</span></span><br><span class="line">	style_cost=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> layer,coeff <span class="keyword">in</span> style_layers:</span><br><span class="line">		out=model[layer]</span><br><span class="line">		a_S=sess.run(out)</span><br><span class="line">		a_G=out</span><br><span class="line"></span><br><span class="line">		style_layer_cost=compute_layer_style_cost(a_S,a_G)</span><br><span class="line"></span><br><span class="line">		style_cost+=coeff*style_layer_cost</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> style_cost</span><br></pre></td></tr></table></figure>

<h3 id="æ€»ä½“æŸå¤±å‡½æ•°"><a href="#æ€»ä½“æŸå¤±å‡½æ•°" class="headerlink" title="æ€»ä½“æŸå¤±å‡½æ•°"></a>æ€»ä½“æŸå¤±å‡½æ•°</h3><p>å°†å†…å®¹æŸå¤±å’Œé£æ ¼æŸå¤±ä¹˜ä»¥ç›¸åº”ç³»æ•°å¾—åˆ°æ€»æˆæœ¬å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¾—åˆ°æ€»æˆæœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">total_cost</span><span class="params">(J_content,J_style,alpha=<span class="number">10</span>,beta=<span class="number">40</span>)</span>:</span></span><br><span class="line">	J_cost=alpha*J_content+J_style*beta</span><br><span class="line">	<span class="keyword">return</span> J_cost</span><br></pre></td></tr></table></figure>

<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>ï¼ˆ1ï¼‰å»ºç«‹äº¤äº’ä¼šè¯</p>
<p>ä½¿ç”¨äº¤äº’å¼å¯¹è¯ï¼Œå¯ä»¥å…ˆå®šä¹‰ä¼šè¯ï¼Œå†å®šä¹‰æ“ä½œï¼Œè¾ƒç›´æ¥ä¼šè¯æ–¹å¼ä½¿ç”¨æ›´æ–¹ä¾¿</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#0.ä½¿ç”¨äº¤äº’å¼ä¼šè¯åŠå¯¼å…¥æ¨¡å‹</span></span><br><span class="line">tf.reset_default_graph()</span><br><span class="line">sess=tf.InteractiveSession()<span class="comment">#tf.sessionæ˜¯éœ€è¦å°†æ“ä½œéƒ½å»ºç«‹å¥½æ‰èƒ½è¿›è¡Œä¼šè¯æ“ä½œï¼Œä½¿ç”¨äº¤äº’å¼ä¼šè¯å¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªä¼šè¯ï¼Œå†å®šä¹‰æ“ä½œ</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¯¼å…¥æ¨¡å‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model=nu.load_vgg_model(<span class="string">"./pretrained-model/imagenet-vgg-verydeep-19.mat"</span>)</span><br><span class="line">print(model)</span><br></pre></td></tr></table></figure>

<p>æ¨¡å‹é‡‡ç”¨ç¥ç»é£æ ¼è½¬æ¢æå‡ºè€…è®ºæ–‡ä¸­çš„æ¨¡å‹ï¼Œé‡‡ç”¨VGG-19æ¨¡å‹ï¼Œæœ¬åœ°ä¿å­˜äº†è¯¥æ¨¡å‹ç½‘ç»œï¼Œæ‰“å°å¦‚ä¸‹ï¼Œå¯è§æ¨¡å‹å­˜å‚¨åœ¨å­—å…¸ä¸­ï¼Œå­—å…¸çš„é”®ä¸­ä¿å­˜æ¯ä¸ªå˜é‡ï¼Œå€¼ä¿å­˜åŒ…å«è¯¥å˜é‡å€¼çš„å¼ é‡ï¼Œå½“éœ€è¦é€šè¿‡ç½‘ç»œè¿è¡Œå›¾åƒçš„æ—¶å€™ï¼Œä½¿ç”¨tf.assignå°†å›¾åƒè¾“å…¥ç½‘ç»œå³å¯</p>
<p>æ¨¡å‹ç»“æ„å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>{â€˜inputâ€™: &lt;tf.Variable â€˜Variable:0â€™ shape=(1, 300, 400, 3) dtype=float32_ref&gt;, â€˜conv1_1â€™: &lt;tf.Tensor â€˜Relu:0â€™ shape=(1, 300, 400, 64) dtype=float32&gt;, â€˜conv1_2â€™: &lt;tf.Tensor â€˜Relu_1:0â€™ shape=(1, 300, 400, 64) dtype=float32&gt;, â€˜avgpool1â€™: &lt;tf.Tensor â€˜AvgPool:0â€™ shape=(1, 150, 200, 64) dtype=float32&gt;, â€˜conv2_1â€™: &lt;tf.Tensor â€˜Relu_2:0â€™ shape=(1, 150, 200, 128) dtype=float32&gt;, â€˜conv2_2â€™: &lt;tf.Tensor â€˜Relu_3:0â€™ shape=(1, 150, 200, 128) dtype=float32&gt;, â€˜avgpool2â€™: &lt;tf.Tensor â€˜AvgPool_1:0â€™ shape=(1, 75, 100, 128) dtype=float32&gt;, â€˜conv3_1â€™: &lt;tf.Tensor â€˜Relu_4:0â€™ shape=(1, 75, 100, 256) dtype=float32&gt;, â€˜conv3_2â€™: &lt;tf.Tensor â€˜Relu_5:0â€™ shape=(1, 75, 100, 256) dtype=float32&gt;, â€˜conv3_3â€™: &lt;tf.Tensor â€˜Relu_6:0â€™ shape=(1, 75, 100, 256) dtype=float32&gt;, â€˜conv3_4â€™: &lt;tf.Tensor â€˜Relu_7:0â€™ shape=(1, 75, 100, 256) dtype=float32&gt;, â€˜avgpool3â€™: &lt;tf.Tensor â€˜AvgPool_2:0â€™ shape=(1, 38, 50, 256) dtype=float32&gt;, â€˜conv4_1â€™: &lt;tf.Tensor â€˜Relu_8:0â€™ shape=(1, 38, 50, 512) dtype=float32&gt;, â€˜conv4_2â€™: &lt;tf.Tensor â€˜Relu_9:0â€™ shape=(1, 38, 50, 512) dtype=float32&gt;, â€˜conv4_3â€™: &lt;tf.Tensor â€˜Relu_10:0â€™ shape=(1, 38, 50, 512) dtype=float32&gt;, â€˜conv4_4â€™: &lt;tf.Tensor â€˜Relu_11:0â€™ shape=(1, 38, 50, 512) dtype=float32&gt;, â€˜avgpool4â€™: &lt;tf.Tensor â€˜AvgPool_3:0â€™ shape=(1, 19, 25, 512) dtype=float32&gt;, â€˜conv5_1â€™: &lt;tf.Tensor â€˜Relu_12:0â€™ shape=(1, 19, 25, 512) dtype=float32&gt;, â€˜conv5_2â€™: &lt;tf.Tensor â€˜Relu_13:0â€™ shape=(1, 19, 25, 512) dtype=float32&gt;, â€˜conv5_3â€™: &lt;tf.Tensor â€˜Relu_14:0â€™ shape=(1, 19, 25, 512) dtype=float32&gt;, â€˜conv5_4â€™: &lt;tf.Tensor â€˜Relu_15:0â€™ shape=(1, 19, 25, 512) dtype=float32&gt;, â€˜avgpool5â€™: &lt;tf.Tensor â€˜AvgPool_4:0â€™ shape=(1, 10, 13, 512) dtype=float32&gt;}</p>
</blockquote>
<p>ï¼ˆ3ï¼‰è¾“å…¥å†…å®¹å›¾ç‰‡</p>
<p>ä»ç½‘ç»œç»“æ„ä¸­å¯ä»¥çœ‹å‡ºï¼Œç½‘ç»œè¾“å…¥æ˜¯300 * 400å¤§å°çš„å›¾åƒï¼Œæ‰€ä»¥è¦å®šä¹‰å¥½å›¾åƒå¤§å°</p>
<p>ä½¿ç”¨PIL ä¸­çš„openå‡½æ•°è¯»å–å›¾ç‰‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å›¾ç‰‡å¤§å°ä¸º300*400</span></span><br><span class="line"><span class="comment">#1.å¯¼å…¥å†…å®¹å›¾ç‰‡</span></span><br><span class="line">image_path=<span class="string">"./images/"</span></span><br><span class="line">content_image=Image.open(image_path+<span class="string">"cat.jpg"</span>)</span><br><span class="line">content_image=nu.reshape_and_normalize_image(np.array(content_image))</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰è¾“å…¥é£æ ¼å›¾ç‰‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.å¯¼å…¥é£æ ¼å›¾ç‰‡</span></span><br><span class="line">style_image=Image.open(image_path+<span class="string">"camp-nou.jpg"</span>)</span><br><span class="line">style_image=nu.reshape_and_normalize_image(np.array(style_image))</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ5ï¼‰è®¡ç®—æˆæœ¬å‡½æ•°</p>
<p>å†…å®¹æˆæœ¬ï¼š1Â° å°†å†…å®¹å›¾ç‰‡é€šè¿‡assignæ–¹æ³•è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œå¹¶ä½¿ç”¨ä¼šè¯è¿è¡Œç½‘ç»œï¼›</p>
<p>2Â° ç½‘ç»œä¸€å…±5å±‚ï¼Œé€‰æ‹©ç¬¬å››å±‚çš„å†…å®¹ä½œä¸ºæ¯”å¯¹çš„å†…å®¹ï¼Œå°†æ¨¡å‹è¿è¡Œè¯¥å±‚å¾—åˆ°çš„æ¿€æ´»å€¼ä½œä¸ºa_Cï¼Œå³å†…å®¹å›¾ç‰‡è¾“å‡ºï¼ˆéœ€è¦æ¯”å¯¹çš„å†…å®¹ï¼‰</p>
<p>3Â° a_Gè¿™é‡Œä½¿ç”¨å¯¹åº”å±‚æ•°çš„çº¿æ€§å€¼ä½œä¸ºå ä½ç¬¦ï¼Œå½“è¿è¡Œæ¨¡å‹çš„æ—¶å€™ï¼Œæ›´æ–°å€¼</p>
<p>4Â° æœ€ç»ˆè¾“å…¥å†…å®¹æŸå¤±å‡½æ•°ä¸­</p>
<p>é£æ ¼æˆæœ¬ï¼š1Â° å°†é£æ ¼å›¾ç‰‡é€šè¿‡assignæ–¹æ³•è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œå¹¶ä½¿ç”¨ä¼šè¯è¿è¡Œç½‘ç»œï¼›</p>
<p>2Â° ç½‘ç»œä¸€å…±5å±‚ï¼Œé€‰æ‹©ç¬¬1-5å±‚çš„é£æ ¼å’Œç³»æ•°ä½œä¸ºæ¯”å¯¹çš„å†…å®¹ï¼Œå°†æ¨¡å‹å’Œéœ€è¦æ¯”å¯¹çš„ç½‘ç»œå±‚è¾“å…¥åˆ°é£æ ¼æŸå¤±å‡½æ•°ä¸­</p>
<p>ç»¼ä¸Šï¼Œå°†äºŒè€…æˆæœ¬è¾“å…¥åˆ°æ€»æˆæœ¬ä¸­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#4.åˆ†åˆ«è®¡ç®—ä¸‰ä¸ªæˆæœ¬</span></span><br><span class="line">sess.run(model[<span class="string">"input"</span>].assign(content_image))</span><br><span class="line">out=model[<span class="string">'conv4_2'</span>]</span><br><span class="line">a_C=sess.run(out)</span><br><span class="line">a_G=out</span><br><span class="line">J_content=compute_content_cost(a_C,a_G)</span><br><span class="line"></span><br><span class="line">sess.run(model[<span class="string">"input"</span>].assign(style_image))</span><br><span class="line">J_style=compute_style_cost(model,style_layers)</span><br><span class="line">J_cost=total_cost(J_content,J_style,alpha=<span class="number">10</span>,beta=<span class="number">40</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ6ï¼‰å®šä¹‰ç½‘ç»œçš„ä¼˜åŒ–ç®—æ³•</p>
<p>é€‰æ‹©adamä¼˜åŒ–ç®—æ³•å’Œå­¦ä¹ ç‡ï¼Œä»¥åŠéœ€è¦æœ€å°åŒ–çš„æˆæœ¬å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#5.å®šä¹‰ä¼˜åŒ–ç®—æ³•</span></span><br><span class="line">optimizer=tf.train.AdamOptimizer(learning_rate=<span class="number">2</span>).minimize(J_cost)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ7ï¼‰æ­å»ºç½‘ç»œ</p>
<p>0Â° æ­¤æ—¶è¿è¡Œä¼šè¯åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>1Â° å°†åˆæˆå›¾ç‰‡ä½œä¸ºç½‘ç»œè¾“å…¥ï¼Œå¹¶è¿è¡Œä¼šè¯</p>
<p>2Â° æ¯æ¬¡è¿­ä»£éƒ½æŒ‰ç…§ä¼˜åŒ–ç®—æ³•ï¼Œå¹¶æ›´æ–°åˆæˆçš„å›¾ç‰‡ï¼Œå°†æ¯æ¬¡çš„åˆæˆå›¾ç‰‡æŒ‰ç…§è·¯å¾„ä¿å­˜</p>
<p>3Â° è¿­ä»£ç»“æŸå¾—åˆ°æœ€ç»ˆåˆæˆæ•ˆæœå›¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#6.æ­å»ºæ€»ä½“æ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_nn</span><span class="params">(sess,input_image,iteration=<span class="number">200</span>)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–æ‰€æœ‰å˜é‡</span></span><br><span class="line">	sess.run(tf.global_variables_initializer())</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å°†è¾“å…¥çš„å›¾ç‰‡ä½œä¸ºåˆå§‹å›¾ç‰‡è¾“å…¥ç½‘ç»œ</span></span><br><span class="line">	generate_image=sess.run(model[<span class="string">"input"</span>].assign(input_image))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(iteration):</span><br><span class="line">		sess.run(optimizer)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æ¯æ¬¡è¿­ä»£æ›´æ–°åˆæˆçš„å›¾ç‰‡</span></span><br><span class="line">		generate_image=sess.run(model[<span class="string">"input"</span>])</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> i%<span class="number">20</span>==<span class="number">0</span>:</span><br><span class="line">			Jc,Js,Jt=sess.run([J_content,J_style,J_cost])</span><br><span class="line">			print(<span class="string">"iteration:"</span>,i)</span><br><span class="line">			print(<span class="string">"å†…å®¹å‡½æ•°æŸå¤±ï¼š"</span>,Jc)</span><br><span class="line">			print(<span class="string">"é£æ ¼å‡½æ•°æŸå¤±ï¼š"</span>,Js)</span><br><span class="line">			print(<span class="string">"æ€»ä½“æŸå¤±ï¼š"</span>,Jt)</span><br><span class="line">			nu.save_image(<span class="string">"./out/"</span>+str(i)+<span class="string">".png"</span>,generate_image)</span><br><span class="line"></span><br><span class="line">	nu.save_image(<span class="string">"./out/generate_image.jpg"</span>,generate_image)</span><br><span class="line">	<span class="keyword">return</span> generate_image</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ8ï¼‰æœ€ç»ˆç»“æœ</p>
<p>å†…å®¹å›¾ç‰‡ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200610093228.png" alt></p>
<p>é£æ ¼å›¾ç‰‡ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200610093247.png" alt></p>
<p>è¾“å…¥model_nn(sess,generate_image)è¿›è¡Œæµ‹è¯•ï¼Œæ¯æ¬¡è¿­ä»£å¾—åˆ°çš„ç»“æœè¾“å‡ºåœ¨outæ–‡ä»¶å¤¹ä¸‹ï¼Œè¿­ä»£ç»“æŸåæœ€ç»ˆå¾—åˆ°çš„åˆæˆç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200610093114.png" alt></p>
<p>ä»åˆæˆå›¾åƒå¯ä»¥çœ‹å‡ºï¼Œå¾ˆå¥½çš„ä¿ç•™äº†å†…å®¹å›¾åƒä¸­å†…å®¹ï¼Œä¹Ÿå¾ˆå¥½çš„èåˆäº†é£æ ¼å›¾ç‰‡ä¸­çš„é£æ ¼ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”äººè„¸è¯†åˆ«</title>
    <url>/blogs/convNet4/</url>
    <content><![CDATA[<p>äººè„¸è¯†åˆ«ç³»ç»ŸåŒ…æ‹¬äººè„¸è¯†åˆ«å’Œæ´»ä½“æ£€æµ‹ï¼ˆä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼‰ï¼Œè¿™é‡Œç€é‡ä»‹ç»äººè„¸è¯†åˆ«éƒ¨åˆ†ã€‚</p><h2 id="äººè„¸éªŒè¯å’Œäººè„¸è¯†åˆ«åŒºåˆ«"><a href="#äººè„¸éªŒè¯å’Œäººè„¸è¯†åˆ«åŒºåˆ«" class="headerlink" title="äººè„¸éªŒè¯å’Œäººè„¸è¯†åˆ«åŒºåˆ«"></a>äººè„¸éªŒè¯å’Œäººè„¸è¯†åˆ«åŒºåˆ«</h2><p>ï¼ˆ1ï¼‰äººè„¸éªŒè¯</p><p>è¾“å…¥ï¼šå›¾ç‰‡å’ŒID/å§“å</p><p>è¾“å‡ºï¼šéªŒè¯è¿™ä¸ªå›¾ç‰‡æ˜¯å¦æ˜¯ID/å§“åä»£è¡¨çš„è¿™ä¸ªäºº</p><p>è¿™æ˜¯ä¸ª1ï¼š1é—®é¢˜</p><p>ï¼ˆ2ï¼‰äººè„¸è¯†åˆ«</p><p>è¾“å…¥ï¼šå›¾ç‰‡</p><p>è¾“å‡ºï¼šæŸ¥æ‰¾è¾“å…¥çš„å›¾ç‰‡æ˜¯å¦æ˜¯kä¸ªäººä¸­çš„ä¸€ä¸ª</p><p>è¿™æ˜¯ä¸ª1:Ké—®é¢˜</p><p>æ€»ç»“ï¼šäººè„¸è¯†åˆ«æ˜¯ä»¥äººè„¸éªŒè¯ä½œä¸ºåŸºç¡€æ¨¡å—</p><a id="more"></a>









<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>äººè„¸è¯†åˆ«æ˜¯ä¸ºäº†è§£å†³one shot learningé—®é¢˜ï¼Œå³ä¸€æ¬¡å­¦ä¹ å°±èƒ½è¯†åˆ«å‡ºäººçš„èº«ä»½ã€‚</p>
<p>ä¸€æ¬¡å­¦ä¹ å³ä½¿ç”¨ä¸€å¼ å›¾ç‰‡è®­ç»ƒå‡ºæ¥çš„ç¥ç»ç½‘ç»œè¯†åˆ«ç‡å¾ˆå·®ï¼Œè€Œä¸”å½“æœ‰æ–°çš„äººå›¾ç‰‡å‡ºç°è¿˜éœ€è¦é‡æ–°è®­ç»ƒç½‘ç»œï¼Œè¿™æ ·å¾ˆéº»çƒ¦ã€‚</p>
<p>å› æ­¤ï¼Œäººè„¸è¯†åˆ«çš„æ ¸å¿ƒï¼š</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨èƒ½å¤Ÿè¯†åˆ«äººè„¸å›¾ç‰‡çš„ç½‘ç»œ</p>
<p>ï¼ˆ2ï¼‰å°†è¾“å…¥çš„å›¾ç‰‡è¾“å…¥ç½‘ç»œå¾—åˆ°å›¾ç‰‡ç¼–ç ä¸æ•°æ®åº“å†…å›¾ç‰‡å¯¹æ¯”ï¼Œå·®å¼‚æ€§å°çš„å°±è®¤ä¸ºä¸¤è€…ä¸€è‡´ï¼Œåä¹‹ä¸ä¸€è‡´</p>
<p>æ‰€ä»¥ï¼Œé‡ç‚¹åœ¨äºè®­ç»ƒçš„ç½‘ç»œè¦ä½¿å¾—ç›¸åŒäººçš„å·®å¼‚æ€§å°ï¼Œä¸åŒäººçš„å·®å¼‚æ€§å¤§ã€‚</p>
<p>äºæ˜¯å¾—åˆ°æŸå¤±å‡½æ•°ä¸ºä¸‰å…ƒç»„æŸå¤±å‡½æ•°ï¼Œç½‘ç»œç»“æ„é‡‡ç”¨Siameseç½‘ç»œç»“æ„èƒ½å¤Ÿå¯¹å›¾ç‰‡ç¼–ç ï¼Œä¸‹é¢ä¸¤éƒ¨åˆ†åˆ†åˆ«ä»‹ç»</p>
<h3 id="â€œsimilarityâ€å‡½æ•°-gt-ä¸‰å…ƒç»„æŸå¤±å‡½æ•°çš„ç¡®å®š"><a href="#â€œsimilarityâ€å‡½æ•°-gt-ä¸‰å…ƒç»„æŸå¤±å‡½æ•°çš„ç¡®å®š" class="headerlink" title="â€œsimilarityâ€å‡½æ•°-&gt;ä¸‰å…ƒç»„æŸå¤±å‡½æ•°çš„ç¡®å®š"></a>â€œsimilarityâ€å‡½æ•°-&gt;ä¸‰å…ƒç»„æŸå¤±å‡½æ•°çš„ç¡®å®š</h3><p>â€œsimilarityâ€å‡½æ•°ï¼šç”¨äºè¡¡é‡ä¸¤ä¸ªå›¾ç‰‡çš„ç›¸ä¼¼åº¦ï¼Œå®šä¹‰ä¸ºd(img1,img2)=ä¸¤å¼ å›¾ç‰‡çš„ä¸åŒï¼Œå³è¾“å…¥ä¸¤å¼ å›¾ç‰‡ï¼Œè¾“å‡ºä¸¤å¼ å›¾ç‰‡çš„ç›¸ä¼¼åº¦ã€‚</p>
<p>äººè„¸è¯†åˆ«çš„ä¸‰å…ƒç»„æŸå¤±å‡½æ•°tripletsä¸ºï¼š</p>
<p>ï¼ˆ1ï¼‰ç›¸åŒçš„äººï¼šanchorå’Œpositiveå·®å¼‚å°</p>
<p>ï¼ˆ2ï¼‰ä¸åŒçš„äººï¼šanchorå’Œnegativeå·®å¼‚å¤§</p>
<p>å³d(A,P)&lt;=d(A,N)ï¼Œä¸ºäº†è®©ä¸¤è€…ç›¸å·®å¤šä¸€ç‚¹ï¼Œè¿™é‡ŒåŠ ä¸Šä¸€ä¸ªé—´éš”alphaï¼ŒåŒæ—¶ä¸ºäº†é˜²æ­¢å‡ºç°æŸå¤±å‡½æ•°ä¸º0çš„æƒ…å†µï¼ˆè¿™æ ·è¾“å‡ºæ— æ„ä¹‰ï¼‰ï¼Œå³éœ€è¦ä¿è¯ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609203322.png" alt></p>
<p>å³æ»¡è¶³triplet&lt;=0ï¼Œåˆ™æœ€ç»ˆç½‘ç»œçš„æŸå¤±å‡½æ•°åœ¨tripletså’Œ0ä¹‹é—´å–è¾ƒå¤§å€¼ï¼Œå½“tripletså°äºç­‰äº0æ—¶ï¼Œå³æŸå¤±ç­‰äº0ï¼Œåˆ™æ­¤æ—¶ç½‘ç»œè®­ç»ƒç»“æŸï¼Œå½“å¤§äº0æ—¶ï¼ŒæŸå¤±ä¸ä¸º0ï¼Œæ­¤æ—¶éœ€è¦è®©d(A,P)æ›´å°ï¼Œæˆ–è€…d(A,N)æ›´å¤§ï¼Œä»¥æ»¡è¶³æ¡ä»¶ã€‚</p>
<p>æˆæœ¬å‡½æ•°æ˜¯æŸå¤±å‡½æ•°æ±‚å’Œï¼Œåˆ™ç½‘ç»œçš„æŸå¤±å’Œæˆæœ¬å®šä¹‰ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609203435.png" alt></p>
<h3 id="Siameseç½‘ç»œç»“æ„"><a href="#Siameseç½‘ç»œç»“æ„" class="headerlink" title="Siameseç½‘ç»œç»“æ„"></a>Siameseç½‘ç»œç»“æ„</h3><p>å°†è¾“å…¥çš„å›¾åƒè½¬æ¢ä¸ºç¼–ç å½¢å¼ï¼Œå³ç½‘ç»œç»“æ„å’Œconvnetç›¸ä¼¼ï¼Œä½†æ˜¯æœ€åå…¨è¿æ¥å±‚è¾“å‡ºéƒ¨åˆ†ä¸è¾“å…¥softmaxï¼Œç›´æ¥å°†å…¨è¿æ¥å±‚çš„è¾“å‡ºä½œä¸ºè¾“å…¥å›¾åƒçš„ç¼–ç ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨Siameseç½‘ç»œå¾—åˆ°è¾“å…¥å›¾ç‰‡çš„ç¼–ç </p>
<p>ï¼ˆ2ï¼‰é€‰æ‹©éš¾å’Œè¾“å…¥å›¾ç‰‡åŒºåˆ†çš„å›¾ç‰‡ä½œä¸ºnegativeå›¾ç‰‡ï¼ŒåŒæ—¶é€‰æ‹©ç›¸åŒå›¾ç‰‡ï¼ŒåŠ ä¸Šè¾“å…¥å›¾ç‰‡æ„æˆä¸‰å…ƒç»„</p>
<p>ï¼ˆ3ï¼‰è®¡ç®—è¿™ä¸‰å…ƒç»„çš„è·ç¦»ï¼Œä»è€Œå¾—å‡ºæŸå¤±ï¼Œé‡‡ç”¨åå‘ä¼ æ’­ç®—æ³•æ›´æ–°ç½‘ç»œå‚æ•°</p>
<p>æœ€ç»ˆå¾—åˆ°èƒ½å¤Ÿè¯†åˆ«äººè„¸çš„ç½‘ç»œã€‚</p>
<h3 id="é™„ï¼šå¯ä»¥å°†äººè„¸è¯†åˆ«è½¬æ¢ä¸ºç›‘ç£å­¦ä¹ ï¼ˆäºŒåˆ†ç±»ï¼‰é—®é¢˜"><a href="#é™„ï¼šå¯ä»¥å°†äººè„¸è¯†åˆ«è½¬æ¢ä¸ºç›‘ç£å­¦ä¹ ï¼ˆäºŒåˆ†ç±»ï¼‰é—®é¢˜" class="headerlink" title="é™„ï¼šå¯ä»¥å°†äººè„¸è¯†åˆ«è½¬æ¢ä¸ºç›‘ç£å­¦ä¹ ï¼ˆäºŒåˆ†ç±»ï¼‰é—®é¢˜"></a>é™„ï¼šå¯ä»¥å°†äººè„¸è¯†åˆ«è½¬æ¢ä¸ºç›‘ç£å­¦ä¹ ï¼ˆäºŒåˆ†ç±»ï¼‰é—®é¢˜</h3><p>å°†ä¸€å¯¹å›¾ç‰‡ç»è¿‡å·ç§¯æ± åŒ–ç­‰æ“ä½œï¼Œç»è¿‡å…¨è¿æ¥å±‚åè¾“å…¥logiticå›å½’ï¼Œæœ€ç»ˆè¾“å‡ºæ˜¯å¦æ˜¯åŒä¸€ä¸ªäººï¼Œå³è¾“å‡º0æˆ–è€…1ï¼Œè¿™æ ·è½¬æ¢æˆäº†ç›‘ç£å­¦ä¹ æ–¹æ³•ã€‚</p>
<p>è¿™é‡Œçš„è¾“å…¥æ˜¯ä¸€å¯¹å›¾ç‰‡ï¼Œlogisticå›å½’å†…çš„é¢„æµ‹å‡½æ•°ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609204309.png" alt></p>
<p>å¯¹ç¼–ç åçš„å‘é‡æ¯ä¸ªå…ƒç´ å–ç»å¯¹å€¼ï¼Œå†åŠ ä¸Šæƒé‡å’Œåç½®é‡ï¼Œè®­ç»ƒw,bï¼Œå¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>ï¼ˆï¼‰ç½‘ç»œæ¶æ„</p>
<p>ç½‘ç»œçš„æ¶æ„ä¸Šéµå¾ªSzegedy et al.ç­‰äººçš„åˆå§‹æ¨¡å‹ï¼Œåº”ç”¨è¯¥ç½‘ç»œç»“æ„å¹¶ä¸”æŒ‡æ˜ä¼˜åŒ–ç®—æ³•å’ŒæŸå¤±å‡½æ•°ï¼Œå°†æ¨¡å‹è¿›è¡Œç¼–è¯‘ï¼Œæœ€åå¯¼å…¥æœ¬åœ°çš„æƒé‡ï¼Œç”Ÿæˆå¾—å‡ºçš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</p>
<p>è¿™é‡Œçš„å›¾ç‰‡æ ¼å¼æ˜¯é€šé“åœ¨å‰ï¼Œå› æ­¤åœ¨æœ€å¼€å§‹éœ€è¦è®¾ç½®é€šé“çš„ä½ç½®ï¼šK.set_image_data_format(â€œchannels_firstâ€)ï¼ŒåŒæ—¶è¾“å…¥ç½‘ç»œçš„å›¾ç‰‡é•¿å®½ä¸º96 * 96</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.åŠ è½½æ¨¡å‹ç»“æ„</span></span><br><span class="line">FRmodel=ibv2.faceRecoModel(input_shape=(<span class="number">3</span>,<span class="number">96</span>,<span class="number">96</span>))</span><br><span class="line"><span class="comment">#ç¼–è¯‘æ¨¡å‹ï¼ŒæŸå¤±é‡‡ç”¨ä¸‰å…ƒç»„æŸå¤±</span></span><br><span class="line">FRmodel.compile(<span class="string">"adam"</span>,loss=triplet_loss,metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"><span class="comment">#å¯¼å…¥æƒé‡</span></span><br><span class="line">fu.load_weights_from_FaceNet(FRmodel)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ1ï¼‰ä½¿ç”¨ä¸‰å…ƒç»„æŸå¤±å‡½æ•°</p>
<p>åˆ†åˆ«æ±‚å‡ºd(A,P),d(A,N)çš„å€¼ï¼ŒåŠ ä¸Šé—´éš”å¹¶æ±‚å’Œå¾—åˆ°ç½‘ç»œçš„æˆæœ¬å‡½æ•°ï¼Œå…¬å¼å‚ç…§ä¸‰å…ƒæŸå¤±å‡½æ•°çš„å®šä¹‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#triplets_loss</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">triplet_loss</span><span class="params">(yred,alpha=<span class="number">0.2</span>)</span>:</span></span><br><span class="line">	anchor,postive,negative=yred[<span class="number">0</span>],yred[<span class="number">1</span>],yred[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">	AP_loss=tf.reduce_sum(tf.square(tf.subtract(anchor,postive)),axis=<span class="number">-1</span>)</span><br><span class="line">	AN_loss=tf.reduce_sum(tf.square(tf.subtract(anchor,negative)),axis=<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">	APN_loss=tf.subtract(AP_loss,AN_loss)</span><br><span class="line">	APN_loss=tf.add(APN_loss,alpha)</span><br><span class="line"></span><br><span class="line">	loss=tf.reduce_sum(tf.maximum(APN_loss,<span class="number">0</span>))</span><br><span class="line">	<span class="keyword">return</span> loss</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ä¿å­˜æ¨¡å‹</p>
<p>å°†å…·æœ‰ç½‘æ ¼ç»“æ„ä¸æƒé‡çš„é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œä¿å­˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">FRmodel.save(<span class="string">'model.h5'</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å¯¼å…¥è®­ç»ƒçš„æ¨¡å‹</p>
<p>ç”±äºæ¨¡å‹ä¸­çš„æŸå¤±å‡½æ•°æ˜¯ä½¿ç”¨çš„è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼Œå› æ­¤åœ¨å¯¼å…¥æ¨¡å‹æ—¶ï¼Œéœ€è¦æŒ‡æ˜ä¿å­˜çš„æ¨¡å‹ä¸­çš„æŸå¤±å‡½æ•°çš„å…·ä½“å®ç°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">FRmodel=load_model(<span class="string">"model.h5"</span>,custom_objects=&#123;<span class="string">"triplet_loss"</span>:triplet_loss&#125;)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰å»ºç«‹å‘˜å·¥äººè„¸ç¼–ç æ•°æ®åº“</p>
<p>å°†ç°æœ‰å‘˜å·¥çš„äººè„¸å›¾åƒç»è¿‡æ¨¡å‹å¾—åˆ°128ä½çš„ç¼–ç ï¼Œä¹‹åå°†æ•°æ®åº“å†…çš„ç¼–ç å’Œè¾“å…¥çš„å›¾åƒç¼–ç æ¯”å¯¹ï¼Œé¢„å…ˆå°†è¿™äº›ç¼–ç ä¿å­˜å¥½èƒ½èŠ‚çœäººè„¸è¯†åˆ«çš„æ—¶é—´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®åº“ï¼šç”Ÿæˆ128ç»´å‘é‡ç¼–ç </span></span><br><span class="line"><span class="comment">#åŠ è½½è‡ªå®šä¹‰çš„losså‡½æ•°</span></span><br><span class="line">FRmodel=load_model(<span class="string">"model.h5"</span>,custom_objects=&#123;<span class="string">"triplet_loss"</span>:triplet_loss&#125;)</span><br><span class="line">img_path=<span class="string">'./images/'</span></span><br><span class="line">dataset=&#123;&#125;</span><br><span class="line">dataset[<span class="string">'bajie'</span>]=fu.img_to_encoding(img_path+<span class="string">'bajie.jpg'</span>,FRmodel)</span><br><span class="line"></span><br><span class="line">dataset[<span class="string">'andrew'</span>]=fu.img_to_encoding(img_path+<span class="string">'andrew.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'arnaud'</span>]=fu.img_to_encoding(img_path+<span class="string">'arnaud.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'benoit'</span>]=fu.img_to_encoding(img_path+<span class="string">'benoit.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'bertrand'</span>]=fu.img_to_encoding(img_path+<span class="string">'bertrand.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'dan.jpg'</span>]=fu.img_to_encoding(img_path+<span class="string">'dan.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'younes'</span>]=fu.img_to_encoding(img_path+<span class="string">'younes.jpg'</span>,FRmodel)</span><br><span class="line">dataset[<span class="string">'kian'</span>]=fu.img_to_encoding(img_path+<span class="string">'kian.jpg'</span>,FRmodel)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ5ï¼‰äººè„¸éªŒè¯ 1ï¼š1é—®é¢˜</p>
<p>å°†è¾“å…¥çš„å›¾åƒç»è¿‡ç½‘ç»œè½¬æ¢ä¸ºç¼–ç å½¢å¼</p>
<p>æ ¹æ®ç”¨æˆ·èº«ä»½æ‰¾åˆ°æ•°æ®åº“ä¸­çš„ç¼–ç </p>
<p>å°†äºŒè€…ç¼–ç å¯¹æ¯”ï¼Œå¦‚æœè·ç¦»å°äºé˜ˆå€¼ï¼ˆè¿™é‡Œè®¾å®š0.7ï¼‰ï¼Œåˆ™äººè„¸å’Œèº«ä»½ç¬¦åˆï¼Œåä¹‹ä¸ç¬¦åˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ ¹æ®è¾“å…¥çš„é—¨ç¦idå’Œå½“å‰è¯†åˆ«çš„äººè„¸æ¯”å¯¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verfy</span><span class="params">(img,model,identity,dataset)</span>:</span></span><br><span class="line">	<span class="comment">#å°†éªŒè¯çš„å›¾ç‰‡è½¬æ¢ä¸ºç¼–ç å½¢å¼</span></span><br><span class="line">	img_code=fu.img_to_encoding(img,model)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è®¡ç®—éªŒè¯å›¾ç‰‡å’Œæ•°æ®åº“å†…å›¾ç‰‡çš„è·ç¦»</span></span><br><span class="line">	distance=np.linalg.norm(img_code-dataset[identity])</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> distance&lt;<span class="number">0.7</span>:</span><br><span class="line">		print(<span class="string">"éªŒè¯é€šè¿‡ï¼Œæ¬¢è¿ä½ ï¼Œ"</span>+str(identity))</span><br><span class="line">		is_open=<span class="literal">True</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(<span class="string">"éªŒè¯å¤±è´¥ï¼Œ"</span>+<span class="string">"ä½ ä¸"</span>+str(identity)+<span class="string">"ä¸ç¬¦åˆ"</span>)</span><br><span class="line">		is_open=<span class="literal">False</span></span><br><span class="line">	<span class="keyword">return</span> distance,is_open</span><br></pre></td></tr></table></figure>

<p>å°†æœ¬äººå›¾ç‰‡ç¼–ç ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå›¾ç‰‡ä¿¡æ¯å¦‚å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609173436.png" alt></p>
<p>è¿›è¡Œæµ‹è¯•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">test_img=img_path+<span class="string">'camera_6.jpg'</span></span><br><span class="line">distance,is_open=verfy(test_img,FRmodel,<span class="string">'bajie'</span>,dataset)</span><br><span class="line">print(distance,is_open)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨éæœ¬äººå›¾ç‰‡æµ‹è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609173550.png" alt></p>
<p>ç»“æœï¼šéªŒè¯å¤±è´¥ï¼Œä½ ä¸bajieä¸ç¬¦åˆ<br>1.041191 False</p>
<p>ä½¿ç”¨æœ¬äººçš„å…¶ä»–å›¾ç‰‡æµ‹è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200609173613.png" alt></p>
<p>ç»“æœï¼šéªŒè¯é€šè¿‡ï¼Œæ¬¢è¿ä½ ï¼Œbajie<br>0.6963635 True</p>
<p>æœ€ç»ˆè¾“å‡ºçš„æ˜¯å·®å¼‚åº¦åŠæ˜¯å¦å¼€é—¨</p>
<p>ï¼ˆ6ï¼‰äººè„¸è¯†åˆ« 1ï¼šKé—®é¢˜</p>
<p>å’Œäººè„¸éªŒè¯ç›¸æ¯”ï¼Œè¿™é‡Œä¸è¾“å…¥ç”¨æˆ·çš„èº«ä»½ï¼Œç›´æ¥æ ¹æ®è¾“å…¥çš„å›¾åƒåˆ¤æ–­ï¼š</p>
<p>å°†è¾“å…¥çš„å›¾åƒç»è¿‡ç½‘ç»œè½¬æ¢ä¸ºç¼–ç å½¢å¼</p>
<p>éå†æ•°æ®åº“ï¼Œæ‰¾åˆ°å½“å‰ç¼–ç å’Œæ•°æ®åº“å†…è·ç¦»æœ€è¿‘çš„ç¼–ç </p>
<p>å½“è·ç¦»å°äºé˜ˆå€¼ï¼ˆè¿™é‡Œè®¾å®š0.7ï¼‰ï¼Œåˆ™è¯´æ˜åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°äº†ä¸ä¹‹ç›¸ä¼¼çš„äººè„¸ï¼Œåˆ™æ‰¾åˆ°äº†è¯¥å‘˜å·¥ï¼Œåä¹‹åˆ™æœªæ‰¾åˆ°ï¼Œå³ä¸å¼€é—¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># äººè„¸è¯†åˆ«ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">#å½“å‰è¯†åˆ«çš„äººè„¸ä¸æ•°æ®åº“å†…æ‰€æœ‰äººå‘˜è¿›è¡Œæ¯”å¯¹ï¼Œå¾—åˆ°æœ€å°çš„è·ç¦»åˆ™ä¸ºæœ€ç›¸ä¼¼çš„äºº</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">config</span><span class="params">(img,model,dataset)</span>:</span></span><br><span class="line">	img_code=fu.img_to_encoding(img,model)</span><br><span class="line">	min_dist=<span class="number">100</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (name,dcode) <span class="keyword">in</span> dataset.items():</span><br><span class="line">		dist=np.linalg.norm(img_code-dcode)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(dist&lt;min_dist):</span><br><span class="line">			min_dist=dist</span><br><span class="line">			identity=name</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> min_dist&lt;<span class="number">0.7</span>:</span><br><span class="line">		print(<span class="string">"éªŒè¯é€šè¿‡ï¼Œæ¬¢è¿ä½ ï¼Œ"</span>+str(identity))</span><br><span class="line">		is_open=<span class="literal">True</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(<span class="string">"éªŒè¯å¤±è´¥ï¼Œä½ ä¸æ˜¯æœ¬ç³»ç»Ÿæˆå‘˜"</span>)</span><br><span class="line">		is_open=<span class="literal">False</span></span><br><span class="line">	<span class="keyword">return</span> min_dist,is_open</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œæµ‹è¯•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">test_img=img_path+<span class="string">'camera_7.jpg'</span></span><br><span class="line">distance,is_open=config(test_img,FRmodel,dataset)</span><br><span class="line">print(distance,is_open)</span><br></pre></td></tr></table></figure>

<p>å½“ä½¿ç”¨ä¸Šè¿°camera_7éç³»ç»Ÿå†…æˆå‘˜å›¾åƒæ—¶ï¼š</p>
<p>éªŒè¯å¤±è´¥ï¼Œä½ ä¸æ˜¯æœ¬ç³»ç»Ÿæˆå‘˜<br>0.79701996 False</p>
<p>å½“ä½¿ç”¨ä¸Šè¿°camera_6ç³»ç»Ÿå†…æˆå‘˜çš„å…¶ä»–å›¾åƒæ—¶ï¼š</p>
<p>éªŒè¯é€šè¿‡ï¼Œæ¬¢è¿ä½ ï¼Œbajie<br>0.6963635 True</p>
<p>è¯´æ˜ï¼šæœ€ç»ˆè¾“å‡ºå½“å‰è¯†åˆ«å‡ºçš„äººçš„èº«ä»½ï¼Œä»¥åŠé—¨æ˜¯å¦æ‰“å¼€</p>
<h2 id="é™„ï¼šå°†å›¾åƒè½¬æ¢ä¸ºæƒ³è¦çš„å°ºå¯¸å¤§å°"><a href="#é™„ï¼šå°†å›¾åƒè½¬æ¢ä¸ºæƒ³è¦çš„å°ºå¯¸å¤§å°" class="headerlink" title="é™„ï¼šå°†å›¾åƒè½¬æ¢ä¸ºæƒ³è¦çš„å°ºå¯¸å¤§å°"></a>é™„ï¼šå°†å›¾åƒè½¬æ¢ä¸ºæƒ³è¦çš„å°ºå¯¸å¤§å°</h2><p>ä½¿ç”¨PILä¸­Imageå°†å¯¹åº”è·¯å¾„çš„å›¾åƒæ‰“å¼€ï¼Œå¹¶è¿›è¡Œå°ºå¯¸è°ƒæ•´ï¼Œæœ€ç»ˆä½¿ç”¨saveå¯¹è°ƒæ•´å¥½çš„å›¾åƒè¿›è¡Œä¿å­˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img_path=<span class="string">"./images/"</span></span><br><span class="line">file_img=img_path+<span class="string">"camera_7.jpg"</span></span><br><span class="line">img=Image.open(file_img).resize((<span class="number">96</span>,<span class="number">96</span>))</span><br><span class="line">img.save(img_path+<span class="string">"camera_7.jpg"</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°å®éªŒä¸­ä½¿ç”¨çš„è‡ªå·±çš„å›¾ç‰‡éœ€è¦è½¬æ¢ä¸ºç½‘ç»œèƒ½è¯†åˆ«çš„å¤§å°ï¼Œå³96 * 96</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”è¯†åˆ«å¹¶å®šä½è½¦è¾†</title>
    <url>/blogs/convNet3/</url>
    <content><![CDATA[<h2 id="YOLOç®—æ³•"><a href="#YOLOç®—æ³•" class="headerlink" title="YOLOç®—æ³•"></a>YOLOç®—æ³•</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ï¼ˆ1ï¼‰ç›®æ ‡æ£€æµ‹ä¸å®šä½</p><p>ç›®æ ‡æ£€æµ‹ï¼šè¾“å…¥ä¸€ä¸ªå›¾åƒï¼Œç»è¿‡convnetï¼Œåˆ¤è¯»å›¾ç‰‡ä¸­æ˜¯å¦æœ‰ç‰©ä½“ï¼ˆæˆ–è€…è¾“å‡ºè¯¥ç‰©ä½“æ˜¯å‡ ä¸ªç±»åˆ«ä¸­çš„å“ªä¸ªï¼‰ã€‚æ–¹æ³•ç±»ä¼¼äºå¯¹å›¾ç‰‡çš„åˆ†ç±»ã€‚</p><p>ç›®æ ‡å®šä½ï¼šè¾“å…¥ä¸€ä¸ªå›¾åƒï¼Œç»è¿‡convertï¼Œå°†å›¾ç‰‡ä¸­ç‰©ä½“ä½¿ç”¨å®šä½æ¡†å°†å…¶æ ‡æ³¨å‡ºæ¥ã€‚æ–¹æ³•ï¼šæ­¤æ—¶çš„è®­ç»ƒé›†ä¸­æ ‡ç­¾é¡¹éœ€è¦é‡æ–°è®¾ç½®ï¼Œè®¾ç½®æ˜¯å¦æœ‰ç‰©ä½“pcï¼Œç‰©ä½“çš„ä½ç½®å‚æ•°ï¼ˆä¸­å¿ƒç‚¹bx,byï¼Œé•¿å®½bw,bhï¼‰ï¼Œç‰©ä½“å±äºçš„ç±»åˆ«ã€‚</p><a id="more"></a>


<p>ï¼ˆ2ï¼‰æ»‘åŠ¨çª—å£ä¸€æ¬¡å·ç§¯</p>
<p>ä¸Šè¿°çš„ç›®æ ‡å®šä½é€‚ç”¨äºå›¾ç‰‡ä¸­åªæœ‰ä¸€ä¸ªç‰©ä½“ï¼Œå½“æœ‰å¤šä¸ªç‰©ä½“æ—¶ï¼Œå¯ä»¥å°†å›¾åƒåˆ’åˆ†æˆä¸€ä¸ªä¸ªç½‘æ ¼ï¼Œå°†æ¯ä¸ªæ ¼å­è¾“å…¥convertï¼Œåœ¨æ¯ä¸ªæ ¼å­ä¸Šè¿›è¡Œç›®æ ‡æ£€æµ‹ã€‚</p>
<p>ç¼ºç‚¹ï¼šè®¡ç®—æˆæœ¬å¤§ï¼Œè€—æ—¶</p>
<p>æ­¤æ—¶å¯ä»¥é‡‡ç”¨ä¸€æ¬¡å·ç§¯çš„æ–¹æ³•ï¼šå›¾ç‰‡æŒ‰ç…§ç½‘æ ¼åˆ’åˆ†ï¼Œæ¯ä¸ªæ ¼å­å¯¹åº”ä¸€ä¸ªè¾“å‡ºæ ‡ç­¾ï¼Œå°†å›¾ç‰‡æ•´ä½“è¾“å…¥convertä¸­ï¼Œæœ€ç»ˆå¾—åˆ°æ¯ä¸ªæ ¼å­çš„ç»“æœï¼Œå³æ¯ä¸ªæ ¼å­è¾“å‡ºä¸€ä¸ªå®šä½æ¡†ã€‚è¿™æ ·æ¯”å°†æ¯ä¸ªæ ¼å­è¾“å…¥ç½‘ç»œä¸­çš„è®¡ç®—æˆæœ¬å°ã€‚</p>
<h3 id="ç‰©ä½“ä¸­ç‚¹è®¤å®šâ€”â€”è®©ä¸€ä¸ªç‰©ä½“åªè¢«ä¸€ä¸ªæ ¼å­æ£€æµ‹"><a href="#ç‰©ä½“ä¸­ç‚¹è®¤å®šâ€”â€”è®©ä¸€ä¸ªç‰©ä½“åªè¢«ä¸€ä¸ªæ ¼å­æ£€æµ‹" class="headerlink" title="ç‰©ä½“ä¸­ç‚¹è®¤å®šâ€”â€”è®©ä¸€ä¸ªç‰©ä½“åªè¢«ä¸€ä¸ªæ ¼å­æ£€æµ‹"></a>ç‰©ä½“ä¸­ç‚¹è®¤å®šâ€”â€”è®©ä¸€ä¸ªç‰©ä½“åªè¢«ä¸€ä¸ªæ ¼å­æ£€æµ‹</h3><p>ä¸ºäº†ä¿è¯ä¸€ä¸ªç‰©ä½“åªè¢«ä¸€ä¸ªæ ¼å­æ£€æµ‹ï¼Œå®šä¹‰ç‰©ä½“çš„ä¸­ç‚¹æ‰€åœ¨çš„æ ¼å­è¯†åˆ«å‡ºè¯¥å¯¹è±¡ï¼Œå…¶ä½™æœ‰è¯¥å¯¹è±¡çš„æ ¼å­ä¸è¯†åˆ«è¯¥å¯¹è±¡ã€‚</p>
<h3 id="anchor-boxâ€”â€”ä¸€ä¸ªæ ¼å­èƒ½æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“"><a href="#anchor-boxâ€”â€”ä¸€ä¸ªæ ¼å­èƒ½æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“" class="headerlink" title="anchor boxâ€”â€”ä¸€ä¸ªæ ¼å­èƒ½æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“"></a>anchor boxâ€”â€”ä¸€ä¸ªæ ¼å­èƒ½æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“</h3><p>å½“æœ‰å¤šä¸ªç‰©ä½“çš„ä¸­ç‚¹è½åœ¨åŒä¸€ä¸ªæ ¼å­æ—¶ï¼Œç‰©ä½“è¯†åˆ«çš„ç±»åˆ«å¯èƒ½æœ‰å¤šä¸ªï¼Œæ­¤æ—¶ç½‘ç»œæ— æ³•è¯†åˆ«è¾“å‡ºï¼Œä¸ºäº†èƒ½è®©ä¸€ä¸ªæ ¼å­æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“ï¼Œå¼•å…¥anchor boxï¼ŒæŒ‰ç…§ç‰©ä½“çš„å½¢çŠ¶è®¾ç½®anchor boxï¼Œå’Œè®¾ç½®çš„anchor boxçš„Iouå€¼é«˜è¯´æ˜è¯¥ç‰©ä½“åŒ¹é…è¯¥anchor boxï¼Œç±»åˆ«è®¾ç½®åœ¨è¯¥anchor boxä¸­ï¼Œå› æ­¤æ¯ä¸ªæ ‡ç­¾yä¸­æœ‰å¤šä¸ªanchor boxï¼Œå¯¹åº”ä¸åŒå½¢çŠ¶çš„ç‰©ä½“ï¼Œè¿™æ ·ä¸€ä¸ªæ ¼å­å°±èƒ½æ£€æµ‹å‡ºå¤šä¸ªç‰©ä½“ã€‚</p>
<h3 id="éæœ€å¤§å€¼æŠ‘åˆ¶â€”â€”åªè¾“å‡ºä¸€ä¸ªå®šä½æ¡†"><a href="#éæœ€å¤§å€¼æŠ‘åˆ¶â€”â€”åªè¾“å‡ºä¸€ä¸ªå®šä½æ¡†" class="headerlink" title="éæœ€å¤§å€¼æŠ‘åˆ¶â€”â€”åªè¾“å‡ºä¸€ä¸ªå®šä½æ¡†"></a>éæœ€å¤§å€¼æŠ‘åˆ¶â€”â€”åªè¾“å‡ºä¸€ä¸ªå®šä½æ¡†</h3><p>ï¼ˆ1ï¼‰é˜ˆå€¼è¿‡æ»¤</p>
<p>ä½¿ç”¨pc * æ¯ä¸ªç±»åˆ«å¾—åˆ°æ¯ä¸ªç±»åˆ«å‡ºç°çš„æ¦‚ç‡ï¼Œå–æœ€å¤§çš„æ¦‚ç‡ä½œä¸ºè¯¥æ ¼å­è¯†åˆ«å‡ºçš„ç±»åˆ«åŠè¯¥æ ¼å­åˆ¤å®šçš„ç‰©ä½“çš„æ¦‚ç‡ï¼Œå°†è¯¥æ¦‚ç‡å’Œè¿‡æ»¤çš„é˜ˆå€¼æ¯”è¾ƒï¼Œä¿ç•™å¤§äºç­‰äºè¯¥é˜ˆå€¼çš„ç±»åˆ«ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆ†ç±»é˜ˆå€¼è¿‡æ»¤</span></span><br><span class="line"><span class="comment">#box_confidence  ï¼ˆ19ï¼Œ19ï¼Œ5ï¼Œ1ï¼‰</span></span><br><span class="line"><span class="comment">#boxes  ï¼ˆ19ï¼Œ19ï¼Œ5ï¼Œ4ï¼‰</span></span><br><span class="line"><span class="comment">#box_classes_prob    ï¼ˆ19ï¼Œ19ï¼Œ5ï¼Œ80ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yolo_filter_boxes</span><span class="params">(box_confidence,boxes,box_classes_prob,threshold)</span>:</span></span><br><span class="line">	<span class="comment">#å¾—åˆ°æ¯ä¸ªæ¦‚ç‡</span></span><br><span class="line">	box_scores=box_confidence*box_classes_prob</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ‰¾åˆ°æœ€å¤§çš„æ¦‚ç‡çš„åˆ†ç±»å’Œå¯¹åº”çš„pc</span></span><br><span class="line">	<span class="comment">#ç”¨æœ€åçš„80ä¸ªåˆ†ç±»æ¥æ¯”è¾ƒ</span></span><br><span class="line">	box_class=K.argmax(box_scores,axis=<span class="number">-1</span>)</span><br><span class="line">	box_class_scores=K.max(box_scores,axis=<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ ¹æ®æ¯ä¸ªçš„pcå’Œé˜ˆå€¼æ¯”è¾ƒ</span></span><br><span class="line">	box_max=(box_class_scores&gt;=threshold)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	scores=tf.boolean_mask(box_class_scores,box_max)</span><br><span class="line">	boxes=tf.boolean_mask(boxes,box_max)</span><br><span class="line">	classes=tf.boolean_mask(box_class,box_max)</span><br><span class="line">	<span class="keyword">return</span> scores,boxes,classes</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰Iou</p>
<p>å®šä¹‰ï¼šIou=ä¸¤ä¸ªç›®æ ‡å®šä½æ¡†çš„ç›¸äº¤çš„é¢ç§¯/ä¸¤ä¸ªç›®æ ‡å®šä½æ¡†çš„æ€»é¢ç§¯</p>
<p>ä½¿ç”¨Iouå»é™¤ä¸ç¬¦åˆè¦æ±‚çš„å®šä½æ¡†ï¼Œä¸€èˆ¬Iouè®¾ç½®ä¸º0.5ï¼Œå½“å°äºè¯¥å€¼çš„å®šä½æ¡†ç›´æ¥åˆ é™¤</p>
<p>æ–¹æ³•ï¼šè¾“å…¥ä¸¤ä¸ªå®šä½æ¡†çš„å·¦ä¸Šè§’å’Œå³ä¸‹è§’åæ ‡ï¼Œå¾—åˆ°ç›¸äº¤çš„é¢ç§¯å†é™¤ä»¥æ€»é¢ç§¯ã€‚</p>
<p>åŸç†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">iou</span><span class="params">(box1,box2)</span>:</span></span><br><span class="line">	<span class="comment">#box1(x1,y1,x2,y2)</span></span><br><span class="line">	<span class="comment">#box2(x3,y3,x4,y4)</span></span><br><span class="line">	<span class="comment">#å·¦ä¸Šè§’</span></span><br><span class="line">	xi1=np.maximum(box1[<span class="number">0</span>],box2[<span class="number">0</span>])</span><br><span class="line">	yi1=np.maximum(box1[<span class="number">1</span>],box2[<span class="number">1</span>])</span><br><span class="line">	<span class="comment">#å³ä¸‹è§’</span></span><br><span class="line">	xi2=np.minimum(box1[<span class="number">2</span>],box2[<span class="number">2</span>])</span><br><span class="line">	yi2=np.minimum(box1[<span class="number">3</span>],box2[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è®¡ç®—é¢ç§¯</span></span><br><span class="line">	box1_area=(box1[<span class="number">2</span>]-box1[<span class="number">0</span>])*(box1[<span class="number">3</span>]-box1[<span class="number">1</span>])</span><br><span class="line">	box2_area=(box2[<span class="number">2</span>]-box2[<span class="number">0</span>])*(box2[<span class="number">3</span>]-box2[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">	box_inter_area=(xi2-xi1)*(yi2-yi1)</span><br><span class="line">	box_union_area=box1_area+box2_area-box_inter_area</span><br><span class="line"></span><br><span class="line">	iou_area=box_inter_area/box_union_area</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> iou_area</span><br></pre></td></tr></table></figure>

<p>yoloè‡ªå¸¦non_max_suppressionæ–¹æ³•ï¼Œå®šä¹‰ä¸€ä¸ªå›¾åƒä¸­è¾“å‡ºçš„æœ€å¤§å®šä½æ¡†ä¸ªæ•°å’Œioué˜ˆå€¼ï¼Œè‡ªåŠ¨å¾—åˆ°è¿‡æ»¤ä¹‹åçš„å®šä½æ¡†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yolo_non_max_suppression</span><span class="params">(scores,boxes,classes,max_box=<span class="number">10</span>,iou_threshold=<span class="number">0.5</span>)</span>:</span></span><br><span class="line">	max_box_tensor=K.variable(max_box,dtype=<span class="string">"int32"</span>)</span><br><span class="line">	K.get_session().run(tf.variables_initializer([max_box_tensor]))</span><br><span class="line"></span><br><span class="line">	num_dims=tf.image.non_max_suppression(boxes,scores,max_box,iou_threshold)</span><br><span class="line"></span><br><span class="line">	scores=K.gather(scores,num_dims)</span><br><span class="line">	boxes=K.gather(boxes,num_dims)</span><br><span class="line">	classes=K.gather(classes,num_dims)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> scores,boxes,classes</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æ€»ç»“ï¼šå¯¹æ‰€æœ‰æ¡†è¿›è¡Œè¿‡æ»¤</p>
<p>æ ¹æ®å®˜æ–¹çš„yoloæ¨¡å‹ç»è¿‡convnetå¾—åˆ°çš„è¾“å‡ºè½¬æ¢ä¸ºä¸­å¿ƒç‚¹å½¢å¼</p>
<p>å°†å…¶ç»è¿‡é˜ˆå€¼è¿‡æ»¤ï¼Œå¾—åˆ°å®šä½æ¡†å¹¶å°†å…¶æ‰©å±•ä»¥é€‚åº”æ–°å›¾åƒçš„å¤§å°ï¼ˆæ¨¡å‹å¾—åˆ°çš„å®šä½æ¡†æ˜¯680x680ï¼‰</p>
<p>ç»è¿‡éæœ€å¤§å€¼æŠ‘åˆ¶å¾—åˆ°æœ€ç»ˆæ¯ä¸ªæ ¼å­è¿‡æ»¤ä¹‹åçš„ç‰©ä½“å®šä½æ¡†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯¹æ‰€æœ‰æ¡†è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yolo_eval</span><span class="params">(output,image_shape=<span class="params">(<span class="number">720.</span>,<span class="number">1280.</span>)</span>,max_box=<span class="number">10</span>,scores_threshold=<span class="number">0.6</span>,iou_threshold=<span class="number">0.5</span>)</span>:</span></span><br><span class="line">	box_confidence,box_xy,boxhw,box_classes_prob=output</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å°†ä¸­å¿ƒç‚¹è½¬æ¢ä¸ºåæ ‡å½¢å¼</span></span><br><span class="line">	boxes=yolo_boxes_to_corners(box_xy,boxhw)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#é˜ˆå€¼è¿‡æ»¤</span></span><br><span class="line">	scores,boxes,classes=yolo_filter_boxes(box_confidence,boxes,box_classes_prob,scores_threshold)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ç¼©æ”¾anchor boxä»¥é€‚åº”åŸå§‹å›¾åƒ</span></span><br><span class="line">	boxes=yu.scale_boxes(boxes,image_shape)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#nmsè¿‡æ»¤</span></span><br><span class="line">	scores,boxes,classes=yolo_non_max_suppression(scores,boxes,classes,max_box,iou_threshold)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> scores,boxes,classes</span><br></pre></td></tr></table></figure>

<h3 id="è®­ç»ƒé›†è®¾ç½®"><a href="#è®­ç»ƒé›†è®¾ç½®" class="headerlink" title="è®­ç»ƒé›†è®¾ç½®"></a>è®­ç»ƒé›†è®¾ç½®</h3><p>å°†æ¯ä¸ªå›¾åƒåˆ’åˆ†ä¸ºn * nçš„ç½‘æ ¼ï¼Œå¸¸ç”¨çš„ç½‘æ ¼ä¸ªæ•°n=19ï¼Œæ¯ä¸€ä¸ªç½‘æ ¼å¯¹åº”ä¸€å¯¹æ•°æ®ï¼ˆx,yï¼‰</p>
<p>xï¼šä»£è¡¨æ¯ä¸ªç½‘æ ¼ä¸­è¾“å…¥çš„å›¾ç‰‡</p>
<p>yï¼šä»£è¡¨å½“å‰æ ¼å­å¯¹åº”ç‰©ä½“çš„æ¦‚ç‡ï¼Œå®šä½æ¡†ä»¥åŠç±»åˆ«ã€‚å‡è®¾ç±»åˆ«æ•°ä¸º80ï¼Œåˆ™yçš„ç»´åº¦ä¸ºpc+å®šä½æ¡†ç³»æ•°ï¼ˆ4ä¸ªï¼‰+ç±»åˆ«æ•°ï¼ˆ80ä¸ªï¼‰=85ä¸ªï¼Œå½“æœ‰5ä¸ªanchor boxæ—¶ï¼Œæ¯ä¸ªanchor boxä¸­éƒ½æœ‰85ä¸ªæ•°æ®ï¼Œå¡«å……åœ¨yä¸­ï¼Œyçš„ç»´åº¦=85 * 5=425</p>
<h3 id="ç®—æ³•å¦‚ä½•é¢„æµ‹"><a href="#ç®—æ³•å¦‚ä½•é¢„æµ‹" class="headerlink" title="ç®—æ³•å¦‚ä½•é¢„æµ‹"></a>ç®—æ³•å¦‚ä½•é¢„æµ‹</h3><p>ï¼ˆ1ï¼‰è¾“å…¥å›¾åƒï¼Œç»è¿‡convertï¼Œå¾—åˆ°é¢„æµ‹çš„æ ‡ç­¾yï¼šæ¯ä¸ªæ ¼å­å¯¹åº”ä¸€ä¸ª425çš„å‘é‡ï¼Œ19 * 19çš„æ ¼å­å³ä¸€å¼ å›¾ç‰‡å¯¹åº”ï¼ˆ19ï¼Œ19ï¼Œ425ï¼‰ç»´çš„å‘é‡ï¼Œæ¯ä¸ªå›¾ç‰‡çš„yè¾“å‡ºï¼ˆ19ï¼Œ19ï¼Œ425ï¼‰ç»´çš„å‘é‡ï¼Œé¢„æµ‹å¯¹åº”æ ¼å­ä¸­ç‰©ä½“å‡ºç°çš„æ¦‚ç‡ä»¥åŠå®šä½æ¡†</p>
<p>ï¼ˆ2ï¼‰è¿‡æ»¤å®šä½æ¡†ï¼šé€šè¿‡è®¡ç®—æ¯ä¸ªæ ¼å­ä¸­è¯†åˆ«å‡ºçš„ç‰©ä½“çš„æ¦‚ç‡ï¼Œè¿›è¡Œé˜ˆå€¼è¿‡æ»¤ï¼Œå°äºé˜ˆå€¼çš„å®šä½æ¡†å»é™¤ï¼Œæ¯ä¸ªç±»åˆ«çš„æ— å›¾å†æ ¹æ®éæœ€å¤§å€¼æŠ‘åˆ¶ï¼Œåˆ é™¤Ioué«˜çš„å®šä½æ¡†ï¼Œä¿è¯ä¸€ä¸ªç‰©ä½“åªæœ‰ä¸€ä¸ªå®šä½æ¡†ã€‚</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>ï¼ˆ1ï¼‰å¯¼å…¥æ¨¡å‹</p>
<p>ä½¿ç”¨å®˜ç½‘yoloæ¨¡å‹ï¼Œå¯¼å…¥anchor boxçš„ç±»å‹åŠåˆ†ç±»çš„ç±»åˆ«æ•°é‡ï¼Œä½¿ç”¨keras.modelsä¸­çš„load_modelå¾—åˆ°è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åŠ è½½æ¨¡å‹</span></span><br><span class="line">sess=K.get_session()</span><br><span class="line"><span class="comment">#å®šä¹‰anchor box,class,è¾“å…¥å›¾åƒå¤§å°</span></span><br><span class="line">boxes=yu.read_anchors(<span class="string">"./model_data/yolo_anchors.txt"</span>)</span><br><span class="line">classes_name=yu.read_classes(<span class="string">"./model_data/object_classes.txt"</span>)</span><br><span class="line">image_shape=(<span class="number">720.</span>,<span class="number">1280.</span>)</span><br><span class="line">car_model=load_model(<span class="string">"./model_data/yolov2.h5"</span>)</span><br><span class="line">car_model.summary()</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ‰¹é‡é¢„æµ‹</p>
<p>1Â° è¾“å…¥å›¾åƒï¼Œå¹¶å°†å›¾åƒæŒ‰ç…§æ¨¡å‹ä¸­680x680å°ºå¯¸æ¢ç®—ï¼Œå¹¶è¾“å…¥æ¨¡å‹ä¸­</p>
<p>2Â° è¿è¡Œæ¨¡å‹ï¼Œå°†yoloæ¨¡å‹çš„æ•°æ®è½¬æ¢ä¸ºè¾¹æ¡†åæ ‡å½¢å¼ï¼Œç»è¿‡é˜ˆå€¼ä¸éæœ€å¤§å€¼æŠ‘åˆ¶è¿‡æ»¤è¾¹æ¡†ï¼Œå¾—åˆ°é¢„æµ‹çš„ç‰©ä½“å³è¾¹æ¡†</p>
<p>3Â° æ ¹æ®å¾—åˆ°çš„è¾¹æ¡†è¿›è¡Œè¿‡æ»¤ï¼Œå¹¶ä¸”è¾¹æ¡†éœ€è¦é€‚åº”åŸå§‹å›¾åƒå¤§å°ï¼Œæœ€ç»ˆå¾—åˆ°è¿‡æ»¤åçš„è¾¹æ¡†</p>
<p>4Â° æ ¹æ®æ¨¡å‹ç±»åˆ«å¾—åˆ°é¢œè‰²ï¼Œå¹¶å°†è¾¹æ¡†åœ¨åŸå§‹å›¾åƒä¸Šç”»å‡ºæ¥</p>
<p>5Â° ä½¿ç”¨os.path.joinå¾—å‡ºé¢„æµ‹åå›¾åƒçš„ä¿å­˜åœ°å€ï¼Œè¿›è¡Œä¿å­˜ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†æ¨¡å‹è¾“å‡ºè½¬æ¢ä¸ºè¾¹æ¡†</span></span><br><span class="line">yolo_outputs=yolo_head(car_model.output,boxes,len(classes_name))</span><br><span class="line"></span><br><span class="line"><span class="comment">#è°ƒç”¨evalè¿›è¡Œè¾¹æ¡†è¿‡æ»¤</span></span><br><span class="line">scores,boxes,classes=yolo_eval(yolo_outputs,image_shape)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½¿ç”¨æ¨¡å‹è¿›è¡Œè½¦è¾†è¯†åˆ«</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(sess,img_file)</span>:</span></span><br><span class="line">	<span class="comment">#å›¾ç‰‡å¤„ç†ï¼ˆå½’ä¸€åŒ–å’Œå»¶å±•ï¼‰</span></span><br><span class="line">	file=<span class="string">'./images/'</span></span><br><span class="line">	img_path=file+img_file</span><br><span class="line"></span><br><span class="line">	img,img_data=yu.preprocess_image(img_path,model_image_size=(<span class="number">608</span>,<span class="number">608</span>))</span><br><span class="line">	<span class="comment">#è®¾ç½®å ä½ç¬¦</span></span><br><span class="line">	out_scores,out_boxes,out_classes=sess.run([scores,boxes,classes],feed_dict=&#123;car_model.input:img_data,K.learning_phase():<span class="number">0</span>&#125;)</span><br><span class="line"></span><br><span class="line">	print(img_file+<span class="string">"ä¸­æ‰¾åˆ°äº†anchor boxï¼š"</span>+str(len(out_boxes)))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è®¾ç½®è¾“å‡ºçš„é¢œè‰²</span></span><br><span class="line">	colors=yu.generate_colors(classes_name)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ç”»è¾¹æ¡†</span></span><br><span class="line">	yu.draw_boxes(img,out_scores,out_boxes,out_classes,classes_name,colors)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ä¿å­˜ç”»å¥½è¾¹æ¡†çš„å›¾ç‰‡</span></span><br><span class="line">	img.save(os.path.join(<span class="string">'out'</span>,img_file),quatity=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å±•ç¤ºå›¾ç‰‡</span></span><br><span class="line">	p_image=Image.open(os.path.join(<span class="string">'out'</span>,img_file))</span><br><span class="line">	plt.imshow(p_image)</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> out_scores,out_boxes,out_classes</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ç»“æœ</p>
<p>zfill:å­—ç¬¦ä¸²å³å¯¹é½ï¼Œä¸å¤Ÿé•¿åº¦çš„å·¦è¾¹è¡¥0ï¼Œè°ƒç”¨predictï¼Œè¾“å…¥éœ€è¦çš„å›¾ç‰‡è¿›è¡Œç‰©ä½“è¯†åˆ«å®šä½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>,<span class="number">18</span>):</span><br><span class="line">	img=str(i).zfill(<span class="number">4</span>)+<span class="string">".jpg"</span></span><br><span class="line">	out_scores,out_boxes,out_classes=predict(sess,img)</span><br><span class="line">print(<span class="string">"è¯†åˆ«ç»“æŸ"</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200605162058.png" alt></p>
<p>0066.jpgä¸­æ‰¾åˆ°äº†anchor boxï¼š2<br>traffic light 0.62 (532, 68) (564, 113)<br>car 0.77 (372, 281) (454, 333)</p>
<p>ç»“æœè¾“å‡ºè¯¥å›¾åƒä¸­æ‰¾åˆ°çš„ç‰©ä½“ä»¥åŠç‰©ä½“çš„åæ ‡</p>
<p>è¯´æ˜ï¼šä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯†åˆ«å‡ºäº†è½¦è¾†å’Œçº¢ç¯ï¼Œå¹¶ç”¨æ–¹æ¡†å°†å…¶å®šä½å‡ºæ¥äº†ã€‚</p>
<p>å†æµ‹è¯•å¦ä¸€ä¸ªå›¾ç‰‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200608105320.png" alt></p>
<p>0017.jpgä¸­æ‰¾åˆ°äº†anchor boxï¼š3<br>truck 0.64 (666, 274) (1063, 392)<br>car 0.79 (1103, 300) (1271, 356)<br>car 0.82 (1, 358) (183, 427)</p>
<p>è¯´æ˜ï¼šæ­¤æ—¶è¯†åˆ«å‡ºä¸€ä¸ªå¡è½¦å’Œä¸¤ä¸ªæ±½è½¦ï¼Œå¹¶ç”¨ä¸åŒé¢œè‰²æ¡†å°†å…¶å®šä½ã€‚</p>
<h2 id="é™„ï¼šR-CNNå¸¦åŒºåŸŸçš„å·ç§¯ç¥ç»ç½‘ç»œ"><a href="#é™„ï¼šR-CNNå¸¦åŒºåŸŸçš„å·ç§¯ç¥ç»ç½‘ç»œ" class="headerlink" title="é™„ï¼šR-CNNå¸¦åŒºåŸŸçš„å·ç§¯ç¥ç»ç½‘ç»œ"></a>é™„ï¼šR-CNNå¸¦åŒºåŸŸçš„å·ç§¯ç¥ç»ç½‘ç»œ</h2><p>æ€è·¯æ¥æºäºåŸºäºæ»‘åŠ¨çª—å£çš„ç›®æ ‡æ£€æµ‹ç®—æ³•</p>
<p>æ€æƒ³ï¼š</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨æŸç§ç®—æ³•ï¼ˆ1.åˆ†å‰²ç®—æ³•ï¼›2.å·ç§¯ç¥ç»ç½‘ç»œï¼‰å¾—åˆ°å›¾åƒçš„å€™é€‰åŒºåŸŸ</p>
<p>ï¼ˆ2ï¼‰åœ¨å€™é€‰åŒºåŸŸä¸­è¿è¡Œåˆ†ç±»å™¨ï¼Œå¾—åˆ°æ¯ä¸ªå€™é€‰å…¶ä½™çš„ç±»åˆ«åŠå®šä½æ¡†</p>
<p>è¯´æ˜ï¼šå› ä¸ºè¯¥ç§ç›®æ ‡å®šä½ä¸è¯†åˆ«æ˜¯åˆ†ä¸¤æ­¥è¿›è¡Œï¼Œæ—¶é—´æ•ˆç‡æ¯”yoloæ€»ä½“è¦ä½ä¸€äº›ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>springBootéƒ¨ç½²é—®é¢˜</title>
    <url>/blogs/tomcatNoWebXml/</url>
    <content><![CDATA[<p>springbooté¡¹ç›®é€šè¿‡å¤–ç½®tomcatéƒ¨ç½²ï¼Œä¸éœ€è¦web.xmlçš„åŸå› åˆ†æï¼š</p><p>é¦–å…ˆå¯ä»¥çœ‹åˆ°åœ¨spring-web.jarçš„META-INFæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200604155440.png" alt="spié…ç½®æ–‡ä»¶"></p><p>è¿™é‡Œæ˜¯é€šè¿‡SPIæœºåˆ¶ï¼Œæ‰§è¡Œäº†ServletContainerInitializeræ¥å£çš„å®ç°ç±»SpringServletContainerInitializerä¸­çš„onStartupæ–¹æ³•</p><a id="more"></a>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartup</span><span class="params">(Set&lt;Class&lt;?&gt;&gt; webAppInitializerClasses, ServletContext servletContext)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">		List&lt;WebApplicationInitializer&gt; initializers = <span class="keyword">new</span> LinkedList&lt;WebApplicationInitializer&gt;();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (webAppInitializerClasses != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (Class&lt;?&gt; waiClass : webAppInitializerClasses) &#123;</span><br><span class="line">				<span class="comment">// Be defensive: Some servlet containers provide us with invalid classes,</span></span><br><span class="line">				<span class="comment">// no matter what @HandlesTypes says...</span></span><br><span class="line">				<span class="keyword">if</span> (!waiClass.isInterface() &amp;&amp; !Modifier.isAbstract(waiClass.getModifiers()) &amp;&amp;</span><br><span class="line">						WebApplicationInitializer<span class="class">.<span class="keyword">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">waiClass</span>)) </span>&#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						initializers.add((WebApplicationInitializer) waiClass.newInstance());</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">						<span class="keyword">throw</span> <span class="keyword">new</span> ServletException(<span class="string">"Failed to instantiate WebApplicationInitializer class"</span>, ex);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (initializers.isEmpty()) &#123;</span><br><span class="line">			servletContext.log(<span class="string">"No Spring WebApplicationInitializer types detected on classpath"</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		servletContext.log(initializers.size() + <span class="string">" Spring WebApplicationInitializers detected on classpath"</span>);</span><br><span class="line">		AnnotationAwareOrderComparator.sort(initializers);</span><br><span class="line">		<span class="keyword">for</span> (WebApplicationInitializer initializer : initializers) &#123;</span><br><span class="line">			initializer.onStartup(servletContext);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç æœ€åçš„å¾ªç¯é‡Œæ˜¯æ‰§è¡ŒWebApplicationInitializeræ¥å£çš„æ‰€æœ‰å®ç°ç±»onStartupæ–¹æ³•</p>
<p>æˆ‘ä»¬springbootçš„å…¥å£æ–¹æ³•ï¼Œä¹Ÿæ˜¯ç»§æ‰¿äº†æŠ½è±¡æ–¹æ³•SpringBootServletInitializerï¼Œè€ŒSpringBootServletInitializerå®ç°äº†WebApplicationInitializeræ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Application</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> builder.sources(Application<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¦é‡å†™configureæ–¹æ³•ï¼Œå°†è¿™ä¸ªå…¥å£ç±»æ”¾åˆ°sourceé‡Œ</p>
<p>SpringBootServletInitializerçš„onStartupä¼šè°ƒç”¨createRootApplicationContextæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartup</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		<span class="comment">// Logger initialization is deferred in case a ordered</span></span><br><span class="line">		<span class="comment">// LogServletContextInitializer is being used</span></span><br><span class="line">		<span class="keyword">this</span>.logger = LogFactory.getLog(getClass());</span><br><span class="line">		WebApplicationContext rootAppContext = createRootApplicationContext(</span><br><span class="line">				servletContext);</span><br><span class="line">		<span class="keyword">if</span> (rootAppContext != <span class="keyword">null</span>) &#123;</span><br><span class="line">			servletContext.addListener(<span class="keyword">new</span> ContextLoaderListener(rootAppContext) &#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent event)</span> </span>&#123;</span><br><span class="line">					<span class="comment">// no-op because the application context is already initialized</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.logger.debug(<span class="string">"No ContextLoaderListener registered, as "</span></span><br><span class="line">					+ <span class="string">"createRootApplicationContext() did not "</span></span><br><span class="line">					+ <span class="string">"return an application context"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>createRootApplicationContextæ–¹æ³•é‡Œä¼šè°ƒç”¨runæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">createRootApplicationContext</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			ServletContext servletContext)</span> </span>&#123;</span><br><span class="line">		SpringApplicationBuilder builder = createSpringApplicationBuilder();</span><br><span class="line">		builder.main(getClass());</span><br><span class="line">		ApplicationContext parent = getExistingRootWebApplicationContext(servletContext);</span><br><span class="line">		<span class="keyword">if</span> (parent != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.logger.info(<span class="string">"Root context already created (using as parent)."</span>);</span><br><span class="line">			servletContext.setAttribute(</span><br><span class="line">					WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, <span class="keyword">null</span>);</span><br><span class="line">			builder.initializers(<span class="keyword">new</span> ParentContextApplicationContextInitializer(parent));</span><br><span class="line">		&#125;</span><br><span class="line">		builder.initializers(</span><br><span class="line">				<span class="keyword">new</span> ServletContextApplicationContextInitializer(servletContext));</span><br><span class="line">		builder.contextClass(AnnotationConfigEmbeddedWebApplicationContext<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		builder = configure(builder);</span><br><span class="line">		builder.listeners(<span class="keyword">new</span> WebEnvironmentPropertySourceInitializer(servletContext));</span><br><span class="line">		SpringApplication application = builder.build();</span><br><span class="line">		<span class="keyword">if</span> (application.getSources().isEmpty() &amp;&amp; AnnotationUtils</span><br><span class="line">				.findAnnotation(getClass(), Configuration<span class="class">.<span class="keyword">class</span>) !</span>= <span class="keyword">null</span>) &#123;</span><br><span class="line">			application.getSources().add(getClass());</span><br><span class="line">		&#125;</span><br><span class="line">		Assert.state(!application.getSources().isEmpty(),</span><br><span class="line">				<span class="string">"No SpringApplication sources have been defined. Either override the "</span></span><br><span class="line">						+ <span class="string">"configure method or add an @Configuration annotation"</span>);</span><br><span class="line">		<span class="comment">// Ensure error pages are registered</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.registerErrorPageFilter) &#123;</span><br><span class="line">			application.getSources().add(ErrorPageFilterConfiguration<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> run(application);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>runæ–¹æ³•é‡Œæœ€åå°±æ˜¯è°ƒç”¨application.runï¼ŒåŒåŸæ¥çš„å…¥å£æ‰§è¡Œæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">run</span><span class="params">(SpringApplication application)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (WebApplicationContext) application.run();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>springBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”æ„å»ºæ®‹å·®ç½‘ç»œ</title>
    <url>/blogs/convNet2/</url>
    <content><![CDATA[<h2 id="ä¸åŒæ•°æ®é‡ä¸‹çš„è¿ç§»å­¦ä¹ "><a href="#ä¸åŒæ•°æ®é‡ä¸‹çš„è¿ç§»å­¦ä¹ " class="headerlink" title="ä¸åŒæ•°æ®é‡ä¸‹çš„è¿ç§»å­¦ä¹ "></a>ä¸åŒæ•°æ®é‡ä¸‹çš„è¿ç§»å­¦ä¹ </h2><p>å¯ä»¥ä½¿ç”¨å¼€æºçš„åˆ«äººçš„è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œï¼Œå°†å…¶ç½‘ç»œä¸­å­¦ä¹ çš„çŸ¥è¯†è¿ç§»åˆ°è‡ªå·±çš„ç½‘ç»œä¸­ï¼Œé€šå¸¸å¼€æºçš„ç½‘ç»œé…ç½®åœ¨prototxtä¸­</p><p>ï¼ˆ1ï¼‰å°‘é‡çš„æ ‡å®šæ•°æ®</p><p>å°†softmaxè¾“å‡ºç±»åˆ«å±‚ä¹‹å‰çš„ç¥ç»å…ƒè¿›è¡Œå†»ç»“ï¼Œå³ç›´æ¥ä½¿ç”¨åˆ«äººè®­ç»ƒå¥½çš„å‚æ•°ï¼Œåœ¨softmaxå±‚é‡æ–°ç”¨è‡ªå·±çš„æ ‡å®šæ•°æ®è¿›è¡Œè®­ç»ƒã€‚</p><p>ï¼ˆ2ï¼‰å……è¶³çš„æ ‡å®šæ•°æ®</p><a id="more"></a>



<p>ä»softmaxå±‚å‘å‰é€‰æ‹©ä¸€äº›å±‚æ•°è¿›è¡Œè®­ç»ƒï¼Œå…¶ä½™å±‚è¿›è¡Œå†»ç»“ç›´æ¥ä½¿ç”¨åˆ«äººè®­ç»ƒå¥½çš„å‚æ•°ã€‚</p>
<p>ï¼ˆ3ï¼‰å·¨å¤šçš„æ ‡å®šæ•°æ®</p>
<p>å°†åˆ«äººçš„ç½‘ç»œå‚æ•°ä½œä¸ºåˆå§‹åŒ–ï¼Œä½¿ç”¨è‡ªå·±çš„æ ‡å®šæ•°æ®é‡æ–°è®­ç»ƒç½‘ç»œã€‚</p>
<p>æ€»ç»“ï¼Œå½“æ ‡å®šæ•°æ®è¶Šå¤šï¼Œéœ€è¦å†»ç»“çš„ç½‘ç»œå±‚æ•°è¶Šå°‘ï¼Œè®­ç»ƒçš„ç½‘ç»œå±‚æ•°è¶Šå¤šã€‚</p>
<h2 id="æ•°æ®æ‰©å……çš„æ–¹æ³•"><a href="#æ•°æ®æ‰©å……çš„æ–¹æ³•" class="headerlink" title="æ•°æ®æ‰©å……çš„æ–¹æ³•"></a>æ•°æ®æ‰©å……çš„æ–¹æ³•</h2><p>è®¡ç®—æœºè§†è§‰éœ€è¦å¤§é‡æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨åŸæœ‰æ•°æ®åŸºç¡€ä¸Šè¿›è¡Œæ‰©å……</p>
<p>ï¼ˆ1ï¼‰å‚ç›´é•œåƒç¿»è½¬</p>
<p>å°†å›¾åƒé•œåƒç¿»è½¬</p>
<p>ï¼ˆ2ï¼‰éšæœºå›¾åƒä¿®å‰ª</p>
<p>åœ¨åŸæœ‰å›¾åƒä¸­å‰ªè£ä¸€å°éƒ¨åˆ†å›¾åƒï¼Œä½†ä¸å½±å“æ•°æ®çš„ç‰¹å¾åŠæ ‡ç­¾æƒ…å†µ</p>
<p>è¿˜æœ‰æ—‹è½¬å›¾åƒï¼Œæ‰­æ›²å›¾åƒç­‰æªæ–½</p>
<p>ï¼ˆ3ï¼‰é¢œè‰²å˜æ¢</p>
<p>å°†å›¾åƒçš„ä¸‰é€šé“é¢œè‰²æŒ‰ç…§ä¸€å®šæ¦‚ç‡åˆ†å¸ƒè¿›è¡Œæ•°å€¼åŠ å‡å¾—åˆ°æ–°çš„å›¾åƒ</p>
<h2 id="Incepton-Net"><a href="#Incepton-Net" class="headerlink" title="Incepton Net"></a>Incepton Net</h2><h3 id="1x1å·ç§¯çš„ä½œç”¨"><a href="#1x1å·ç§¯çš„ä½œç”¨" class="headerlink" title="1x1å·ç§¯çš„ä½œç”¨"></a>1x1å·ç§¯çš„ä½œç”¨</h3><p>å¯ä»¥å‡å°‘è¾“å…¥çš„é€šé“æ•°å³nCï¼Œé™ä½è®¡ç®—çš„æˆæœ¬</p>
<p>æ³¨ï¼šæ± åŒ–å±‚æ˜¯å‡å°‘è¾“å…¥çš„é•¿å®½ï¼Œå³nH,nW</p>
<h3 id="è°·æ­Œçš„Incepton-Net"><a href="#è°·æ­Œçš„Incepton-Net" class="headerlink" title="è°·æ­Œçš„Incepton Net"></a>è°·æ­Œçš„Incepton Net</h3><p>ä¸éœ€è¦æ‰‹å·¥è®¾ç½®ç½‘ç»œçš„ç»“æ„ï¼Œç›´æ¥å°†è¿‡æ»¤å™¨ç±»å‹æˆ–è€…æ± åŒ–å±‚ç­‰åŠ å…¥åˆ°ç½‘ç»œä¸­ï¼Œè®©ç½‘ç»œè‡ªåŠ¨å­¦ä¹ ï¼Œå°†æ‰€æœ‰çš„è¾“å‡ºå †å åœ¨ä¸€èµ·ï¼Œå°†æ‰€æœ‰incepetionæ¨¡å‹è¿æ¥åœ¨ä¸€èµ·å°±æ˜¯Incepton Netï¼Œè¯¥ç½‘ç»œä¸­é—´å±‚ä¹Ÿèƒ½è¾“å‡ºå›¾åƒç‰¹å¾å’Œé¢„æµ‹ç»“æœï¼Œé˜²æ­¢äº†è¿‡æ‹Ÿåˆã€‚</p>
<p>æ³¨ï¼šå¦‚æœä¸€ä¸ªæ¨¡å‹ä¸­æœ‰ä¸€ç§æƒ…å†µè¾“å‡ºçš„é€šé“æ•°è¿‡å¤§ï¼Œå¯ä»¥ä½¿ç”¨1x1å·ç§¯æ¥å‡å°é€šé“æ•°</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªinceptionæ¨¡å—ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200603123833.png" alt></p>
<h2 id="æ„å»ºæ®‹å·®å—"><a href="#æ„å»ºæ®‹å·®å—" class="headerlink" title="æ„å»ºæ®‹å·®å—"></a>æ„å»ºæ®‹å·®å—</h2><h3 id="æ’ç­‰å—"><a href="#æ’ç­‰å—" class="headerlink" title="æ’ç­‰å—"></a>æ’ç­‰å—</h3><p>è¾“å…¥çš„æ¿€æ´»å€¼a[l]å’Œè¾“å‡ºçš„æ¿€æ´»å€¼a[l+1]ç»´åº¦ç›¸åŒ</p>
<p>ç½‘ç»œç»“æ„ï¼šç›´æ¥ä»è¾“å…¥ç‚¹åŠ ä¸€ä¸ªshortcutæ·å¾„åˆ°è¾“å‡º</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨keras.layersè‡ªå¸¦çš„Conv2D,BatchNormalization,Activation,MaxPooling2Dæ„é€ æ­£å¸¸ç½‘ç»œç»“æœï¼ŒæŒ‡æ˜è¿‡æ»¤å™¨ä¸ªæ•°å’Œç»´åº¦ï¼Œä»¥åŠå‚æ•°åˆå§‹åŒ–æ–¹æ³•ï¼ˆå‡åŒ€æ­£æ€åˆ†å¸ƒï¼‰ï¼Œå¹¶è¿›è¡Œå‘½åã€‚</p>
<p>ï¼ˆ2ï¼‰å°†æ·å¾„è¾“å…¥çš„xå’Œæ­£å¸¸ç½‘ç»œå¾—å‡ºçš„xä½¿ç”¨Addå‡½æ•°è¿›è¡Œåˆå¹¶ï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°å¾—åˆ°æœ€ç»ˆè¾“å‡º</p>
<p>æ³¨ï¼šBatchNormalizationçš„ä½œç”¨æ˜¯å¯¹éšè—å±‚è¿›è¡Œå½’ä¸€åŒ–ï¼Œä½¿å¾—æ¯å±‚éƒ½èƒ½å°½é‡å•ç‹¬å­¦ä¹ ï¼Œé™åˆ¶äº†å‰å±‚å‚æ•°å˜åŒ–å¯¹åå±‚å‚æ•°çš„æ•°å€¼åˆ†å¸ƒç¨‹åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ’ç­‰å— è¿æ¥å‰åç»´åº¦ç›¸åŒ</span></span><br><span class="line"><span class="comment">#stage - æ•´æ•°ï¼Œæ ¹æ®æ¯å±‚çš„ä½ç½®æ¥å‘½åæ¯ä¸€å±‚ï¼Œä¸blockå‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="comment">#block - å­—ç¬¦ä¸²ï¼Œæ®æ¯å±‚çš„ä½ç½®æ¥å‘½åæ¯ä¸€å±‚ï¼Œä¸stageå‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identity_block</span><span class="params">(X,filters,f,stage,block)</span>:</span></span><br><span class="line">	<span class="comment">#ç»“æ„ï¼šconv-bn-relu,conv-bn-relu,conv-bn    relu</span></span><br><span class="line">	conv_name_base=<span class="string">"res"</span>+str(stage)+block+<span class="string">"_branch"</span></span><br><span class="line">	bn_name_base=<span class="string">"bn"</span>+str(stage)+block+<span class="string">"_branch"</span></span><br><span class="line"></span><br><span class="line">	F1,F2,F3=filters</span><br><span class="line">	X_input=X</span><br><span class="line">	<span class="comment">#å‡åŒ€æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</span></span><br><span class="line">	X=Conv2D(filters=F1,kernel_size=(<span class="number">1</span>,<span class="number">1</span>),strides=(<span class="number">1</span>,<span class="number">1</span>),padding=<span class="string">'valid'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2a'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2a'</span>)(X)</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Conv2D(filters=F2,kernel_size=(f,f),strides=(<span class="number">1</span>,<span class="number">1</span>),padding=<span class="string">'same'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2b'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2b'</span>)(X)</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Conv2D(filters=F3,kernel_size=(<span class="number">1</span>,<span class="number">1</span>),strides=(<span class="number">1</span>,<span class="number">1</span>),padding=<span class="string">'valid'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2c'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2c'</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Add()([X_input,X])</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> X</span><br></pre></td></tr></table></figure>

<h3 id="å·ç§¯å—"><a href="#å·ç§¯å—" class="headerlink" title="å·ç§¯å—"></a>å·ç§¯å—</h3><p>è¾“å…¥çš„æ¿€æ´»å€¼a[l]å’Œè¾“å‡ºçš„æ¿€æ´»å€¼a[l+1]ç»´åº¦ä¸åŒ</p>
<p>ç½‘ç»œç»“æ„ï¼šä»è¾“å…¥ç‚¹å‡ºå‘çš„ä¸€ä¸ªshortcutæ·å¾„éœ€è¦å¢åŠ å·ç§¯å±‚ï¼Œå¦‚ä½•å†åˆ°è¾“å‡º</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨keras.layersè‡ªå¸¦çš„Conv2D,BatchNormalization,Activation,MaxPooling2Dæ„é€ æ­£å¸¸ç½‘ç»œç»“æœï¼ŒæŒ‡æ˜è¿‡æ»¤å™¨ä¸ªæ•°å’Œç»´åº¦ï¼Œä»¥åŠå‚æ•°åˆå§‹åŒ–æ–¹æ³•ï¼ˆå‡åŒ€æ­£æ€åˆ†å¸ƒï¼‰ï¼Œå¹¶è¿›è¡Œå‘½åã€‚</p>
<p>ï¼ˆ2ï¼‰æ·å¾„è¾“å…¥xä½¿ç”¨Conv2D,BatchNormalization,ç»è¿‡ä¸€ä¸ªå·ç§¯å±‚å¾—åˆ°æ·å¾„çš„è¾“å‡ºx</p>
<p>ï¼ˆ3ï¼‰å°†æ·å¾„è¾“å‡ºçš„xå’Œæ­£å¸¸ç½‘ç»œå¾—å‡ºçš„xä½¿ç”¨Addå‡½æ•°è¿›è¡Œåˆå¹¶ï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°å¾—åˆ°æœ€ç»ˆè¾“å‡º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å·ç§¯å— è¿æ¥å‰åç»´åº¦ä¸åŒ,éœ€è¦åœ¨æ·å¾„é‡ŒåŠ ä¸Šconvå±‚</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convolutional_block</span><span class="params">(X,filters,f,stage,block,s=<span class="number">2</span>)</span>:</span></span><br><span class="line">	<span class="comment">#ç»“æ„ï¼šconv-bn-relu,conv-bn-relu,conv-bn    relu</span></span><br><span class="line">	conv_name_base=<span class="string">"res"</span>+str(stage)+block+<span class="string">"_branch"</span></span><br><span class="line">	bn_name_base=<span class="string">"bn"</span>+str(stage)+block+<span class="string">"_branch"</span></span><br><span class="line"></span><br><span class="line">	F1,F2,F3=filters</span><br><span class="line">	X_input=X</span><br><span class="line">	<span class="comment">#å‡åŒ€æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</span></span><br><span class="line">	X=Conv2D(filters=F1,kernel_size=(<span class="number">1</span>,<span class="number">1</span>),strides=(s,s),padding=<span class="string">'valid'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2a'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2a'</span>)(X)</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Conv2D(filters=F2,kernel_size=(f,f),strides=(<span class="number">1</span>,<span class="number">1</span>),padding=<span class="string">'same'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2b'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2b'</span>)(X)</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	X=Conv2D(filters=F3,kernel_size=(<span class="number">1</span>,<span class="number">1</span>),strides=(<span class="number">1</span>,<span class="number">1</span>),padding=<span class="string">'valid'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'2c'</span>)(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'2c'</span>)(X)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ·å¾„</span></span><br><span class="line">	X_input=Conv2D(filters=F3,kernel_size=(<span class="number">1</span>,<span class="number">1</span>),strides=(s,s),padding=<span class="string">'valid'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>),name=conv_name_base+<span class="string">'1'</span>)(X_input)</span><br><span class="line">	X_input=BatchNormalization(axis=<span class="number">3</span>,name=bn_name_base+<span class="string">'1'</span>)(X_input)</span><br><span class="line"></span><br><span class="line">	X=Add()([X_input,X])</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> X</span><br></pre></td></tr></table></figure>

<h2 id="æ„å»ºæ®‹å·®ç½‘ç»œ"><a href="#æ„å»ºæ®‹å·®ç½‘ç»œ" class="headerlink" title="æ„å»ºæ®‹å·®ç½‘ç»œ"></a>æ„å»ºæ®‹å·®ç½‘ç»œ</h2><h3 id="å°†æ®‹å·®å—ä¸€ä¸ªä¸ªè¿æ¥èµ·æ¥å³ä¸ºæ®‹å·®ç½‘ç»œ"><a href="#å°†æ®‹å·®å—ä¸€ä¸ªä¸ªè¿æ¥èµ·æ¥å³ä¸ºæ®‹å·®ç½‘ç»œ" class="headerlink" title="å°†æ®‹å·®å—ä¸€ä¸ªä¸ªè¿æ¥èµ·æ¥å³ä¸ºæ®‹å·®ç½‘ç»œ"></a>å°†æ®‹å·®å—ä¸€ä¸ªä¸ªè¿æ¥èµ·æ¥å³ä¸ºæ®‹å·®ç½‘ç»œ</h3><p>æŒ‰ç…§å¦‚å›¾çš„ç½‘ç»œç»“æ„æ­å»ºæ®‹å·®ç½‘ç»œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200603120554.png" alt></p>
<p>ï¼ˆ1ï¼‰å…ˆå®šä¹‰ä¸€ä¸ªtensorçš„å ä½ç¬¦ï¼Œå¹¶æ ¹æ®è¾“å…¥å›¾åƒçš„å¤§å°å®šä¹‰ç»´åº¦</p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨kears.layersè‡ªå¸¦çš„ZeroPadding2Då¯¹å›¾åƒè¿›è¡Œå¡«å……</p>
<p>ï¼ˆ3ï¼‰ç½‘ç»œç¬¬ä¸€ä¸ªæ¨¡å—ç»“æ„ä¸ºconv-bn-maxpoool-relu</p>
<p>ï¼ˆ4ï¼‰åé¢çš„æ¨¡å—æ˜¯ä½¿ç”¨å·ç§¯å—å’Œæ’ç­‰å—è¿›è¡Œç»„åˆ</p>
<p>ï¼ˆ5ï¼‰æœ€ç»ˆçš„åˆ°çš„ç»“æœé€šè¿‡å¹³å‡æ± åŒ–ï¼Œå¹¶è¿›è¡Œæ‹‰ä¼¸åï¼Œå°†å›¾åƒå‘é‡ä¼ å…¥å…¨è¿æ¥å±‚</p>
<p>ï¼ˆ6ï¼‰æ ¹æ®è¾“å…¥å’Œè¾“å‡ºï¼Œå¾—åˆ°ResNet50çš„æ¨¡å‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ­å»ºæ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ResNet50</span><span class="params">(input_shape=<span class="params">(<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>)</span>,classes=<span class="number">6</span>)</span>:</span></span><br><span class="line">	<span class="comment">#å®šä¹‰ä¸€ä¸ªtensorçš„å ä½ç¬¦ï¼Œå¹¶åˆ¶å®šç»´åº¦</span></span><br><span class="line">	X_input=Input(input_shape)</span><br><span class="line">	X=ZeroPadding2D((<span class="number">3</span>,<span class="number">3</span>))(X_input)</span><br><span class="line"></span><br><span class="line">	X=Conv2D(<span class="number">64</span>,kernel_size=(<span class="number">7</span>,<span class="number">7</span>),strides=(<span class="number">2</span>,<span class="number">2</span>),name=<span class="string">'conv1'</span>,kernel_initializer=glorot_uniform(seed=<span class="number">0</span>))(X)</span><br><span class="line">	X=BatchNormalization(axis=<span class="number">3</span>,name=<span class="string">'bn_conv1'</span>)(X)</span><br><span class="line">	X=Activation(<span class="string">'relu'</span>)(X)</span><br><span class="line">	X=MaxPooling2D((<span class="number">3</span>,<span class="number">3</span>),strides=(<span class="number">2</span>,<span class="number">2</span>),name=<span class="string">'max_pool'</span>)(X)</span><br><span class="line"></span><br><span class="line">	filters=[<span class="number">64</span>,<span class="number">64</span>,<span class="number">256</span>]</span><br><span class="line">	f=<span class="number">3</span></span><br><span class="line">	stage=<span class="number">2</span></span><br><span class="line">	X=convolutional_block(X,filters,f,stage,block=<span class="string">'a'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'b'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'c'</span>)</span><br><span class="line"></span><br><span class="line">	filters=[<span class="number">128</span>,<span class="number">128</span>,<span class="number">512</span>]</span><br><span class="line">	f=<span class="number">3</span></span><br><span class="line">	stage=<span class="number">3</span></span><br><span class="line">	X=convolutional_block(X,filters,f,stage,block=<span class="string">'a'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'b'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'c'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'d'</span>)</span><br><span class="line"></span><br><span class="line">	filters=[<span class="number">256</span>,<span class="number">256</span>,<span class="number">1024</span>]</span><br><span class="line">	f=<span class="number">3</span></span><br><span class="line">	stage=<span class="number">4</span></span><br><span class="line">	X=convolutional_block(X,filters,f,stage,block=<span class="string">'a'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'b'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'c'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'d'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'e'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'f'</span>)</span><br><span class="line"></span><br><span class="line">	filters=[<span class="number">512</span>,<span class="number">512</span>,<span class="number">2048</span>]</span><br><span class="line">	f=<span class="number">3</span></span><br><span class="line">	stage=<span class="number">5</span></span><br><span class="line">	X=convolutional_block(X,filters,f,stage,block=<span class="string">'a'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'b'</span>)</span><br><span class="line">	X=identity_block(X,filters,f,stage,block=<span class="string">'c'</span>)</span><br><span class="line"></span><br><span class="line">	X=AveragePooling2D((<span class="number">2</span>,<span class="number">2</span>),padding=<span class="string">'same'</span>,name=<span class="string">'avg_pool'</span>)(X)</span><br><span class="line">	X=Flatten()(X)</span><br><span class="line">	X=Dense(classes,activation=<span class="string">'softmax'</span>,name=<span class="string">'fc'</span>+str(classes),kernel_initializer=glorot_uniform(seed=<span class="number">0</span>))(X)</span><br><span class="line"></span><br><span class="line">	model=Model(inputs=X_input,outputs=X,name=<span class="string">'ResNet50'</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>

<h3 id="æ®‹å·®ç½‘ç»œä½œç”¨"><a href="#æ®‹å·®ç½‘ç»œä½œç”¨" class="headerlink" title="æ®‹å·®ç½‘ç»œä½œç”¨"></a>æ®‹å·®ç½‘ç»œä½œç”¨</h3><p>å½“ç½‘ç»œå¾ˆæ·±æ—¶ï¼Œè®­ç»ƒé›†çš„è¯¯å·®åè€Œä¼šå¢å¤§ï¼Œè¯¯å·®å…ˆå‡å°åå¢å¤§ã€‚</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨æ®‹å·®ç½‘ç»œèƒ½å¾ˆå¥½çš„å­¦ä¹ æ’ç­‰å¼ï¼Œå¹¶ä¸é™ä½æ•ˆç‡</p>
<p>ï¼ˆ2ï¼‰èƒ½å°†è¾“å…¥çš„å¤æ‚çš„éçº¿æ€§å‡½æ•°ä¼ é€’åˆ°æ›´æ·±å±‚ï¼Œè½»æ¾å­¦ä¹ è¾“å…¥è¾“å‡ºä¹‹é—´çš„æ˜ å°„</p>
<p>æœ€ç»ˆå½“ç½‘ç»œå¾ˆæ·±ï¼Œè®­ç»ƒé›†è¯¯å·®éšç€å±‚æ•°å¢åŠ è€Œå‡å°‘ã€‚</p>
<p>a[l+2]=g(z[l+2]+a[l])=g(w[l+2] * a[l+1]+b[l+2]+ws * a[l])ï¼Œå½“è¾“å…¥è¾“å‡ºç»´åº¦ä¸åŒï¼Œå¯ä»¥åœ¨a[l]å‰é¢åŠ ä¸Šwsè¿›è¡Œç»´åº¦è°ƒæ•´</p>
<p>å…¶ä¸­a[l]æ˜¯æ·å¾„è¾“å…¥ï¼Œz[l+2]æ˜¯æ­£å¸¸ç½‘ç»œè¾“å‡ºï¼Œa[l+2]æ˜¯æœ€ç»ˆè¾“å‡º</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>ï¼ˆ1ï¼‰åœ¨æ‰‹åŠ¿å›¾ç‰‡ä¸Šä½¿ç”¨æ®‹å·®ç½‘ç»œè¿›è¡Œæ¨¡å‹è®­ç»ƒ</p>
<p>è¾“å…¥æ¯ä¸ªå›¾ç‰‡çš„ç»´åº¦å’Œè¾“å‡ºæ ‡ç­¾æ•°é‡ï¼Œè¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚</p>
<p>é€‰æ‹©æ¨¡å‹ä¸­é‡‡ç”¨çš„ç®—æ³•å’ŒæŸå¤±å‡½æ•°ã€‚</p>
<p>æœ€åä½¿ç”¨fitå°†æ•°æ®è¾“å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¼–è¯‘æ¨¡å‹</span></span><br><span class="line">mymodel=ResNet50(input_shape=(<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>),classes=<span class="number">6</span>)</span><br><span class="line">mymodel.compile(optimizer=<span class="string">'adam'</span>,loss=<span class="string">'categorical_crossentropy'</span>,metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"><span class="comment">#æ ‡ç­¾è½¬æ¢ä¸ºç‹¬çƒ­çŸ©é˜µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_one_hot</span><span class="params">(Y,C)</span>:</span></span><br><span class="line">	Y=np.eye(C)[Y.reshape(<span class="number">-1</span>).T]</span><br><span class="line">	<span class="keyword">return</span> Y</span><br><span class="line"><span class="comment">#å¯¼å…¥æ•°æ®</span></span><br><span class="line">train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes=ru.load_dataset()</span><br><span class="line"><span class="comment">#å½’ä¸€åŒ–</span></span><br><span class="line">train_x=train_set_x_orig/<span class="number">255</span></span><br><span class="line">test_x=test_set_x_orig/<span class="number">255</span></span><br><span class="line"></span><br><span class="line">train_y=convert_one_hot(train_set_y_orig,<span class="number">6</span>)</span><br><span class="line">test_y=convert_one_hot(test_set_y_orig,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å…¥æ•°æ®ï¼Œè®­ç»ƒæ¨¡å‹</span></span><br><span class="line">mymodel.fit(train_x,train_y,epochs=<span class="number">3</span>,batch_size=<span class="number">64</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ä¿å­˜æ¨¡å‹</p>
<p>ä½¿ç”¨saveä¿å­˜æ¨¡å‹ï¼šå°†æ¨¡å‹çš„ç»“æ„ï¼Œå‚æ•°ï¼Œå¯¼å‡ºçš„æ¨¡å‹å¯ä»¥ç›´æ¥è¿›è¡Œæ¨¡å‹é¢„æµ‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mymodel.save(<span class="string">"my_resnet50.h5"</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å¯¼å…¥ä¿å­˜çš„æ¨¡å‹ï¼Œå¾—åˆ°æ¨¡å‹çš„å‡†ç¡®ç‡</p>
<p>ä½¿ç”¨keras.modelsä¸‹çš„load_modelæ–¹æ³•å°†ä¹‹å‰è®­ç»ƒå¥½çš„æ¨¡å‹å¯¼å…¥ï¼Œå¹¶è®¡ç®—å‡†ç¡®åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mymodel=load_model(<span class="string">'my_resnet50.h5'</span>)</span><br><span class="line">p=mymodel.evaluate(test_x,test_y)</span><br><span class="line">print(<span class="string">"è¯¯å·®ç‡ï¼š"</span>,p[<span class="number">0</span>])</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ï¼š"</span>,p[<span class="number">1</span>])mymodel.save(<span class="string">"my_resnet50.h5"</span>)</span><br></pre></td></tr></table></figure>

<p>è¯¯å·®ç‡ï¼š 0.7191567063331604<br>å‡†ç¡®ç‡ï¼š 0.7833333611488342</p>
<p>ç”±äºåŸç®—æ³•è¿­ä»£æ•°ä»…2æ¬¡ï¼Œæ‰€ä»¥å‡†ç¡®ç‡ä¸æ˜¯ç‰¹åˆ«é«˜ã€‚</p>
<p>ï¼ˆ4ï¼‰åˆ©ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹æµ‹è¯•</p>
<p>ä½¿ç”¨keras.preprocessingä¸‹çš„imageå¯¼å…¥å›¾åƒï¼Œå°†å›¾åƒè½¬æ¢ä¸ºæ•°ç»„ï¼Œå¹¶è¿›è¡Œå½’ä¸€åŒ–åè¾“å…¥è®­ç»ƒå¥½çš„ç½‘ç»œï¼Œæœ€ç»ˆé€šè¿‡np.argmaxå¾—åˆ°åˆ†ç±»çš„ç»“æœ</p>
<p>æ³¨ï¼šè¿™é‡Œå›¾åƒéœ€è¦æ‹“å±•ç»´åº¦ï¼Œä»(64, 64, 3)æ‹“å±•ä¸º(1, 64, 64, 3)ï¼Œä»£ç ä¸ºx=np.expand_dims(x,axis=0)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨è‡ªå·±çš„å›¾åƒæµ‹è¯•</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image_path=<span class="string">'./fingers/2.jpg'</span></span><br><span class="line">x=image.load_img(image_path,target_size=(<span class="number">64</span>,<span class="number">64</span>))</span><br><span class="line"></span><br><span class="line">x=image.img_to_array(x)</span><br><span class="line"><span class="comment">#æ‹“å±•ç»´åº¦</span></span><br><span class="line">x=np.expand_dims(x,axis=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># x=preprocess_input(x)</span></span><br><span class="line">x=x/<span class="number">255</span></span><br><span class="line"></span><br><span class="line">res=np.argmax(mymodel.predict(x))</span><br><span class="line">print(res)</span><br><span class="line">print(mymodel.predict(x))</span><br><span class="line"></span><br><span class="line">test_image=Image.open(image_path).convert(<span class="string">'RGB'</span>).resize((<span class="number">64</span>,<span class="number">64</span>))</span><br><span class="line">plt.imshow(test_image)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥å›¾åƒ</p>
<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200602210826.jpg" style="zoom:25%;">

<p>é¢„æµ‹ç»“æœä¸ºï¼š</p>
<p>2<br>[[0.1477255  0.15454543 0.18347658 0.16707171 0.18196131 0.16521947]]</p>
<p>è¾“å…¥çš„æ‰‹åŠ¿æ˜¯2ï¼Œé¢„æµ‹ä¹Ÿæ˜¯2ï¼Œè¯´æ˜é¢„æµ‹æ­£ç¡®</p>
<p>è¯´æ˜ï¼šç”±äºè®­ç»ƒé›†ä¸­çš„æ‰‹åŠ¿å›¾ç‰‡ä¸æ˜¯è‡ªå·±æ‹æ‘„çš„ï¼Œæ‰€ä»¥é¢„æµ‹çš„æ•ˆæœä¸ä¸€å®šå¾ˆå‡†ç¡®ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”è¯†åˆ«æ‰‹åŠ¿å›¾ç‰‡</title>
    <url>/blogs/convNet1/</url>
    <content><![CDATA[<h2 id="ç®—æ³•ç®€ä»‹"><a href="#ç®—æ³•ç®€ä»‹" class="headerlink" title="ç®—æ³•ç®€ä»‹"></a>ç®—æ³•ç®€ä»‹</h2><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>ä½¿ç”¨æ™®é€šçš„ç¥ç»ç½‘ç»œæ—¶ï¼Œå½“è¾“å…¥çš„å›¾ç‰‡ç»´åº¦å¤§ï¼Œå‡è®¾ä¸º1000 * 1000 * 3ï¼Œç¬¬ä¸€å±‚çš„ç¥ç»å…ƒä¸º1000ä¸ªï¼Œåˆ™æƒé‡å‚æ•°è¾¾åˆ°ä¸‰äº¿ä¸ªï¼ˆ1000 * 1000 * 3 * 1000ï¼‰ï¼Œè¿™æ—¶å€™ç½‘ç»œä¼šå˜å¾—å¾ˆå¤§ï¼Œæœ‰å·¨å¤§çš„å‚æ•°ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œã€‚</p><p>å·ç§¯ç¥ç»ç½‘ç»œé€šè¿‡å‚æ•°å…±äº«å’Œç¨€ç–è¿æ¥çš„æ–¹å¼ä½¿å¾—å‚æ•°å˜å¾—å¾ˆå°‘ï¼Œå¯ä»¥ç”¨å¾ˆå°‘çš„è®­ç»ƒé›†è®­ç»ƒï¼Œé¿å…ç½‘ç»œè¿‡æ‹Ÿåˆã€‚</p><a id="more"></a>

<p>å‚æ•°å…±äº«ï¼šå›¾ç‰‡çš„ä¸åŒåŒºåŸŸéƒ½å¯ä»¥ç”¨ç›¸åŒçš„è¿‡æ»¤å™¨è®¡ç®—</p>
<p>ç¨€ç–è¿æ¥ï¼šæ¯ä¸ªè¾“å‡ºçš„åƒç´ ä»…å’Œéƒ¨åˆ†è¾“å…¥åƒç´ ç›¸å…³ï¼Œå…¶ä»–åƒç´ ä¸å½±å“ç›¸åº”è¾“å‡º</p>
<p>å‡è®¾ä¸º1000 * 1000 * 3ï¼Œè¿‡æ»¤å™¨ä¸º4 * 4 * 3ï¼ŒåŠ ä¸Šåç½®é¡¹ï¼Œå…±10ä¸ªè¿‡æ»¤å™¨ï¼Œåˆ™éœ€è¦çš„å‚æ•°ä¸ºï¼ˆ4 * 4 * 3 +1ï¼‰ * 10=490ä¸ªï¼ŒåŸå°äºåŸä½¿ç”¨æ™®é€šçš„ç¥ç»ç½‘ç»œ</p>
<h3 id="ç½‘ç»œæ„æˆ"><a href="#ç½‘ç»œæ„æˆ" class="headerlink" title="ç½‘ç»œæ„æˆ"></a>ç½‘ç»œæ„æˆ</h3><p>å·ç§¯ç¥ç»ç½‘ç»œé€šå¸¸æœ‰ä¸‰å±‚ï¼ˆä¹Ÿæœ‰åªæœ‰å·ç§¯å±‚çš„ç½‘ç»œï¼Œå…·ä½“ç½‘ç»œçš„é…ç½®ï¼Œå¦‚å±‚æ•°ï¼Œè¶…å‚è®¾ç½®å¯ä»¥å‚ç…§æ–‡çŒ®ä¸­å…¶ä»–äººçš„æ–¹æ³•ï¼‰ï¼Œè¿™é‡Œå°†å·ç§¯å±‚+æ± åŒ–å±‚ä½œä¸ºç¥ç»ç½‘ç»œçš„ä¸€å±‚ã€‚</p>
<p>ï¼ˆ1ï¼‰å·ç§¯å±‚</p>
<p>ä½œç”¨ï¼šä½¿ç”¨è¿‡æ»¤å™¨å¯¹è¾“å…¥çš„å›¾åƒè¿›è¡Œå·ç§¯æ“ä½œï¼ˆæŒ‰ç…§æ­¥é•¿ï¼Œåœ¨å›¾åƒç›¸åº”åŒºåŸŸåšä¹˜ç§¯å¹¶æ±‚å’Œï¼‰ï¼ŒåŠŸèƒ½ç±»ä¼¼äºæ±‚Z=W * X +b</p>
<p>ç»è¿‡å·ç§¯å±‚çš„å›¾åƒä½¿ç”¨éçº¿æ€§å‡½æ•°è¿›è¡Œè®¡ç®—å¾—åˆ°A=relu(Z)</p>
<p>paddingçš„ä½œç”¨ï¼šç”±äºå·ç§¯ä¹‹åå›¾åƒä¼šå˜å°ï¼Œå¯ä»¥é€šè¿‡äº‹å…ˆåœ¨è¾“å…¥å›¾åƒå¤–éƒ¨è¿›è¡Œå¡«å……0ã€‚æœ‰ä¸¤ç§å¡«å……æ–¹å¼ï¼švalid paddingå³p=0ï¼Œä¸å¡«å……ï¼›same paddingï¼Œå³å¡«å……å®Œæˆåï¼Œè¾“å…¥è¾“å‡ºçš„ç»´åº¦ç›¸åŒï¼Œå³n+2p-f+1=nï¼Œç”±æ­¤å¾·é©°p=(f-1)/2</p>
<p>é™„ï¼ˆå…¬å¼ï¼‰ï¼š</p>
<p>å½“è¾“å…¥çš„ç»´åº¦ä¸ºn * n * n_cï¼Œè¿‡æ»¤å™¨ä¸ºf * fï¼Œæ­¥é•¿ä¸ºsï¼Œå¡«å……ä¸ºpï¼Œåˆ™è¾“å‡ºçš„æ•°æ®ç»´åº¦ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200528143258.png" alt></p>
<p>ï¼ˆ2ï¼‰æ± åŒ–å±‚</p>
<p>ä½œç”¨ï¼šç¼©å°æ¨¡å‹ï¼ŒåŠ å¿«è®¡ç®—é€Ÿåº¦</p>
<p>åˆ†ç±»ï¼šæœ€å¤§æ± åŒ–ï¼Œå–å›¾åƒå¯¹åº”åŒºåŸŸå†…çš„æœ€å¤§å€¼ï¼›å¹³å‡æ± åŒ–ï¼Œå–å›¾åƒåŒºåŸŸå†…çš„å¹³å‡å€¼</p>
<p>æ¥æ”¶ç»è¿‡å·ç§¯å±‚çš„è¾“å‡ºAï¼Œé€šè¿‡æ± åŒ–å±‚ï¼Œé€‰æ‹©æ± åŒ–æ–¹å¼æœ€ç»ˆå¾—åˆ°Pï¼Œä½œä¸ºä¸€å±‚ç½‘ç»œçš„è¾“å‡ºã€‚</p>
<p>æ³¨ï¼šæ± åŒ–å±‚ä¸­å‚æ•°ä¸åœ¨åå‘ä¼ æ’­ä¸­æ›´æ–°ï¼Œå³æ± åŒ–å±‚æ²¡æœ‰è¦å­¦ä¹ çš„å‚æ•°</p>
<p>å¸¸ç”¨å‚æ•°ï¼šf=2ï¼Œs=2ï¼ˆé•¿å®½ç¼©å°ä¸€åŠï¼‰</p>
<p>ï¼ˆ3ï¼‰å…¨è¿æ¥å±‚</p>
<p>ä½œç”¨ï¼šå…¨è¿æ¥å±‚ç±»ä¼¼äºå•ç¥ç»ç½‘ç»œï¼Œå‡è®¾é€šè¿‡ä¸¤å±‚ç½‘ç»œï¼ˆå·ç§¯+æ± åŒ–ï¼‰å¾—åˆ°å›¾åƒå°†å…¶æ‹‰ä¼¸æˆä¸€ç»´å‘é‡ï¼Œå…¶ç»´åº¦ä¸ºnï¼Œå…¨è¿æ¥å±‚çš„ç»´åº¦ä¸ºmï¼Œåˆ™ä¸­é—´çš„æƒé‡ç»´åº¦ä¸ºï¼ˆm,nï¼‰ï¼Œå¯è§å·ç§¯ç¥ç»ç½‘ç»œä¸­å‚æ•°ä¸»è¦é›†ä¸­åœ¨å…¨è¿æ¥å±‚ã€‚</p>
<p>ç»è¿‡å…¨è¿æ¥å±‚çš„å›¾åƒä¼šæœ€ç»ˆè¾“å‡ºä¸€ä¸ªä¸€ç»´å‘é‡ä½œä¸ºç»“æœï¼Œå½“æœ€åæ¥softmaxå‡½æ•°æ—¶ï¼Œåˆ™æœ€ç»ˆè¾“å‡ºä¸€ä¸ªç»“æœã€‚</p>
<h3 id="ç®€å•ç½‘ç»œç»“æ„ç¤ºæ„å›¾"><a href="#ç®€å•ç½‘ç»œç»“æ„ç¤ºæ„å›¾" class="headerlink" title="ç®€å•ç½‘ç»œç»“æ„ç¤ºæ„å›¾"></a>ç®€å•ç½‘ç»œç»“æ„ç¤ºæ„å›¾</h3><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200527180339.png" alt></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¯ä¸€ä¸ªç®€å•çš„äºŒå±‚å·ç§¯ç¥ç»ç½‘ç»œï¼Œè¾“å…¥çš„å›¾åƒä¸º32 * 32 * 3</p>
<p>ï¼ˆ1ï¼‰å·ç§¯å±‚+æ± åŒ–å±‚</p>
<p>ç¬¬ä¸€å±‚ç½‘ç»œï¼šå·ç§¯å±‚è®¾ç½®è¿‡æ»¤å™¨ä¸º5 * 5ï¼Œæ•°é‡ä¸º6ä¸ªï¼Œæ­¥é•¿s=1ï¼Œp=0ï¼Œåˆ™è¾“å‡º28 * 28 * 6çš„å›¾åƒï¼ˆå¥—ç”¨å…¬å¼å³å¯å¾—åˆ°è¾“å‡ºçš„ç»´åº¦ï¼‰ï¼Œç¬¬ä¸‰ä¸ªç»´åº¦6ä»£è¡¨6ä¸ªè¿‡æ»¤å™¨</p>
<p>æ± åŒ–å±‚é€‰æ‹©æœ€å¤§æ± åŒ–ï¼Œf=2ï¼Œs=2ï¼ˆé•¿å®½ç¼©å°ä¸€åŠï¼‰ï¼Œåˆ™è¾“å‡º14 * 14 *6çš„å›¾åƒ</p>
<p>ç¬¬äºŒå±‚ç½‘ç»œåŒç†ï¼Œæœ€ç»ˆå¾—åˆ°5 * 5 * 16çš„å›¾åƒï¼Œå°†å…¶æ‹‰ä¼¸ä¸º400 * 1çš„ä¸€ç»´å‘é‡ï¼Œè¾“å…¥å…¨è¿æ¥å±‚ä¸­</p>
<p>ï¼ˆ2ï¼‰å…¨è¿æ¥å±‚</p>
<p>å¯ä»¥è®¾ç½®å¤šä¸ªå…¨è¿æ¥å±‚ï¼Œè¿™é‡Œè®¾ç½®äº†ä¸¤å±‚ï¼Œå°†æ‹‰ä¼¸äº†çš„å›¾åƒè¾“å…¥å…¨è¿æ¥å±‚ä¸­ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ•°æ®è¾“å…¥softmaxå‡½æ•°ä¸­å¾—åˆ°æœ€ç»ˆè¾“å‡ºï¼Œæ•°å­—æœ€å¤§çš„æ•°å­—ä»£è¡¨è¾“å…¥å›¾åƒä»£è¡¨çš„ç±»åˆ«</p>
<h3 id="ç½‘ç»œä¸­å„æ•°æ®çš„ç»´åº¦"><a href="#ç½‘ç»œä¸­å„æ•°æ®çš„ç»´åº¦" class="headerlink" title="ç½‘ç»œä¸­å„æ•°æ®çš„ç»´åº¦"></a>ç½‘ç»œä¸­å„æ•°æ®çš„ç»´åº¦</h3><p>å¡«å……ï¼šp</p>
<p>æ­¥é•¿ï¼šs</p>
<p>æ¯ä¸ªè¿‡æ»¤å™¨ï¼šf * f * n_c_pre ï¼ˆè¿™é‡Œçš„n_c_preæ˜¯æŒ‡è¿‡æ»¤å™¨ç»´åº¦éœ€è¦å’Œè¾“å…¥ï¼Œå³ä¸Šä¸€å±‚çš„è¾“å…¥ä¿æŒä¸€è‡´ï¼‰</p>
<p>æœ¬å±‚è¿‡æ»¤å™¨æ•°é‡ï¼šn_c</p>
<p>æƒé‡Wï¼šf * f *n_c_pre * n_c ï¼ˆn_cæ˜¯æŒ‡æœ¬å±‚è¿‡æ»¤å™¨æ•°é‡ï¼Œæƒé‡çš„ç»´åº¦ç­‰äºæ¯ä¸ªè¿‡æ»¤å™¨ç»´åº¦ * è¿‡æ»¤å™¨æ•°é‡ï¼‰</p>
<p>åç½®é‡bï¼š1 * 1 * 1 * n_c</p>
<p>æ¿€æ´»å€¼aï¼šn_h * n_w * n_cï¼ˆæœ¬å±‚çš„è¾“å‡ºï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200527180726.png" alt></p>
<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ï¼ˆ1ï¼‰padding å¡«å……æ•°æ®</p>
<p>ä½¿ç”¨numpyä¸­çš„padï¼Œå¡«å……è¿‡æ»¤å™¨çš„é•¿å®½ï¼Œå¡«å……å¤§å°ä¸ºpadï¼Œå½“ä¸æŒ‡å®šconstant_valueæ—¶ï¼Œè‡ªåŠ¨å¡«å……0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å°†è¾“å…¥çš„å›¾åƒï¼ŒæŒ‰ç…§æŒ‡å®šçš„paddingè¿›è¡Œå¡«å……</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zero_pad</span><span class="params">(X,pad)</span>:</span></span><br><span class="line">  X=np.pad(X,((<span class="number">0</span>,<span class="number">0</span>),(pad,pad),(pad,pad),(<span class="number">0</span>,<span class="number">0</span>)),<span class="string">'constant'</span>) <span class="comment">#ä¸æŒ‡å®šconstant_value,é»˜è®¤å¡«å……0</span></span><br><span class="line">  <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>1.å·ç§¯å±‚</p>
<p>1Â° è®¡ç®—éœ€è¦è¾“å‡ºçš„å›¾åƒZçš„ç»´åº¦ï¼Œå¹¶å¡«å……è¾“å…¥çš„å›¾åƒ</p>
<p>2Â° å¯¹æ¯ä¸ªè¾“å…¥çš„å›¾åƒï¼Œè®¡ç®—éœ€è¦å·ç§¯çš„åŒºåŸŸï¼š</p>
<p>h_start=h * stride<br>h_end=h_start+f_h<br>w_start=w * stride<br>w_end=w_start+f_w</p>
<p>æŒ‰ç…§å·ç§¯çš„åŒºåŸŸè®¡ç®—æ¯ä¸ªæ ·æœ¬çš„å·ç§¯å€¼</p>
<p>3Â° ä¿å­˜å·ç§¯å±‚çš„ä¸Šä¸€å±‚è¾“å…¥ï¼Œå½“å‰å±‚çš„æƒé‡å’Œè¶…å‚ï¼ˆåŒ…å«så’Œpadï¼‰ï¼Œä¿å­˜ä¸ºcache</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å·ç§¯å±‚çš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv_forward</span><span class="params">(A_pre,W,b,hparameters)</span>:</span></span><br><span class="line">  pad=hparameters[<span class="string">'pad'</span>]</span><br><span class="line">  stride=hparameters[<span class="string">'stride'</span>]</span><br><span class="line">  m,n_h_pre,n_w_pre,n_c_pre=A_pre.shape</span><br><span class="line">  f_h,f_w,n_c_pre,n_c=W.shape</span><br><span class="line"></span><br><span class="line">  <span class="comment">#å°†æ¯ä¸ªè¾“å…¥æ ·æœ¬è¿›è¡Œå¡«å……</span></span><br><span class="line">  A_pre_single=zero_pad(A_pre,pad)</span><br><span class="line"></span><br><span class="line">  <span class="comment">#è®¡ç®—è¾“å‡ºçš„ç»´åº¦</span></span><br><span class="line">  n_h=int(((n_h_pre+<span class="number">2</span>*pad-f_h)/stride)+<span class="number">1</span>)</span><br><span class="line">  n_w=int(((n_w_pre+<span class="number">2</span>*pad-f_w)/stride)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  Z=np.zeros((m,n_h,n_w,n_c))</span><br><span class="line"></span><br><span class="line">  <span class="comment">#å¯¹å¡«å……çš„æ ·æœ¬ä¸€ä¸€ç”¨è¿‡æ»¤å™¨å¤„ç†å¾—åˆ°ç»“æœ</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">    a_pre_single=A_pre_single[i]</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n_h):</span><br><span class="line">      <span class="keyword">for</span> w <span class="keyword">in</span> range(n_w):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n_c):</span><br><span class="line">          h_start=h*stride</span><br><span class="line">          h_end=h_start+f_h</span><br><span class="line">          w_start=w*stride</span><br><span class="line">          w_end=w_start+f_w</span><br><span class="line">          <span class="comment">#å°†å¯¹åº”é€šé“çš„çŸ©é˜µè¿›è¡Œä¸€æ¬¡å·ç§¯</span></span><br><span class="line">          	Z[i,h,w,c]=conv_single_step(a_pre_single[h_start:h_end,w_start:w_end,:],W[:,:,:,c],b[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,c])</span><br><span class="line">          <span class="comment">#æ¿€æ´»å€¼å¯ä»¥åœ¨è¿™é‡Œè®¡ç®—</span></span><br><span class="line">          <span class="comment">#....</span></span><br><span class="line"></span><br><span class="line">    cache=(A_pre,W,b,hparameters)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Z,cache</span><br></pre></td></tr></table></figure>

<p>2.æ± åŒ–å±‚</p>
<p>æ¥æ”¶å·ç§¯å±‚çš„è¾“å…¥ï¼ŒæŒ‰ç…§å·ç§¯æ–¹å¼ï¼Œåœ¨æŒ‡å®šåŒºåŸŸè¿›è¡Œå–æœ€å¤§å€¼æˆ–è€…å–å¹³å‡å€¼ï¼Œæœ€ç»ˆå¾—åˆ°Pè¾“å‡º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ± åŒ–å±‚å‰å‘ä¼ æ’­ A_preæ˜¯å·ç§¯ä¹‹åçš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pool_forward</span><span class="params">(A_pre,hparameters,pool=<span class="string">'max'</span>,pad=<span class="number">0</span>)</span>:</span></span><br><span class="line">  m,n_h_pre,n_w_pre,n_c_pre=A_pre.shape</span><br><span class="line"></span><br><span class="line">  f=hparameters[<span class="string">'f'</span>]</span><br><span class="line">  stride=hparameters[<span class="string">'stride'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#è®¡ç®—è¾“å‡ºçš„ç»´åº¦</span></span><br><span class="line">  n_h=int(((n_h_pre+<span class="number">2</span>*pad-f)/stride)+<span class="number">1</span>)</span><br><span class="line">  n_w=int(((n_w_pre+<span class="number">2</span>*pad-f)/stride)+<span class="number">1</span>)</span><br><span class="line">  n_c=n_c_pre</span><br><span class="line"></span><br><span class="line">  Z_pool=np.zeros((m,n_h,n_w,n_c))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n_h):</span><br><span class="line">      <span class="keyword">for</span> w <span class="keyword">in</span> range(n_w):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n_c):</span><br><span class="line">          h_start=h*stride</span><br><span class="line">          h_end=h_start+f</span><br><span class="line">          w_start=w*stride</span><br><span class="line">          w_end=w_start+f</span><br><span class="line">            <span class="comment">#æŒ‡å®šç¬¬iä¸ªæ ·æœ¬å’Œå…¶ç»´åº¦</span></span><br><span class="line">          a_single=A_pre[i,h_start:h_end,w_start:w_end,c]</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span>(pool==<span class="string">"max"</span>):</span><br><span class="line">            Z_pool[i,h,w,c]=np.max(a_single)</span><br><span class="line">          <span class="keyword">elif</span>(pool==<span class="string">"average"</span>):</span><br><span class="line">            Z_pool[i,h,w,c]=np.mean(a_single)</span><br><span class="line">  cache=(A_pre,hparameters)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Z_pool,cache</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰åå‘ä¼ æ’­ï¼ˆäº†è§£ï¼‰</p>
<p>1.å·ç§¯å±‚</p>
<p>åˆ©ç”¨å…¬å¼dA=W * DZï¼ŒdW= 1/m *(A_pre * dZ)ï¼Œdb=dZ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å·ç§¯å±‚åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv_backward</span><span class="params">(dZ,cache)</span>:</span></span><br><span class="line">  m,n_h,n_w,n_c=dZ.shape</span><br><span class="line">  A_pre,W,b,hparameters=cache</span><br><span class="line">  m,n_h_pre,n_w_pre,n_c_pre=A_pre.shape</span><br><span class="line">  f,f,n_c_pre,n_c=W.shape</span><br><span class="line"></span><br><span class="line">  pad=hparameters[<span class="string">'pad'</span>]</span><br><span class="line">  stride=hparameters[<span class="string">'stride'</span>]</span><br><span class="line"></span><br><span class="line">  dA_pre=np.zeros((m,n_h_pre,n_w_pre,n_c_pre))</span><br><span class="line">  dW=np.zeros((f,f,n_c_pre,n_c))</span><br><span class="line">  db=np.zeros((<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,n_c))</span><br><span class="line"></span><br><span class="line">  <span class="comment">#å¡«å……A</span></span><br><span class="line">  A_pre_pad=zero_pad(A_pre,pad)</span><br><span class="line">  dA_pre_pad=zero_pad(dA_pre,pad)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">    a_pre_single=A_pre_pad[i]</span><br><span class="line">    da_pre_single=dA_pre_pad[i]</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n_h):</span><br><span class="line">      <span class="keyword">for</span> w <span class="keyword">in</span> range(n_w):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n_c):</span><br><span class="line">          h_start=h*stride</span><br><span class="line">          h_end=h_start+f</span><br><span class="line">          w_start=w*stride</span><br><span class="line">          w_end=w_start+f</span><br><span class="line"></span><br><span class="line">          a_single=a_pre_single[h_start:h_end,w_start:w_end,:]</span><br><span class="line"></span><br><span class="line">          da_pre_single[h_start:h_end,w_start:w_end,:]+=W[:,:,:,c]*dZ[i,h,w,c]</span><br><span class="line"></span><br><span class="line">          dW[:,:,:,c]+=a_single*dZ[i,h,w,c]</span><br><span class="line">          db[:,:,:,c]+=dZ[i,h,w,c]</span><br><span class="line">    dA_pre[i,:,:,:]=da_pre_single[pad:-pad,pad:-pad,:]</span><br><span class="line">  grads=(dA_pre,dW,db)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> grads</span><br></pre></td></tr></table></figure>

<p>2.æ± åŒ–å±‚</p>
<p>æœ€å¤§æ± åŒ–ä½¿ç”¨æ©ç çŸ©é˜µæ ‡è®°æœ€å¤§å€¼ï¼Œå¾—åˆ°åœ¨æœ€å¤§å€¼ä½œç”¨ä¸‹çš„æ¢¯åº¦ï¼Œå¹³å‡æ± åŒ–æ˜¯æ ¹æ®å›¾åƒç»´åº¦è®¡ç®—å‡ºå¹³å‡å€¼ï¼Œå¾—åˆ°åœ¨å¹³å‡å€¼ä½œç”¨ä¸‹çš„æ¢¯åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ± åŒ–å±‚åå‘ä¼ æ’­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ€å¤§æ± åŒ–</span></span><br><span class="line"><span class="comment">#åˆ›å»ºçŸ©é˜µä¿å­˜æœ€å¤§å€¼æ‰€åœ¨çš„ä½ç½®ï¼Œå³åˆ›å»ºæ©ç çŸ©é˜µ</span></span><br><span class="line"><span class="comment">#ä¸ºäº†åå‘ä¼ æ’­çš„æ—¶å€™ï¼Œç”¨å€¼å®šä½åˆ°å·ç§¯å±‚ä¸­çš„ä½ç½®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_mask_from_window</span><span class="params">(x)</span>:</span></span><br><span class="line">  mask=(x==np.max(x))</span><br><span class="line">  <span class="keyword">return</span> mask</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¹³å‡æ± åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">distribute_value</span><span class="params">(dz,shape)</span>:</span></span><br><span class="line">  n_h,n_w=shape</span><br><span class="line">  average=dz/(n_h*n_w)</span><br><span class="line">  a=np.ones((shape))*average</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pool_backward</span><span class="params">(dA,cache,pool=<span class="string">"max"</span>)</span>:</span></span><br><span class="line">  A_pre,hparameters=cache</span><br><span class="line">  m,n_h,n_w,n_c=dA.shape</span><br><span class="line"></span><br><span class="line">  dA_pre=np.zeros_like(A_pre)</span><br><span class="line"></span><br><span class="line">  f=hparameters[<span class="string">'f'</span>]</span><br><span class="line">  stride=hparameters[<span class="string">'stride'</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(n_h):</span><br><span class="line">      <span class="keyword">for</span> w <span class="keyword">in</span> range(n_w):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n_c):</span><br><span class="line">          h_start=h*stride</span><br><span class="line">          h_end=h_start+f</span><br><span class="line">          w_start=w*stride</span><br><span class="line">          w_end=w_start+f</span><br><span class="line">          <span class="comment">#æŒ‡å®šç¬¬iä¸ªæ ·æœ¬å’Œå…¶ç»´åº¦</span></span><br><span class="line">          a_single=A_pre[i,h_start:h_end,w_start:w_end,c]</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span>(pool==<span class="string">"max"</span>):</span><br><span class="line">            mask=create_mask_from_window(a_single)</span><br><span class="line">            dA_pre[i,h_start:h_end,w_start:w_end,c]+=np.multiply(mask,dA[i,h,w,c])</span><br><span class="line">            </span><br><span class="line">          <span class="keyword">elif</span>(pool==<span class="string">"average"</span>):</span><br><span class="line">            shape=(f,f)</span><br><span class="line">            dA_pre[i,h_start:h_end,w_start:w_end,c]+=distribute_value(dA[i,h,w,c],shape)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> dA_pre</span><br></pre></td></tr></table></figure>

<h2 id="åº”ç”¨å®ä¾‹â€”â€”ä½¿ç”¨tensorflowæ¡†æ¶"><a href="#åº”ç”¨å®ä¾‹â€”â€”ä½¿ç”¨tensorflowæ¡†æ¶" class="headerlink" title="åº”ç”¨å®ä¾‹â€”â€”ä½¿ç”¨tensorflowæ¡†æ¶"></a>åº”ç”¨å®ä¾‹â€”â€”ä½¿ç”¨tensorflowæ¡†æ¶</h2><p>ï¼ˆ0ï¼‰å¯¼å…¥æ•°æ®</p>
<p>å¯¼å…¥h5æ–‡ä»¶ä¸‹çš„æ•°æ®é›†ï¼Œå¹¶è¿›è¡Œå½’ä¸€åŒ–</p>
<p>è¿™é‡Œè¾“å…¥æ•°æ®çš„æ ¼å¼æ˜¯ï¼ˆm,n_h,n_w,n_cï¼‰ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿®æ­£å¤§å°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†è¾“å…¥çš„æ ‡ç­¾è½¬æ¢ä¸ºç‹¬çƒ­çŸ©é˜µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_one_hot</span><span class="params">(Y,C)</span>:</span></span><br><span class="line">	<span class="comment">#Y.reshape(-1)è½¬æˆä¸€ç»´çš„</span></span><br><span class="line">	one_hot=np.eye(C)[Y.reshape(<span class="number">-1</span>)].T</span><br><span class="line">	<span class="keyword">return</span> one_hot</span><br><span class="line">train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes=cu.load_dataset()</span><br><span class="line">train_x=train_set_x_orig/<span class="number">255</span></span><br><span class="line">test_x=test_set_x_orig/<span class="number">255</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ1ï¼‰å»ºç«‹å ä½ç¬¦ï¼Œåˆå§‹åŒ–å‚æ•°</p>
<p>å› ä¸ºä¸ç¡®å®šè¾“å…¥å›¾ç‰‡çš„ä¸ªæ•°ï¼Œç¬¬ä¸€ä½è®¾ç½®ä¸ºnone</p>
<p>ä½¿ç”¨tfä¸‹çš„get_variableåˆå§‹åŒ–æƒé‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.åˆ›å»ºå ä½ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_placeholders</span><span class="params">(n_h,n_w,n_c,n_y)</span>:</span></span><br><span class="line">  <span class="comment">#mä¸ç¡®å®š</span></span><br><span class="line">  X=tf.placeholder(tf.float32,[<span class="literal">None</span>,n_h,n_w,n_c])</span><br><span class="line">  Y=tf.placeholder(tf.float32,[<span class="literal">None</span>,n_y])</span><br><span class="line">  <span class="keyword">return</span> X,Y</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.åˆå§‹åŒ–æƒé‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">()</span>:</span></span><br><span class="line">  n_h1,n_w1,n_c_pre1,n_c1=[<span class="number">4</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">8</span>] <span class="comment">#f*f*n_c_pre*n_c</span></span><br><span class="line">  n_h2,n_w2,n_c_pre2,n_c2=[<span class="number">2</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">16</span>]</span><br><span class="line">  tf.set_random_seed(<span class="number">1</span>)</span><br><span class="line">  W1=tf.get_variable(<span class="string">"W1"</span>,[n_h1,n_w1,n_c_pre1,n_c1],initializer=tf.contrib.layers.xavier_initializer(seed=<span class="number">0</span>))</span><br><span class="line">  W2=tf.get_variable(<span class="string">"W2"</span>,[n_h2,n_w2,n_c_pre2,n_c2],initializer=tf.contrib.layers.xavier_initializer(seed=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">  parameters=&#123;<span class="string">"W1"</span>:W1,<span class="string">"W2"</span>:W2&#125;</span><br><span class="line">  <span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>ä½¿ç”¨tf.nnä¸‹çš„conv2dã€reluã€max_poolå®ç°å·ç§¯å’Œæ± åŒ–ï¼Œå…¶ä¸­æ­¥é•¿[1,s,s,1]æ˜¯æŒ‡æŒ‡å¯¹äºè¾“å…¥ (m, n_H_prev, n_W_prev, n_C_prev)è€Œè¨€ï¼Œæ¯æ¬¡æ»‘åŠ¨çš„æ­¥ä¼ï¼Œå³é•¿å®½æ»‘åŠ¨sæ­¥ï¼ŒåŒç†æ± åŒ–ä¸­çš„ksizeçš„çª—å£å¤§å°ä¹Ÿæ˜¯å€¼é•¿å®½æ»‘åŠ¨çš„å¤§å°ã€‚</p>
<p>æœ€ç»ˆå¾—åˆ°ç»“æœä½¿ç”¨tf.contrib.layerä¸‹çš„flattenè¿›è¡Œæ‹‰ä¼¸ï¼Œæœ€åè°ƒç”¨fully_connectedè¾“å‡ºå…¨è¿æ¥å±‚çš„å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_propagation</span><span class="params">(X,parameters)</span>:</span></span><br><span class="line">  W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">  W2=parameters[<span class="string">'W2'</span>]</span><br><span class="line">  <span class="comment">#1.1å·ç§¯</span></span><br><span class="line">  <span class="comment">#[1,s,s,1]æ˜¯æŒ‡å¯¹äºè¾“å…¥ (m, n_H_prev, n_W_prev, n_C_prev)è€Œè¨€ï¼Œæ¯æ¬¡æ»‘åŠ¨çš„æ­¥ä¼</span></span><br><span class="line">  <span class="comment">#æ­¥é•¿1ï¼ŒæŒ‡å®šå¡«å……æ–¹å¼</span></span><br><span class="line">  Z1=tf.nn.conv2d(X,W1,strides=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],padding=<span class="string">"SAME"</span>)</span><br><span class="line">  A1=tf.nn.relu(Z1)</span><br><span class="line">  <span class="comment">#1.2æ± åŒ–</span></span><br><span class="line">  <span class="comment">#çª—å£å¤§å°8*8ï¼Œæ­¥é•¿8</span></span><br><span class="line">  P1=tf.nn.max_pool(A1,ksize=[<span class="number">1</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">1</span>],strides=[<span class="number">1</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">1</span>],padding=<span class="string">"SAME"</span>)</span><br><span class="line"></span><br><span class="line">  Z2=tf.nn.conv2d(P1,W2,strides=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],padding=<span class="string">"SAME"</span>)</span><br><span class="line">  A2=tf.nn.relu(Z2)</span><br><span class="line">  P2=tf.nn.max_pool(A2,ksize=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">1</span>],strides=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">1</span>],padding=<span class="string">"SAME"</span>)</span><br><span class="line"></span><br><span class="line">  P3=tf.contrib.layers.flatten(P2)</span><br><span class="line">  <span class="comment">#6æ˜¯è¾“å‡ºçš„ç»´åº¦</span></span><br><span class="line">  Z3=tf.contrib.layers.fully_connected(P3,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Z3</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰è®¡ç®—æŸå¤±</p>
<p>è°ƒç”¨tf.nnä¸‹è®¡ç®—softmaxçš„äº¤å‰ç†µæ¨¡å‹ï¼Œè¾“å…¥çš„æ•°æ®ç»´åº¦æ˜¯ï¼ˆæ•°æ®é›†å¤§å°ï¼Œåˆ†å¸ƒï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#4.è®¡ç®—æˆæœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(Z3,Y)</span>:</span></span><br><span class="line">  <span class="comment">#å‚æ•°ç»´åº¦[æ•°æ®é›†å¤§å°ï¼Œåˆ†å¸ƒ]-&gt;logits,labels</span></span><br><span class="line">  cost=tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(logits=Z3,labels=Y))</span><br><span class="line">  <span class="keyword">return</span> cost</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰åå‘ä¼ æ’­</p>
<p>ä½¿ç”¨tfã€‚trainä¸‹çš„adamå‡½æ•°</p>
<p>optimizer=tf.train.AdamOptimizer(learning_rate).minimize(cost)</p>
<p>ï¼ˆ5ï¼‰å»ºç«‹ä¼šè¯ï¼Œå¯¼å…¥æ•°æ®</p>
<p>1Â° é‡ç°å»ºç«‹æ¨¡å‹è€Œä¸è¦†ç›–tfå˜é‡ï¼šops.reset_default_graph()</p>
<p>2Â° æ„å»ºå ä½ç¬¦ï¼Œåˆå§‹åŒ–å‚æ•°ï¼Œå‰å‘ä¼ æ’­ï¼Œè®¡ç®—æˆæœ¬ï¼Œåå‘ä¼ æ’­</p>
<p>3Â° åˆ›å»ºä¼šè¯ï¼Œå¯¹æ¯ä¸ªæ‰¹é‡è®¡ç®—å…¶æŸå¤±</p>
<p>4Â° ä¿å­˜æ¨¡å‹çš„å‚æ•°ï¼Œå°†å¾—åˆ°çš„ç»“æœä½¿ç”¨tfä¸‹çš„argmaxå¾—åˆ°æœ€å¤§å€¼å’ŒçœŸå®å€¼æ¯”è¾ƒï¼Œå¹¶è®¡ç®—å…¶å‡†ç¡®åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#5.æ„å»ºæ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(X_train,Y_train,X_test,Y_test,num_ecpom=<span class="number">50</span>,learning_rate=<span class="number">0.001</span>,mini_batches_size=<span class="number">64</span>)</span>:</span></span><br><span class="line">  <span class="comment">#é‡æ–°è¿è¡Œæ¨¡å‹ä¸è¦†ç›–tfå˜é‡</span></span><br><span class="line">  ops.reset_default_graph()</span><br><span class="line">  tf.set_random_seed(<span class="number">1</span>)</span><br><span class="line">  seed=<span class="number">3</span></span><br><span class="line">  costs=[]</span><br><span class="line">  m,n_h,n_w,n_c=X_train.shape</span><br><span class="line">  m,n_y=Y_train.shape</span><br><span class="line"></span><br><span class="line">  X,Y=create_placeholders(n_h,n_w,n_c,n_y)</span><br><span class="line"></span><br><span class="line">  parameters=initialize_parameters()</span><br><span class="line"></span><br><span class="line">  Z3=forward_propagation(X,parameters)</span><br><span class="line"></span><br><span class="line">  cost=compute_cost(Z3,Y)</span><br><span class="line"></span><br><span class="line">  optimizer=tf.train.AdamOptimizer(learning_rate).minimize(cost)</span><br><span class="line"></span><br><span class="line">  <span class="comment">#åˆ›å»ºä¼šè¯ï¼Œå¯¼å…¥è®­ç»ƒé›†æ•°æ®</span></span><br><span class="line">  init=tf.global_variables_initializer()</span><br><span class="line">  session=tf.Session()</span><br><span class="line">  session.run(init)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(num_ecpom):</span><br><span class="line">    <span class="comment">#æŒ‰ç…§å°æ‰¹é‡æ¢¯åº¦ä¸‹é™</span></span><br><span class="line">    mini_batches=cu.random_mini_batches(X_train,Y_train,mini_batches_size,seed)</span><br><span class="line">    <span class="comment">#æ¯ä¸ªæ•°æ®å—çš„å¤§å°-&gt;å¾—åˆ°åœ¨è¯¥æ•°æ®å—ä¸Šçš„é”™è¯¯ç‡</span></span><br><span class="line">    num_mini_batch=int(m/mini_batches_size)</span><br><span class="line">    mini_batch_cost=<span class="number">0</span></span><br><span class="line">    seed=seed+<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> mini_batch <span class="keyword">in</span> mini_batches:</span><br><span class="line">      mini_batch_x,mini_batch_y=mini_batch</span><br><span class="line">      _,ecpom_cost=session.run([optimizer,cost],feed_dict=&#123;X:X_train,Y:Y_train&#125;)</span><br><span class="line">      mini_batch_cost=mini_batch_cost+ecpom_cost/num_mini_batch</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">      costs.append(mini_batch_cost)</span><br><span class="line">      <span class="keyword">if</span> i%<span class="number">5</span>==<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"ç¬¬"</span>+str(i)+<span class="string">"æ¬¡ï¼Œcost:"</span>+str(mini_batch_cost))</span><br><span class="line">  plt.plot(costs)</span><br><span class="line">  plt.title(<span class="string">"learning_rate="</span>+str(learning_rate))</span><br><span class="line">  plt.xlabel(<span class="string">"iteration"</span>)</span><br><span class="line">  plt.ylabel(<span class="string">"cost"</span>)</span><br><span class="line">  plt.show()</span><br><span class="line"></span><br><span class="line">  <span class="comment">#ä¿å­˜å¾—åˆ°çš„å‚æ•°</span></span><br><span class="line">  parameters=session.run(parameters)</span><br><span class="line">  print(<span class="string">"å‚æ•°å·²ç»ä¿å­˜è‡³sessionä¸­"</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">#è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">  <span class="comment">#å–ä¸€è¡Œä¸­æœ€å¤§çš„é‚£ä¸ª</span></span><br><span class="line">  <span class="comment">#predict=tf.argmax(Z3,1)</span></span><br><span class="line">  predict_matrix=tf.equal(tf.argmax(Z3,<span class="number">1</span>),tf.argmax(Y,<span class="number">1</span>))</span><br><span class="line">  accuary=tf.reduce_mean(tf.cast(predict_matrix,<span class="string">"float32"</span>))</span><br><span class="line"></span><br><span class="line">  print(<span class="string">"è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š"</span>,session.run(accuary,&#123;X:X_train,Y:Y_train&#125;))</span><br><span class="line">  print(<span class="string">"æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š"</span>,session.run(accuary,&#123;X:X_test,Y:Y_test&#125;))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200527180218.jpg" alt></p>
<p>è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š 0.8074074<br>æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š 0.7416667</p>
<p>å®éªŒä¸­é€‰æ‹©è¿­ä»£50æ¬¡ï¼Œå­¦ä¹ ç‡ä¸º0.001ï¼Œä¸ºå–å¾—æ›´å¥½çš„ç»“æœï¼Œå¯ä»¥å°†è¿­ä»£æ¬¡æ•°å¢åŠ æˆ–è€…ä¿®æ”¹å­¦ä¹ ç‡</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å·ç§¯ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å›¾åƒæ•°æ®é›†ï¼šå°†æœ¬åœ°å›¾ç‰‡æ‰¹é‡å†™å…¥h5æ–‡ä»¶</title>
    <url>/blogs/imgToH5/</url>
    <content><![CDATA[<h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>å½“éœ€è¦ç”¨å¤§é‡å›¾ç‰‡è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œä¿å­˜ä¸ºå›¾åƒæ ¼å¼çš„å›¾ç‰‡æ‰€å çš„å†…å­˜å¤§ï¼Œå› æ­¤å°†æœ¬åœ°å›¾ç‰‡å­˜å…¥h5æ–‡ä»¶ä¸­å‡å°‘æ•°æ®é›†æ‰€å å†…å­˜ã€‚</p><p>ä½¿ç”¨æ‰‹æœºæ‹æ‘„å‰ªåˆ€ã€çŸ³å¤´ã€å¸ƒå…±ä¸‰ç»„å›¾ç‰‡ï¼Œæ¯ç»„å›¾ç‰‡å››å¼ ï¼Œå…±12å¼ å›¾åƒï¼Œé€‰æ‹©11å¼ ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä½™çš„ä½œä¸ºæµ‹è¯•é›†ã€‚</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>ï¼ˆ1ï¼‰è¯»å–æœ¬åœ°å›¾ç‰‡å¹¶å°†æ•°æ®æ‰“ä¹±</p><p>1Â° è¯»å–æ–‡ä»¶ï¼šä½¿ç”¨osçš„listdirå‡½æ•°è¯»å–ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼šè¿™é‡Œè¯»å–å¹¶å­˜å‚¨çš„çš„æ˜¯æœ¬åœ°å›¾åƒçš„è·¯å¾„ï¼ŒåŒæ—¶å°†å›¾ç‰‡çš„æ ‡ç­¾è¿›è¡Œå­˜å‚¨</p><a id="more"></a>



<p>2Â° åˆå¹¶å›¾åƒå’Œæ ‡ç­¾ï¼šä½¿ç”¨numpyä¸‹çš„hstackå°†ä¸åŒæ ‡ç­¾çš„å›¾åƒæ•°æ®è¿›è¡Œå †å ä¿å­˜ï¼Œå¹¶åˆå¹¶</p>
<p>3Â° æ‰“ä¹±æ•°æ®é›†ï¼šä½¿ç”¨numpy.randomä¸‹çš„shuffleæ‰“ä¹±æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_files</span><span class="params">(file_dir)</span>:</span></span><br><span class="line">	stone=[]</span><br><span class="line">	label_stone=[]</span><br><span class="line">	cut=[]</span><br><span class="line">	label_cut=[]</span><br><span class="line">	cloth=[]</span><br><span class="line">	label_cloth=[]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è¯»å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶</span></span><br><span class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(file_dir+<span class="string">'/stone'</span>):</span><br><span class="line">		stone.append(file_dir+<span class="string">'/stone/'</span>+file)</span><br><span class="line">		label_stone.append(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(file_dir+<span class="string">'/cut'</span>):</span><br><span class="line">		cut.append(file_dir+<span class="string">'/cut/'</span>+file)</span><br><span class="line">		label_cut.append(<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(file_dir+<span class="string">'/cloth'</span>):</span><br><span class="line">		cloth.append(file_dir+<span class="string">'/cloth/'</span>+file)</span><br><span class="line">		label_cloth.append(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å°†æ•°æ®é›†åˆå¹¶</span></span><br><span class="line">	merge_x=np.hstack((stone,cut,cloth))</span><br><span class="line">	merge_y=np.hstack((label_stone,label_cut,label_cloth))</span><br><span class="line">	merge=np.array([merge_x,merge_y]).T</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ‰“ä¹±æ•°æ®é›†</span></span><br><span class="line">	np.random.shuffle(merge)</span><br><span class="line"></span><br><span class="line">	image_list=merge[:,<span class="number">0</span>]</span><br><span class="line">	label_list=merge[:,<span class="number">1</span>]</span><br><span class="line">	<span class="comment">#å°†æ ‡ç­¾åŒ–ä¸ºæ•´å‹æ•°æ®</span></span><br><span class="line">	label_list=[int(i) <span class="keyword">for</span> i <span class="keyword">in</span> label_list]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> image_list,label_list</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</p>
<p>1Â° éšæœºåˆå§‹åŒ–ï¼šè®¾ç½®å››ä¸ªæ•°ç»„åˆ†åˆ«ä¿å­˜è®­ç»ƒé›†å’Œæµ‹è¯•é›†æ•°æ®</p>
<p>è¿™é‡Œéœ€è¦å°†æ•°ç»„çš„ç±»å‹ä½¿ç”¨astypeè½¬æ¢ä¸ºintï¼Œå› ä¸ºMatplotlibæ˜¾ç¤ºå›¾åƒï¼Œå¦‚æœæ˜¯0-1åŒºé—´ï¼Œå€¼ä¸ºfloatï¼Œå¦‚æœæ˜¯0-255åŒºé—´ï¼Œå€¼ä¸ºintï¼Œéœ€è¦è½¬æ¢ï¼Œå¦åˆ™æ— æ³•æ˜¾ç¤ºï¼Œç©ºç™½å›¾åƒï¼ŒæŠ¥é”™ï¼šClipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).</p>
<p>è¿™é‡Œçš„å›¾åƒå€¼åœ¨0-255ä¹‹é—´ï¼Œæ‰€ä»¥éœ€è¦è½¬æ¢ä¸ºint.</p>
<p>2Â° æŒ‰æ¯”ä¾‹åˆ’åˆ†æ•°æ®</p>
<p>è¾“å…¥çš„å›¾ç‰‡å¯èƒ½å¤§å°ä¸ä¸€æ ·ï¼Œä½¿ç”¨PILä¸­çš„Imageä¸­çš„resizeè½¬æ¢å›¾åƒåˆ°åˆé€‚çš„å¤§å°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3ä¸ªè®­ç»ƒï¼Œ1ä¸ªæµ‹è¯•</span></span><br><span class="line">num_px=<span class="number">64</span></span><br><span class="line">train_x=np.random.rand(m<span class="number">-1</span>,num_px,num_px,<span class="number">3</span>).astype(<span class="string">'int'</span>)</span><br><span class="line">train_y=np.random.rand(m<span class="number">-1</span>,<span class="number">1</span>).astype(<span class="string">'int'</span>)</span><br><span class="line">test_x=np.random.rand(<span class="number">1</span>,num_px,num_px,<span class="number">3</span>).astype(<span class="string">'int'</span>)</span><br><span class="line">test_y=np.random.rand(<span class="number">1</span>,<span class="number">1</span>).astype(<span class="string">'int'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(m<span class="number">-1</span>):</span><br><span class="line">	image=image_list[i]</span><br><span class="line">	image_convert=Image.open(image).convert(<span class="string">'RGB'</span>).resize((num_px,num_px))</span><br><span class="line">	train_x[i]=np.array(image_convert)</span><br><span class="line">	train_y[i]=np.array(label_list[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(m<span class="number">-1</span>,m):</span><br><span class="line">	image=image_list[i]</span><br><span class="line">	image_convert=Image.open(image).convert(<span class="string">'RGB'</span>).resize((num_px,num_px))</span><br><span class="line">	test_x[i+<span class="number">1</span>-m]=np.array(image_convert)</span><br><span class="line">	test_y[i+<span class="number">1</span>-m]=np.array(label_list[i])</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å°†å›¾åƒæ•°æ®å†™å…¥h5æ–‡ä»¶å¹¶æµ‹è¯•</p>
<p>ä½¿ç”¨create_datasetå°†æ•°æ®æŒ‰ç…§å¯¹åº”åç§°å­˜å‚¨ï¼Œæœ€åä»¥åªè¯»æ–¹å¼è¯»å–h5å¯¹åº”åç§°ä¸­çš„å›¾åƒæ•°æ®ï¼Œç”¨pltæ–¹æ³•æ˜¾ç¤ºæŒ‡å®šå›¾ç‰‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†å›¾åƒå†™å…¥h5æ–‡ä»¶</span></span><br><span class="line">f=h5py.File(<span class="string">'data.h5'</span>,<span class="string">'w'</span>)</span><br><span class="line">f.create_dataset(<span class="string">'X_train'</span>,data=train_x)</span><br><span class="line">f.create_dataset(<span class="string">'y_train'</span>,data=train_y)</span><br><span class="line">f.create_dataset(<span class="string">'X_test'</span>,data=test_x)</span><br><span class="line">f.create_dataset(<span class="string">'y_test'</span>,data=test_y)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dataset</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="comment">#è¯»å–h5æ–‡ä»¶ä¸­çš„å›¾åƒ</span></span><br><span class="line">	dataset=h5py.File(<span class="string">'data.h5'</span>,<span class="string">'r'</span>)</span><br><span class="line">	my_train_x=np.array(dataset[<span class="string">'X_train'</span>][:])</span><br><span class="line">	my_train_y=np.array(dataset[<span class="string">'y_train'</span>][:])</span><br><span class="line">	my_test_x=np.array(dataset[<span class="string">'X_test'</span>][:])</span><br><span class="line">	my_test_y=np.array(dataset[<span class="string">'y_test'</span>][:])</span><br><span class="line">	<span class="keyword">return</span> my_train_x,my_train_y,my_test_x,my_test_y</span><br><span class="line"></span><br><span class="line">my_train_x,my_train_y,my_test_x,my_test_y=load_dataset()</span><br><span class="line">print(my_train_x.shape)</span><br><span class="line">print(my_train_y.shape)</span><br><span class="line">print(my_test_x.shape)</span><br><span class="line">print(my_test_y.shape)</span><br><span class="line">index=<span class="number">1</span></span><br><span class="line">plt.imshow(my_train_x[index])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p>ï¼ˆ1ï¼‰å°†å›¾åƒä¿å­˜ä¸ºh5æ–‡ä»¶å</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200527212520.png" alt></p>
<p>å¯è§ï¼ŒåŸå›¾åƒå¤§å°58.5MBï¼Œä¿å­˜ä¸ºh5æ–‡ä»¶ååªæœ‰1.5MBï¼Œæ˜æ˜¾æ‰€å å†…å­˜å‡å°‘äº†</p>
<p>ï¼ˆ2ï¼‰æŒ‡å®šæŸ¥çœ‹ç¬¬ä¸€ä¸ªå›¾åƒæ˜¾ç¤ºå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200527212728.png" alt></p>
<p>ï¼ˆ3ï¼‰è®­ç»ƒé›†å’Œæµ‹è¯•é›†ç»´åº¦ä¸ºï¼š</p>
<p>(11, 64, 64, 3)<br>(11, 1)<br>(1, 64, 64, 3)<br>(1, 1)</p>
<p>å‚è€ƒï¼š</p>
<p><a href="https://blog.csdn.net/chenkz123/article/details/79640658" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/chenkz123/article/details/79640658</a></p>
<p><a href="https://blog.csdn.net/weixin_43615222/article/details/84577293" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/weixin_43615222/article/details/84577293</a></p>
<p><a href="https://www.jianshu.com/p/778d78463028" target="_blank" rel="external nofollow noopener noreferrer">https://www.jianshu.com/p/778d78463028</a></p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›®â€”â€”ç¬¬äºŒå‘¨å­¦ä¹ ç¬”è®°</title>
    <url>/blogs/struLearning2/</url>
    <content><![CDATA[<h2 id="è¯¯å·®åˆ†æ"><a href="#è¯¯å·®åˆ†æ" class="headerlink" title="è¯¯å·®åˆ†æ"></a>è¯¯å·®åˆ†æ</h2><h3 id="å¦‚ä½•è¿›è¯¯å·®åˆ†æ"><a href="#å¦‚ä½•è¿›è¯¯å·®åˆ†æ" class="headerlink" title="å¦‚ä½•è¿›è¯¯å·®åˆ†æ"></a>å¦‚ä½•è¿›è¯¯å·®åˆ†æ</h3><p>å½“éœ€è¦æé«˜ç³»ç»Ÿçš„æ­£ç¡®ç‡æ—¶ï¼Œéœ€è¦ä¸€ä¸€çœ‹å‘ç”Ÿé”™è¯¯çš„æ ·æœ¬å¹¶è¿›è¡Œè®°å½•ï¼ˆä¸»è¦æ˜¯çœ‹å‡é˜³å’Œå‡é˜´æ ·æœ¬ï¼‰ï¼Œåˆ—æˆå¦‚ä¸‹çš„è¡¨æ ¼ï¼Œçºµå‘ä»£è¡¨æ¯ä¸ªå‡ºé”™çš„æ ·æœ¬ï¼Œæ¨ªå‘ä»£è¡¨å‡ºé”™çš„ç±»å‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200525102748.png" alt></p><p><strong>æœ€åä¸€è¡Œè®°å½•æ¯ä¸ªé”™è¯¯ç±»å‹çš„ç™¾åˆ†æ¯”ï¼Œæ ¹æ®ç™¾åˆ†æ¯”ç¡®å®šä¸åŒé”™è¯¯ç±»å‹å¯¹é”™è¯¯ç‡çš„å½±å“ï¼Œé€‰æ‹©å½±å“å¤§çš„ä½œä¸ºåç»­ç³»ç»Ÿæ”¹è¿›çš„æ–¹å‘ã€‚</strong></p><p>æ³¨ï¼šå¯ä»¥å°†ç™¾åˆ†æ¯”ç†è§£ä¸ºæ˜¯ç¡®å®šæ¯ä¸ªé”™è¯¯ç±»å‹çš„ä¼˜å…ˆçº§é¡ºåºï¼ŒåŒæ—¶è¦è€ƒè™‘è§£å†³é”™è¯¯ç±»å‹çš„éš¾æ˜“åº¦ï¼Œå³æ·»åŠ æ•°æ®çš„éš¾æ˜“åº¦ï¼Œè·å–éš¾å¯ä»¥é‡‡ç”¨äººå·¥åˆæˆæ•°æ®</p><a id="more"></a>



<h3 id="å¯¹æ ‡è®°é”™è¯¯çš„ä¾‹å­å¦‚ä½•å¤„ç†"><a href="#å¯¹æ ‡è®°é”™è¯¯çš„ä¾‹å­å¦‚ä½•å¤„ç†" class="headerlink" title="å¯¹æ ‡è®°é”™è¯¯çš„ä¾‹å­å¦‚ä½•å¤„ç†"></a>å¯¹æ ‡è®°é”™è¯¯çš„ä¾‹å­å¦‚ä½•å¤„ç†</h3><p>åœ¨è¯¯å·®åˆ†æä¹‹åï¼Œæœ‰äº›é”™è¯¯æ ·æœ¬å¯èƒ½æ˜¯åˆå§‹æ ‡è®°çš„æ—¶å€™å‘ç”Ÿäº†é”™è¯¯ï¼Œè¿™æ—¶å€™åˆ†ç±»å¤„ç†ï¼š</p>
<p>ï¼ˆ1ï¼‰å¦‚æœæ˜¯è®­ç»ƒé›†ä¸­åŸå§‹æ ‡è®°é”™è¯¯ï¼Œå½“è®­ç»ƒé›†è¶³å¤Ÿå¤§ï¼Œå¯ä»¥å¿½ç•¥é”™è¯¯ï¼Œä¸è¿›è¡Œæ”¹æ­£</p>
<p>ï¼ˆ2ï¼‰å¦‚æœæ˜¯å¼€å‘é›†æˆ–è€…æµ‹è¯•é›†ï¼Œå°±éœ€è¦æŸ¥çœ‹åŸå§‹æ ‡è®°é”™è¯¯çš„ç™¾åˆ†æ¯”æ˜¯å¦å¾ˆå¤§ï¼Œå³æ˜¯å¦ä¸¥é‡å½±å“äº†ç³»ç»Ÿçš„æ­£ç¡®ç‡ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™éœ€è¦ä¿®æ­£ï¼Œåä¹‹ä¸éœ€è¦ã€‚</p>
<h2 id="å¿«é€Ÿæ­å»ºè‡ªå·±çš„ç³»ç»Ÿ"><a href="#å¿«é€Ÿæ­å»ºè‡ªå·±çš„ç³»ç»Ÿ" class="headerlink" title="å¿«é€Ÿæ­å»ºè‡ªå·±çš„ç³»ç»Ÿ"></a>å¿«é€Ÿæ­å»ºè‡ªå·±çš„ç³»ç»Ÿ</h2><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p>ï¼ˆ1ï¼‰ç¡®å®š<strong>ç›®æ ‡</strong>ï¼ˆåç»­å‡ºç°é—®é¢˜ä¹Ÿå¯ä¿®æ”¹ï¼‰ï¼šç¡®å®šå¼€å‘é›†ã€æµ‹è¯•é›†å’Œè¡¡é‡ç®—æ³•çš„å•ä¸€å®æ•°æŒ‡æ ‡</p>
<p>ï¼ˆ2ï¼‰æ­å»ºä¸€ä¸ªæœºå™¨å­¦ä¹ ç³»ç»Ÿ<strong>åŸå‹</strong>ï¼šåœ¨è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒçœ‹æ•ˆæœï¼Œåœ¨å¼€å‘é›†ã€æµ‹è¯•é›†ä¸Šæµ‹è¯•çœ‹è¡¨ç°</p>
<p>ï¼ˆ3ï¼‰ç”¨<strong>åå·®</strong>å’Œ<strong>æ–¹å·®</strong>åˆ†æï¼Œç¡®å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆï¼Œè¿›è¡Œ<strong>è¯¯å·®åˆ†æ</strong>ï¼Œäº†è§£å¤§éƒ¨åˆ†å‡ºé”™çš„æ ·æœ¬æ˜¯ä»€ä¹ˆï¼Œæé«˜ç³»ç»Ÿæ­£ç¡®ç‡</p>
<h3 id="æ•°æ®ä¸å¤Ÿå¦‚ä½•å¤„ç†"><a href="#æ•°æ®ä¸å¤Ÿå¦‚ä½•å¤„ç†" class="headerlink" title="æ•°æ®ä¸å¤Ÿå¦‚ä½•å¤„ç†"></a>æ•°æ®ä¸å¤Ÿå¦‚ä½•å¤„ç†</h3><p>å½“çœŸæ­£å…³å¿ƒçš„æ•°æ®æ¯”è¾ƒå°‘ï¼Œå‡è®¾åªæœ‰10000æ¡ï¼ŒéçœŸæ­£å…³å¿ƒçš„æ•°æ®æœ‰500000æ¡ï¼Œå¦‚ä½•åˆ†é…è®­ç»ƒé›†ã€å¼€å‘é›†ã€æµ‹è¯•é›†ï¼š</p>
<p>æ ¹æ®â€œ<u>ç„å‡†éœ€è¦å¤„ç†çš„ç›®æ ‡å³çœŸæ­£å…³ç³»çš„æ•°æ®</u>â€çš„åŸåˆ™åˆ’åˆ†æ•°æ®é›†ï¼Œä¿è¯å¼€å‘é›†å’Œæµ‹è¯•é›†æ•°æ®æ¥è‡ªåŒåˆ†å¸ƒ</p>
<p>ï¼ˆ1ï¼‰é€‰æ‹©1ï¼š500000æ¡ä½œä¸ºè®­ç»ƒé›†ï¼ŒçœŸæ­£å…³ç³»çš„æ•°æ®ä¸­5000æ¡ä½œä¸ºå¼€å‘é›†ï¼Œ5000æ¡ä½œä¸ºæµ‹è¯•é›†</p>
<p>ï¼ˆ2ï¼‰é€‰æ‹©2ï¼š500000æ¡+çœŸæ­£å…³å¿ƒæ•°æ®ä¸­5000æ¡=505000æ¡ä½œä¸ºè®­ç»ƒé›†ï¼ŒçœŸæ­£å…³å¿ƒçš„æ•°æ®ä¸­2500æ¡ä½œä¸ºå¼€å‘é›†ï¼Œ2500æ¡ä½œä¸ºæµ‹è¯•é›†</p>
<h3 id="æ•°æ®ä¸åŒ¹é…å¦‚ä½•å¤„ç†"><a href="#æ•°æ®ä¸åŒ¹é…å¦‚ä½•å¤„ç†" class="headerlink" title="æ•°æ®ä¸åŒ¹é…å¦‚ä½•å¤„ç†"></a>æ•°æ®ä¸åŒ¹é…å¦‚ä½•å¤„ç†</h3><p>å½“æŒ‰ç…§æ•°æ®ä¸å¤Ÿçš„å¤„ç†åŸåˆ™å¤„ç†åå³æ•°æ®ä¸åŒ¹é…çš„ç³»ç»Ÿçš„æ–¹å·®åå·®åˆ†æï¼š</p>
<p>ç”±äºè®­ç»ƒé›†å’Œå¼€å‘é›†æ•°æ®ä¸åŒåˆ†å¸ƒï¼Œä¸ºäº†äº†è§£è®­ç»ƒé›†ä¸Šçš„æ¨¡å‹çš„æ¨å¹¿ç¨‹åº¦ï¼ˆå³æ–¹å·®ï¼‰ï¼Œä»åŸå§‹æ•°æ®ä¸­å–ä¸€éƒ¨åˆ†ä½œç‰©è®­ç»ƒâ€”å¼€å‘é›†ï¼Œæ¥è¡¡é‡æ–¹å·®çš„å€¼ã€‚ï¼ˆè®¾å®š500000æ¡ä½œä¸ºè®­ç»ƒé›†ï¼ŒçœŸæ­£å…³ç³»çš„æ•°æ®ä¸­5000æ¡ä½œä¸ºå¼€å‘é›†ï¼Œ5000æ¡ä½œä¸ºæµ‹è¯•é›†ï¼‰</p>
<table>
<thead>
<tr>
<th>è¯¯å·®ç±»å‹</th>
<th>è¯¯å·®</th>
<th>æ•°æ®é‡</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>äººç±»è¡¨ç°ï¼ˆå³è´å¶æ–¯è¯¯å·®ï¼‰</td>
<td>/</td>
</tr>
<tr>
<td>2</td>
<td>è®­ç»ƒé›†è¯¯å·®</td>
<td>495000ï¼ˆåœ¨è¯¥æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼‰</td>
</tr>
<tr>
<td>3</td>
<td>è®­ç»ƒâ€”å¼€å‘é›†è¯¯å·®</td>
<td>5000ï¼ˆè¯¥æ•°æ®ä¸Šä¸è¿›è¡Œè®­ç»ƒï¼‰</td>
</tr>
<tr>
<td>4</td>
<td>å¼€å‘é›†è¯¯å·®</td>
<td>5000</td>
</tr>
<tr>
<td>5</td>
<td>è®­ç»ƒé›†è¯¯å·®</td>
<td>5000</td>
</tr>
</tbody></table>
<p>ï¼ˆ1ï¼‰1ï¼Œ2ä¹‹é—´æ˜¯å¯é¿å…è¯¯å·®ï¼Œæªæ–½ï¼šè®­ç»ƒæ›´å¤§çš„ç½‘ç»œæˆ–è€…è®­ç»ƒæ—¶é—´æ›´é•¿</p>
<p>ï¼ˆ2ï¼‰2ï¼Œ3ä¹‹é—´æ˜¯æ–¹å·®ï¼Œæªæ–½ï¼šæ­£åˆ™åŒ–æˆ–è€…è·å–æ›´å¤šçš„è®­ç»ƒé›†æ•°æ®</p>
<p>ï¼ˆ3ï¼‰3ï¼Œ4ä¹‹é—´æ˜¯æ•°æ®ä¸åŒ¹é…ï¼Œæªæ–½ï¼šäººå·¥åˆæˆæ•°æ®</p>
<p>å¿«é€Ÿåˆ¶é€ æ›´å¤šè®­ç»ƒæ•°æ®ï¼Œä¾‹å¦‚è¯­éŸ³è¯†åˆ«ï¼Œç”¨å¤§é‡æ¸…æ™°æ•°æ®+å™ªéŸ³æ•°æ®åˆ¶é€ å‡ºå…³å¿ƒçš„æ•°æ®ï¼šåœ¨å™ªéŸ³ä¸‹è¯´è¯çš„å£°éŸ³ã€‚</p>
<p>ç¼ºç‚¹ï¼šå½“å™ªéŸ³æ•°æ®è¿‡å°ï¼Œå®¹æ˜“å¯¹å½“å‰å™ªéŸ³æ•°æ®è¿‡æ‹Ÿåˆã€‚</p>
<p>ï¼ˆ4ï¼‰4ï¼Œ5ä¹‹é—´æ˜¯å¯¹å¼€å‘é›†è¿‡æ‹Ÿåˆç¨‹åº¦ï¼Œæªæ–½ï¼šéœ€è¦æ›´å¤§çš„å¼€å‘é›†æˆ–è€…å¼€å‘é›†æ•°æ®æ›´å¤šäº›</p>
<h2 id="è¿ç§»å­¦ä¹ å’Œå¤šä»»åŠ¡å­¦ä¹ "><a href="#è¿ç§»å­¦ä¹ å’Œå¤šä»»åŠ¡å­¦ä¹ " class="headerlink" title="è¿ç§»å­¦ä¹ å’Œå¤šä»»åŠ¡å­¦ä¹ "></a>è¿ç§»å­¦ä¹ å’Œå¤šä»»åŠ¡å­¦ä¹ </h2><h3 id="è¿ç§»å­¦ä¹ â€”â€”ä¸²è¡Œ"><a href="#è¿ç§»å­¦ä¹ â€”â€”ä¸²è¡Œ" class="headerlink" title="è¿ç§»å­¦ä¹ â€”â€”ä¸²è¡Œ"></a>è¿ç§»å­¦ä¹ â€”â€”ä¸²è¡Œ</h3><p>ç¥ç»ç½‘ç»œä»ä¸€ä¸ªä»»åŠ¡ä¸­å­¦ä¹ åˆ°çŸ¥è¯†ï¼Œå¹¶å°†è¿™äº›çŸ¥è¯†åº”ç”¨åˆ°å…¶ä»–ä»»åŠ¡ä¸­å«åšè¿ç§»å­¦ä¹ ã€‚</p>
<h4 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h4><p>A-&gt;Bï¼ˆå°†Aä»»åŠ¡ä¸­çŸ¥è¯†è¿ç§»åˆ°Bä»»åŠ¡ä¸­ï¼‰</p>
<p>ï¼ˆ1ï¼‰Açš„æ•°æ®é‡æ¯”Bå¤šå¾ˆå¤š</p>
<p>ï¼ˆ2ï¼‰Aï¼ŒBæœ‰ç›¸åŒçš„è¾“å…¥</p>
<p>ï¼ˆ3ï¼‰Aä»»åŠ¡ä¸­ä½å±‚æ¬¡ç‰¹å¾çš„å­¦ä¹ èƒ½å¤Ÿå¸®åŠ©Bä»»åŠ¡</p>
<p>æ³¨ï¼šå½“Açš„æ•°æ®é‡æ¯”Bå°ï¼Œè¿ç§»å­¦ä¹ æ•ˆæœä¸å¤ªå¥½</p>
<h4 id="example"><a href="#example" class="headerlink" title="example"></a>example</h4><p>å°†å¯¹çŒ«çš„è¯†åˆ«è¿ç§»åˆ°å¯¹xå°„çº¿å›¾åƒçš„è¯†åˆ«ä¸­å»</p>
<p>A:å¯¹çŒ«çš„è¯†åˆ«</p>
<p>B:å¯¹xå°„çº¿å›¾åƒçš„è¯†åˆ«</p>
<p>ä¸¤è€…éƒ½æ˜¯è¾“å…¥å›¾åƒï¼Œæ»¡è¶³æ¡ä»¶ï¼ˆ2ï¼‰ï¼ŒåŒæ—¶Aä»»åŠ¡ä¸­èƒ½å¤Ÿå­¦ä¹ å›¾åƒçš„è½®å»“ç­‰èƒ½ä¿ä½Bä»»åŠ¡ï¼Œæ»¡è¶³æ¡ä»¶ï¼ˆ3ï¼‰ï¼Œä»»åŠ¡Açš„æ•°æ®é‡å¾ˆå¤§ã€‚</p>
<p>æ–¹æ³•ï¼šé¢„è®­ç»ƒ+å¾®è°ƒ</p>
<p>é¢„è®­ç»ƒï¼šä½¿ç”¨æ•°æ®é‡å¤§çš„Aä»»åŠ¡è®­ç»ƒçš„æ¨¡å‹</p>
<p>å¾®è°ƒï¼šä½¿ç”¨æ•°æ®é‡å°çš„Bä»»åŠ¡å»æ‰æœ€åè¾“å‡ºå±‚ï¼Œé‡æ–°è®­ç»ƒæƒé‡çš„è¿‡ç¨‹</p>
<p>ï¼ˆ1ï¼‰æ–¹æ³•1ï¼ˆxå°„çº¿å›¾åƒçš„è¯†åˆ«æ•°æ®é‡å°ï¼‰ï¼šå°†å¯¹çŒ«è¯†åˆ«ç½‘ç»œæœ€åä¸€å±‚å»æ‰ï¼Œåˆå§‹åŒ–æœ€åä¸€å±‚çš„æƒé‡ç­‰å‚æ•°ï¼ˆéšæœºæƒé‡ï¼‰ï¼Œä½¿ç”¨åŸå§‹å‰n-1å±‚å‚æ•°è¿›è¡Œè®­ç»ƒ</p>
<p>ï¼ˆ2ï¼‰æ–¹æ³•2ï¼ˆxå°„çº¿å›¾åƒçš„è¯†åˆ«æ•°æ®é‡å¤§ï¼‰ï¼šå°†å¯¹çŒ«è¯†åˆ«ç½‘ç»œæœ€åä¸€å±‚å»æ‰ï¼Œåˆå§‹åŒ–æ‰€æœ‰å±‚çš„æƒé‡ç­‰å‚æ•°è¿›è¡Œè®­ç»ƒ</p>
<p>æ³¨ï¼šå»æ‰æœ€åä¸€å±‚ä¹‹åï¼Œå¯ä»¥åŠ å‡ å±‚éšè—å±‚å†æ¥è¾“å‡º</p>
<h3 id="å¤šä»»åŠ¡å­¦ä¹ â€”â€”å¹¶è¡Œ"><a href="#å¤šä»»åŠ¡å­¦ä¹ â€”â€”å¹¶è¡Œ" class="headerlink" title="å¤šä»»åŠ¡å­¦ä¹ â€”â€”å¹¶è¡Œ"></a>å¤šä»»åŠ¡å­¦ä¹ â€”â€”å¹¶è¡Œ</h3><p>åŒæ—¶å¼€å§‹å­¦ä¹ ï¼Œç¥ç»ç½‘ç»œæ¯æ¬¡å­¦ä¹ å‡ ä»¶äº‹ï¼Œå¹¶å¸Œæœ›æ¯ä¸ªä»»åŠ¡éƒ½èƒ½å¸®åŠ©å…¶ä»–ä»»åŠ¡ç§°ä¸ºå¤šä»»åŠ¡å­¦ä¹ </p>
<h4 id="åº”ç”¨åœºæ™¯-1"><a href="#åº”ç”¨åœºæ™¯-1" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h4><p>ï¼ˆ1ï¼‰è®­ç»ƒçš„ä¸€ç»„ä»»åŠ¡ï¼Œå¯ä»¥å…±ç”¨ä½å±‚æ¬¡ç‰¹å¾ï¼ˆä¾‹å¦‚è‡ªåŠ¨è½¦é©¾é©¶ï¼Œéœ€è¦è®­ç»ƒå¯¹ç‰©ä½“çš„è¯†åˆ«ï¼Œè¯†åˆ«è¡Œäººï¼Œæ ‡å¿—ï¼Œæ–‘é©¬çº¿ç­‰ï¼Œæ­¤æ—¶å¯ä»¥å…±ç”¨ä½å±‚æ¬¡ç‰¹å¾ï¼‰</p>
<p>ï¼ˆ2ï¼‰æ¯ä¸ªå•ç‹¬çš„ä»»åŠ¡æ•°æ®é‡æ¥è¿‘</p>
<p>ï¼ˆ3ï¼‰å»ºç«‹ä¸€ä¸ªå¤§çš„ç¥ç»ç½‘ç»œåŒæ—¶è®­ç»ƒä¸€ç»„ä»»åŠ¡æ¯”å•ç‹¬è®­ç»ƒæ¯ä¸ªä»»åŠ¡æ•ˆç‡é«˜</p>
<p>ä¸€èˆ¬ç½‘ç»œæœ€åè¾“å‡ºä»£è¡¨æ˜¯å¦æœ‰è¯¥ç»„ä»»åŠ¡ï¼Œå³æ¯ä¸ªä»»åŠ¡èµ‹äºˆä¸€ä¸ªæ ‡ç­¾ã€‚ï¼ˆå’Œsoftmaxtå±‚ä¸åŒï¼Œsoftmaxæœ€åæ•°æ®ä»£è¡¨å•ä¸ªæ ·æœ¬çš„åˆ†ç±»æƒ…å†µï¼‰</p>
<h4 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h4><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200525111013.png" alt></p>
<p>çº¢è‰²æ¡†ä¸­ä»£è¡¨å¯¹å››ä¸ªä»»åŠ¡åˆ†ç±»çš„æ±‚å’Œ</p>
<h2 id="ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ "><a href="#ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ " class="headerlink" title="ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ "></a>ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ </h2><h3 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h3><p>è¯­éŸ³è¯†åˆ«ä»»åŠ¡ï¼ˆx,yï¼‰ï¼Œxä»£è¡¨è¾“å…¥çš„éŸ³é¢‘ï¼Œyä»£è¡¨å¬å†™æ–‡æœ¬</p>
<p>ä¸€èˆ¬æ·±åº¦å­¦ä¹ ï¼šä»x-&gt;æå–ç‰¹å¾-&gt;æå–éŸ³ä½-&gt;ç”Ÿæˆè¯-&gt;yï¼Œä¸­é—´åŒ…å«å¾ˆå¤šæ‰‹å·¥ç”Ÿæˆçš„ç»„ä»¶ï¼Œé‡Œé¢åŒ…å«äººç±»å¯¹çŸ¥è¯†çš„åˆ†æï¼Œä»è€Œä¼ é€’ç»™ç½‘ç»œ</p>
<p>ç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ ï¼šä»xç›´æ¥æ˜ å°„åˆ°yï¼Œå®Œå…¨ä¾é æ•°æ®æ¥å­¦ä¹ çŸ¥è¯†ï¼Œæ²¡æœ‰äººç±»çš„å¹²é¢„å³æ‰‹å·¥ç”Ÿæˆç»„ä»¶</p>
<h3 id="åº”ç”¨åœºæ™¯-2"><a href="#åº”ç”¨åœºæ™¯-2" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>ä»xç›´æ¥æ˜ å°„åˆ°yæœ‰å¤§é‡è®­ç»ƒæ ·æœ¬</p>
<p>å½“ä»xç›´æ¥æ˜ å°„åˆ°yæ²¡æœ‰å¾ˆå¤šæ ·æœ¬ï¼Œè¿™æ—¶å€™å¯ä»¥æ¢åˆ†ä¸ºå­ä»»åŠ¡ï¼Œåœ¨å­ä»»åŠ¡ä¸­è¿›è¡Œç«¯åˆ°ç«¯çš„æ·±åº¦å­¦ä¹ </p>
<p>ä¾‹å¦‚ï¼šäººè„¸è¯†åˆ«ç³»ç»Ÿï¼ˆx,yï¼‰ï¼Œxä»£è¡¨è¾“å…¥çš„äººåƒå›¾ç‰‡ï¼Œyä»£è¡¨è¿™ä¸ªäººçš„èº«ä»½</p>
<p>ç”±äºäººè„¸è¯†åˆ«ä»»åŠ¡ä¸­çš„è¾“å…¥å›¾ç‰‡æœ‰å¾ˆå¤šï¼Œå„ç§è§’åº¦å’Œå„ç§è·ç¦»çš„ï¼Œè¿™æ ·çš„æ•°æ®é›†è¾ƒå°‘ï¼Œå› æ­¤å¯ä»¥å°†ä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªå­ä»»åŠ¡ï¼š</p>
<p>ï¼ˆ1ï¼‰ï¼ˆx1,y1ï¼‰ï¼Œxä»£è¡¨è¾“å…¥çš„äººè„¸å›¾ç‰‡ï¼Œy1ä»£è¡¨å°†è¾“å…¥çš„å›¾ç‰‡è£å‰ªå‡ºäººè„¸å¹¶å±…ä¸­</p>
<p>ï¼ˆ2ï¼‰ï¼ˆx2,y2ï¼‰ï¼Œx2ä»£è¡¨è¾“å…¥çš„å±…ä¸­äººè„¸å›¾ç‰‡ï¼Œy2ä»£è¡¨è¿™ä¸ªäººçš„èº«ä»½ï¼ˆé€šè¿‡x2äººè„¸å’Œåº“ä¸­äººè„¸è¿›è¡ŒåŒ¹é…è®­ç»ƒæ¨¡å‹ï¼‰</p>
<p>å­ä»»åŠ¡ï¼ˆ1ï¼‰ã€ï¼ˆ2ï¼‰æ•°æ®é‡å……è¶³ï¼Œåˆ’åˆ†ä¹‹åä»»åŠ¡ç®€å•ä¹Ÿæ˜“è®­ç»ƒæ¨¡å‹ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»“æ„åŒ–æœºå™¨å­¦ä¹ é¡¹ç›®â€”â€”ç¬¬ä¸€å‘¨å­¦ä¹ ç¬”è®°</title>
    <url>/blogs/struLearning1/</url>
    <content><![CDATA[<h2 id="æ­£äº¤åŒ–"><a href="#æ­£äº¤åŒ–" class="headerlink" title="æ­£äº¤åŒ–"></a>æ­£äº¤åŒ–</h2><p>æ­£äº¤åŒ–åœ¨æ•°å­¦ä¸­æ˜¯å‚ç›´çš„å«ä¹‰ï¼Œæ¯ä¸ªæ–¹æ³•å•ç‹¬å½±å“ä¸€ä¸ªåŠŸèƒ½ã€‚</p><p>ä¸€ä¸ªç›‘ç£å­¦ä¹ ç³»ç»Ÿ</p><p>ï¼ˆ1ï¼‰è®­ç»ƒé›†</p><p>å½“è®­ç»ƒé›†æ‹Ÿåˆä¸ä½³æ—¶ï¼Œé‡‡ç”¨æ›´å¤§çš„ç½‘ç»œæˆ–è€…ä¼˜åŒ–çš„ç®—æ³•ï¼ˆå¦‚Adamç®—æ³•ï¼‰ï¼Œè¿™äº›æªæ–½å•ä¸€çš„å½±å“è®­ç»ƒé›†è®­ç»ƒçš„æ•ˆæœï¼Œè¿™æ ·èƒ½æ–¹ä¾¿å¯¹æ¨¡å‹ä¿®æ”¹ã€‚</p><p>ï¼ˆ2ï¼‰å¼€å‘é›†</p><p>å½“å¼€å‘é›†é”™è¯¯ç‡é«˜ï¼Œè¯´æ˜å­˜åœ¨è¾ƒå¤§çš„æ–¹å·®ï¼Œå¯èƒ½æ˜¯è®­ç»ƒé›†è¿‡æ‹Ÿåˆäº†ï¼Œå¯ä»¥é‡‡ç”¨æ­£åˆ™åŒ–æˆ–è€…è·å–æ›´å¤šçš„è®­ç»ƒæ•°æ®ï¼Œè¿™äº›äº‹æ­£äº¤åŒ–æªæ–½ã€‚å¦‚æœä½¿ç”¨æ—©åœçš„æ–¹æ³•ï¼Œè™½ç„¶å¯ä»¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´è®­ç»ƒé›†è®­ç»ƒä¸å®Œå…¨ï¼Œè¿™ç§éæ­£äº¤åŒ–çš„æªæ–½ä¸å»ºè®®ä½¿ç”¨ã€‚</p><a id="more"></a>





<p>ï¼ˆ3ï¼‰æµ‹è¯•é›†</p>
<p>å½“æµ‹è¯•é›†é”™è¯¯ç‡é«˜ï¼Œè¯´æ˜åœ¨å¼€å‘é›†ä¸Šæ•ˆæœè‰¯å¥½çš„æ¨¡å‹æ²¡æœ‰å¾ˆå¥½çš„æ¨å¹¿åˆ°æµ‹è¯•é›†ï¼Œè¯´æ˜å¼€å‘é›†å¯èƒ½è¿‡æ‹Ÿåˆäº†ï¼Œè¿™æ—¶å°±éœ€è¦æ›´å¤šçš„å¼€å‘é›†æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯æ­£äº¤åŒ–æªæ–½ï¼Œåªå•ç‹¬å½±å“æµ‹è¯•é›†ã€‚</p>
<p>ï¼ˆ4ï¼‰ç”¨æˆ·ä½“éªŒï¼ˆå³æˆæœ¬å‡½æ•°ï¼‰</p>
<p>æ ¹æ®åŸæœ‰çš„æˆæœ¬å‡½æ•°ç”Ÿæˆçš„æ¨¡å‹æ•ˆæœå¥½ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­æ•ˆæœä¸å¥½ï¼Œè¯´æ˜å¯èƒ½æ˜¯æˆæœ¬å‡½æ•°çš„è¯„ä»·æ ‡å‡†å‘ç”Ÿé”™è¯¯ï¼Œè¿™æ—¶å°±éœ€è¦é‡æ–°å®šä¹‰æˆæœ¬å‡½æ•°ï¼Œæˆ–è€…æ”¹å˜éªŒè¯é›†ã€‚</p>
<p>æ€»ç»“ï¼šå› æ­¤ï¼Œåœ¨æ­å»ºæ¨¡å‹çš„æ—¶å€™ï¼Œéœ€è¦é‡‡ç”¨æ­£äº¤åŒ–çš„æ–¹æ³•ï¼Œä»¥ä¾¿ä»¥æ–¹ä¾¿çš„è§£å†³é—®é¢˜ã€‚</p>
<p>æ­£äº¤åŒ–æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰é¦–å…ˆè®¾å®šä¸€ä¸ªç›®æ ‡æ¥è¡¡é‡æƒ³åšçš„äº‹</p>
<p>ï¼ˆ2ï¼‰è°ƒè¯•ç®—æ³•è¡¨ç°ï¼šåˆ†å¼€è€ƒè™‘æ”¹å–„ç³»ç»Ÿåœ¨æŒ‡æ ‡ä¸Šçš„è¡¨ç°</p>
<h2 id="å•ä¸€å®æ•°æŒ‡æ ‡"><a href="#å•ä¸€å®æ•°æŒ‡æ ‡" class="headerlink" title="å•ä¸€å®æ•°æŒ‡æ ‡"></a>å•ä¸€å®æ•°æŒ‡æ ‡</h2><p>å•ä¸€çš„å®æ•°æŒ‡æ ‡èƒ½å¾ˆæ–¹ä¾¿çš„åˆ¤æ–­ä¼—å¤šæ¨¡å‹ä¸­æœ€ä¼˜çš„é‚£ä¸ªã€‚</p>
<p>ä¸€èˆ¬è¯„ä¼°æ¨¡å‹å¸¸ç”¨æŸ¥å‡†ç‡Pï¼Œå³æ¨¡å‹æ ‡è®°ä¸ºçœŸçš„æ•°æ®ä¸­æœ‰å¤šå°‘ç¡®å®æ˜¯çœŸï¼›æŒ‡æ ‡æŸ¥å…¨ç‡Tï¼Œå³åœ¨çœŸçš„æ•°æ®ä¸­æ¨¡å‹æ ‡è®°å‡ºäº†å¤šå°‘ã€‚ç„¶è€Œè¿™ä¸¤ä¸ªæŒ‡æ ‡å…·æœ‰å¹³è¡¡æ€§ï¼Œæ‰€ä»¥å¸¸é‡‡ç”¨F1åˆ†æ•°è¯„ä¼°æ¨¡å‹ï¼Œå³Få’ŒPçš„è°ƒå’Œå¹³å‡æ•°ï¼šF1=2/(1/P+1/T)</p>
<p>æ€»ç»“ï¼šé€šè¿‡è®¾ç½®å¼€å‘é›†å’Œå•ä¸€å®æ•°æŒ‡æ ‡èƒ½å¤Ÿå¿«é€Ÿåˆ¤æ–­æ¨¡å‹çš„å¥½åï¼ŒåŠ å¿«è¿­ä»£é€Ÿåº¦ã€‚</p>
<p>æ³¨ï¼šå½“æŒ‡æ ‡ä¸èƒ½å¾ˆå¥½çš„è¡¡é‡æ¨¡å‹çš„å¥½åæ—¶ï¼Œéœ€è¦æ›´æ¢æ–°çš„æŒ‡æ ‡ã€‚ä¾‹å¦‚å¯¹äºå‡é˜³çš„ä¾‹å­ï¼Œå¯¹å…¶è®¾ç½®æƒ©ç½šæƒé‡ï¼Œæé«˜å…¶é”™è¯¯ç‡ã€‚</p>
<h2 id="æ»¡è¶³æŒ‡æ ‡å’Œä¼˜åŒ–æŒ‡æ ‡"><a href="#æ»¡è¶³æŒ‡æ ‡å’Œä¼˜åŒ–æŒ‡æ ‡" class="headerlink" title="æ»¡è¶³æŒ‡æ ‡å’Œä¼˜åŒ–æŒ‡æ ‡"></a>æ»¡è¶³æŒ‡æ ‡å’Œä¼˜åŒ–æŒ‡æ ‡</h2><p>å•ä¸€çš„å®æ•°æŒ‡æ ‡ä¸ä¸€å®šèƒ½å¤Ÿæ»¡è¶³æ¨¡å‹çš„æ‰€æœ‰æ¡ä»¶ï¼Œå½“éœ€è¦ç¬¦åˆNä¸ªæ¡ä»¶æ—¶ï¼Œé€‰æ‹©ä¸€ä¸ªä½œä¸ºä¼˜åŒ–æŒ‡æ ‡ï¼Œå‰©ä½™çš„N-1ä¸ªä½œä¸ºæ»¡è¶³æŒ‡æ ‡ã€‚</p>
<p>ä¼˜åŒ–æŒ‡æ ‡ï¼šå°½å¯èƒ½ä¼˜åŒ–ï¼Œå³ç²¾åº¦è¶Šé«˜ï¼Œæ•°å€¼è¶Šå¤§å³å¯</p>
<p>æ»¡è¶³æŒ‡æ ‡ï¼šè®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œåœ¨é˜ˆå€¼çº¿ä»¥å†…å³å¯ï¼Œä¸è¦æ±‚æœ€ä¼˜</p>
<p>è¿™æ ·æ¨¡å‹å°±è½¬æ¢ä¸ºå°½å¯èƒ½ä¼˜åŒ–è®¾å®šçš„ä¼˜åŒ–æŒ‡æ ‡å³å¯ï¼Œæ»¡è¶³æŒ‡æ ‡åªè¦è¾¾åˆ°æ¡ä»¶å°±è¡Œã€‚</p>
<h2 id="å¦‚ä½•è®¾å®šè®­ç»ƒé›†ï¼Œå¼€å‘é›†ï¼Œæµ‹è¯•é›†"><a href="#å¦‚ä½•è®¾å®šè®­ç»ƒé›†ï¼Œå¼€å‘é›†ï¼Œæµ‹è¯•é›†" class="headerlink" title="å¦‚ä½•è®¾å®šè®­ç»ƒé›†ï¼Œå¼€å‘é›†ï¼Œæµ‹è¯•é›†"></a>å¦‚ä½•è®¾å®šè®­ç»ƒé›†ï¼Œå¼€å‘é›†ï¼Œæµ‹è¯•é›†</h2><p>ï¼ˆ1ï¼‰ä¸‰è€…åˆ†åˆ«ä½œç”¨</p>
<p>è®­ç»ƒé›†ä½œç”¨ï¼šæ ¹æ®ä¸åŒæ€è·¯è®­ç»ƒå‡ºä¸åŒæ¨¡å‹</p>
<p>å¼€å‘é›†ä½œç”¨ï¼šç”¨äºè¯„ä¼°ä¸åŒæ¨¡å‹ä¸­æœ€å¥½çš„æ¨¡å‹</p>
<p>æµ‹è¯•é›†ä½œç”¨ï¼šç³»ç»Ÿå¼€å‘ä¹‹åè¯„ä¼°æ€§èƒ½ï¼ˆè¯„ä¼°æˆæœ¬å‡½æ•°ï¼‰ï¼Œèƒ½å¦æ»¡è¶³ç”¨æˆ·éœ€æ±‚</p>
<p>ï¼ˆ2ï¼‰å¤§å°å¦‚ä½•è®¾ç½®</p>
<p>æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µï¼Œè®­ç»ƒé›†å 98%ä»¥ä¸Šï¼Œå¼€å‘é›†å’Œæµ‹è¯•é›†å å¾ˆå°‘éƒ¨åˆ†ï¼ˆ1%å·¦å³ï¼‰ã€‚</p>
<p>ï¼ˆ3ï¼‰è®¾ç½®æ³¨æ„ç‚¹</p>
<p>ä¸ºäº†è®©ç®—æ³•é›†ä¸­äºæƒ³è¦çš„ç›®æ ‡æ•°æ®ï¼Œå¼€å‘é›†å’Œæµ‹è¯•é›†çš„æ•°æ®åˆ†å¸ƒè¦ç›¸åŒã€‚</p>
<p>ä¸ºäº†è®©åœ¨å¼€å‘é›†ä¸Šè¿è¡Œçš„æ¨¡å‹èƒ½å¾ˆå¥½çš„æ¨å¹¿åˆ°æµ‹è¯•é›†ä¸Šã€‚</p>
<h2 id="äººçš„è¡¨ç°"><a href="#äººçš„è¡¨ç°" class="headerlink" title="äººçš„è¡¨ç°"></a>äººçš„è¡¨ç°</h2><p>ï¼ˆ1ï¼‰ä¼°è®¡bayes error</p>
<p>äººçš„è¡¨ç°è¯¯å·®å¯ä»¥ç”¨æ¥è´å¶æ–¯æœ€ä¼˜è¯¯å·®ï¼Œè´å¶æ–¯æœ€ä¼˜è¯¯å·®æ—¶ç†è®ºä¸Šæœ€å°çš„è¯¯å·®</p>
<p>ï¼ˆ2ï¼‰åˆ¶å®šç®—æ³•çš„ç­–ç•¥</p>
<p>å‡å®šhunman error(çº¦ç­‰äºbayes error)=a%ï¼Œtraining eror=b%ï¼Œdev error=c%</p>
<p>åˆ™å¯é¿å…åå·®ä¸ºb%-a%ï¼Œæ–¹å·®ä¸ºc%-b%ï¼Œä»¥æ­¤å¯ä»¥å¯ä»¥æ ¹æ®ä¸åŒçš„åœºæ™¯ç¡®å®šä¸åŒçš„ç­–ç•¥ã€‚å½“å¯é¿å…åå·®å¤§æ—¶ï¼Œé‡‡å–è®­ç»ƒæ›´å¤§çš„ç½‘ç»œæˆ–è€…è®­ç»ƒæ—¶é—´æ›´é•¿ï¼Œå½“æ–¹å·®å¤§æ—¶ï¼Œå¯ä»¥é‡‡å–æ­£åˆ™åŒ–æˆ–è€…é€‰å–æ›´å¤šçš„è®­ç»ƒé›†æ•°æ®ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œâ€”â€”è¯†åˆ«æ‰‹åŠ¿å›¾ç‰‡</title>
    <url>/blogs/ipvNNet3/</url>
    <content><![CDATA[<h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>ä½¿ç”¨TensorFlowæ·±åº¦å­¦ä¹ æ¡†æ¶å»ºç«‹è¯†åˆ«æ‰‹åŠ¿å›¾ç‰‡çš„ç½‘ç»œ</p><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>æ³¨ï¼šï¼ˆ1ï¼‰â€” ï¼ˆ5ï¼‰æ­¥éª¤å¹¶æ²¡æœ‰å®é™…æ‰§è¡Œï¼Œæ‰€æœ‰è®­ç»ƒæ¨¡å‹è¿‡ç¨‹éƒ½åœ¨ä¼šè¯ï¼ˆsessionï¼‰ä¸­è¿›è¡Œï¼Œå³æ¨¡å‹è®­ç»ƒåŸºäºä¼šè¯çš„åˆ›å»ºï¼Œ<strong>æ‰€æœ‰è¾“å…¥çš„æ•°æ®åœ¨ä¼šè¯ä¸­èµ‹å€¼ï¼Œå…¶ä»–åœ°æ–¹å‡å¤„ç†çš„æ˜¯å˜é‡</strong>ã€‚</p><p>ç½‘ç»œç»“æ„ä¸ºä¸‰å±‚ç½‘ç»œï¼Œå„å±‚çš„æ¿€æ´»å‡½æ•°reluï¼Œreluï¼Œsoftmaxï¼Œå³æ¨¡å‹ç»“æ„ä¸ºlinear-&gt;relu-&gt;linear-&gt;relu-&gt;linear-&gt;softmax</p><a id="more"></a>


<h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p>ï¼ˆ0ï¼‰æ•°æ®å¤„ç†</p>
<p>å¯¼å…¥æ•°æ®ï¼Œå¹¶å°†æ•°æ®å½’ä¸€åŒ–ï¼Œå¯¹æ ‡ç­¾é¡¹è½¬æ¢ä¸ºç‹¬çƒ­çŸ©é˜µç¼–ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¯¼å…¥æ•°æ®å¹¶å½’ä¸€åŒ–</span></span><br><span class="line">train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes=tu.load_dataset()</span><br><span class="line"><span class="comment">#æ¯å¹…å›¾ç‰‡64*64*3ï¼Œå°†æ¯ä¸ªæ ·æœ¬å †å èµ·æ¥</span></span><br><span class="line">train_x_flattern=train_set_x_orig.reshape(train_set_x_orig.shape[<span class="number">0</span>],<span class="number">-1</span>).T</span><br><span class="line">test_x_flattern=test_set_x_orig.reshape(test_set_x_orig.shape[<span class="number">0</span>],<span class="number">-1</span>).T</span><br><span class="line"><span class="comment">#å½’ä¸€åŒ–</span></span><br><span class="line">train_x=train_x_flattern/<span class="number">255</span></span><br><span class="line">test_x=test_x_flattern/<span class="number">255</span></span><br><span class="line"><span class="comment">#yå…¨éƒ¨è½¬æ¢ä¸ºç‹¬çƒ­çŸ©é˜µ</span></span><br><span class="line">train_y=tu.convert_to_one_hot(train_set_y_orig,<span class="number">6</span>)</span><br><span class="line">test_y=tu.convert_to_one_hot(test_set_y_orig,<span class="number">6</span>)</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šä½¿ç”¨np.eye(C)[Y.reshape(-1)].Tï¼Œeyeåé¢è·Ÿä¸€ç»´æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ä»£è¡¨1çš„åç§»é‡ï¼Œç”±äºæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼Œæ‰€ä»¥æœ€åéœ€è¦è½¬ç½®</p>
<p>ï¼ˆ1ï¼‰åˆ›å»ºå ä½ç¬¦ç”¨äºè¾“å…¥è®­ç»ƒé›†æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.æ„é€ å ä½ç¬¦ï¼Œä¾¿äºè¾“å…¥è®­ç»ƒé›†æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_placeholder</span><span class="params">(n_x,n_y)</span>:</span></span><br><span class="line">	X=tf.placeholder(tf.float32,[n_x,<span class="literal">None</span>])</span><br><span class="line">	Y=tf.placeholder(tf.float32,[n_y,<span class="literal">None</span>])</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> X,Y</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–æƒé‡ç­‰å‚æ•°</p>
<p>åˆ©ç”¨tfåˆ›å»ºå˜é‡ï¼štf.get_variable()</p>
<p>æƒé‡åˆå§‹åŒ–ï¼šinitializer=tf.contrib.layers.xavaier_initializer</p>
<p>åç½®é‡åˆå§‹åŒ–ï¼šinitializer=tf.zeros_initializer</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"><span class="comment">#æ„å»ºå˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">(layer_dims)</span>:</span></span><br><span class="line">	n_0,n_1,n_2,n_3=layer_dims</span><br><span class="line">	parameters=&#123;&#125;</span><br><span class="line">	tf.set_random_seed(<span class="number">1</span>)</span><br><span class="line">	W1=tf.get_variable(<span class="string">"W1"</span>,[n_1,n_0],initializer=tf.contrib.layers.xavier_initializer(seed=<span class="number">1</span>))</span><br><span class="line">	b1=tf.get_variable(<span class="string">"b1"</span>,[n_1,<span class="number">1</span>],initializer=tf.zeros_initializer())</span><br><span class="line">	W2=tf.get_variable(<span class="string">"W2"</span>,[n_2,n_1],initializer=tf.contrib.layers.xavier_initializer(seed=<span class="number">1</span>))</span><br><span class="line">	b2=tf.get_variable(<span class="string">"b2"</span>,[n_2,<span class="number">1</span>],initializer=tf.zeros_initializer())	</span><br><span class="line">	W3=tf.get_variable(<span class="string">"W3"</span>,[n_3,n_2],initializer=tf.contrib.layers.xavier_initializer(seed=<span class="number">1</span>))</span><br><span class="line">	b3=tf.get_variable(<span class="string">"b3"</span>,[n_3,<span class="number">1</span>],initializer=tf.zeros_initializer())</span><br><span class="line"></span><br><span class="line">	parameters=&#123;<span class="string">"W1"</span>:W1,<span class="string">"b1"</span>:b1,<span class="string">"W2"</span>:W2,<span class="string">"b2"</span>:b2,<span class="string">"W3"</span>:W3,<span class="string">"b3"</span>:b3&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>



<p>ï¼ˆ3ï¼‰å‰å‘ä¼ æ’­</p>
<p>æ ¹æ®ä¼ å…¥çš„å‚æ•°å’Œä¸Šä¸€å±‚æ•°æ®è®¡ç®—Zï¼ŒA</p>
<p>æ³¨ï¼šæœ€åä¸€å±‚ä¸ç”¨è®¡ç®—æ¿€æ´»å€¼ï¼Œæ ¹æ®å¾—å‡ºçš„Z3ï¼Œåˆ©ç”¨tf.argmaxå¾—å‡ºæ¦‚ç‡æœ€å¤§ï¼ˆæœ€å¤§å€¼æ¦‚ç‡æœ€å¤§ï¼‰ï¼Œå³ä¸ºå½“å‰åˆ†ç±»ç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#4.å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_propogation</span><span class="params">(parameters,X)</span>:</span></span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	b1=parameters[<span class="string">"b1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line">	b2=parameters[<span class="string">"b2"</span>]</span><br><span class="line">	W3=parameters[<span class="string">"W3"</span>]</span><br><span class="line">	b3=parameters[<span class="string">"b3"</span>]</span><br><span class="line"></span><br><span class="line">	Z1=tf.add(tf.matmul(W1,X),b1)</span><br><span class="line">	A1=tf.nn.relu(Z1)</span><br><span class="line">	Z2=tf.add(tf.matmul(W2,A1),b2)</span><br><span class="line">	A2=tf.nn.relu(Z2)</span><br><span class="line">	<span class="comment">#Z3æœ€å¤§ç›¸å½“äºæ¦‚ç‡æœ€å¤§</span></span><br><span class="line">	Z3=tf.add(tf.matmul(W3,A2),b3)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> Z3</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰è®¡ç®—æŸå¤±</p>
<p>åˆ©ç”¨æ¡†æ¶ä¸­softmaxçš„æŸå¤±å‡½æ•°ï¼štf.softmax_cross_entropy_with_logits(logits=â€¦.ï¼Œlabels=â€¦..)ï¼Œè¯¥æŸå¤±å‡½æ•°æ•°æ®è¾“å…¥çš„ç»´åº¦æ˜¯ï¼ˆæ•°æ®é›†å¤§å°ï¼Œåˆ†å¸ƒï¼‰ï¼Œæ‰€ä»¥è¾“å…¥çš„å †å æ•°æ®éœ€è¦è½¬ç½®</p>
<p>ä½¿ç”¨reduce_meanè®¡ç®—å‡å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#5.è®¡ç®—æŸå¤±</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(Z3,Y)</span>:</span></span><br><span class="line">	logits=tf.transpose(Z3)</span><br><span class="line">	labels=tf.transpose(Y)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æœ€åä¸€å±‚ç”¨softmax,å¹¶æ±‚å¹³å‡</span></span><br><span class="line">	<span class="comment">#å‚æ•°ç»´åº¦[æ•°æ®é›†å¤§å°ï¼Œåˆ†å¸ƒ]</span></span><br><span class="line">	cost=tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(logits=logits,labels=labels))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> cost</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ5ï¼‰åå‘ä¼ æ’­</p>
<p>tensorflowæ¡†æ¶åœ¨å‰å‘ä¼ æ’­æ—¶ï¼Œè‡ªåŠ¨è®¡ç®—å¯¼æ•°ï¼Œå› æ­¤åå‘ä¼ æ’­ç”¨ä¸€è¡Œä»£ç å³å¯ï¼Œè¿™é‡Œä½¿ç”¨adamç®—æ³•</p>
<p>tf.train.AdamOptimizer(å­¦ä¹ ç‡)).minimize(cost)</p>
<p>ï¼ˆ6ï¼‰åˆ›å»ºä¼šè¯æ‰§è¡Œè®­ç»ƒæ¨¡å‹è¿‡ç¨‹</p>
<p>1Â° åˆ›å»ºä¼šè¯ï¼Œå¹¶åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>2Â° å°†è®­ç»ƒæ•°æ®è¾“å…¥å ä½ç¬¦ä¸­è¿›è¡Œæ¨¡å‹è®­ç»ƒ</p>
<p>åˆ©ç”¨å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼š</p>
<p>aï¼‰æ¯æ¬¡è·å–ä¸€å°æ‰¹æ ·æœ¬æ•°æ®ï¼Œå°†å…¶è¾“å…¥å ä½ç¬¦ä¸­ï¼›</p>
<p>bï¼‰åœ¨ä¼šè¯ä¸­è¾“å…¥åå‘ä¼ æ’­çš„ç®—æ³•å’ŒæŸå¤±å‡½æ•°ï¼Œå¾—åˆ°å½“å‰æ€»æŸå¤±</p>
<p>cï¼‰æ ¹æ®æ ·æœ¬æ€»æ•°å¾—åˆ°å½“å‰æ‰¹é‡çš„æŸå¤±ï¼Œå¹¶è¿›è¡Œè®°å½•</p>
<p>æ³¨ï¼šæ¨¡å‹çš„å‚æ•°éœ€è¦ä¿å­˜åˆ°ä¼šè¯ä¸­ï¼Œä¸ç„¶parametersä¸€ç›´æ˜¯åªæœ‰ç‰©ç†ç©ºé—´ï¼Œæ²¡æœ‰èµ‹å€¼çš„çŠ¶æ€ï¼š</p>
<p>{â€˜W1â€™: &lt;tf.Variable â€˜W1:0â€™ shape=(25, 12288) dtype=float32_ref&gt;, â€˜b1â€™: &lt;tf.Variable â€˜b1:0â€™ shape=(25, 1) dtype=float32_ref&gt;, â€˜W2â€™: &lt;tf.Variable â€˜W2:0â€™ shape=(12, 25) dtype=float32_ref&gt;, â€˜b2â€™: &lt;tf.Variable â€˜b2:0â€™ shape=(12, 1) dtype=float32_ref&gt;, â€˜W3â€™: &lt;tf.Variable â€˜W3:0â€™ shape=(6, 12) dtype=float32_ref&gt;, â€˜b3â€™: &lt;tf.Variable â€˜b3:0â€™ shape=(6, 1) dtype=float32_ref&gt;}</p>
<p>æœ€ååˆ©ç”¨argmaxå¾—åˆ°è¾“å‡ºæœ€å¤§æ¦‚ç‡å¯¹åº”çš„ç±»åˆ«ï¼Œå°†å…¶å’Œæ­£ç¡®è¾“å‡ºå¯¹æ¯”ï¼Œå³å¯å¾—åˆ°å‡†ç¡®ç‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#6.æ„å»ºæ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(train_x,train_y,test_x,test_y,layer_dims,num_ecpho=<span class="number">100</span>,mini_batch_size=<span class="number">32</span>,learning_rate=<span class="number">0.0001</span>)</span>:</span></span><br><span class="line">	<span class="comment">#é‡æ–°è¿è¡Œæ¨¡å‹ä¸è¦†ç›–tfå˜é‡</span></span><br><span class="line">	ops.reset_default_graph()</span><br><span class="line">	tf.set_random_seed(<span class="number">1</span>)</span><br><span class="line">	costs=[]</span><br><span class="line">	seed=<span class="number">3</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.å ä½ç¬¦ï¼šè¾“å…¥è®­ç»ƒæ•°æ®</span></span><br><span class="line">	n_x,m=train_x.shape</span><br><span class="line">	n_y=train_y.shape[<span class="number">0</span>]</span><br><span class="line">	X,Y=create_placeholder(n_x,n_y)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#2.åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">	parameters=initialize_parameters(layer_dims)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.å‰å‘ä¼ æ’­</span></span><br><span class="line">	Z3=forward_propogation(parameters,X)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#4.è®¡ç®—æŸå¤±</span></span><br><span class="line">	cost=compute_cost(Z3,Y)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#5.åå‘ä¼ æ’­</span></span><br><span class="line">	optimizer=tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost)</span><br><span class="line"></span><br><span class="line">	init=tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line">	<span class="comment">#5.åˆ›å»ºä¼šè¯ï¼Œè®­ç»ƒæ¨¡å‹</span></span><br><span class="line">	session=tf.Session()</span><br><span class="line">	session.run(init)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_ecpho):</span><br><span class="line">		seed=seed+<span class="number">1</span></span><br><span class="line">		mini_batchs=tu.random_mini_batches(train_x,train_y,mini_batch_size,seed)</span><br><span class="line">		<span class="comment">#æ¯ä¸€ä»£çš„æˆæœ¬</span></span><br><span class="line">		ecpho_cost=<span class="number">0</span></span><br><span class="line">		num_mini_batch=int(m/mini_batch_size)</span><br><span class="line">		<span class="keyword">for</span> mini_batch <span class="keyword">in</span> mini_batchs:</span><br><span class="line">			mini_batch_x,mini_batch_y=mini_batch</span><br><span class="line">			_,mini_cost=session.run([optimizer,cost],feed_dict=&#123;X:mini_batch_x,Y:mini_batch_y&#125;)</span><br><span class="line">			ecpho_cost=ecpho_cost+mini_cost/num_mini_batch</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> i%<span class="number">5</span>==<span class="number">0</span>:</span><br><span class="line">			costs.append(ecpho_cost)</span><br><span class="line">			<span class="keyword">if</span> i%<span class="number">100</span>==<span class="number">0</span>:</span><br><span class="line">				print(<span class="string">"ç¬¬"</span>+str(i)+<span class="string">"æ¬¡ï¼Œcost:"</span>+str(ecpho_cost))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#6.ç”»å›¾</span></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.xlabel(<span class="string">"iteration"</span>)</span><br><span class="line">	plt.ylabel(<span class="string">"cost"</span>)</span><br><span class="line">	plt.title(<span class="string">"learning_rate:"</span>+str(learning_rate))</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line">	<span class="comment">#7.ä¿å­˜å‚æ•° ï¼ï¼ï¼ï¼ï¼è¦åœ¨sessionä¸­ä¿å­˜ï¼Œä¸ç„¶parametersä¸€ç›´æ˜¯åªæœ‰ç‰©ç†ç©ºé—´ï¼Œæ²¡æœ‰èµ‹å€¼çš„çŠ¶æ€</span></span><br><span class="line">	parameters=session.run(parameters)</span><br><span class="line">	print(<span class="string">"å‚æ•°å·²ä¿å­˜åˆ°session"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#8.è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">	predit_matrix=tf.equal(tf.argmax(Z3),tf.argmax(Y))</span><br><span class="line">	accury=tf.reduce_mean(tf.cast(predit_matrix,<span class="string">"float32"</span>))</span><br><span class="line"></span><br><span class="line">	print(<span class="string">"è®­ç»ƒé›†æ­£ç¡®ç‡:"</span>,session.run(accury,&#123;X:train_x,Y:train_y&#125;))</span><br><span class="line">	print(<span class="string">"æµ‹è¯•é›†æ­£ç¡®ç‡:"</span>,session.run(accury,&#123;X:test_x,Y:test_y&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ7ï¼‰è¾“å…¥è‡ªå·±æ•°æ®è¿›è¡Œæµ‹è¯•</p>
<p>åˆ©ç”¨matplotlibä¸­çš„å›¾ç‰‡å·¥å‚è¯»å…¥å›¾ç‰‡ï¼Œå¹¶è¿›è¡Œå¤§å°è½¬æ¢ï¼Œå°†ä¸Šè¿°å¾—å‡ºçš„æ¨¡å‹å‚æ•°å’Œå½“å‰å›¾åƒè¾“å…¥é¢„æµ‹å‡½æ•°ä¸­ï¼ˆé¢„æµ‹å‡½æ•°æ˜¯è¿›è¡Œä¸€æ¬¡å‰å‘ä¼ æ’­ï¼Œå¹¶æ ¹æ®æœ€ç»ˆçš„è¾“å‡ºåˆ¤æ–­ç±»åˆ«ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> image <span class="keyword">as</span> mpimg</span><br><span class="line">my_image=<span class="string">"1.png"</span></span><br><span class="line">file_name=<span class="string">"./datasets/fingers/"</span>+my_image</span><br><span class="line">img=mpimg.imread(file_name)</span><br><span class="line">plt.imshow(img)</span><br><span class="line">plt.show()</span><br><span class="line">my_test=img.reshape(<span class="number">1</span>,<span class="number">64</span>*<span class="number">64</span>*<span class="number">3</span>).T</span><br><span class="line">predict=tu.predict(my_test,parameters)</span><br><span class="line">print(<span class="string">"é¢„æµ‹ç»“æœä¸ºï¼š"</span>+str(predict))</span><br></pre></td></tr></table></figure>

<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>ï¼ˆ1ï¼‰è®­ç»ƒç»“æœ</p>
<p>å³ç®—æ³•ä¸­ç¬¬6æ­¥ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519160728.png" alt></p>
<p>è®­ç»ƒé›†æ­£ç¡®ç‡: 0.9990741<br>æµ‹è¯•é›†æ­£ç¡®ç‡: 0.71666664</p>
<p>å¯è§æŸå¤±ä¸æ–­å‡å°‘ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ­£ç¡®ç‡æ•ˆæœå¯ä»¥ã€‚</p>
<p>ï¼ˆ2ï¼‰æµ‹è¯•ç»“æœ</p>
<p>è¾“å…¥æ–°çš„å›¾ç‰‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519205603.png" alt></p>
<p>é¢„æµ‹ç»“æœä¸º</p>
<p>CPUè¿è¡Œæ—¶é—´407.137855s.<br>é¢„æµ‹ç»“æœä¸ºï¼š[1]</p>
<p>å¯è§é¢„æµ‹æ— è¯¯ï¼Œè®­ç»ƒå¥½çš„ç½‘ç»œèƒ½è¯†åˆ«å‡ºæ‰‹åŠ¿ã€‚</p>
<h2 id="é™„"><a href="#é™„" class="headerlink" title="é™„"></a>é™„</h2><h3 id="è¶…å‚è°ƒè¯•"><a href="#è¶…å‚è°ƒè¯•" class="headerlink" title="è¶…å‚è°ƒè¯•"></a>è¶…å‚è°ƒè¯•</h3><p>ï¼ˆ1ï¼‰è¶…å‚è°ƒè¯•é‡‡ç”¨éšæœºå–å€¼æ–¹å¼ï¼šå› ä¸ºä¸çŸ¥é“å“ªä¸ªå‚æ•°æ›´é‡è¦</p>
<p>ï¼ˆ2ï¼‰é‡‡å–ä»ç²—ç³™åˆ°ç²¾ç»†çš„ç­–ç•¥ï¼šå…ˆåœ¨å¤§èŒƒå›´å†…éšæœºå–å€¼ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°æœ€å¥½æ•ˆæœçš„åŒºé—´ï¼Œåœ¨è¿™ä¸ªåŒºé—´è¿›è¡Œç²¾ç»†åŒ–ï¼Œå³æ›´å¯†é›†çš„å–å€¼</p>
<p>ï¼ˆ3ï¼‰æ³¨æ„æ ‡å°ºçš„é€‰æ‹©ï¼šå½“å°çš„å˜åŒ–å¯¹ç»“æœå½±å“å¾ˆå¤§æ—¶ï¼Œéœ€è¦ä½¿ç”¨å¯¹æ•°æ ‡å°º</p>
<p>å¦‚å‚æ•°å–å€¼ä¸º0.9 ~ 0.99ï¼Œåˆ™è½¬æ¢ä¸º1-ï¼ˆ0.1 ~ 0.11ï¼‰,æœ€å¤§å€¼0.1å¯¹åº”10^-1ï¼Œæœ€å°å€¼0.11å¯¹åº”10^-2</p>
<p>åˆ™å–å€¼èŒƒå›´æŒ‡æ•°r=[-2ï¼Œ-1]ï¼Œå‚æ•°å–å€¼ä¸º1-10^r</p>
<p>é™„ï¼šå„è¶…å‚çš„é‡è¦æ€§æ’åºï¼š</p>
<p>å­¦ä¹ ç‡learning_rate &gt; momentumä¸­çš„beta(å¸¸ç”¨å–å€¼0.9) = éšè—å±‚ç¥ç»å…ƒæ•°é‡ = mini_batch_size &gt; ç½‘ç»œå±‚æ•° = å­¦ä¹ ç‡è¡°å‡ç‡</p>
<p>æœ€ä¸é‡è¦Adamç®—æ³•ä¸­çš„beta1(å–0.9)ï¼Œbeta2(å–0.99)ï¼Œepsilon(å–1e-8)</p>
<h3 id="batch-normå½’ä¸€åŒ–"><a href="#batch-normå½’ä¸€åŒ–" class="headerlink" title="batch normå½’ä¸€åŒ–"></a>batch normå½’ä¸€åŒ–</h3><p>å½“æ·±å±‚ç½‘ç»œå±‚æ•°å¾ˆå¤šï¼Œå³ç½‘ç»œå¾ˆæ·±æ—¶ï¼Œå¯ä»¥ä½¿ç”¨batch normå½’ä¸€åŒ–å¯¹éšè—å±‚æ•°æ®è¿›è¡Œå½’ä¸€åŒ–ã€‚</p>
<p>ä½œç”¨ï¼šä½¿å¾—æ¯å±‚éšè—å±‚çš„è¾“å…¥æ›´è¶‹äºç¨³å®šèŒƒå›´å†…ï¼Œå³é™åˆ¶äº†åœ¨å‰å±‚ç½‘ç»œå‚æ•°å˜åŒ–æ—¶ï¼Œä¼šå½±å“æ•°å€¼çš„åˆ†å¸ƒï¼Œä½¿å¾—åå±‚çš„å€¼è¶‹äºç¨³å®šï¼Œå³åé¢å•å…ƒä¸è¿‡åˆ†ä¾èµ–å‰é¢å•å…ƒï¼Œå…·æœ‰ä¸€å®šçš„ç‹¬ç«‹æ€§ï¼Œå¯å•ç‹¬è¿›è¡Œå­¦ä¹ ã€‚</p>
<p>æ–¹æ³•ï¼šç”¨å‚æ•°Î²,Î³æ§åˆ¶éšè—å±‚çš„æ–¹å·®å’Œå‡å€¼</p>
<p>ï¼ˆä¸ºäº†ä½¿å¾—æ–¹å·®å’Œå‡å€¼ä¸å…¨ä¸º0ï¼Œ1ï¼ŒåŠ å…¥çš„è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå½“æ–¹å·®å’Œå‡å€¼ä¸º0ï¼Œ1ï¼Œåˆ™æ¿€æ´»å‡½æ•°åªåœ¨æŸä¸€æ®µå˜åŒ–ï¼Œä¸èƒ½å®Œå…¨å­¦ä¹ åˆ°æ‰€æœ‰ç‰¹å¾ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519202110.png" alt></p>
<p>æ›´æ–°å‚æ•°æ—¶å’Œæ›´æ–°æƒé‡ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æˆ–è€…Adamç­‰å…¶ä»–ç®—æ³•ã€‚</p>
<p>æ³¨ï¼šæµ‹è¯•æ—¶æ²¡æœ‰å‡å€¼å’Œæ–¹å·®ï¼Œåˆ™éœ€è¦åœ¨è®­ç»ƒæ—¶ï¼Œæ ¹æ®æŒ‡æ•°åŠ æƒå¹³å‡æ–¹æ³•å¾—åˆ°è®­ç»ƒé›†æ•´ä½“çš„å‡å€¼å’Œæ–¹å·®ï¼Œä½œä¸ºæµ‹è¯•çš„å‡å€¼å’Œæ–¹å·®ä½¿ç”¨</p>
<h3 id="å¤šåˆ†ç±»ä½¿ç”¨softmax"><a href="#å¤šåˆ†ç±»ä½¿ç”¨softmax" class="headerlink" title="å¤šåˆ†ç±»ä½¿ç”¨softmax"></a>å¤šåˆ†ç±»ä½¿ç”¨softmax</h3><p>å½“è¾“å‡ºå±‚çš„åˆ†ç±»ä¸æ­¢2ä¸ªæ—¶ï¼Œä½¿ç”¨softmaxå‡½æ•°ï¼šå¯¹è¾“å‡ºçš„æ•°å€¼è¿›è¡Œåˆ¤æ–­ï¼Œå°†æœ€å¤§æ¦‚ç‡å¯¹åº”çš„æ•°å€¼ä½œä¸ºå½“å‰åˆ†ç±»ï¼ˆè¾“å‡ºå±‚å¾—åˆ°çš„æœ€å¤§çš„æ•°å³æ¦‚ç‡æœ€å¤§ï¼‰</p>
<p>å½“åˆ°æœ€åä¸€å±‚æ—¶ï¼Œå¾—åˆ°çº¿æ€§å€¼Z[l]ï¼Œæ¿€æ´»å‡½æ•°ä½¿ç”¨å¯¹å¹‚æŒ‡æ•°å–å¹³å‡çš„æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519203045.png" alt></p>
<p>å¾—åˆ°æœ€å¤§çš„å€¼ä½œä¸ºè¾“å‡ºå€¼ã€‚</p>
<p>æŸå¤±å‡½æ•°ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519203054.png" alt></p>
<h3 id="å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶"><a href="#å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶" class="headerlink" title="å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶"></a>å…¶ä»–æ·±åº¦å­¦ä¹ æ¡†æ¶</h3><p>å¯¹ä¸åŒé¢†åŸŸçš„ä¸åŒåº”ç”¨æœ‰ä¸åŒçš„æ·±åº¦å­¦ä¹ æ¡†æ¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200519203341.png" alt></p>
<p>ï¼ˆæ·±åº¦å­¦ä¹ æ¡†æ¶å­¦ä¹ å¾…ç»­â€¦ï¼‰</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œâ€”â€”ç¬¬äºŒå‘¨ç¼–ç¨‹ä½œä¸š</title>
    <url>/blogs/ipvNNet2/</url>
    <content><![CDATA[<p>å¯ä»¥é€šè¿‡ä¼˜åŒ–ç®—æ³•æé«˜ç½‘ç»œè®­ç»ƒé€Ÿåº¦</p><h2 id="Mini-batchæ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#Mini-batchæ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="Mini_batchæ¢¯åº¦ä¸‹é™ç®—æ³•"></a>Mini_batchæ¢¯åº¦ä¸‹é™ç®—æ³•</h2><p>æ¢¯åº¦ä¸‹é™ç®—æ³•å°†æ ·æœ¬å…¨éƒ¨éå†ä¸€éåï¼Œå†è®¡ç®—æ¢¯åº¦ï¼Œå½“æ ·æœ¬å¾ˆå¤šæ—¶ï¼Œè®­ç»ƒæ—¶é—´å¤ªé•¿ã€‚</p><p>è¿™æ—¶å€™éœ€è¦ç”¨Mini_batchæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼š</p><p>ï¼ˆ1ï¼‰å°†åŸå§‹çš„æ ·æœ¬æ‰“ä¹±ï¼Œéšæœºåˆ†å¸ƒï¼Œä½¿ç”¨numpyåº“ä¸­permutationç”Ÿæˆéšæœºæ•°ç»„ï¼Œæ‰“ä¹±æ ·æœ¬é›†</p><p>ï¼ˆ2ï¼‰å°†æ ·æœ¬æŒ‰ç…§ç”¨æˆ·è¾“å…¥çš„å¤§å°mini_batch_sizeï¼ˆä¸€èˆ¬æ˜¯64 ~ 512ï¼Œå³ç¬¦åˆè®¡ç®—æœºå†…å­˜å¤§å°çš„2çš„å¹‚æ¬¡æ–¹ï¼Œè¿™æ ·è®­ç»ƒé€Ÿåº¦ä¼šå¿«ï¼‰ï¼Œå°†æ ·æœ¬é‡æ–°åˆ†ä¸ºx{1}ï¼Œx{2} â€¦x{n}ï¼Œå…¶ä¸­åˆ’åˆ†çš„ä¸ªæ•°num_mini_batch=æ ·æœ¬æ€»ä¸ªæ•°m / mini_batch_sizeï¼Œåˆ™ç¬¬ä¸€ä¸ªmini_batchï¼Œå³x{1}=train_x[:ï¼Œ0:mini_batch_size * 1]ï¼Œç¬¬äºŒä¸ªmini_batchï¼Œå³x{2}=train_x[:ï¼Œmini_batch_size * 1ï¼šmini_batch_size * 2]</p><a id="more"></a>




<p>ï¼ˆ3ï¼‰ç”±äºåˆ’åˆ†çš„ä¸ªæ•°num_mini_batchå¯èƒ½æœ‰å°æ•°éƒ¨åˆ†ï¼Œç¬¬äºŒæ­¥æ˜¯å¤„ç†å…¶æ•´æ•°éƒ¨åˆ†ï¼Œå½“å¤„ç†ç»“æŸåï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦æœ‰ä½™ä¸‹éƒ¨åˆ†ï¼Œæœ‰ä½™ä¸‹éƒ¨åˆ†éœ€è¦å°†æ•°æ®è¡¥å…¨åœ¨æœ€åx{n}=train_x[:ï¼Œmini_batch_size * num_mini_batchï¼š]</p>
<p>ï¼ˆ4ï¼‰æ³¨ï¼šå½“ç”¨æˆ·è¾“å…¥çš„å¤§å°mini_batch_size=æ ·æœ¬æ€»æ•°æ—¶ï¼Œç®—æ³•å˜ä¸ºæ¢¯åº¦ä¸‹é™æ³•ï¼Œå³ä¸€æ¬¡éå†æ•´ä¸ªæ ·æœ¬é›†ï¼Œå½“ç”¨æˆ·è¾“å…¥çš„å¤§å°mini_batch_size==1æ—¶ï¼Œç®—æ³•å˜ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå³ä¸€æ¬¡éå†ä¸€ä¸ªæ ·æœ¬ï¼Œæ­¤æ—¶å¤±å»äº†å°†æ ·æœ¬å‘é‡åŒ–çš„åŠ é€Ÿä½œç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨mini_batchçš„æ¢¯åº¦ä¸‹é™ï¼ˆå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_mini_batches</span><span class="params">(X,Y,mini_batch_size,seed)</span>:</span></span><br><span class="line">	np.random.seed(seed)</span><br><span class="line">	mini_batchs=[]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è·å–æ ·æœ¬çš„æ•°é‡</span></span><br><span class="line">	m=X.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.æ‰“ä¹±è®­ç»ƒé›†</span></span><br><span class="line">	<span class="comment">#è¿”å›é•¿åº¦ä¸ºmçš„éšæœºæ•°ç»„</span></span><br><span class="line">	permutation=list(np.random.permutation(m))</span><br><span class="line">	shuffle_X=X[:,permutation]</span><br><span class="line">	shuffle_Y=Y[:,permutation].reshape((<span class="number">1</span>,m))</span><br><span class="line"></span><br><span class="line">	num_mini_batch=math.floor(m/mini_batch_size)</span><br><span class="line">	<span class="comment">#2.æŒ‰ç…§å¤§å°åˆ‡åˆ†æ•°æ®</span></span><br><span class="line">	<span class="keyword">for</span> k <span class="keyword">in</span> range(num_mini_batch):</span><br><span class="line">		mini_batch_X=shuffle_X[:,mini_batch_size*k:mini_batch_size*(k+<span class="number">1</span>)]</span><br><span class="line">		mini_batch_Y=shuffle_Y[:,mini_batch_size*k:mini_batch_size*(k+<span class="number">1</span>)]</span><br><span class="line">		mini_batch=(mini_batch_X,mini_batch_Y)</span><br><span class="line"></span><br><span class="line">		mini_batchs.append(mini_batch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.å¤„ç†ä½™ä¸‹éƒ¨åˆ†çš„æ•°æ®</span></span><br><span class="line">	<span class="keyword">if</span>(m%mini_batch_size!=<span class="number">0</span>):</span><br><span class="line">		mini_batch_X=shuffle_X[:,mini_batch_size*num_mini_batch:]</span><br><span class="line">		mini_batch_Y=shuffle_Y[:,mini_batch_size*num_mini_batch:]</span><br><span class="line">		mini_batch=(mini_batch_X,mini_batch_Y)</span><br><span class="line">		mini_batchs.append(mini_batch)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> mini_batchs</span><br></pre></td></tr></table></figure>

<p>a ï¼‰å½“mini_batch_sizeè®¾ç½®ä¸ºæ ·æœ¬æ€»æ•°æ—¶</p>
<p>æŸå¤±å˜åŒ–æƒ…å†µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515143104.png" alt></p>
<p>train data:<br>Accuracy: 0.66</p>
<p>æ‰“å°å‡ºçš„å†³ç­–è¾¹ç•Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515143125.png" alt></p>
<p>b ï¼‰ å½“mini_batch_sizeè®¾ç½®ä¸º64æ—¶</p>
<p>æŸå¤±å˜åŒ–æƒ…å†µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515142350.png" alt></p>
<p>train data:<br>Accuracy: 0.7966666666666666</p>
<p>æ‰“å°å‡ºçš„å†³ç­–è¾¹ç•Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515142739.png" alt></p>
<p>åˆ†æ</p>
<p>å¯ä»¥çœ‹å‡ºæ¢¯åº¦ä¸‹é™ç®—æ³•åŸºæœ¬æ— æ‘†åŠ¨ï¼Œä½†æ˜¯æŸå¤±ä¸‹é™åˆ°0.64å·¦å³å˜åŒ–å¹…åº¦å¾ˆå°ï¼Œä»åˆ†ç±»æƒ…å†µæ¥çœ‹è¯¯åˆ†è§’åº¦ï¼Œè€Œmini_batchæ¢¯åº¦ä¸‹é™ç®—æ³•æ‘†åŠ¨è¾ƒå¤§ï¼Œåˆ†ç±»å‡†ç¡®ç‡æ¯”æ¢¯åº¦ä¸‹é™è¦é«˜ä¸€äº›ã€‚</p>
<h2 id="Momentunç®—æ³•ï¼ˆå¸¦åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼‰"><a href="#Momentunç®—æ³•ï¼ˆå¸¦åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼‰" class="headerlink" title="Momentunç®—æ³•ï¼ˆå¸¦åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼‰"></a>Momentunç®—æ³•ï¼ˆå¸¦åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼‰</h2><p>Momentunç®—æ³•ä½¿ç”¨äº†æŒ‡æ•°åŠ æƒå¹³å‡é¡¹æ¥è®¡ç®—æ¢¯åº¦ï¼ŒåŠ¨é‡å‚æ•°betaè®¾ç½®ä¸º0.9ï¼Œæ¯ä¸ªæ¢¯åº¦çš„å˜åŒ–å‰éƒ½åŠ å…¥äº†æŒ‡æ•°é¡¹ï¼Œéšç€æ—¶é—´å¢åŠ ï¼Œæ¢¯åº¦å‰çš„æŒ‡æ•°é¡¹è¡°å‡ï¼Œå³æ¯æ¬¡æ¢¯åº¦çš„å˜åŒ–éƒ½å‚ç…§äº†å‰é¢æ¢¯åº¦çš„å˜åŒ–æ–¹å‘ï¼ˆè¶Šè¿‘çš„æ¢¯åº¦æƒé‡è¶Šé«˜ï¼‰ï¼Œä»è€Œå‡å°‘å‘æœ€ä½ç‚¹å‰è¿›æ—¶çš„æ‘†åŠ¨ã€‚</p>
<p>æ³¨ï¼šæŒ‡æ•°åŠ æƒå¹³å‡é¡¹ v(t)=beta * v(t-1)+(1-beta) * Î¸</p>
<p>ï¼ˆ1ï¼‰åœ¨åˆå§‹åŒ–å‚æ•°çš„æ—¶å€™ï¼ŒæŒ‰ç…§å‚æ•°Wï¼Œbçš„ç»´åº¦ç”ŸæˆåŠ¨é‡é¡¹</p>
<p>ï¼ˆ2ï¼‰å½“é€‰æ‹©å¸¦åŠ¨é‡çš„æ¢¯åº¦ä¸‹é™ç®—æ³•æ—¶ï¼ŒæŒ‰ç…§æŒ‡æ•°åŠ æƒå¹³å‡å…¬å¼ï¼Œè®¡ç®—åŠ¨é‡é¡¹ï¼Œå½“å•çº¯ä½¿ç”¨momentumç®—æ³•æ—¶ï¼Œä¸éœ€è¦åå·®ä¿®æ­£ï¼Œæ ¹æ®åŠ¨é‡é¡¹æ›´æ–°å‚æ•°Wï¼Œb</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#momentumç®—æ³•</span></span><br><span class="line"><span class="comment">#é€šè¿‡æŒ‡æ•°åŠ æƒå¹³å‡æ–¹æ³•æ”¹å˜æ¢¯åº¦ï¼Œå‡å°‘æ‘†åŠ¨å¹…åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_momentum</span><span class="params">(parameters)</span>:</span></span><br><span class="line">	L=len(parameters)//<span class="number">2</span></span><br><span class="line">	v=&#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(L):</span><br><span class="line">		v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line">		v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line">	<span class="keyword">return</span> v</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameter_momentum</span><span class="params">(parameters,grads,v,beta,learning_rate)</span>:</span></span><br><span class="line">	L=len(parameters)//<span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(L):</span><br><span class="line">		v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=beta*v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta)*grads[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">		v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=beta*v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta)*grads[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">		parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]=parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]-learning_rate*v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">		parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]=parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]-learning_rate*v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">	<span class="keyword">return</span> parameters,v</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515143700.png" alt></p>
<p>train data:<br>Accuracy: 0.8766666666666667</p>
<p>æ‰“å°å‡ºçš„å†³ç­–è¾¹ç•Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515143712.png" alt></p>
<p>åˆ†æ</p>
<p>momentunç®—æ³•ä¸­ç”±äºæ¯æ¬¡æ¢¯åº¦çš„å˜åŒ–éƒ½æ˜¯å‚è€ƒä¹‹å‰çš„æ¢¯åº¦è¿›è¡Œå˜åŒ–ï¼Œå³å¢åŠ äº†åŠ¨é‡ï¼Œæ‘†åŠ¨å¹…åº¦æ¯”åªä½¿ç”¨mini_batchç®—æ³•è¾ƒå°ï¼Œå¹¶ä¸”åˆ†ç±»æ­£ç¡®ç‡ä¹Ÿæé«˜äº†ã€‚</p>
<h2 id="Adamç®—æ³•ï¼ˆç»“åˆMomentunå’ŒRMSpropç®—æ³•ï¼‰"><a href="#Adamç®—æ³•ï¼ˆç»“åˆMomentunå’ŒRMSpropç®—æ³•ï¼‰" class="headerlink" title="Adamç®—æ³•ï¼ˆç»“åˆMomentunå’ŒRMSpropç®—æ³•ï¼‰"></a>Adamç®—æ³•ï¼ˆç»“åˆMomentunå’ŒRMSpropç®—æ³•ï¼‰</h2><p>RMSpropç®—æ³•æ˜¯ä¿ç•™å¾®åˆ†å¹³æ–¹çš„åŠ æƒå¹³å‡æ•°çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¹Ÿæ˜¯ç”¨äºè¾ƒå°‘æ¢¯åº¦å˜åŒ–ä¸­çš„æ‘†åŠ¨ã€‚</p>
<p>è®¡ç®—å…¬å¼ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515144636.png" alt></p>
<p>åœ¨å¯¹æ¯ä¸ªmini_batchè¿­ä»£ä¸­ï¼ŒæŒ‰ç…§æŒ‡æ•°åŠ æƒå¹³å‡çš„è¡°å‡æ–¹å¼è®¡ç®—æ¢¯åº¦ï¼Œä½†æ˜¯è¿™é‡Œæ¢¯åº¦æ˜¯éœ€è¦å°†å¾®åˆ†å¹³æ–¹ï¼Œç„¶åå†æ›´æ–°å‚æ•°ï¼Œä¸ºäº†è®©æ›´æ–°å‚æ•°ä¸­çš„åˆ†æ¯ä¸º0ï¼Œè¿™é‡Œå°†åˆ†æ¯åŠ ä¸Šepsilon(é»˜è®¤å€¼ä¸º1e-8)</p>
<p>Adamç®—æ³•æ˜¯ç»“åˆMomentunå’ŒRMSpropç®—æ³•</p>
<p>ï¼ˆ1ï¼‰momentunéƒ¨åˆ†ï¼šåœ¨åˆå§‹åŒ–å‚æ•°çš„æ—¶å€™ï¼ŒæŒ‰ç…§å‚æ•°Wï¼Œbçš„ç»´åº¦ç”ŸæˆåŠ¨é‡é¡¹ï¼›RMSpropéƒ¨åˆ†ï¼šåœ¨åˆå§‹åŒ–å‚æ•°çš„æ—¶å€™ï¼ŒæŒ‰ç…§å‚æ•°Wï¼Œbç”Ÿæˆç”Ÿæˆåˆå§‹é¡¹Sdwï¼ŒSdb</p>
<p>ï¼ˆ2ï¼‰momentunéƒ¨åˆ†ï¼šæŒ‰ç…§æŒ‡æ•°åŠ æƒå¹³å‡å…¬å¼ï¼Œè®¡ç®—åŠ¨é‡é¡¹ï¼Œå¹¶è¿›è¡Œåå·®ä¿®æ­£(v /ï¼ˆ1-np.powerï¼ˆbeta1,tï¼‰))ï¼Œå¾—åˆ°ä¿®æ­£ä¹‹åçš„åŠ¨é‡é¡¹ï¼›RMSpropéƒ¨åˆ†ï¼šæŒ‰ç…§ä¿ç•™å¾®åˆ†å¹³æ–¹çš„åŠ æƒå¹³å‡æ•°æ–¹å¼ï¼Œå¾—åˆ°Sdwï¼ŒSdbï¼Œå¹¶è¿›è¡Œåå·®ä¿®æ­£(s /ï¼ˆ1-np.powerï¼ˆbeta2,tï¼‰))ï¼Œå…¶ä¸­momentuméƒ¨åˆ†çš„beat1é»˜è®¤ä¸º0.9ï¼ŒRMSpropéƒ¨åˆ†çš„beta2é»˜è®¤ä¸º0.99</p>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨æŒ‡æ•°è¡°å‡ä¹‹åçš„æ¢¯åº¦å€¼æ›´æ–°å‚æ•°Wï¼Œb</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515145910.png" alt></p>
<p>æ³¨ï¼šåå·®ä¿®æ­£æ˜¯å°†éœ€è¦ä¿®æ­£çš„é¡¹ç›®væˆ–è€…sé™¤ä»¥ï¼ˆ1-np.powerï¼ˆbeta,tï¼‰ï¼‰ï¼Œå…¶ä¸­tä»£è¡¨ç¬¬å‡ ä¸ªmini_catchï¼Œè¿™é‡Œçš„betaéƒ½æ˜¯å°äº1çš„ï¼ˆç”±äºæ˜¯è¿›è¡ŒæŒ‡æ•°è¡°å‡ï¼‰ï¼Œå½“tè¶Šå¤§ï¼Œnp.powerï¼ˆbeta,tï¼‰çš„å€¼è¶Šæ¥è¿‘äº0ï¼Œåˆ†æ¯å°±æ¥è¿‘1ï¼Œæ­¤æ—¶åŸºæœ¬æ²¡æœ‰ä¿®æ­£ï¼Œå½“tè¶Šå°ï¼Œä¿®æ­£è¶Šå¤šï¼Œè¿™æ˜¯ç”±äºç®—æ³•åˆå§‹çš„æ—¶å€™ï¼Œç”±äºè¿­ä»£æ¬¡æ•°å°‘ï¼Œæ•°å€¼å‡ºç°åå·®å¯èƒ½å¤§ï¼Œæ‰€ä»¥åœ¨åˆå§‹æ—¶éœ€è¦ä¿®æ­£å¤šä¸€äº›ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#adamç®—æ³•</span></span><br><span class="line"><span class="comment">#ç»“åˆäº†momentunç®—æ³•å’ŒRMSpropç®—æ³•ï¼Œå¹¶è¿›è¡Œåå·®ä¿®æ­£</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_adam</span><span class="params">(parameters)</span>:</span></span><br><span class="line">	L=len(parameters)//<span class="number">2</span></span><br><span class="line">	v=&#123;&#125;</span><br><span class="line">	s=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(L):</span><br><span class="line">		v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line">		v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line">		s[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line">		s[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=np.zeros_like(parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> v,s</span><br><span class="line"></span><br><span class="line"><span class="comment">#tè¡¨ç¤ºè¿­ä»£çš„mini_batchçš„æ¬¡æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameter_adam</span><span class="params">(parameters,grads,v,s,t,learning_rate=<span class="number">0.01</span>,beta1=<span class="number">0.9</span>,beta2=<span class="number">0.999</span>,epsilon=<span class="number">1e-8</span>)</span>:</span></span><br><span class="line">	L=len(parameters)//<span class="number">2</span></span><br><span class="line">	vcorrect=&#123;&#125;</span><br><span class="line">	scorrect=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(L):</span><br><span class="line">		v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=beta1*v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta1)*grads[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">		v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=beta1*v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta1)*grads[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">		vcorrect[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=v[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]/(<span class="number">1</span>-np.power(beta1,t))</span><br><span class="line">		vcorrect[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=v[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]/(<span class="number">1</span>-np.power(beta1,t))</span><br><span class="line"></span><br><span class="line">		s[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=beta2*s[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta2)*(np.square(grads[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]))</span><br><span class="line">		s[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=beta2*s[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]+(<span class="number">1</span>-beta2)*(np.square(grads[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]))</span><br><span class="line">		scorrect[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=s[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]/(<span class="number">1</span>-np.power(beta2,t))</span><br><span class="line">		scorrect[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=s[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]/(<span class="number">1</span>-np.power(beta2,t))</span><br><span class="line"></span><br><span class="line">		parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]=parameters[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]-learning_rate*vcorrect[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]/np.sqrt(scorrect[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]+epsilon)</span><br><span class="line">		parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]=parameters[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]-learning_rate*vcorrect[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]/np.sqrt(scorrect[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]+epsilon)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters,v,s</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515150033.png" alt></p>
<p>train data:<br>Accuracy: 0.94</p>
<p>æ‰“å°å‡ºçš„å†³ç­–è¾¹ç•Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515150045.png" alt></p>
<p>åˆ†æ</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œadamç®—æ³•åŸºæœ¬æ— æ‘†åŠ¨ï¼Œåˆ†ç±»å‡†ç¡®ç‡ä¹Ÿå¾ˆé«˜</p>
<h2 id="é™„ï¼šå­¦ä¹ ç‡è¡°å‡"><a href="#é™„ï¼šå­¦ä¹ ç‡è¡°å‡" class="headerlink" title="é™„ï¼šå­¦ä¹ ç‡è¡°å‡"></a>é™„ï¼šå­¦ä¹ ç‡è¡°å‡</h2><p>åœ¨å­¦ä¹ åˆæœŸï¼Œå­¦ä¹ ç‡å¤§ï¼›åœ¨æ”¶æ•›æ—¶ï¼Œå­¦ä¹ ç‡å°ï¼ŒæŒ‰ç…§ä»¥ä¸‹å…¬å¼è®¾ç½®å­¦ä¹ ç‡</p>
<p>alpha=(1 / ï¼ˆ1+è¡°å‡ç‡ * è¿­ä»£æ¬¡æ•°ï¼‰) * alpha0</p>
<p>è¿˜æœ‰å…¶ä»–æŒ‡æ•°è¡°å‡æˆ–è€…ç¦»æ•£è¡°å‡æ–¹å¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200515162005.png" alt></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ï¼ˆ1ï¼‰å½“æ ·æœ¬é›†æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œä½¿ç”¨mini_batchç®—æ³•åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼Œæ¯æ¬¡éå†mini_batch_sizeå¤§å°çš„æ•°æ®ï¼Œå½“ç”¨æˆ·è¾“å…¥çš„å¤§å°mini_batch_size=æ ·æœ¬æ€»æ•°æ—¶ï¼Œç®—æ³•å˜ä¸ºæ¢¯åº¦ä¸‹é™æ³•ï¼Œå³ä¸€æ¬¡éå†æ•´ä¸ªæ ·æœ¬é›†ï¼Œå½“ç”¨æˆ·è¾“å…¥çš„å¤§å°mini_batch_size==1æ—¶ï¼Œç®—æ³•å˜ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå³ä¸€æ¬¡éå†ä¸€ä¸ªæ ·æœ¬ï¼Œæ­¤æ—¶å¤±å»äº†å°†æ ·æœ¬å‘é‡åŒ–çš„åŠ é€Ÿä½œç”¨ã€‚</p>
<p>ï¼ˆ2ï¼‰ç”±äºæ¢¯åº¦ä¸‹é™æ—¶å­˜åœ¨æ‘†åŠ¨ï¼Œå³å™ªå£°å¾ˆå¤§ï¼Œæ­¤æ—¶å­¦ä¹ ç‡éœ€è¦å¾ˆå°ï¼Œå³å‘æœ€ä½ç‚¹å‰è¿›çš„æ­¥é•¿å°ï¼Œè¿™æ—¶ä¹Ÿä¼šå¯¼è‡´ç½‘ç»œè®­ç»ƒé€Ÿåº¦å‡æ…¢ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ ç”¨æŒ‡æ•°åŠ æƒå¹³å‡é¡¹æ¥å¾—åˆ°å½“å‰çš„æ¢¯åº¦ï¼šæ¯ä¸ªæ¢¯åº¦çš„å˜åŒ–å‰éƒ½åŠ å…¥äº†æŒ‡æ•°é¡¹ï¼Œéšç€æ—¶é—´å¢åŠ ï¼Œæ¢¯åº¦å‰çš„æŒ‡æ•°é¡¹è¡°å‡ï¼Œå³æ¯æ¬¡æ¢¯åº¦çš„å˜åŒ–éƒ½å‚ç…§äº†å‰é¢æ¢¯åº¦çš„å˜åŒ–æ–¹å‘ï¼ˆè¶Šè¿‘çš„æ¢¯åº¦æƒé‡è¶Šé«˜ï¼‰ï¼Œä»è€Œå‡å°‘å‘æœ€ä½ç‚¹å‰è¿›æ—¶çš„æ‘†åŠ¨ã€‚å…¶ä¸­momentunç®—æ³•å’ŒAdamç®—æ³•èƒ½æœ‰æ•ˆå‡å°‘æ‘†åŠ¨ï¼Œå¯ä»¥å¢åŠ å­¦ä¹ ç‡ï¼Œå³åŠ å¤§æ¯æ¬¡å‚æ•°å˜åŒ–çš„æ­¥é•¿ï¼Œä»è€ŒåŠ å¿«äº†ç½‘ç»œè®­ç»ƒé€Ÿåº¦ï¼Œå…¶ä¸­Adamç®—æ³•ç”±äºç»“åˆäº†ç»“åˆMomentunå’ŒRMSpropç®—æ³•ï¼Œä¼˜åŒ–æ•ˆæœæœ€å¥½ï¼Œå¹¶ä¸”åˆ†ç±»å‡†ç¡®ç‡ä¹Ÿé«˜ã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ï¼ˆè½¬è½½ï¼‰windows10ä¸“ä¸šç‰ˆ,æˆ‘ä»¬æ— æ³•åœ¨æ­¤è®¾å¤‡ä¸Šæ¿€æ´»windowså› ä¸ºæ— æ³•è¿æ¥åˆ°ä½ çš„ç»„ç»‡çš„æ¿€æ´»æœåŠ¡å™¨è§£å†³æ–¹æ³•</title>
    <url>/blogs/sovConSever/</url>
    <content><![CDATA[<p>è½¬è½½äº <a href="https://www.jianshu.com/p/953c1517e436" target="_blank" rel="external nofollow noopener noreferrer">https://www.jianshu.com/p/953c1517e436</a> </p><p>1.ç®¡ç†å‘˜è¿è¡Œcmdï¼Œç„¶åè¾“å…¥</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX</span><br></pre></td></tr></table></figure><p>2.å†è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">slmgr.vbs -skms zh.us.to</span><br></pre></td></tr></table></figure><p>3.å†è®¾ç½®â€“æ›´æ–°å’Œå®‰å…¨â€“æ¿€æ´»ä¸­ï¼Œç‚¹å‡»æ›´æ–°äº§å“å¯†é’¥ï¼Œè¾“å…¥ä»¥ä¸Šå¯†é’¥ W269N-WFGWX-YVC9B-4J6C9-T83GXï¼Œå¹¶ç‚¹å‡»ä¸‹ä¸€æ­¥æ¿€æ´»è¯¥å¯†é’¥ã€‚</p>]]></content>
      <categories>
        <category>win10</category>
      </categories>
      <tags>
        <tag>win10</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œâ€”â€”ç¬¬ä¸€å‘¨ç¼–ç¨‹ä½œä¸š</title>
    <url>/blogs/ipvNNet1/</url>
    <content><![CDATA[<h2 id="è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†é€‰å–"><a href="#è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†é€‰å–" class="headerlink" title="è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†é€‰å–"></a>è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†é€‰å–</h2><p>è®­ç»ƒé›†ç”¨äºæ ¹æ®ç®—æ³•è®­ç»ƒä¸åŒçš„æ¨¡å‹</p><p>éªŒè¯é›†ç”¨äºéªŒè¯ä¸åŒçš„ç®—æ³•ä¸­å“ªä¸€ç§æ›´æœ‰æ•ˆ</p><p>æµ‹è¯•é›†ç”¨äºè¯„ä¼°ç®—æ³•çš„æ€§èƒ½</p><p>å¯¹äºå¤§æ•°æ®ï¼ˆå¦‚ä¸€ä¸‡æ¡æ•°æ®ä»¥ä¸Šï¼‰ï¼Œè®­ç»ƒé›†ï¼ŒéªŒè¯é›†ï¼Œæµ‹è¯•é›†çš„æ¯”åˆ—ä¸º98%ï¼Œ1%ï¼Œ1%ï¼Œè®­ç»ƒé›†å ç»å¤§éƒ¨åˆ†ã€‚</p><h2 id="æé«˜è®­ç»ƒé€Ÿåº¦"><a href="#æé«˜è®­ç»ƒé€Ÿåº¦" class="headerlink" title="æé«˜è®­ç»ƒé€Ÿåº¦"></a>æé«˜è®­ç»ƒé€Ÿåº¦</h2><h3 id="å½’ä¸€åŒ–è¾“å…¥ç‰¹å¾"><a href="#å½’ä¸€åŒ–è¾“å…¥ç‰¹å¾" class="headerlink" title="å½’ä¸€åŒ–è¾“å…¥ç‰¹å¾"></a>å½’ä¸€åŒ–è¾“å…¥ç‰¹å¾</h3><p>æœªå½’ä¸€åŒ–çš„è¾“å…¥ç‰¹å¾å¾—åˆ°çš„æŸå¤±å‡½æ•°æ˜¯æ¯”è¾ƒç‹­é•¿çš„ï¼Œè€Œä¸”åœ¨åå‘ä¼ æ’­ä¸­ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ—¶ï¼Œæ­¥é•¿éœ€è¦å¾ˆå°ï¼Œå¦åˆ™æ— æ³•æ‰¾åˆ°æœ€å°å€¼ã€‚</p><a id="more"></a>




<p>æ‰€æœ‰éœ€è¦å½’ä¸€åŒ–è¾“å…¥ç‰¹å¾ï¼Œå°†è¾“å…¥ç‰¹å¾ç»Ÿä¸€å‡å»æ•°æ®å‡å€¼å¹¶é™¤ä»¥æ–¹å·®ï¼Œä½¿å¾—å¾—å‡ºçš„æŸå¤±å‡½æ•°æ›´åŒ€ç§°ï¼Œæ— è®ºä»ä»€ä¹ˆæ­¥é•¿éƒ½èƒ½å¾—åˆ°æœ€å°å€¼ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæµ‹è¯•é›†ï¼ŒéªŒè¯é›†éƒ½éœ€è¦å¾ˆè®­ç»ƒé›†ä¸€æ ·çš„å½’ä¸€åŒ–æ–¹å¼</p>
<h3 id="åˆå§‹æƒé‡çš„é€‰å–"><a href="#åˆå§‹æƒé‡çš„é€‰å–" class="headerlink" title="åˆå§‹æƒé‡çš„é€‰å–"></a>åˆå§‹æƒé‡çš„é€‰å–</h3><p>ä¸åŒåˆå§‹åŒ–æ–¹æ³•çš„å¯¹æ¯”</p>
<p>ï¼ˆ1ï¼‰æƒé‡å…¨éƒ½åˆå§‹åŒ–ä¸º0</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.åˆå§‹åŒ–å‚æ•°ä¸º0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_zeros</span><span class="params">(layer_dims)</span>:</span></span><br><span class="line">	L=len(layer_dims)</span><br><span class="line">	parameters=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,L):</span><br><span class="line">		parameters[<span class="string">"W"</span>+str(i)]=np.zeros((layer_dims[i],layer_dims[i<span class="number">-1</span>]))</span><br><span class="line">		parameters[<span class="string">"b"</span>+str(i)]=np.zeros((layer_dims[i],<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513104721.png" alt></p>
<p>åˆ†æ</p>
<p>å¯ä»¥çœ‹å‡ºä½¿ç”¨è¯¥ç§åˆå§‹åŒ–æƒé‡çš„æ–¹å¼ï¼ŒæŸå¤±æ²¡æœ‰å˜åŒ–ï¼Œå¹¶ä¸”é¢„æµ‹ç²¾åº¦ä¹Ÿå¾ˆä½ï¼šè®­ç»ƒé›†Accuracy: 0.5ï¼Œæµ‹è¯•é›†Accuracy: 0.5ã€‚ä¸»è¦æ˜¯å› ä¸ºæƒé‡åˆå§‹åŒ–ä¸º0ï¼Œä½¿å¾—æ‰€æœ‰ç¥ç»å…ƒéƒ½åšç›¸åŒçš„äº‹ï¼Œå­˜åœ¨å¯¹ç§°æ€§ã€‚</p>
<p>ï¼ˆ2ï¼‰æƒé‡ç”¨å¾ˆå¤§çš„éšæœºå€¼åˆå§‹åŒ–</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.åˆå§‹åŒ–å‚æ•°ä¸ºå¾ˆå¤§çš„éšæœºæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_random</span><span class="params">(layer_dims)</span>:</span></span><br><span class="line">	L=len(layer_dims)</span><br><span class="line">	parameters=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,L):</span><br><span class="line">		parameters[<span class="string">"W"</span>+str(i)]=np.random.randn(layer_dims[i],layer_dims[i<span class="number">-1</span>])*<span class="number">10</span></span><br><span class="line">		parameters[<span class="string">"b"</span>+str(i)]=np.zeros((layer_dims[i],<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513105002.png" alt></p>
<p>åˆ†æ</p>
<p>å¯ä»¥çœ‹å‡ºä½¿ç”¨è¯¥ç§åˆå§‹åŒ–æƒé‡çš„æ–¹å¼ï¼ŒæŸå¤±ä¸€å¼€å§‹ç”±äºæƒé‡è¾ƒå¤§ï¼Œä¸‹é™å¿«ï¼Œä½†åˆ°ååŠæ®µï¼ŒæŸå¤±ä¸‹é™å¾ˆæ…¢ï¼Œå› ä¸ºwå˜å¤§ï¼Œzå˜å¤§ï¼Œæ­¤æ—¶çš„æ¢¯åº¦å˜åŒ–ä¸‹ï¼Œè®­ç»ƒé€Ÿåº¦å‡æ…¢ã€‚é¢„æµ‹ç²¾åº¦ä¹Ÿä¸æ˜¯å¾ˆé«˜ï¼šè®­ç»ƒé›†Accuracy: 0.8833333333333333ï¼Œæµ‹è¯•é›†Accuracyï¼š0.85ã€‚</p>
<p>ï¼ˆ3ï¼‰é‡‡ç”¨æŠ‘åˆ¶æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±çš„æ–¹å¼åˆå§‹åŒ–</p>
<p>å½“æƒé‡å¤§äº1æ—¶ï¼Œæ¢¯åº¦ä»¥æŒ‡æ•°æ–¹å¼å¢é•¿ï¼Œå½“æƒé‡å°äº1æ—¶ï¼Œæ¢¯åº¦é€’å‡ï¼Œä¸ºäº†é˜²æ­¢å‡ºç°è¿™ç§æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±çš„å‡ºç°ï¼Œéœ€è¦å°†æƒé‡åˆå§‹åŒ–ä¸ºä¸æ¯”1å¤§å¾ˆå¤šï¼Œä¸æ¯”1å°å¾ˆå¤šçš„å€¼ï¼šw=np.random.randn(shape) * sqrt(1/n[l-1])ï¼Œå³éœ€è¦é™¤ä»¥ä¸Šä¸€å±‚ç¥ç»å…ƒçš„ä¸ªæ•°ï¼ˆn[l-1]ä»£è¡¨ä¸Šä¸€å±‚ç¥ç»å…ƒä¸ªæ•°ï¼‰ï¼Œå°†æƒé‡wå½’ä¸€åŒ–ã€‚ï¼ˆå½“æ¿€æ´»å‡½æ•°æ˜¯tanhæ—¶ï¼Œä½¿ç”¨sqrt(2/n[l-1]æ•ˆæœæ›´å¥½)</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.åˆå§‹åŒ–å‚æ•°ä½¿ç”¨æŠ‘æ¢¯åº¦å¼‚å¸¸æ–¹å¼  ä¹˜ä»¥sqrt(2/ä¸Šä¸€å±‚ç¥ç»å…ƒæ•°é‡)  æŠŠå‚æ•°wåˆå§‹åŒ–åˆ°äº†1é™„è¿‘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters_he</span><span class="params">(layer_dims)</span>:</span></span><br><span class="line">	L=len(layer_dims)</span><br><span class="line">	parameters=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,L):</span><br><span class="line">		parameters[<span class="string">"W"</span>+str(i)]=np.random.randn(layer_dims[i],layer_dims[i<span class="number">-1</span>])*np.sqrt(<span class="number">2</span>/layer_dims[i<span class="number">-1</span>])</span><br><span class="line">		parameters[<span class="string">"b"</span>+str(i)]=np.zeros((layer_dims[i],<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513104411.png" alt></p>
<p>åˆ†æ</p>
<p>å¯ä»¥çœ‹å‡ºä½¿ç”¨è¯¥ç§åˆå§‹åŒ–æƒé‡çš„æ–¹å¼ï¼ŒæŸå¤±é€æ¸å‡å°‘ï¼Œå¹¶ä¸”é¢„æµ‹ç²¾åº¦ä¹Ÿå¾ˆé«˜ï¼šè®­ç»ƒé›†Accuracy: 0.9933333333333333ï¼Œæµ‹è¯•é›†Accuracy: 0.93ã€‚</p>
<p>æ€»ç»“</p>
<p>é‡‡ç”¨æŠ‘åˆ¶æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±çš„æ–¹å¼åˆå§‹åŒ–æƒé‡</p>
<h2 id="é«˜åå·®é«˜æ–¹å·®çš„è§£å†³"><a href="#é«˜åå·®é«˜æ–¹å·®çš„è§£å†³" class="headerlink" title="é«˜åå·®é«˜æ–¹å·®çš„è§£å†³"></a>é«˜åå·®é«˜æ–¹å·®çš„è§£å†³</h2><h3 id="é«˜åå·®"><a href="#é«˜åå·®" class="headerlink" title="é«˜åå·®"></a>é«˜åå·®</h3><p>é«˜åå·®æ˜¯æŒ‡è®­ç»ƒé›†çš„è¯¯å·®å¤§ï¼Œå³æ¨¡å‹æ²¡æœ‰å­¦åˆ°è®­ç»ƒé›†çš„æ‰€æœ‰ç‰¹å¾ï¼Œä¸èƒ½å¾ˆå¥½çš„æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>ï¼ˆ1ï¼‰é€‰æ‹©æ›´å¤§çš„ç½‘ç»œï¼ˆå¢åŠ ç½‘ç»œå±‚æ•°æˆ–è€…ç¥ç»å…ƒæ•°é‡ï¼‰</p>
<p>ï¼ˆ2ï¼‰è®­ç»ƒæ—¶é—´æ›´é•¿</p>
<h3 id="é«˜æ–¹å·®"><a href="#é«˜æ–¹å·®" class="headerlink" title="é«˜æ–¹å·®"></a>é«˜æ–¹å·®</h3><p>é«˜æ–¹å·®æ˜¯æŒ‡è®­ç»ƒçš„æ¨¡å‹åœ¨æµ‹è¯•é›†çš„è¯¯å·®å¤§ï¼Œå³æ¨¡å‹å­˜åœ¨è¿‡æ‹Ÿåˆï¼Œè¿‡åº¦æ‹Ÿåˆè®­ç»ƒé›†æ•°æ®ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>ï¼ˆ1ï¼‰æ­£åˆ™åŒ–</p>
<p>ï¼ˆ2ï¼‰æ›´å¤šè®­ç»ƒæ•°æ®</p>
<p>ä¸€èˆ¬ç¬¬äºŒç§æ–¹æ³•æˆæœ¬è¾ƒé«˜ï¼Œå½“å‡ºç°é«˜æ–¹å·®çš„æ—¶å€™é€‰æ‹©æ­£åˆ™åŒ–æ–¹æ³•</p>
<p>æ­£åˆ™åŒ–æ–¹æ³•ç®€å•æ¥è¯´å°±æ˜¯å‡å°‘å¯¹è¾“å…¥æ•°æ®çš„å­¦ä¹ ï¼Œä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p>
<p>ä¸åŒæ­£åˆ™åŒ–æ–¹æ³•å¯¹æ¯”ï¼š</p>
<p>ï¼ˆ0ï¼‰å½“ä¸ä½¿ç”¨æ­£åˆ™åŒ–</p>
<p>lambdæ˜¯L2æ­£åˆ™åŒ–ä¸­çš„å‚æ•°,keep_propæ˜¯dropoutæ­£åˆ™åŒ–ä¸­çš„å‚æ•°ï¼Œlambd=0,keep_prop=1.0ä»£è¡¨ä¸ä½¿ç”¨æ­£åˆ™åŒ–</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ˜¯å¦åŠ å…¥æ­£åˆ™åŒ–çš„æ¨¡å‹  lambdæ˜¯L2æ­£åˆ™åŒ–ä¸­çš„å‚æ•°,keep_propæ˜¯dropoutæ­£åˆ™åŒ–ä¸­çš„å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_regularization</span><span class="params">(X,Y,layer_dims,iter=<span class="number">30000</span>,learning_rate=<span class="number">0.3</span>,lambd=<span class="number">0</span>,keep_prop=<span class="number">1.0</span>)</span>:</span></span><br><span class="line">	<span class="comment">#1.åˆå§‹åŒ–å‚æ•° é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±</span></span><br><span class="line">	parameters=ru.initialize_parameters(layer_dims)</span><br><span class="line">	costs=[]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(iter):</span><br><span class="line">		<span class="comment">#2.å‰å‘ä¼ æ’­ æ˜¯å¦è¿›è¡Œkeep_propæ­£åˆ™åŒ–</span></span><br><span class="line">		<span class="keyword">if</span>(keep_prop==<span class="number">1.0</span>):</span><br><span class="line">			A,cache=ru.forward_propagation(X,parameters)</span><br><span class="line">		<span class="keyword">elif</span>(keep_prop&lt;<span class="number">1.0</span>):</span><br><span class="line">			A,cache=forward_propagation_dropout(X,parameters,keep_prop)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			print(<span class="string">"keep_propå‚æ•°é”™è¯¯"</span>)</span><br><span class="line">			exit</span><br><span class="line"></span><br><span class="line">		<span class="comment">#3.è®¡ç®—æŸå¤±ï¼Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨L2æ­£åˆ™åŒ–</span></span><br><span class="line">		<span class="keyword">if</span>(lambd==<span class="number">0</span>):</span><br><span class="line">			cost=ru.compute_cost(A,Y)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			cost=compute_loss_L2(A,Y,parameters,lambd)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#4.åå‘ä¼ æ’­ æ˜¯å¦è¿›è¡Œæ­£åˆ™åŒ–(dropoutæˆ–è€…L2)</span></span><br><span class="line">		<span class="keyword">if</span>(keep_prop==<span class="number">1</span>) <span class="keyword">and</span> (lambd==<span class="number">0</span>):</span><br><span class="line">			grad=ru.backward_propagation(X,Y,cache)</span><br><span class="line">		<span class="keyword">elif</span>(lambd!=<span class="number">0</span>):</span><br><span class="line">			grad=backward_propagation_L2(X,Y,cache,lambd)</span><br><span class="line">		<span class="keyword">elif</span>(keep_prop&lt;<span class="number">1</span>):</span><br><span class="line">			grad=backward_propagation_dropout(X,Y,cache,keep_prop)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#5.æ›´æ–°å‚æ•°</span></span><br><span class="line">		parameters=ru.update_parameters(parameters,grad,learning_rate)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">1000</span>==<span class="number">0</span>):</span><br><span class="line">			costs.append(cost)</span><br><span class="line">			print(<span class="string">"ç¬¬"</span>+str(i)+<span class="string">"æ¬¡ï¼Œcost:"</span>+str(cost))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ç»˜åˆ¶æ›²çº¿</span></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.xlabel(<span class="string">"iteration"</span>)</span><br><span class="line">	plt.ylabel(<span class="string">"cost"</span>)</span><br><span class="line">	plt.title(<span class="string">"learning_rate="</span>+str(learning_rate))</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513110235.png" alt></p>
<p>è®­ç»ƒé›†<br>Accuracy: 0.9478672985781991<br>æµ‹è¯•é›†<br>Accuracy: 0.915</p>
<p>åˆ†æ</p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¨¡å‹å­˜åœ¨è¿‡æ‹Ÿåˆï¼Œè®­ç»ƒé›†å‡†ç¡®ç‡æ˜æ˜¾é«˜äºæµ‹è¯•é›†å¾ˆå¤šã€‚</p>
<p>ï¼ˆ1ï¼‰L2èŒƒæ•°</p>
<p>åœ¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥L2å‚æ•°ï¼Œä½¿å¾—æƒé‡ç¼©å‡ï¼Œå³å‡å°‘å¯¹ä¸€äº›ä¸é‡è¦ç‰¹å¾çš„å­¦ä¹ ã€‚</p>
<p><strong>L2èŒƒæ•°æ­£åˆ™åŒ–æ˜¯åœ¨è®¡ç®—æŸå¤±æ—¶åŠ å…¥æ­£åˆ™åŒ–å‚æ•°ï¼Œå¹¶åœ¨åå‘ä¼ æ’­ç»“æœè°ƒæ•´æƒé‡ã€‚</strong></p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨L2èŒƒæ•°è¿›è¡Œæ­£åˆ™åŒ–</span></span><br><span class="line"><span class="comment">#è®¡ç®—æŸå¤±</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_loss_L2</span><span class="params">(A,Y,parameters,lambd)</span>:</span></span><br><span class="line">	m=A.shape[<span class="number">1</span>]</span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line">	W3=parameters[<span class="string">"W3"</span>]</span><br><span class="line"></span><br><span class="line">	loss=ru.compute_cost(A,Y)</span><br><span class="line">	L2_regularization=(lambd/(<span class="number">2</span>*m))*(np.sum(np.square(W1))+np.sum(np.square(W2))+np.sum(np.square(W3)))</span><br><span class="line">	all_loss=loss+L2_regularization</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> all_loss</span><br><span class="line"></span><br><span class="line"><span class="comment">#åå‘ä¼ æ’­è¿‡ç¨‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backward_propagation_L2</span><span class="params">(X,Y,cache,lambd)</span>:</span></span><br><span class="line">	Z1,A1,W1,b1,Z2,A2,W2,b2,Z3,A3,W3,b3=cache</span><br><span class="line"></span><br><span class="line">	m=X.shape[<span class="number">1</span>]</span><br><span class="line">	dZ3=A3-Y</span><br><span class="line">	dW3=(<span class="number">1</span>/m)*np.dot(dZ3,A2.T)+(lambd/m)*W3</span><br><span class="line">	db3=(<span class="number">1</span>/m)*np.sum(dZ3,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	dA2=np.dot(W3.T,dZ3)</span><br><span class="line">	dZ2=np.multiply(dA2,np.int64(A2&gt;<span class="number">0</span>))</span><br><span class="line">	dW2=(<span class="number">1</span>/m)*np.dot(dZ2,A1.T)+(lambd/m)*W2</span><br><span class="line">	db2=(<span class="number">1</span>/m)*np.sum(dZ2,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	dA1=np.dot(W2.T,dZ2)</span><br><span class="line">	dZ1=np.multiply(dA1,np.int64(A1&gt;<span class="number">0</span>))</span><br><span class="line">	dW1=(<span class="number">1</span>/m)*np.dot(dZ1,X.T)+(lambd/m)*W1</span><br><span class="line">	db1=(<span class="number">1</span>/m)*np.sum(dZ1,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	grad=&#123;<span class="string">"dW1"</span>:dW1,<span class="string">"dW2"</span>:dW2,<span class="string">"dW3"</span>:dW3,<span class="string">"db1"</span>:db1,<span class="string">"db2"</span>:db2,<span class="string">"db3"</span>:db3&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> grad</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513110551.png" alt></p>
<p>è®­ç»ƒé›†<br>Accuracy: 0.9383886255924171<br>æµ‹è¯•é›†<br>Accuracy: 0.93</p>
<p>åˆ†æ</p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºå†³ç­–è¾¹ç•Œå˜å¾—å¹³æ»‘ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†è¯¯å·®ç›¸è¿‘ï¼Œå‡å°‘äº†æ¨¡å‹çš„è¿‡æ‹Ÿåˆæƒ…å†µ</p>
<p>ï¼ˆbï¼‰dropoutéšæœºå¤±æ´»</p>
<p><strong>dropoutéšæœºå¤±æ´»æ–¹æ³•æ˜¯åœ¨æ¯æ¬¡è®­ç»ƒæ¨¡å‹æ—¶ï¼ŒæŒ‰ç…§ä¸€å®šæ¦‚ç‡éšæœºåˆ é™¤ä¸€äº›èŠ‚ç‚¹ï¼Œå³æ¯æ¬¡éƒ½è®­ç»ƒä¸€ä¸ªå°å‹çš„ç½‘ç»œï¼Œkeep_propæ˜¯ä¿ç•™èŠ‚ç‚¹çš„æ¦‚ç‡ã€‚</strong></p>
<p>ä½†ç”±äºéšæœºåˆ é™¤ä¸€äº›èŠ‚ç‚¹ï¼Œåœ¨éšæœºå¤±æ´»æ–¹æ³•ä¸­æˆæœ¬å‡½æ•°æ²¡æœ‰æ˜ç¡®çš„å®šä¹‰</p>
<p>1Â°å‰å‘ä¼ æ’­</p>
<p>åœ¨å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­æ ¹æ®é˜ˆå€¼keep_propå†³å®šæ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¿ç•™ï¼šD=np.random.rand(A.shape[0],A.shape[1])&lt;keep_prop</p>
<p>è¿‡æ»¤æ‰€æœ‰ä¸º0çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”æŒ‰ç…§é˜ˆå€¼ä¿®è¡¥ç¼ºå¤±èŠ‚ç‚¹åçš„å‡½æ•°å€¼ï¼šA=A * D / keep_prop</p>
<p>2Â°åå‘ä¼ æ’­</p>
<p>æ ¹æ®å‰å‘ä¼ æ’­ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„ä¿ç•™æƒ…å†µï¼Œåˆ é™¤ç¼ºå¤±çš„èŠ‚ç‚¹ï¼Œå¹¶è®¡ç®—ç¼ºå¤±èŠ‚ç‚¹åçš„æ¢¯åº¦å€¼ï¼šdA=dA * D / keep_prop</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨dropoutè¿›è¡Œæ­£åˆ™åŒ–ï¼Œéšæœºåˆ é™¤ä¸€äº›èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­£å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_propagation_dropout</span><span class="params">(X,parameters,keep_prop=<span class="number">0.5</span>)</span>:</span></span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line">	W3=parameters[<span class="string">"W3"</span>]</span><br><span class="line">	b1=parameters[<span class="string">"b1"</span>]</span><br><span class="line">	b2=parameters[<span class="string">"b2"</span>]</span><br><span class="line">	b3=parameters[<span class="string">"b3"</span>]</span><br><span class="line"></span><br><span class="line">	Z1=np.dot(W1,X)+b1</span><br><span class="line">	A1=ru.relu(Z1)</span><br><span class="line">	D1=np.random.rand(A1.shape[<span class="number">0</span>],A1.shape[<span class="number">1</span>])</span><br><span class="line">	<span class="comment">#å°äºkeep_propçš„è®¾ç½®ä¸º1ï¼Œåä¹‹ä¸º0</span></span><br><span class="line">	D1=D1&lt;keep_prop</span><br><span class="line">	A1=A1*D1</span><br><span class="line">	A1=A1/keep_prop</span><br><span class="line"></span><br><span class="line">	Z2=np.dot(W2,A1)+b2</span><br><span class="line">	A2=ru.relu(Z2)</span><br><span class="line">	D2=np.random.rand(A2.shape[<span class="number">0</span>],A2.shape[<span class="number">1</span>])</span><br><span class="line">	D2=D2&lt;keep_prop</span><br><span class="line">	A2=A2*D2</span><br><span class="line">	A2=A2/keep_prop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	Z3=np.dot(W3,A2)+b3</span><br><span class="line">	A3=ru.sigmoid(Z3)</span><br><span class="line">	<span class="comment"># D3=np.random.rand(A3.shape[0],A3.shape[1])</span></span><br><span class="line">	<span class="comment"># D3=D3&lt;keep_prop</span></span><br><span class="line">	<span class="comment"># A3=A3*D3</span></span><br><span class="line">	<span class="comment"># A3=A3/keep_prop</span></span><br><span class="line"></span><br><span class="line">	cache=[Z1,D1,A1,W1,b1,Z2,D2,A2,W2,b2,Z3,A3,W3,b3]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> A3,cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backward_propagation_dropout</span><span class="params">(X,Y,cache,keep_prop)</span>:</span></span><br><span class="line">	Z1,D1,A1,W1,b1,Z2,D2,A2,W2,b2,Z3,A3,W3,b3=cache</span><br><span class="line"></span><br><span class="line">	m=X.shape[<span class="number">1</span>]</span><br><span class="line">	dZ3=A3-Y</span><br><span class="line">	dW3=(<span class="number">1</span>/m)*np.dot(dZ3,A2.T)</span><br><span class="line">	db3=(<span class="number">1</span>/m)*np.sum(dZ3,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	dA2=np.dot(W3.T,dZ3)</span><br><span class="line">	dA2=dA2*D2</span><br><span class="line">	dA2=dA2/keep_prop</span><br><span class="line"></span><br><span class="line">	dZ2=np.multiply(dA2,np.int64(A2&gt;<span class="number">0</span>))</span><br><span class="line">	dW2=(<span class="number">1</span>/m)*np.dot(dZ2,A1.T)</span><br><span class="line">	db2=(<span class="number">1</span>/m)*np.sum(dZ2,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	dA1=np.dot(W2.T,dZ2)</span><br><span class="line">	dA1=dA1*D1</span><br><span class="line">	dA1=dA1/keep_prop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	dZ1=np.multiply(dA1,np.int64(A1&gt;<span class="number">0</span>))</span><br><span class="line">	dW1=(<span class="number">1</span>/m)*np.dot(dZ1,X.T)</span><br><span class="line">	db1=(<span class="number">1</span>/m)*np.sum(dZ1,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	grad=&#123;<span class="string">"dW1"</span>:dW1,<span class="string">"dW2"</span>:dW2,<span class="string">"dW3"</span>:dW3,<span class="string">"db1"</span>:db1,<span class="string">"db2"</span>:db2,<span class="string">"db3"</span>:db3&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> grad</span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200513111546.png" alt></p>
<p>è®­ç»ƒé›†<br>Accuracy: 0.943127962085308<br>æµ‹è¯•é›†<br>Accuracy: 0.935</p>
<p>åˆ†æ</p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºå†³ç­–è¾¹ç•Œå˜å¾—å¹³æ»‘ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†è¯¯å·®ç›¸è¿‘ï¼Œå‡å°‘äº†æ¨¡å‹çš„è¿‡æ‹Ÿåˆæƒ…å†µã€‚</p>
<h2 id="æ¢¯åº¦æ£€éªŒ"><a href="#æ¢¯åº¦æ£€éªŒ" class="headerlink" title="æ¢¯åº¦æ£€éªŒ"></a>æ¢¯åº¦æ£€éªŒ</h2><p>é€šè¿‡åŒè¾¹è¯¯å·®æ£€éªŒåå‘ä¼ æ’­æ˜¯å¦å¾ˆå¥½çš„å®ç°ï¼Œä¸»è¦ç”¨äºè°ƒè¯•</p>
<p>ï¼ˆ1ï¼‰å¾—åˆ°ç®—æ³•ä¸­çš„æ¢¯åº¦grads</p>
<p>ï¼ˆ2ï¼‰è®¡ç®—åŒè¾¹è¯¯å·®gradprox=J_plus(Î¸+eplison)-J_minus(Î¸+eplison)/2 * eplison</p>
<p>ï¼ˆ3ï¼‰æ¯”è¾ƒåŒè¾¹è¯¯å·®å’Œæ¢¯åº¦çš„è·ç¦»d=||grads-gradprox||2 / (||grads||2+||gradprox||2)</p>
<p>å½“è·ç¦»å°äº1e-7è¯´æ˜åå‘ä¼ æ’­ä¸­æ¢¯åº¦æ­£ç¡®å®ç°äº†ï¼Œåä¹‹åˆ™æ²¡æœ‰</p>
<p>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ¢¯åº¦æ ¡éªŒ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">grandient_check_n</span><span class="params">(parameters,grad,X,Y,eplison=<span class="number">1e-7</span>)</span>:</span></span><br><span class="line">	parameters_values=gu.dictionary_to_vector(parameters)</span><br><span class="line">	grad_values=gu.gradients_to_vector(grad)</span><br><span class="line">	num_iter=parameters_values.shape[<span class="number">0</span>]</span><br><span class="line">	J_min=np.zeros((num_iter,<span class="number">1</span>))</span><br><span class="line">	J_max=np.zeros((num_iter,<span class="number">1</span>))</span><br><span class="line">	gradprox=np.zeros((num_iter,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_iter):</span><br><span class="line">		temp_para=np.copy(parameters_values)</span><br><span class="line">		temp_para[i][<span class="number">0</span>]=temp_para[i][<span class="number">0</span>]-eplison</span><br><span class="line">		J_min[i],cache=forward_propagation_n(X,Y,gu.vector_to_dictionary(temp_para))</span><br><span class="line"></span><br><span class="line">		temp_para2=np.copy(parameters_values)</span><br><span class="line">		temp_para2[i][<span class="number">0</span>]=temp_para2[i][<span class="number">0</span>]+eplison</span><br><span class="line">		J_max[i],cache=forward_propagation_n(X,Y,gu.vector_to_dictionary(temp_para))</span><br><span class="line"></span><br><span class="line">		gradprox[i]=J_max[i]-J_min[i]/<span class="number">2</span>*eplison</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å‘é‡ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">	denum=np.liang.norm(grad_values)+np.liang.norm(gradprox)</span><br><span class="line">	nenum=np.liang.norm(grad_values-gradprox)</span><br><span class="line">	difference=nenum/denum</span><br><span class="line">	<span class="keyword">if</span> difference&lt;<span class="number">1e-7</span>:</span><br><span class="line">		print(<span class="string">"æ¢¯åº¦æ£€éªŒæ­£ç¡®"</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(<span class="string">"æ¢¯åº¦æ£€éªŒæœ‰è¯¯"</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ â€”â€”æ­å»ºè¯†åˆ«å›¾ç‰‡çš„å¤šå±‚ç¥ç»ç½‘ç»œ</title>
    <url>/blogs/NNet4/</url>
    <content><![CDATA[<h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>åˆ©ç”¨çŒ«å’ªå›¾ç‰‡æ­å»ºèƒ½å¤Ÿè¯†åˆ«çŒ«å›¾ç‰‡çš„ç¥ç»ç½‘ç»œï¼Œå¹¶ä½¿ç”¨æ–°çš„å›¾ç‰‡æµ‹è¯•ç½‘ç»œæ•ˆæœ</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ç¥ç»ç½‘ç»œçš„æ­å»ºä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</p><p>ï¼ˆ1ï¼‰å‰å‘ä¼ æ’­</p><p>æ ¹æ®è¾“å…¥çš„å‚æ•°åŠä¸Šä¸€å±‚çš„è¾“å…¥å¾—å‡ºæ¯å±‚çš„å‡½æ•°å€¼ï¼Œé€šè¿‡æ¯å±‚ä¸åŒçš„æ¿€æ´»å‡½æ•°å¾—åˆ°è¾“å‡ºï¼Œæœ€ç»ˆè¾“å‡ºç»“æœæ ¹æ®äº¤å‰ç†µæ¨¡å‹å¾—å‡ºå‰å‘ä¼ æ’­ä¸­çš„æŸå¤±ã€‚</p><p>ï¼ˆ2ï¼‰åå‘ä¼ æ’­</p><p>æ ¹æ®æŸå¤±å€¼ï¼Œä»æœ€åä¸€å±‚å‘å‰å¾—åˆ°æ¯å±‚çš„æ¢¯åº¦ï¼Œæ ¹æ®æ¢¯åº¦ä¸‹é™åŸåˆ™æ›´æ–°å‚æ•°ï¼Œå‘ç€æŸå¤±å‡å°çš„æ–¹å‘å˜åŒ–ã€‚</p><a id="more"></a>





<p>å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ä¸æ–­å¾ªç¯ï¼Œå½“æŸå¤±è¾¾åˆ°æœ€å°æˆ–è€…è¶‹äºç¨³å®šæ—¶ï¼Œç½‘ç»œæ¨¡å‹åˆ™è®­ç»ƒç»“æŸ</p>
<p>å…·ä½“åŸç†æµç¨‹å›¾å‚ç…§ä¸‹å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509151835.png" alt></p>
<h2 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h2><p>ä¸ºäº†ä½¿å¾—ç½‘ç»œä¸é™·å…¥å½“æ•°å€¼å¢å¤§ï¼Œæ¿€æ´»å‡½æ•°æ¢¯åº¦å‡å°è€Œå¯¼è‡´å­¦ä¹ é€Ÿåº¦å‡æ…¢ï¼Œæ‰€æœ‰çš„éšè—å±‚é€‰æ‹©ä½¿ç”¨Reluæ¿€æ´»å‡½æ•°ï¼Œç”±äºæ˜¯è¯†åˆ«åˆ†ç±»é—®é¢˜ï¼Œè¾“å‡ºå±‚ä½¿ç”¨sigmoidå‡½æ•°ã€‚</p>
<p>è®¾æ­å»ºLå±‚ç½‘ç»œï¼Œåˆ™è¾“å…¥å±‚æ˜¯ç¬¬0å±‚ï¼Œéšè—å±‚ä¸ºç¬¬1å±‚ ~ ç¬¬L-2å±‚ï¼Œè¾“å‡ºå±‚ä¸ºç¬¬L-1å±‚</p>
<p>æ­å»ºå¤šå±‚ç¥ç»ç½‘ç»œæ­¥éª¤</p>
<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–å„å±‚å‚æ•°ï¼ˆWï¼Œbï¼‰</p>
<p>éœ€è¦åˆå§‹åŒ–å‚æ•°çš„å±‚æ•°ä¸ºç¬¬1å±‚ ~ ç¬¬L-1å±‚ï¼Œå³å‚æ•°ç´¢å¼•ä¸º1 ~ L-1</p>
<p>è®¾æœ‰Lå±‚ç½‘ç»œï¼Œåˆ™ç¬¬lå±‚çš„æƒé‡Wå’Œåç½®é‡bçš„ç»´åº¦æ»¡è¶³ï¼š</p>
<p>shape(W)=(n[l],n[l-1])</p>
<p>shpe(b)=(n[l],1)</p>
<p>ä½¿ç”¨æ­£æ€åˆ†å¸ƒæ•°æ®åˆå§‹åŒ–æ¯å±‚ç¥ç»å…ƒæƒé‡ï¼Œä¸ºé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ï¼Œå°†æ¯å±‚çš„æƒé‡æ•°å€¼é™¤ä»¥å‰ä¸€å±‚æƒé‡æ•°å€¼çš„äºŒåˆ†ä¹‹ä¸€æ¬¡æ–¹ï¼Œåç½®é‡åˆå§‹åŒ–ä¸º0ï¼Œå°†åˆå§‹åŒ–å‚æ•°è¿›è¡Œä¿å­˜ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ2ï¼‰å‰å‘ä¼ æ’­</p>
<p>ç¬¬1å±‚ ~ ç¬¬L-2å±‚ï¼Œæ¯å±‚è®¡ç®—å‰å‘å‡½æ•°çš„çº¿æ€§å€¼ï¼Œå¹¶ä¼ å…¥reluå‡½æ•°ä¸­è®¡ç®—æ¯å±‚çš„æ¿€æ´»å€¼ï¼Œå°†å‰ä¸€å±‚çš„è¾“å…¥å’Œå½“å‰å±‚çš„å‚æ•°ä¿å­˜ä¸ºlinear_cahe,å°†æ¯å±‚çš„å‡½æ•°çº¿æ€§å€¼ä¿å­˜ä¸ºactive_cacheï¼Œæœ€ç»ˆå¾—åˆ°æ¯ä¸€å±‚çš„cacheå’Œæ¯å±‚çš„è¾“å‡ºå€¼ã€‚ç¬¬L-1å±‚ï¼ŒåŒç†ï¼Œè°ƒç”¨sigmoidæ¿€æ´»å‡½æ•°ã€‚</p>
<p>æœ€ç»ˆï¼Œå°†ç¼“å­˜cacheä¿å­˜åœ¨cachesä¸­ï¼Œåœ¨åå‘ä¼ æ’­ä¸­çš„è®¡ç®—æ¢¯åº¦æ—¶ä½¿ç”¨ã€‚</p>
<p>ï¼ˆ3ï¼‰è®¡ç®—æŸå¤±</p>
<p>æ¯æ¬¡è¿­ä»£ï¼Œæ ¹æ®æœ€åè¾“å‡ºå±‚æ•°æ®å’Œå®é™…æ•°æ®ï¼Œä»£å…¥äº¤å‰ç†µæ¨¡å‹å…¬å¼ä¸­å¾—å‡ºæŸå¤±å€¼ï¼Œå¹¶æ¯ç™¾æ¬¡è¾“å‡ºã€‚</p>
<p>ï¼ˆ4ï¼‰åå‘ä¼ æ’­</p>
<p>ä»ç¬¬L-1å±‚å‘å‰æ›´æ–°å‚æ•°æ¢¯åº¦ï¼š</p>
<p>ç¬¬L-1å±‚ï¼Œè®¡ç®—è¾“å‡ºå±‚çš„å¯¼æ•°ï¼Œå³dALï¼ˆäº¤å‰ç†µå…¬å¼å¯¹è¾“å‡ºå€¼çš„å¯¼æ•°ï¼‰ï¼Œæ ¹æ®æœ€åä¸€å±‚çš„å¯¼æ•°ï¼ŒåŠæœ€åä¸€å±‚çš„cacheï¼ˆä¿å­˜äº†å‰ä¸€å±‚çš„å‰å‘å‡½æ•°çº¿æ€§å€¼ï¼Œæœ¬å±‚çš„å‚æ•°ï¼Œæœ¬å±‚çš„å‰å‘å‡½æ•°çº¿æ€§å€¼ï¼‰ï¼Œæ ¹æ®sigmoidæ¿€æ´»å‡½æ•°æ±‚å¯¼å¾—å‡ºdZï¼Œæ ¹æ®å¯¼æ•°å…¬å¼dW=(1/m) * multiplyï¼ˆdZ,dA_preï¼‰ï¼Œdb=(1/m) * sumï¼ˆdZï¼‰,å¾—åˆ°å‚æ•°çš„æ¢¯åº¦ï¼Œå°†å‚æ•°æ¢¯åº¦ä¿å­˜åœ¨gradä¸­ï¼Œç´¢å¼•ä¸ºLï¼ˆä¸ºäº†å’Œå‚æ•°ç´¢å¼•å¯¹åº”ï¼‰ã€‚</p>
<p>ç¬¬L-2å±‚ ~ ç¬¬1å±‚ï¼ŒåŒç†ï¼Œæ ¹æ®åä¸€å±‚çš„dAå€¼ï¼ˆä»ä¿å­˜çš„gradsä¸­å–ï¼Œå½“å‰gradsç´¢å¼•ä¸ºi+1ï¼Œåä¸€å±‚çš„æ¢¯åº¦ç´¢å¼•ä¸ºi+2ï¼‰ï¼Œå½“å‰å±‚çš„cacheï¼Œå¾—åˆ°æ¢¯åº¦ä¿å­˜åœ¨ç´¢å¼•ä¸ºi+1çš„æ¢¯åº¦ä¸­ã€‚</p>
<p>ï¼ˆ5ï¼‰æ›´æ–°å‚æ•°</p>
<p>æ ¹æ®å¾—å‡ºçš„æ¢¯åº¦ï¼ŒæŒ‰ç…§æ¢¯åº¦ä¸‹é™å…¬å¼ï¼Œå³æŸå¤±å‡å°çš„æ–¹å‘å˜åŒ–ã€‚</p>
<p>ï¼ˆ5ï¼‰æ¨¡å‹é¢„æµ‹</p>
<p>å°†è¾“å…¥çš„å›¾åƒå‘é‡å’Œç±»åˆ«ï¼Œä»¥åŠä¹‹å‰è®­ç»ƒçš„å„å±‚å‚æ•°åŠå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ä¼ å…¥é¢„æµ‹å‡½æ•°ä¸­ï¼Œæ ¹æ®å‚æ•°å’Œè¾“å…¥çš„å›¾åƒå‘é‡å¾—å‡ºæœ€ç»ˆçš„è¾“å‡ºAï¼Œå¾—å‡ºæ¯ä¸ªè¾“å…¥å›¾åƒå‘é‡å¯¹åº”çš„è¾“å‡ºå€¼ï¼Œå¹¶æ ¹æ®sigmoidç‰¹æ€§è¿›è¡Œåˆ†ç±»ï¼Œå¤§äº0.5çš„åˆ™åˆ¤å®šä¸ºçŒ«ï¼Œåä¹‹ä¸æ˜¯çŒ«ï¼Œå°†é¢„æµ‹çš„ç±»åˆ«å’ŒçœŸå®ç±»åˆ«æ¯”è¾ƒå¾—å‡ºæœ€ç»ˆæ­£ç¡®ç‡ã€‚</p>
<p>æ•ˆæœ</p>
<p>æ­å»º5å±‚ç¥ç»ç½‘ç»œï¼Œéšè—å±‚ç¥ç»å…ƒä¸ªæ•°åˆ†åˆ«ä¸º20ï¼Œ7ï¼Œ5ï¼Œè¿­ä»£2500æ¬¡ï¼Œå­¦ä¹ ç‡ä¸º0.0075ï¼Œæœ€ç»ˆéšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ æŸå¤±å˜åŒ–ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509160309.png" alt></p>
<p>è®­ç»ƒé›†æ­£ç¡®ç‡ä¸ºï¼š99.52%</p>
<p>æµ‹è¯•é›†æ­£ç¡®ç‡ä¸ºï¼š78%</p>
<p>å½“è¾“å…¥æ–°çš„æµ‹è¯•å›¾åƒæ—¶ï¼Œç”±äºç¥ç»ç½‘ç»œä¸­å¤„ç†çš„å›¾åƒéƒ½è½¬æ¢ä¸ºå‘é‡å¤„ç†ï¼Œè¿™é‡Œå°†è¯»å…¥çš„å›¾åƒä½¿ç”¨PILä¸­çš„Imageæ¨¡å—è¯»å–ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºRGBç±»å‹çš„å›¾ç‰‡ï¼Œä½¿ç”¨arrayå°†å›¾åƒè½¬æ¢ä¸ºå’Œè®­ç»ƒå›¾ç‰‡ä¸€æ ·å¤§å°çš„çŸ©é˜µã€‚</p>
<p>å½“è¾“å…¥å›¾ç‰‡æ˜¯çŒ«çš„å›¾åƒæ—¶ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509160906.jpg" alt></p>
<p>æœ€ç»ˆå¾—å‡ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509161327.png" alt></p>
<p>å½“è¾“å…¥å›¾ç‰‡ä¸æ˜¯çŒ«çš„å›¾åƒæ—¶ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509161223.jpg" alt></p>
<p>æœ€ç»ˆå¾—å‡ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200509161153.png" alt></p>
<p>å¯è§ç½‘ç»œæ­£ç¡®è¯†åˆ«äº†çŒ«å’ŒéçŒ«çš„å›¾ç‰‡</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ­å»ºä¸€ä¸ªä¸¤å±‚ç½‘ç»œå’Œæ·±å±‚ç½‘ç»œ</span></span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> dnn_utils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> testCases <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> h5py</span><br><span class="line"><span class="keyword">from</span> lr_utils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> misc,ndimage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.å¯¼å…¥æ•°æ®</span></span><br><span class="line">train_x_original,train_y_original,test_x_original,test_y_original,classes=load_dataset()</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŠŠå‘é‡ç«–èµ·æ¥æ’åˆ—</span></span><br><span class="line">train_x=train_x_original.reshape(train_x_original.shape[<span class="number">0</span>],<span class="number">-1</span>).T</span><br><span class="line">test_x=test_x_original.reshape(test_x_original.shape[<span class="number">0</span>],<span class="number">-1</span>).T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å½’ä¸€åŒ–</span></span><br><span class="line">train_x=train_x/<span class="number">255</span></span><br><span class="line">print()</span><br><span class="line">test_x=test_x/<span class="number">255</span></span><br><span class="line">train_y=train_y_original</span><br><span class="line">test_y=test_y_original</span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.å‚æ•°åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">#2.0ä¸¤å±‚ç½‘ç»œå‚æ•°åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inital_parameter</span><span class="params">(n_x,n_h,n_y)</span>:</span></span><br><span class="line">	W1=random.randn(n_h,n_x)*<span class="number">0.01</span></span><br><span class="line">	b1=zeros((n_h,<span class="number">1</span>))</span><br><span class="line">	W2=random.randn(n_y,n_h)*<span class="number">0.01</span></span><br><span class="line">	b2=zeros((n_y,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	parameter=&#123;<span class="string">"W1"</span>:W1,<span class="string">"b1"</span>:b1,<span class="string">"W2"</span>:W2,<span class="string">"b2"</span>:b2&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.1æ·±å±‚ç½‘ç»œå‚æ•°åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inital_parameter_deep</span><span class="params">(layer_dims)</span>:</span></span><br><span class="line">	np.random.seed(<span class="number">3</span>)</span><br><span class="line">	parameter=&#123;&#125;</span><br><span class="line">	L=len(layer_dims)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,L):</span><br><span class="line">		parameter[<span class="string">"W"</span>+str(i)]=random.randn(layer_dims[i],layer_dims[i<span class="number">-1</span>])/sqrt(layer_dims[i<span class="number">-1</span>])</span><br><span class="line">		parameter[<span class="string">"b"</span>+str(i)]=zeros((layer_dims[i],<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="comment">#3.1çº¿æ€§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_forward</span><span class="params">(A,W,b)</span>:</span></span><br><span class="line"></span><br><span class="line">	Z=dot(W,A)+b</span><br><span class="line">	cache=(A,W,b)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> Z,cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.2æ¿€æ´»å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_forward</span><span class="params">(A_pre,W,b,active)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> active==<span class="string">"sigmoid"</span>:</span><br><span class="line">		Z,linear_cache=linear_forward(A_pre,W,b)</span><br><span class="line">		A,active_cache=sigmoid(Z)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">elif</span> active==<span class="string">"relu"</span>:</span><br><span class="line">		Z,linear_cache=linear_forward(A_pre,W,b)</span><br><span class="line">		A,active_cache=relu(Z)</span><br><span class="line"></span><br><span class="line">	cache=(linear_cache,active_cache)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> A,cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·±å±‚ç½‘ç»œçš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_forward</span><span class="params">(A,parameter)</span>:</span></span><br><span class="line">	<span class="comment">#å‰L-1ä¸ªç”¨reluæ¿€æ´»ï¼Œæœ€åä¸€ä¸ªç”¨sigmoidæ¿€æ´»</span></span><br><span class="line">	L=len(parameter)//<span class="number">2</span></span><br><span class="line">	caches=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,L):</span><br><span class="line">		A_pre=A</span><br><span class="line">		A,cache=linear_activation_forward(A_pre,parameter[<span class="string">"W"</span>+str(i)],parameter[<span class="string">"b"</span>+str(i)],<span class="string">"relu"</span>)</span><br><span class="line">		caches.append(cache)</span><br><span class="line"></span><br><span class="line">	A_pre=A</span><br><span class="line">	A,cache=linear_activation_forward(A_pre,parameter[<span class="string">"W"</span>+str(L)],parameter[<span class="string">"b"</span>+str(L)],<span class="string">"sigmoid"</span>)</span><br><span class="line">	caches.append(cache)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> A,caches</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4.è®¡ç®—æŸå¤±</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_loss</span><span class="params">(Yhat,Y)</span>:</span></span><br><span class="line">	m=shape(Y)[<span class="number">1</span>]</span><br><span class="line">	cost=-sum(multiply(log(Yhat),Y)+multiply(log(<span class="number">1</span>-Yhat),(<span class="number">1</span>-Y)))</span><br><span class="line">	cost=(<span class="number">1</span>/m)*cost</span><br><span class="line">	<span class="comment"># AL=Yhat</span></span><br><span class="line">	<span class="comment"># cost = -sum(multiply(np.log(Yhat),Y) + multiply(np.log(1 - Yhat), 1 - Y)) / m</span></span><br><span class="line">	<span class="comment"># cost = squeeze(cost)</span></span><br><span class="line">	<span class="keyword">return</span> cost</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#5.åå‘ä¼ æ’­</span></span><br><span class="line"><span class="comment">#5.2çº¿æ€§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_backward</span><span class="params">(dZ,linear_cache)</span>:</span></span><br><span class="line">	A_pre,W,b=linear_cache</span><br><span class="line">	m=shape(A_pre)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">	dW=(<span class="number">1</span>/m)*dot(dZ,A_pre.T)</span><br><span class="line">	db=(<span class="number">1</span>/m)*sum(dZ,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	dA_pre=dot(W.T,dZ)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> dA_pre,dW,db</span><br><span class="line"></span><br><span class="line"><span class="comment">#5.1æ¿€æ´»å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_activation_backward</span><span class="params">(dA,cache,active)</span>:</span></span><br><span class="line">	linear_cache,active_cache=cache</span><br><span class="line">	<span class="keyword">if</span> active==<span class="string">"sigmoid"</span>:</span><br><span class="line">		dZ=sigmoid_backward(dA,active_cache) <span class="comment">#activecache ä¿å­˜z</span></span><br><span class="line">		dA_pre,dW,db=linear_backward(dZ,linear_cache) <span class="comment">#linear_cacheä¿å­˜A,w,b</span></span><br><span class="line">	<span class="keyword">elif</span> active==<span class="string">"relu"</span>:</span><br><span class="line">		dZ=relu_backward(dA,active_cache)</span><br><span class="line">		dA_pre,dW,db=linear_backward(dZ,linear_cache)</span><br><span class="line">	<span class="keyword">return</span> dA_pre,dW,db</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·±å±‚ç½‘ç»œçš„åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_model_backward</span><span class="params">(AL,Y,caches)</span>:</span></span><br><span class="line">	L=len(caches)</span><br><span class="line"></span><br><span class="line">	grads=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	dAL=-(divide(Y,AL)-divide(<span class="number">1</span>-Y,<span class="number">1</span>-AL))</span><br><span class="line">	dA_pre,dW,db=linear_activation_backward(dAL,caches[L<span class="number">-1</span>],<span class="string">"sigmoid"</span>)</span><br><span class="line">	grads[<span class="string">"dA"</span>+str(L)]=dA_pre</span><br><span class="line">	grads[<span class="string">"dW"</span>+str(L)]=dW</span><br><span class="line">	grads[<span class="string">"db"</span>+str(L)]=db</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(L<span class="number">-1</span>)): <span class="comment">#æ³¨æ„åè½¬</span></span><br><span class="line">		dA_pre,dW,db=linear_activation_backward(grads[<span class="string">"dA"</span>+str(i+<span class="number">2</span>)],caches[i],<span class="string">"relu"</span>)</span><br><span class="line">		grads[<span class="string">"dA"</span>+str(i+<span class="number">1</span>)]=dA_pre</span><br><span class="line">		grads[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]=dW</span><br><span class="line">		grads[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]=db</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> grads</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#6.æ›´æ–°å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameter</span><span class="params">(parameter,grads,learning_rate)</span>:</span></span><br><span class="line">	L=len(parameter)//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(L):</span><br><span class="line">		parameter[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]=parameter[<span class="string">"W"</span>+str(i+<span class="number">1</span>)]-learning_rate*grads[<span class="string">"dW"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line">		parameter[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]=parameter[<span class="string">"b"</span>+str(i+<span class="number">1</span>)]-learning_rate*grads[<span class="string">"db"</span>+str(i+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#7.æ­å»ºæ¨¡å‹</span></span><br><span class="line"><span class="comment">#ä¸¤å±‚ç¥ç»ç½‘ç»œ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">two_layer_model</span><span class="params">(X,Y,layer_dims,learning_rate=<span class="number">0.0075</span>,num_iter=<span class="number">3000</span>)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">	np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	grads=&#123;&#125;</span><br><span class="line">	costs=[]</span><br><span class="line">	(n_x,n_h,n_y)=layer_dims</span><br><span class="line">	parameter=inital_parameter(n_x,n_h,n_y)</span><br><span class="line">	W1=parameter[<span class="string">"W1"</span>]</span><br><span class="line">	b1=parameter[<span class="string">"b1"</span>]</span><br><span class="line">	W2=parameter[<span class="string">"W2"</span>]</span><br><span class="line">	b2=parameter[<span class="string">"b2"</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_iter):</span><br><span class="line">		<span class="comment">#å‰å‘ä¼ æ’­</span></span><br><span class="line">		A1,cache1=linear_activation_forward(X,W1,b1,<span class="string">"relu"</span>)</span><br><span class="line">		A2,cache2=linear_activation_forward(A1,W2,b2,<span class="string">"sigmoid"</span>)</span><br><span class="line">		<span class="comment">#è®¡ç®—æŸå¤±</span></span><br><span class="line">		cost=compute_loss(A2,Y)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">		dAL=-(divide(Y,A2)-divide(<span class="number">1</span>-Y,<span class="number">1</span>-A2))</span><br><span class="line">		dA_pre1,dW2,db2=linear_activation_backward(dAL,cache2,<span class="string">"sigmoid"</span>)</span><br><span class="line">		dA_pre0,dW1,db1=linear_activation_backward(dA_pre1,cache1,<span class="string">"relu"</span>)</span><br><span class="line"></span><br><span class="line">		grads[<span class="string">"dW1"</span>]=dW1</span><br><span class="line">		grads[<span class="string">"dW2"</span>]=dW2</span><br><span class="line">		grads[<span class="string">"db1"</span>]=db1</span><br><span class="line">		grads[<span class="string">"db2"</span>]=db2</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æ›´æ–°å‚æ•°</span></span><br><span class="line">		parameter=update_parameter(parameter,grads,learning_rate)</span><br><span class="line"></span><br><span class="line">		W1=parameter[<span class="string">"W1"</span>]</span><br><span class="line">		b1=parameter[<span class="string">"b1"</span>]</span><br><span class="line">		W2=parameter[<span class="string">"W2"</span>]</span><br><span class="line">		b2=parameter[<span class="string">"b2"</span>]</span><br><span class="line"></span><br><span class="line">		<span class="comment"># print("ç¬¬ "+str(i)+" æ¬¡ï¼Œcost: "+str(cost))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">100</span>==<span class="number">0</span>):</span><br><span class="line">			costs.append(cost)</span><br><span class="line">			print(<span class="string">"ç¬¬ "</span>+str(i)+<span class="string">" æ¬¡ï¼Œcost: "</span>+str(cost))</span><br><span class="line"></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.xlabel(<span class="string">"iter"</span>)</span><br><span class="line">	plt.ylabel(<span class="string">"cost"</span>)</span><br><span class="line">	plt.title(<span class="string">"learning_rate:"</span>+str(learning_rate))</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·±å±‚ç¥ç»ç½‘ç»œ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_layer_model</span><span class="params">(X,Y,layer_dims,learning_rate,num_iter)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">	np.random.seed(<span class="number">1</span>)</span><br><span class="line">	costs=[]</span><br><span class="line">	parameter=inital_parameter_deep(layer_dims)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_iter):</span><br><span class="line">		<span class="comment">#å‰å‘ä¼ æ’­</span></span><br><span class="line">		A,caches=L_model_forward(X,parameter)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#è®¡ç®—æŸå¤±</span></span><br><span class="line">		cost=compute_loss(A,Y)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">		grads=L_model_backward(A,Y,caches)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#æ›´æ–°å‚æ•°</span></span><br><span class="line">		parameter=update_parameter(parameter,grads,learning_rate)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">100</span>==<span class="number">0</span>):</span><br><span class="line">			costs.append(cost)</span><br><span class="line">			print(<span class="string">"ç¬¬ "</span>+str(i)+<span class="string">" æ¬¡ï¼Œcost: "</span>+str(cost))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.xlabel(<span class="string">"iter"</span>)</span><br><span class="line">	plt.ylabel(<span class="string">"cost"</span>)</span><br><span class="line">	plt.title(<span class="string">"learning_rate:"</span>+str(learning_rate))</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameter</span><br><span class="line"><span class="comment">#7.é¢„æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(X,Y,parameter)</span>:</span></span><br><span class="line">	<span class="comment">#æŒ‰ç…§å‚æ•°èµ°ä¸€æ¬¡å‰å‘ä¼ æ’­ï¼ŒæŸ¥çœ‹é¢„æµ‹å€¼å’Œå®é™…å€¼æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">	A,caches=L_model_forward(X,parameter)</span><br><span class="line"></span><br><span class="line">	m=shape(A)[<span class="number">1</span>]</span><br><span class="line">	n=shape(X)[<span class="number">1</span>]</span><br><span class="line">	p=zeros((<span class="number">1</span>,n))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		<span class="keyword">if</span>(A[<span class="number">0</span>,i]&gt;<span class="number">0.5</span>):</span><br><span class="line">			p[<span class="number">0</span>,i]=<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			p[<span class="number">0</span>,i]=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	print(<span class="string">"æ­£ç¡®ç‡ä¸ºï¼š"</span>+str(sum(Y==p)/n))</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹åˆ†ç±»é”™è¯¯çš„å›¾ç‰‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_mislabeled_image</span><span class="params">(X,y,p)</span>:</span></span><br><span class="line">	<span class="comment">#y:å®é™…ç±»åˆ«  #p:é¢„æµ‹ç±»åˆ«</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#å¾—åˆ°é¢„æµ‹é”™è¯¯çš„ä¸‹æ ‡</span></span><br><span class="line">	a=p+y</span><br><span class="line">	print(a)</span><br><span class="line">	error_index=asarray(where(a==<span class="number">1</span>))</span><br><span class="line">	print(error_index)</span><br><span class="line">	num_range=len(error_index[<span class="number">0</span>])</span><br><span class="line">	plt.rcParams[<span class="string">'figure.figsize'</span>]=(<span class="number">40.0</span>,<span class="number">40.0</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#æ‰“å°é”™è¯¯å›¾ç‰‡</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(num_range):</span><br><span class="line">		index=error_index[<span class="number">1</span>][i]</span><br><span class="line">		plt.subplot(<span class="number">2</span>,num_range,i+<span class="number">1</span>)</span><br><span class="line">		plt.imshow(X[:,index].reshape(<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>))</span><br><span class="line">		plt.axis(<span class="string">'off'</span>)</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#8.ä¸¤å±‚ç½‘ç»œæµ‹è¯•</span></span><br><span class="line"><span class="comment"># n_x=shape(train_x)[0]</span></span><br><span class="line"><span class="comment"># n_h=7</span></span><br><span class="line"><span class="comment"># n_y=shape(train_y)[0]</span></span><br><span class="line"><span class="comment"># layer_dims = [12288,7,1] </span></span><br><span class="line"><span class="comment"># parameter=two_layer_model(train_x,train_y,layer_dims,learning_rate=0.0075,num_iter=2500)</span></span><br><span class="line"><span class="comment"># p_train=predict(train_x,train_y,parameter)</span></span><br><span class="line"><span class="comment"># p_test=predict(test_x,test_y,parameter)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#9.å¤šå±‚ç½‘ç»œæµ‹è¯•</span></span><br><span class="line">layer_dims = [<span class="number">12288</span>,<span class="number">20</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">1</span>] </span><br><span class="line">parameter=L_layer_model(train_x,train_y,layer_dims,learning_rate=<span class="number">0.0075</span>,num_iter=<span class="number">2500</span>)</span><br><span class="line">p_train=predict(train_x,train_y,parameter)</span><br><span class="line">p_test=predict(test_x,test_y,parameter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#10.ä½¿ç”¨è‡ªå·±å›¾åƒæµ‹è¯•</span></span><br><span class="line"><span class="comment">#å¯¼å…¥å›¾åƒå¤„ç†æ¨¡å—</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment">#è¾“å…¥è‡ªå·±å›¾åƒçš„æ•°æ®ç‰¹å¾åŠæ ‡ç­¾</span></span><br><span class="line">my_image=<span class="string">"my_image.jpg"</span></span><br><span class="line">my_image_y=[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†è‡ªå·±çš„å›¾åƒè½¬æ¢ä¸ºå‘é‡ï¼Œä»¥ä¾¿ç½‘ç»œå¤„ç†</span></span><br><span class="line">num_px=<span class="number">64</span></span><br><span class="line">image=Image.open(my_image).convert(<span class="string">'RGB'</span>).resize((num_px,num_px))</span><br><span class="line">my_input=array(image).reshape((num_px*num_px*<span class="number">3</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å…¥ç½‘ç»œè¿›è¡Œæµ‹è¯•</span></span><br><span class="line">my_predict=predict(my_input,my_image_y,parameter)</span><br><span class="line">plt.imshow(image)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"y = "</span> + str(squeeze(my_predict)) + <span class="string">", your L-layer model predicts a \""</span> + classes[int(squeeze(my_predict)),].decode(<span class="string">"utf-8"</span>) +  <span class="string">"\" picture."</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æ·±å±‚ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>react+springbootå‰åå°åˆ†ç¦»é¡¹ç›®</title>
    <url>/blogs/react-springboot/</url>
    <content><![CDATA[<h2 id="å®éªŒæè¿°"><a href="#å®éªŒæè¿°" class="headerlink" title="å®éªŒæè¿°"></a>å®éªŒæè¿°</h2><p>è®­ç»ƒéƒ¨åˆ†ï¼šä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹æ³•å®ç°ä¸¤ç§æœºå™¨å­¦ä¹ ç®—æ³•BPã€SVMï¼Œå¹¶å°†ä¸¤ç§ç®—æ³•è¿›è¡Œå°è£…ï¼Œé€šè¿‡æ¥å£è°ƒç”¨ä¸¤ç§ç®—æ³•ï¼Œåˆ©ç”¨å·²çŸ¥1-5æœˆæ°”è±¡æ•°æ®è®­ç»ƒ2ä¸ªæ°”æ¸©é¢„æµ‹æ¨¡å‹ï¼Œå¹¶é¢„æµ‹åç»­3æ—¥æ°”æ¸©å€¼ã€‚</p><p>æµ‹è¯•éƒ¨åˆ†ï¼šåˆ©ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå½“è¾“å…¥æœ€å¤§æ¸©åº¦ï¼Œæœ€å°æ¸©åº¦ï¼Œæ¹¿åº¦å’Œå…‰ç…§æ—¶ï¼Œå¯ä»¥å¾—åˆ°é¢„æµ‹å¾—æ°”æ¸©ã€‚</p><h2 id="é€šè¿‡dubbo-zookeeperå®ç°é€šè¿‡æ¥å£è¿œç¨‹è°ƒç”¨ç®—æ³•æ¨¡å‹"><a href="#é€šè¿‡dubbo-zookeeperå®ç°é€šè¿‡æ¥å£è¿œç¨‹è°ƒç”¨ç®—æ³•æ¨¡å‹" class="headerlink" title="é€šè¿‡dubbo+zookeeperå®ç°é€šè¿‡æ¥å£è¿œç¨‹è°ƒç”¨ç®—æ³•æ¨¡å‹"></a>é€šè¿‡dubbo+zookeeperå®ç°é€šè¿‡æ¥å£è¿œç¨‹è°ƒç”¨ç®—æ³•æ¨¡å‹</h2><a id="more"></a>

<p>å®ç°åŠŸèƒ½ï¼šç”Ÿäº§è€…å®ç°ä¸¤ç§æœºå™¨å­¦ä¹ ç®—æ³•BP,SVMï¼Œæ¶ˆè´¹è€…é€šè¿‡è¿œç¨‹è°ƒç”¨ç”Ÿäº§è€…çš„æ¥å£ï¼Œèƒ½å¤Ÿç”¨è‡ªå·±çš„æ•°æ®è®­ç»ƒBPå’ŒSVMçš„æ¨¡å‹ï¼Œå¹¶æ ¹æ®è®­ç»ƒçš„æ¨¡å‹ï¼Œä½¿ç”¨æ•°æ®è¿›è¡Œæµ‹è¯•ã€‚</p>
<h3 id="å®‰è£…é…ç½®zookeeper"><a href="#å®‰è£…é…ç½®zookeeper" class="headerlink" title="å®‰è£…é…ç½®zookeeper"></a>å®‰è£…é…ç½®zookeeper</h3><p>åœ¨å®˜ç½‘<a href="http://zookeeper.apache.org/" target="_blank" rel="external nofollow noopener noreferrer">http://zookeeper.apache.org/</a>é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ä¸‹è½½ï¼Œæˆ‘ä¸‹è½½çš„æ˜¯zookeeper-3.5.7ï¼Œè§£å‹å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­dataDirï¼Œæˆ‘ä½¿ç”¨çš„é»˜è®¤è·¯å¾„/bmp/zookeeperã€‚åˆ‡æ¢è‡³binç›®å½•ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤./zkServer.sh startï¼Œå¯åŠ¨æœåŠ¡</p>
<p>å‡ºç°å¦‚ä¸‹å­—æ ·è¯´æ˜æœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /Users/Local/Resource/zookeeper/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br></pre></td></tr></table></figure>

<h3 id="æ–°å»ºç”Ÿäº§è€…pc2ï¼ˆproviderCenterï¼‰é¡¹ç›®"><a href="#æ–°å»ºç”Ÿäº§è€…pc2ï¼ˆproviderCenterï¼‰é¡¹ç›®" class="headerlink" title="æ–°å»ºç”Ÿäº§è€…pc2ï¼ˆproviderCenterï¼‰é¡¹ç›®"></a>æ–°å»ºç”Ÿäº§è€…pc2ï¼ˆproviderCenterï¼‰é¡¹ç›®</h3><p>ï¼ˆ1ï¼‰æä¾›æ¥å£</p>
<p>åœ¨provideré¡¹ç›®ä¸­æ–°å»ºclientæ¨¡å—ï¼Œå…¶ä¸­å®šä¹‰IUseModelsæ¥å£ï¼Œè¯¥æ¥å£å°±æ˜¯è¦æ³¨å†Œåˆ°zookeeperä¸­å¿ƒã€‚ä¾›è¿œç¨‹æ¶ˆè´¹è€…è°ƒç”¨ã€‚</p>
<p>IUseModelsæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUseModels</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  Map&lt;String, <span class="keyword">double</span>[][]&gt; bpTrain(<span class="keyword">double</span>[][] inData,<span class="keyword">double</span>[][] target, <span class="keyword">int</span> inputSize, <span class="keyword">int</span> hideSize, <span class="keyword">int</span> outputSize, <span class="keyword">int</span> iter);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">bpTest</span><span class="params">(<span class="keyword">double</span>[] inData,Map&lt;String, <span class="keyword">double</span>[][]&gt; map)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">double</span>[] svmTrain(<span class="keyword">double</span>[][] inData,<span class="keyword">double</span>[] y,<span class="keyword">int</span> iter,<span class="keyword">double</span> parameter);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">svmTest</span><span class="params">(<span class="keyword">double</span>[] inData,<span class="keyword">double</span>[] w)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥å£å®šä¹‰äº†bpç®—æ³•çš„è®­ç»ƒæ¨¡å‹éƒ¨åˆ†ã€æµ‹è¯•æ•°æ®åŠŸèƒ½ï¼Œsvmç®—æ³•çš„è®­ç»ƒæ¨¡å‹éƒ¨åˆ†ã€æµ‹è¯•æ•°æ®åŠŸèƒ½ã€‚</p>
<p>æ¥å£çš„å…·ä½“å®ç°åœ¨ä¸»æ¨¡å—çš„UseModelsImplä¸­ï¼š</p>
<p>bpTrainæ ¹æ®ç”¨æˆ·è¾“å…¥çš„è®­ç»ƒæ•°æ®ï¼Œè¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚ç¥ç»å…ƒä¸ªæ•°ï¼Œè®­ç»ƒæ¬¡æ•°è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå¹¶è¿”å›è®­ç»ƒçš„æ¨¡å‹ã€‚</p>
<p>bpTestæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æµ‹è¯•æ•°æ®ï¼Œä¹‹å‰è®­ç»ƒçš„æ¨¡å‹å¾—å‡ºè¾“å‡ºçš„ç»“æœè¿”å›ã€‚</p>
<p>svmTrainæ ¹æ®ç”¨æˆ·è¾“å…¥çš„è®­ç»ƒæ•°æ®ï¼ŒæŸå¤±å‡½æ•°çš„å‚æ•°ï¼Œè®­ç»ƒæ¬¡æ•°è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå¹¶è¿”å›è®­ç»ƒçš„æ¨¡å‹</p>
<p>svmTestæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æµ‹è¯•æ•°æ®ï¼Œä¹‹å‰è®­ç»ƒçš„æ¨¡å‹å¾—å‡ºè¾“å‡ºçš„ç»“æœè¿”å›ã€‚</p>
<p>ï¼ˆ2ï¼‰å¼•ç”¨æœåŠ¡</p>
<p>ç”Ÿäº§è€…é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æœåŠ¡å¼•ç”¨ï¼Œéœ€è¦é…ç½®dubboä¾èµ–å’Œzookeeperä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ç”Ÿäº§è€…åœ¨zookeeperä¸Šæ³¨å†Œ</p>
<p>åœ¨é¡¹ç›®å†…æ–°å»ºé…ç½®æ–‡ä»¶provider.xmlï¼ŒæŒ‡å®šå½“å‰æœåŠ¡çš„åå­—ï¼ŒæŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œè¿™é‡Œé»˜è®¤æ³¨å†Œä¸­å¿ƒåœ¨æœ¬åœ°ï¼ŒæŒ‡å®šé€šä¿¡è§„åˆ™æ˜¯dubboï¼Œé€šä¿¡ç«¯å£ä¸º7070ï¼Œå£°æ˜éœ€è¦æš´éœ²çš„æœåŠ¡æ¥å£ï¼ŒåŒæ—¶æŒ‡å‘å®¹å™¨ä¸­çš„æ¥å£å®ç°å¯¹è±¡ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span> = <span class="string">"dubbo_provider"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span> = <span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"7070"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span> = <span class="string">"zookeeper://127.0.0.1:2181"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span> = <span class="string">"com.cl.client.IUseModels"</span> <span class="attr">ref</span> = <span class="string">"UseModelsImpl"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨zkui-masteræŸ¥çœ‹æ³¨å†Œä¸­å¿ƒä¸Šå·²æ³¨å†Œçš„ç”Ÿäº§è€…èŠ‚ç‚¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507202451.png" alt></p>
<p>ï¼ˆ4ï¼‰æš´éœ²æ¥å£</p>
<p>ä½¿ç”¨mavenä¸­çš„installå‘½ä»¤å°†æ¥å£å•ç‹¬è¿›è¡Œç¼–è¯‘ï¼Œå¹¶æŠŠæ¥å£ç¼–è¯‘çš„jaråŒ…å®‰è£…è‡³æœ¬åœ°mavenä»“åº“ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507202521.png" alt></p>
<p>æŸ¥çœ‹æœ¬åœ°mavenä»“åº“ï¼Œå‘ç°æ¥å£æˆåŠŸä¸Šä¼ è‡³ä»“åº“ï¼Œä»¥ä¾›æ¶ˆè´¹è€…ä½¿ç”¨ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507202529.png" alt></p>
<h3 id="æ–°å»ºæ¶ˆè´¹è€…oc2ï¼ˆconsumerCenterï¼‰é¡¹ç›®"><a href="#æ–°å»ºæ¶ˆè´¹è€…oc2ï¼ˆconsumerCenterï¼‰é¡¹ç›®" class="headerlink" title="æ–°å»ºæ¶ˆè´¹è€…oc2ï¼ˆconsumerCenterï¼‰é¡¹ç›®"></a>æ–°å»ºæ¶ˆè´¹è€…oc2ï¼ˆconsumerCenterï¼‰é¡¹ç›®</h3><p>ï¼ˆ1ï¼‰æ¶ˆè´¹è€…åœ¨zookeeperä¸Šè°ƒç”¨</p>
<p>åœ¨é¡¹ç›®å†…æ–°å»ºé…ç½®æ–‡ä»¶consumer.xmlï¼ŒæŒ‡å®šå½“å‰æœåŠ¡çš„åå­—ï¼ŒæŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼ŒæŒ‡å®šéœ€è¦è°ƒç”¨çš„æœåŠ¡çš„æ¥å£åç§°ï¼Œä»¥ä¾¿è°ƒç”¨ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"demo_consumer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"zookeeper://127.0.0.1:2181"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">"UseModelsImpl"</span> <span class="attr">interface</span>=<span class="string">"com.cl.client.IUseModels"</span> <span class="attr">timeout</span>=<span class="string">"3000"</span> <span class="attr">check</span>=<span class="string">"false"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¯¼å…¥ç”Ÿäº§è€…æ¥å£jaråŒ…</p>
<p>åœ¨pom.xmlæ·»åŠ å¯¹åº”åŒ…çš„ä¾èµ–ï¼Œmavenè‡ªåŠ¨ä¸‹è½½æœ¬åœ°ä»“åº“ä¸­çš„jaråŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å®ç°è¿œç¨‹è°ƒç”¨</p>
<p>å¯åŠ¨ç”Ÿäº§è€…ç«¯åï¼Œç”Ÿäº§è€…ç«¯é€šè¿‡dubboæœåŠ¡å°†è‡ªå·±çš„urlåœ°å€æ³¨å†Œåˆ°zookeeperä¸Šï¼Œæ¶ˆè´¹è€…ç«¯é€šè¿‡è°ƒç”¨dubboæœåŠ¡ï¼Œæ ¹æ®é…ç½®çš„æ³¨å†Œä¸­å¿ƒä»¥åŠæ¥å£åç§°åˆ°zookeeperä¸ŠæŸ¥æ‰¾å¯¹åº”çš„ç”Ÿäº§è€…ç«¯ä¸­çš„æ¥å£å®ç°ã€‚</p>
<p>æ¶ˆè´¹è€…ç«¯å°†IUseModelsæ¥å£å®ä¾‹åŒ–ï¼Œç¼–å†™æ–¹æ³•testbpç”¨äºè®­ç»ƒbpæ¨¡å‹å¹¶è¿›è¡Œæ°”æ¸©é¢„æµ‹ï¼šå¯¼å…¥æœ¬åœ°æ•°æ®ï¼Œå¹¶è°ƒç”¨IUseModelsä¸­çš„bpTrainæ–¹æ³•ï¼Œæ¶ˆè´¹è€…ç«¯æ‰¾åˆ°ç”Ÿäº§è€…ç«¯ä¸­çš„ç«¯å£å®ç°ï¼Œä¼ å…¥è®­ç»ƒçš„æ ·æœ¬ï¼Œè¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚çš„ç»“æ„è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œè®­ç»ƒç»“æŸåï¼Œå¾—åˆ°å®Œæˆçš„æ¨¡å‹ï¼Œå¹¶æ ¹æ®æµ‹è¯•æ•°æ®è¿”å›é¢„æµ‹å¾—åä¸‰å¤©æ°”æ¸©ã€‚</p>
<p>åŒç†ï¼Œæ¶ˆè´¹è€…ç«¯çš„testsvmæ–¹æ³•è°ƒç”¨IUseModelsä¸­çš„svmTrainæ–¹æ³•å¾—åˆ°é¢„æµ‹å¾—æ°”æ¸©ã€‚</p>
<p>bpå’Œsvmæ¨¡å‹è®­ç»ƒåè¿›è¡Œä¿å­˜ï¼Œæ¶ˆè´¹è€…ç«¯çš„calcTempæ–¹æ³•é€šè¿‡ä»¥è®­ç»ƒçš„æ¨¡å‹å’Œå‰å°ä¼ å…¥çš„æµ‹è¯•æ•°æ®é¢„æµ‹å…­æœˆæŸå¤©çš„æ°”æ¸©ã€‚</p>
<p>ä½¿ç”¨zkui-masteræŸ¥çœ‹æ³¨å†Œä¸­å¿ƒä¸Šå·²æ³¨å†Œçš„æ¶ˆè´¹è€…èŠ‚ç‚¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204011.png" alt></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨bubboèŠ‚ç‚¹ä¸‹çš„consumersæ¶ˆè´¹è€…èŠ‚ç‚¹ä¸­åŒ…å«äº†å½“å‰æä¾›æœåŠ¡çš„ç”Ÿäº§è€…æä¾›çš„æ¥å£åç§°å’Œæ¥å£æ–¹æ³•ã€‚</p>
<h2 id="ä½¿ç”¨springboot-react-antdå®ç°é¡¹ç›®å‰åå°åˆ†ç¦»å¹¶å‘å¸ƒè®­ç»ƒçš„æ¨¡å‹åŠæµ‹è¯•çš„ç»“æœ"><a href="#ä½¿ç”¨springboot-react-antdå®ç°é¡¹ç›®å‰åå°åˆ†ç¦»å¹¶å‘å¸ƒè®­ç»ƒçš„æ¨¡å‹åŠæµ‹è¯•çš„ç»“æœ" class="headerlink" title="ä½¿ç”¨springboot+react+antdå®ç°é¡¹ç›®å‰åå°åˆ†ç¦»å¹¶å‘å¸ƒè®­ç»ƒçš„æ¨¡å‹åŠæµ‹è¯•çš„ç»“æœ"></a>ä½¿ç”¨springboot+react+antdå®ç°é¡¹ç›®å‰åå°åˆ†ç¦»å¹¶å‘å¸ƒè®­ç»ƒçš„æ¨¡å‹åŠæµ‹è¯•çš„ç»“æœ</h2><h3 id="ä½¿ç”¨react-antdè¿›è¡Œå‰å°æ­å»º"><a href="#ä½¿ç”¨react-antdè¿›è¡Œå‰å°æ­å»º" class="headerlink" title="ä½¿ç”¨react+antdè¿›è¡Œå‰å°æ­å»º"></a>ä½¿ç”¨react+antdè¿›è¡Œå‰å°æ­å»º</h3><p>ï¼ˆ1ï¼‰åˆ›å»ºå‰å°é¡µé¢å·¥ç¨‹</p>
<p>ä½¿ç”¨reactè„šæ‰‹æ¶create-react-appåˆ›å»ºå·¥ç¨‹testã€‚</p>
<p>æ­¥éª¤å‚ç…§å®˜ç½‘<a href="https://ant.design/docs/react/use-with-create-react-app-cn" target="_blank" rel="external nofollow noopener noreferrer">https://ant.design/docs/react/use-with-create-react-app-cn</a></p>
<p>å®‰è£…è„šæ‰‹æ¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g create-react-app</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create react-app test</span><br></pre></td></tr></table></figure>

<p>å¼•å…¥antdï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yarn add antd</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹package.json,è®©é¡¹ç›®å¯ä»¥è‡ªå®šä¹‰é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;react-app-rewired start&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;react-app-rewired build&quot;,</span><br><span class="line">  &quot;test&quot;: &quot;react-app-rewired test&quot;,</span><br><span class="line">  &quot;eject&quot;: &quot;react-scripts eject&quot;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª config-overrides.js ç”¨äºä¿®æ”¹é»˜è®¤é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; override, fixBabelImports &#125; = <span class="built_in">require</span>(<span class="string">'customize-cra'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = override(</span><br><span class="line"> fixBabelImports(<span class="string">'import'</span>, &#123;</span><br><span class="line">  libraryName: <span class="string">'antd'</span>,</span><br><span class="line">  libraryDirectory: <span class="string">'es'</span>,</span><br><span class="line">  style: <span class="string">'css'</span>,</span><br><span class="line"> &#125;),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨yarnå®‰è£…é¡¹ç›®éœ€è¦çš„ä¾èµ–ï¼šyarn install</p>
<p>è¿›å…¥é¡¹ç›®ï¼Œå¹¶å¯åŠ¨ï¼šcd antd-demo  yarn start</p>
<p>é¡¹ç›®é»˜è®¤ç«¯å£æ˜¯3000ï¼Œå½“æ²¡æœ‰ç¨‹åºå ç”¨æ—¶ï¼Œç›´æ¥æ‰“å¼€æµè§ˆå™¨ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼Œè¯´æ˜è¿è¡ŒæˆåŠŸã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204025.png" alt></p>
<p>å½“ç«¯å£è¢«å ç”¨æ—¶ï¼Œä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œé€‰æ‹©y,å³ç”¨å…¶ä»–ç«¯å£æ‰“å¼€å³å¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204034.png" alt></p>
<p>å¦‚æœéœ€è¦ä¿®æ”¹é»˜è®¤ç«¯å£å·ï¼Œå¯ä»¥æ‰¾åˆ°é¡¹ç›®ä¸‹/node_modules/react-scripts/scripts/start.jsï¼Œæ‰¾åˆ°DEFAULT_PORTï¼Œä¿®æ”¹ç«¯å£å³å¯ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204201.png" alt></p>
<p>ï¼ˆ2ï¼‰reactè„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®ç»“æ„</p>
<p>åˆ›å»ºçš„é¡¹ç›®é»˜è®¤ç›®å½•å¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204210.png" alt></p>
<p>å…¶ä¸­node_mudulesæ–‡ä»¶å¤¹å†…æ˜¯å®‰è£…çš„æ‰€æœ‰ä¾èµ–æ¨¡å—ï¼Œpackage.jsoné‡ŒåŒ…å«é¡¹ç›®åŸºæœ¬è®¾ç½®ï¼Œå¦‚åç§°ã€ç‰ˆæœ¬å·ç­‰ï¼Œæœ€ä¸»è¦çš„æ˜¯srcæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«çš„jsæ–‡ä»¶æ˜¯é¡µé¢å±•ç¤ºçš„å†…å®¹,cssæ–‡ä»¶æ˜¯æ ·å¼æ–‡ä»¶ï¼Œé¡¹ç›®é»˜è®¤index.jsæ˜¯é¡¹ç›®çš„å…¥å£ã€‚index.jså†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204219.png" alt></p>
<p>ä½¿ç”¨ React æ„å»ºçš„åº”ç”¨é€šå¸¸åªæœ‰å•ä¸€çš„æ ¹ DOM èŠ‚ç‚¹ï¼Œé€šè¿‡â€˜rootâ€™ä¹Ÿå¯åˆ¤æ–­indexæ˜¯ä»£ç å…¥å£ï¼Œå…¶ä¸­ReactDOM.renderåé¢æ˜¯æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„å†…å®¹ï¼Œè¿™é‡Œæ˜¯ç›´æ¥æ˜¾ç¤ºAppé¡µé¢ï¼ŒAppé¡µé¢ä¸­ç®€å•è®¾ç½®äº†æ–‡å­—å’Œå›¾åƒï¼Œå³é¡¹ç›®åˆå§‹è¿è¡Œæ—¶æ˜¾ç¤ºçš„å†…å®¹ã€‚</p>
<p>ï¼ˆ3ï¼‰åˆ›å»ºé¡µé¢</p>
<p>åœ¨srcæ–‡ä»¶å¤¹ä¸‹æ–°å»ºjsæ–‡ä»¶ï¼Œé€šè¿‡classç»„ä»¶å»ºç«‹æ˜¾ç¤ºçš„é¡µé¢å†…å®¹ï¼Œclassç»„ä»¶æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">  å†…å®¹<span class="number">1</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">    å†…å®¹<span class="number">2</span>);</span><br><span class="line">  	&#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>



<p>å†…å®¹1éƒ¨åˆ†è®¾ç½®éœ€è¦ç”¨åˆ°çš„å¯¹è±¡ï¼Œæ„é€ å‡½æ•°ï¼Œè§¦å‘çš„äº‹ä»¶ï¼Œä¸åå°æ•°æ®äº¤äº’ç­‰å†…å®¹ã€‚</p>
<p>å†…å®¹2éƒ¨åˆ†æ˜¯è®¾ç½®é¡µé¢æ˜¾ç¤ºçš„éƒ¨åˆ†ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨antdç»„ä»¶ã€‚</p>
<p>1Â°å†…å®¹2éƒ¨åˆ†:ä½¿ç”¨antdç»„ä»¶åˆ›å»ºé¡µé¢å†…å®¹</p>
<p>è¿›å…¥antdå®˜ç½‘<a href="https://ant.design/components/button-cn/" target="_blank" rel="external nofollow noopener noreferrer">https://ant.design/components/button-cn/</a> ï¼Œé€‰æ‹©ç»„ä»¶ï¼Œä»¥buttonç»„ä»¶ä¸ºä¾‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204229.png" alt></p>
<p>ç¬¬ä¸€æ­¥ï¼Œé€‰æ‹©éœ€è¦çš„ç»„ä»¶button</p>
<p>ç¬¬äºŒæ­¥ï¼Œåœ¨â€œä»£ç æ¼”ç¤ºâ€éƒ¨åˆ†æ‰¾åˆ°è‡ªå·±éœ€è¦çš„æ ·å¼</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œæ˜¾ç¤ºå½“å‰ç»„ä»¶çš„ä»£ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204238.png" alt></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œå±•ç¤ºäº†å››ç§æŒ‰é’®ä»£ç ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šé¢å››ç§ä¸åŒæ ·å¼çš„æŒ‰é’®ï¼Œé€‰æ‹©ç¬¬ä¸€ç§æŒ‰é’®ï¼Œèµ‹å€¼ä»£ç ï¼Œå¹¶æŠŠéœ€è¦çš„åº“æ–‡ä»¶å¯¼å…¥ï¼Œé€‰æ‹©æ–¹æ¡†å†…çš„ä»£ç å¤åˆ¶è¿›App.jsæ–‡ä»¶ä¸­</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204248.png" alt></p>
<p>é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204257.png" alt></p>
<p>antdç»„ä»¶è¿›è¡ŒæŒ‰éœ€é€‰æ‹©ï¼Œé¡¹ç›®ä¸­æ„å»ºäº†å¦‚ä¸‹æ–‡ä»¶ï¼š</p>
<p>index.js:é¡¹ç›®å…¥å£ï¼Œæ˜¾ç¤ºDemo.jsé¡µé¢ã€‚</p>
<p>Demo.js:ä¸»é¡µé¢ï¼Œè®¾ç½®ä¸ºä¾§è¾¹å¸ƒå±€ï¼Œå½“é¡µé¢æ¨ªå‘ç©ºé—´æœ‰é™æ—¶ï¼Œä¾§è¾¹å¯¼èˆªå¯ä»¥æ”¶èµ·ï¼Œå½“ç‚¹å‡»å¯¼èˆªä¸Šå¯¹åº”èœå•è·³è½¬å¯¹åº”é¡µé¢ï¼ˆé¦–é¡µé¡µé¢show.jsã€è®­ç»ƒé¡µé¢Train.js,æµ‹è¯•é¡µé¢Res.js,å…³äºé¡µé¢About.jsï¼‰ã€‚</p>
<p>show.js: é¦–é¡µé¡µé¢ï¼Œé¡¹ç›®é»˜è®¤æ˜¾ç¤ºé¦–é¡µé¡µé¢ï¼Œç”±Cardç»„ä»¶å’Œæ–‡å­—ç»„æˆã€‚</p>
<p>Train.js: è®­ç»ƒé¡µé¢ï¼Œå®ç°è·å–åå°æ•°æ®åŠŸèƒ½ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œåå°è®­ç»ƒå¯¹åº”ç®—æ³•æ¨¡å‹ï¼Œå¹¶å°†ç»“æœä¼ å›å‰å°è¿›è¡Œæ˜¾ç¤ºã€‚</p>
<p>Res.js: æµ‹è¯•é¡µé¢ï¼Œä»¥è¡¨å•å½¢å¼å®ç°é€šè¿‡å‰å°æäº¤æ•°æ®ï¼Œåå°æ¥æ”¶æ•°æ®å¹¶è®¡ç®—ï¼Œæœ€ç»ˆå°†ç»“æœè¿”å›å‰å°çš„åŠŸèƒ½ã€‚</p>
<p>About.js:å…³äºé¡µé¢ï¼Œæ˜¾ç¤ºé¡¹ç›®åŠä½œè€…ä¿¡æ¯ã€‚</p>
<p>æœ€ç»ˆæ­å»ºçš„é¡¹ç›®é¡µé¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204304.png" alt></p>
<p>ï¼ˆ4ï¼‰å‰å°é¡µé¢è½¬å‘</p>
<p>é¡¹ç›®ä¸»é¡µé¢Demo.jsé€šè¿‡ç‚¹å‡»ä¾§è¾¹å¯¼èˆªæ ï¼Œèƒ½å¤Ÿè·³è½¬å¯¹åº”é¡µé¢ï¼Œä¸»è¦æ˜¯ä½¿ç”¨react-router-dom,ä»react-router-domä¸­å¯¼å…¥è·¯ç”±Router,Demoé¡µé¢ä½¿ç”¨è·¯ç”±ç»„ä»¶æ¸²æŸ“ï¼Œä½¿ç”¨linkç»„ä»¶å®ç°è‡³è·¯ç”±è·³è½¬ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œå°†éœ€è¦è·³è½¬çš„å¯¼èˆªèœå•ä¸Šè®¾ç½®Linkç»„ä»¶ï¼Œè®¾ç½®éœ€è¦è·³è½¬çš„é¡µé¢<link to="/">é¦–é¡µ</p>
<p>ç¬¬äºŒæ­¥ï¼Œç”±é¡µé¢è·¯ç”±è®¾ç½®è¿æ¥éœ€è¦è·³è½¬çš„é¡µé¢<route exact path="/" component="{show}">ï¼Œcomponentåé¢å°±æ˜¯è·³è½¬çš„é¡µé¢å†…å®¹,è¿™é‡Œexact pathè®¾ç½®ç³»ç»Ÿé»˜è®¤è¿›å…¥çš„é¡µé¢ã€‚</route></p>
<p>è½¬å‘å‰å°é¡µé¢æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;Router&gt;</span><br><span class="line">   &lt;Menu theme=<span class="string">"dark"</span> defaultSelectedKeys=&#123;[<span class="string">'0'</span>]&#125; mode=<span class="string">"inline"</span>&gt;</span><br><span class="line">        &lt;Menu.Item key=<span class="string">"0"</span>&gt;</span><br><span class="line">            &lt;Link to=<span class="string">"/"</span>&gt;é¦–é¡µ&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">         &lt;/</span>Menu.Item&gt;</span><br><span class="line">         &lt;Menu.Item key=<span class="string">"1"</span>&gt;</span><br><span class="line">             &lt;Link to=<span class="string">"/Train"</span>&gt;è®­ç»ƒ&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>Menu.Item&gt;</span><br><span class="line">   &lt;<span class="regexp">/Menu&gt;</span></span><br><span class="line"><span class="regexp">   &lt;Route exact path="/</span><span class="string">" component=&#123;show&#125; /&gt;</span></span><br><span class="line"><span class="string">   &lt;Route  path="</span>/Train<span class="string">" component=&#123;Train&#125; /&gt;</span></span><br><span class="line"><span class="string">&lt;/Router&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="å‰å°å’Œåå°æ•°æ®äº¤äº’"><a href="#å‰å°å’Œåå°æ•°æ®äº¤äº’" class="headerlink" title="å‰å°å’Œåå°æ•°æ®äº¤äº’"></a>å‰å°å’Œåå°æ•°æ®äº¤äº’</h3><p>åå°å¼€å‘ä½¿ç”¨springbootæ¡†æ¶,å¼€å‘è½¯ä»¶ä¸ºIntelliJ IDEAã€‚</p>
<p>ï¼ˆ1ï¼‰è·¨åŸŸé—®é¢˜</p>
<p>è·¨åŸŸæ˜¯æŒ‡å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œurlä¼šæœ‰åŒ…å«ä¸‰ä¸ªä¸»è¦ä¿¡æ¯ï¼šåè®®ï¼ˆprotocolï¼‰ï¼ŒåŸŸåï¼ˆhostï¼‰ï¼Œç«¯å£å·ï¼ˆportï¼‰ã€‚å½“ä¸‰éƒ¨åˆ†éƒ½å’ŒæœåŠ¡å™¨ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå±äºåŒæºã€‚ä½†æ˜¯åªè¦æœ‰ä¸€ä¸ªä¸åŒ,å°±å±äºæ„æˆäº†è·¨åŸŸè°ƒç”¨ã€‚ä¼šå—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ã€‚åŒæºç­–ç•¥é™åˆ¶ä»ä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚springbooté¡¹ç›®é»˜è®¤ç«¯å£æ˜¯8080ï¼Œreacté»˜è®¤ç«¯å£æ˜¯3000,å‰åç«¯ç«¯å£ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æœ‰è·¨åŸŸé—®é¢˜ã€‚</p>
<p>è¿™é‡Œé‡‡ç”¨ä»£ç†æ–¹å¼è¿›è¡Œå¤„ç†ï¼šï¼ˆè¿™é‡Œspringbooté¡¹ç›®çš„ç«¯å£ä¸º9091ï¼‰ï¼Œåœ¨reacté¡¹ç›®ä¸­çš„package.jsonä¸­è®¾ç½®è½¬å‘â€proxyâ€:â€<a href="http://localhost:9091&quot;" target="_blank" rel="external nofollow noopener noreferrer">http://localhost:9091&quot;</a> ,å°†å¯¹å‰ç«¯çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨è½¬å‘åˆ°9091ç«¯å£å³åå°é¡¹ç›®çš„å…¥å£ä¸­ï¼Œè¿™æ ·å°±è§£å†³äº†è·¨åŸŸé—®é¢˜ã€‚</p>
<p>ï¼ˆ2ï¼‰æ•°æ®äº¤äº’</p>
<p>è¿™é‡Œçš„é¡¹ç›®æ˜¯é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„æ€æƒ³ï¼Œå‰ç«¯ä»åç«¯å‰¥ç¦»ï¼Œå½¢æˆä¸€ä¸ªå‰ç«¯å·¥ç¨‹ï¼Œå‰ç«¯åªåˆ©ç”¨Jsonæ¥å’Œåç«¯è¿›è¡Œäº¤äº’ï¼Œåç«¯ä¸è¿”å›é¡µé¢ï¼Œåªè¿”å›Jsonæ•°æ®ã€‚å‰åç«¯ä¹‹é—´å®Œå…¨é€šè¿‡public APIçº¦å®šã€‚å‰åç«¯ä¹‹é—´ä½¿ç”¨fetchè¿›è¡Œæ•°æ®äº¤äº’ã€‚</p>
<p>1Â°å‰å°æ¥æ”¶åå°æ•°æ®</p>
<p>åå°ï¼šspringbootè®¾ç½®controlå±‚ï¼Œè¿”å›jsonæ•°æ®ã€‚è¿™é‡Œçš„testbpè°ƒç”¨ç”Ÿäº§è€…ç«¯çš„bpç®—æ³•ï¼Œå¾—åˆ°æ¨¡å‹åä½¿ç”¨æ•°æ®æµ‹è¯•ï¼Œæœ€åè¿”å›â€œåä¸‰å¤©çš„æ¸©åº¦â€çš„jsonæ•°æ®ã€‚</p>
<p>åå°æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/submit"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubmitController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUseModels useModels;</span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,<span class="keyword">double</span>[][]&gt; mapRes;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/testbp"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testbp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¯¼å…¥æ•°æ®</span></span><br><span class="line">        ..</span><br><span class="line">        <span class="comment">//è®­ç»ƒç½‘ç»œ</span></span><br><span class="line">        mapRes= useModels.bpTrain(inData,target,inputSize,hideSize,outputSize,iter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æµ‹è¯•æ•°æ®</span></span><br><span class="line">        <span class="keyword">double</span>[] x = <span class="keyword">new</span> <span class="keyword">double</span>[]&#123;<span class="number">14.7</span>,<span class="number">0</span>,<span class="number">11.7</span>,<span class="number">22.4</span>&#125;;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">double</span> res=useModels.bpTest(x,mapRes);</span><br><span class="line">   	 <span class="comment">//è®¾ç½®è¾“å‡ºç²¾åº¦</span></span><br><span class="line">        DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.00 "</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"åä¸‰å¤©çš„æ¸©åº¦ä¸ºï¼š"</span>+df.format(res)+<span class="string">" , "</span>+df.format(res2)+<span class="string">" , "</span>+df.format(res3);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰å°ï¼šå‰å°å°±éœ€è¦å°†è¯·æ±‚è½¬å‘åˆ°<a href="http://localhost:9091/submit/testbp" target="_blank" rel="external nofollow noopener noreferrer">http://localhost:9091/submit/testbp</a> ä¸Šï¼Œå› ä¸ºä¸Šé¢è®¾ç½®äº†è·¨åŸŸè½¬å‘ï¼Œæ‰€ä»¥ä½¿ç”¨fetch(â€˜/submit/testbpâ€™)å³å¯ä»¥å°†è¯·æ±‚è½¬å‘è‡³åå°ï¼Œå½“è·å–åˆ°jsonæ•°æ®åå°†å…¶è½¬æ¢æˆtextï¼ˆthen(response =&gt; response.text())ï¼‰ï¼Œå¹¶è¯»å–å…¶ä¸­çš„messageï¼ˆthen(message =&gt; {this.setState({message: message});});ï¼‰,å³åå°ä¼ å›çš„åä¸‰å¤©çš„æ¸©åº¦æ•°æ®ã€‚</p>
<p>é¡¹ç›®ä¸­è®¾ç½®çš„æ˜¯ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œå‘åå°è·å–æ•°æ®ï¼Œå› æ­¤å°†fetchå†™åœ¨äº‹ä»¶ä¸­ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶ï¼Œè¿™é‡Œä½¿ç”¨buttonç»„ä»¶è‡ªå¸¦çš„onclickæ–¹æ³•ç»‘å®šäº‹ä»¶ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ JavaScript ä¸­ï¼Œclass çš„æ–¹æ³•é»˜è®¤ä¸ä¼šç»‘å®š thisã€‚å¦‚æœå¿˜è®°ç»‘å®š this.handleClick å¹¶æŠŠå®ƒä¼ å…¥äº† onClickï¼Œå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ this çš„å€¼ä¸º undefinedï¼Œæ‰€ä»¥éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šäº‹ä»¶ã€‚</p>
<p>æ³¨ï¼šå¦‚æœéœ€è¦è¿›å…¥é¡µé¢å°±ä»åå°è·å–æ•°æ®ï¼Œåˆ™éœ€è¦åœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°componentDidMount()ä¸­æ·»åŠ fetch</p>
<p>å‰å°è·å–åå°æ•°æ®è¿‡ç¨‹ï¼š</p>
<p>ç¬¬ä¸€æ­¥ï¼Œç¼–å†™äº‹ä»¶ï¼Œé€šè¿‡fetchè·å–jsonæ•°æ®ï¼Œå¹¶é€šè¿‡setStateè®¾ç½®æ–‡æœ¬å€¼</p>
<p>ç¬¬äºŒæ­¥ï¼Œå°†æ—¶é—´ä¼ å…¥buttonçš„onclickå±æ€§ä¸­ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶è¿›è¡Œè§¦å‘</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šè§¦å‘çš„äº‹ä»¶</p>
<p>ç¬¬å››æ­¥ï¼Œå°†å½“å‰stateä¸­çš„æ–‡æœ¬å€¼æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204315.png" alt></p>
<p>æ³¨ï¼šstateæ˜¯ç»„ä»¶å†…éƒ¨è¿›è¡Œä¼ é€’æ•°æ®ï¼Œå…·æœ‰ä»ä¸Šåˆ°ä¸‹çš„ç‰¹ç‚¹ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–ï¼Œå½“è·å¾—åå°æ•°æ®æ—¶ï¼Œé€šè¿‡setStateè®¾ç½®æ–°çš„stateçš„å€¼ï¼Œæœ€ç»ˆåœ¨é¡µé¢ä¸Šè¿›è¡Œæ˜¾ç¤ºã€‚ï¼ˆstateä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œåªèƒ½é€šè¿‡setStateè®¾ç½®æ–°çš„å€¼ï¼‰</p>
<p>å‰å°è¿è¡Œç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204328.png" alt></p>
<p>å‰å°é€šè¿‡ç‚¹å‡»è®­ç»ƒæ¨¡å‹æŒ‰é’®ï¼Œåå°åˆ†åˆ«é€šè¿‡æ¥å£è°ƒç”¨ç”Ÿäº§è€…ç«¯çš„ç®—æ³•ï¼Œè¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå¾—åˆ°æ¨¡å‹åï¼Œæ ¹æ®è¾“å…¥çš„æµ‹è¯•æ•°æ®å¾—åˆ°åä¸‰å¤©çš„æ°”æ¸©æƒ…å†µï¼Œå¹¶å°†æ•°æ®ä¼ é€ç»™å‰å°é¡µé¢è¿›è¡Œæ˜¾ç¤ºã€‚</p>
<p>åå°å°†ä¼ è¾“çš„æ•°æ®æ‰“å°åœ¨æ§åˆ¶å°</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204347.png" alt></p>
<p>2Â°åå°æ•°æ®æ¥æ”¶å‰å°æ•°æ®ï¼Œå¹¶è®¡ç®—è¿”å›ç»“æœç»™å‰å°</p>
<p>åå°ï¼šspringbootè®¾ç½®controllerå±‚ï¼Œé€šè¿‡requestbodyæ¥æ”¶å‰å°ä¼ å…¥çš„jsonæ•°æ®ï¼Œä¾æ¬¡è·å–æ•°æ®ï¼Œå¹¶è°ƒç”¨è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œæµ‹è¯•ï¼Œå¹¶å°†ç»“æœå°è£…æˆjsonæ•°æ®ä¼ å›åå°ã€‚</p>
<p>åå°æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/submit"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubmitController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUseModels useModels;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/calc"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">calcTemp</span><span class="params">(@RequestBody String str)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, String&gt; map = JSON.parseObject(str, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//è§£æjsonæ•°æ®å¹¶ä¼ å…¥xä¸­</span></span><br><span class="line">		  â€¦</span><br><span class="line">        Map result = <span class="keyword">new</span> HashMap();</span><br><span class="line">        <span class="keyword">double</span> res=useModels.svmTest(x,weight);</span><br><span class="line">        <span class="keyword">double</span> res2=useModels.bpTest(x,mapRes);</span><br><span class="line">        DecimalFormat df = <span class="keyword">new</span> DecimalFormat( <span class="string">"0.00 "</span>);</span><br><span class="line">        result.put(<span class="string">"result"</span>, df.format(res));</span><br><span class="line">        result.put(<span class="string">"result2"</span>,df.format(res2));</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰å°ï¼š</p>
<p>aï¼‰æäº¤å‰å°æ•°æ®ï¼šå‰å°é¡µé¢ä¸»è¦è®¾ç½®äº†ä¸€ä¸ªè¡¨å•ï¼Œæ¯ä¸ªè¾“å…¥æ¡†éƒ½è®¾ç½®nameå±æ€§ï¼Œåˆ©ç”¨inputæ¡†çš„onchangeå±æ€§ç»‘å®šhandleInputChangeäº‹ä»¶ï¼Œå½“è¾“å…¥æ¡†å†…æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶å³è§¦å‘handleInputChangeäº‹ä»¶ï¼Œé€šè¿‡setStateå°†å½“å‰å˜åŒ–å€¼ä½œä¸ºè¾“å…¥æ¡†å¯¹åº”nameæ–°valueå€¼ã€‚</p>
<p>å½“ç‚¹å‡»æäº¤æŒ‰é’®æ—¶ï¼Œé€šè¿‡onClickå±æ€§ç»‘å®šcalcäº‹ä»¶ï¼Œæ¯æ¬¡ç‚¹å‡»æäº¤ï¼Œåˆ™è§¦å‘è¯¥äº‹ä»¶ï¼Œäº‹ä»¶ä¸­å®šä¹‰éœ€è¦æäº¤çš„å¯¹è±¡ï¼Œå°†éœ€è¦æäº¤çš„æ•°æ®å°è£…åˆ°è¯¥å¯¹è±¡ä¸­ï¼Œå¹¶é€šè¿‡fetchè½¬å‘åˆ°å¯¹åº”åå°é¡µé¢ï¼Œä¸ºæ–¹ä¾¿åå°å¤„ç†ï¼Œå°†æäº¤çš„å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²æäº¤ã€‚</p>
<p>bï¼‰æ¥æ”¶åå°æ•°æ®ï¼šé€šè¿‡fetchæäº¤ç»“æŸåï¼Œæ¥æ”¶è¿”å›çš„jsonæ•°æ®ï¼Œå¹¶é€šè¿‡setStateè·å–æ•°å€¼å¹¶èµ‹å€¼ç»™ç›¸åº”ç»„ä»¶ã€‚</p>
<p>è¿™é‡Œæ‰€æœ‰äº‹ä»¶éƒ½éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œç»‘å®šï¼Œå¦åˆ™è§¦å‘äº‹ä»¶æ—¶ä¼šæ‰¾ä¸åˆ°ã€‚å› ä¸ºreactå†…éƒ¨é€šè¿‡stateè®¾ç½®ç»„ä»¶çš„æ˜¾ç¤ºçš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®stateçš„åˆå€¼ã€‚ç”±äºç®—æ³•ä¸­å¤„ç†çš„æ˜¯doubleæ•°æ®ï¼Œå½“å‰å°æäº¤doubleæ•°æ®è‡³åå°æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è½¬æ¢ä¸ºBigDecimalï¼Œä¸æ–¹ä¾¿åç»­å¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œå°†å„ä¸ªè¾“å…¥æ¡†çš„åˆå§‹è®¾ç½®ä¸ºéæ•°å€¼ç±»å‹ï¼Œé€šè¿‡å­—ç¬¦ä¸²ç±»å‹ä¼ å›åå°å†è½¬æ¢ä¸ºdoubleç±»å‹å¤„ç†ã€‚</p>
<p>å‰å°è¿è¡Œç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204339.png" alt></p>
<p>åå°å°†æ¥å—çš„å‰å°æ•°æ®æ‰“å°åœ¨æ§åˆ¶å°ä¸­</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507204355.png" alt></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¡¹ç›®ä¸­é‡‡ç”¨dubbo+zookeeperæ–¹å¼å®ç°é¢å‘æ¥å£ç¼–ç¨‹ï¼Œåœ¨ç”Ÿäº§è€…ç«¯é€šè¿‡é¢å‘å¯¹è±¡çš„ç¼–ç¨‹å®ç°äº†ä¸¤ç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼šBPå’ŒSVMï¼Œè®¾ç½®æ¥å£å¯ä»¥è°ƒç”¨è€…ä¸¤ç§ç®—æ³•ï¼Œå¹¶é€šè¿‡dubboåè®®å°†ç”Ÿäº§è€…ç«¯çš„æ¥å£å®ç°æ³¨å†Œè‡³zookeeperç«¯ï¼Œä»¥ä¾›æ¶ˆè´¹è€…ä½¿ç”¨ï¼›åœ¨æ¶ˆè´¹è€…ç«¯é€šè¿‡dubboåè®®ï¼Œæ ¹æ®ç”Ÿäº§è€…çš„æ¥å£æ–¹æ³•åœ¨zookeeperä¸­æ‰¾åˆ°æ¥å£å®ç°æ–¹æ³•ï¼Œå¹¶è¿›è¡Œè°ƒç”¨ï¼Œå®ç°æ¨¡å‹è®­ç»ƒã€‚</p>
<p>é‡‡ç”¨springboot+react+antdå®ç°å‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯é‡‡ç”¨react+antdç¼–å†™é¡¹ç›®ï¼Œä½¿ç”¨reactè„šæ‰‹æ¶åˆ›å»ºå‰ç«¯é¡µé¢å·¥ç¨‹ï¼Œåˆ©ç”¨antdç»„ä»¶æ–¹ä¾¿å¿«é€Ÿçš„æ­å»ºé¡µé¢æ˜¾ç¤ºå†…å®¹ï¼Œåç«¯é‡‡ç”¨springbootæ¡†æ¶ï¼Œç¼–å†™è®­ç»ƒæ¨¡å‹å’Œæµ‹è¯•æ•°æ®çš„åŠŸèƒ½ï¼Œä¸¤è€…ä¹‹é—´çš„è·¨åŸŸé—®é¢˜é€šè¿‡ä»£ç†è½¬å‘è§£å†³ï¼ŒåŒæ—¶å‰ç«¯å’Œåç«¯ä¹‹é—´é€šè¿‡fetchä¼ è¾“jsonæ•°æ®ï¼Œå‰åç«¯ä¹‹é—´å®Œå…¨é€šè¿‡public APIçº¦å®šã€‚</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨zookeeper+dubboå®ç°rpcè¿œç¨‹è°ƒç”¨</title>
    <url>/blogs/dubboZkNote/</url>
    <content><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯zookeeper"><a href="#ä»€ä¹ˆæ˜¯zookeeper" class="headerlink" title="ä»€ä¹ˆæ˜¯zookeeper"></a>ä»€ä¹ˆæ˜¯zookeeper</h2><p>zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼Œæ˜¯Apache Hadoop çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒä¸»è¦æ˜¯ç”¨æ¥è§£å†³åˆ†å¸ƒå¼åº”ç”¨ä¸­ç»å¸¸é‡åˆ°çš„ä¸€äº›æ•°æ®ç®¡ç†é—®é¢˜ï¼Œå¦‚ï¼šç»Ÿä¸€å‘½åæœåŠ¡ã€çŠ¶æ€åŒæ­¥æœåŠ¡ã€é›†ç¾¤ç®¡ç†ã€åˆ†å¸ƒå¼åº”ç”¨é…ç½®é¡¹çš„ç®¡ç†ç­‰ã€‚ç®€å•æ¥è¯´zookeeperæ˜¯æ–‡ä»¶ç³»ç»ŸåŠ ä¸Šç›‘å¬é€šçŸ¥æœºåˆ¶.</p><p>zookeeperç»´æŠ¤ç€æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®ç»“æ„ï¼Œé‡Œé¢åŒ…å«äº†å¾ˆå¤šç›®å½•èŠ‚ç‚¹ï¼Œä¾‹å¦‚NameServiceã€GroupMemberç­‰ï¼Œè¿™äº›å­ç›®å½•æƒ³å¯ä»¥å¢åŠ åˆ é™¤ä»¥åŠå­˜å‚¨æ•°æ®ã€‚å®¢æˆ·ç«¯æ³¨å†Œç›‘å¬å…³å¿ƒçš„ç›®å½•èŠ‚ç‚¹ï¼Œå½“ç›®å½•èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œzookeeperä¼šé€šçŸ¥å®¢æˆ·ç«¯ã€‚</p><a id="more"></a>

<p>zookeeperçš„åŠŸèƒ½æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä¸»è¦ç”¨åˆ°çš„æ˜¯åˆ†å¸ƒå¼åº”ç”¨é…ç½®ç®¡ç†åŠŸèƒ½ã€‚å½“ç¨‹åºæ˜¯åˆ†å¸ƒå¼éƒ¨ç½²åœ¨å¤šå°æœºå™¨ä¸Šï¼Œå¦‚æœè¦æ”¹å˜ç¨‹åºçš„é…ç½®æ–‡ä»¶ï¼Œéœ€è¦é€å°æœºå™¨å»ä¿®æ”¹ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°zookeeperï¼Œå°†é…ç½®æ”¾åˆ°zookeeperä¸Šå»ï¼Œä¿å­˜å…¶ç›®å½•èŠ‚ç‚¹ä¸­ï¼Œç„¶åå®¢æˆ·ç«¯å¯¹è¿™ä¸ªç›®å½•èŠ‚ç‚¹è¿›è¡Œç›‘å¬ï¼Œä¸€æ—¦é…ç½®ä¿¡æ¯å‘ç”Ÿå˜åŒ–ï¼Œå®¢æˆ·ç«¯å°±ä¼šæ”¶åˆ° zookeeper çš„é€šçŸ¥ï¼Œç„¶åä» zookeeper è·å–æ–°çš„é…ç½®ä¿¡æ¯ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯dubbo"><a href="#ä»€ä¹ˆæ˜¯dubbo" class="headerlink" title="ä»€ä¹ˆæ˜¯dubbo"></a>ä»€ä¹ˆæ˜¯dubbo</h2><p>dubboæ˜¯é˜¿é‡Œå·´å·´äº2011å¹´10æœˆæ­£å¼å¼€æºçš„ä¸€ä¸ªç”±Javaè¯­è¨€ç¼–å†™çš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ã€‚å®ƒæ˜¯ä¸€ä¸ªæä¾›é«˜æ€§èƒ½å’Œé€æ˜åŒ–çš„è¿œç¨‹æœåŠ¡è°ƒç”¨æ–¹æ¡ˆå’ŒåŸºäºæœåŠ¡æ¡†æ¶å±•å¼€çš„å®Œæ•´SOAæœåŠ¡æ²»ç†æ–¹æ¡ˆã€‚</p>
<p>dubboçš„æ¶æ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507205533.png" alt></p>
<p>è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ã€‚åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸Šäº†æ³¨å†Œä¸­å¿ƒå’Œç›‘æ§ä¸­å¿ƒï¼Œç”¨äºç®¡ç†æä¾›æ–¹æä¾›çš„urlå’Œç®¡ç†æ•´ä¸ªè¿‡ç¨‹ã€‚</p>
<p>æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å…ˆå¯åŠ¨å®¹å™¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚ç”Ÿäº§è€…åœ¨å¯åŠ¨æ—¶ï¼Œåœ¨æ³¨å†Œä¸­å¿ƒå‘å¸ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œåœ¨æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</p>
<h2 id="zookeeper-dubboå®ç°rpcæ¡†æ¶"><a href="#zookeeper-dubboå®ç°rpcæ¡†æ¶" class="headerlink" title="zookeeper+dubboå®ç°rpcæ¡†æ¶"></a>zookeeper+dubboå®ç°rpcæ¡†æ¶</h2><p>zookeeperæ˜¯ç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®ç»“æœï¼Œæ”¯æŒä¿®æ”¹åˆ é™¤åŒæ—¶è¿˜å¯ä»¥è¿›è¡Œå˜æ›´æ¨é€æ“ä½œï¼Œä»¥æœåŠ¡åå’Œç±»å‹ä½œä¸ºèŠ‚ç‚¹è·¯å¾„ï¼Œç¬¦åˆdubboè®¢é˜…å’Œé€šçŸ¥çš„éœ€æ±‚,å› æ­¤æ­¤é€‚åˆåšdubboæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒ.</p>
<p>zookeeperä¸Šçš„æœåŠ¡èŠ‚ç‚¹è®¾è®¡æ˜¯æ ‘å½¢ç»“æ„ï¼Œdubboä¼šåœ¨zookeeperä¸Šåˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œä¸‹ä¸€å±‚çš„å­èŠ‚ç‚¹ä»£è¡¨dubboçš„ä¸€ä¸ªæœåŠ¡ï¼ŒæœåŠ¡çš„å·¦èŠ‚ç‚¹æ˜¯ç”Ÿäº§è€…çš„æ ¹èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹æ˜¯æ¶ˆè´¹è€…çš„æ ¹èŠ‚ç‚¹ï¼Œã€‚</p>
<p>å½“zookeeperå¯åŠ¨æ—¶ï¼Œç”Ÿäº§è€…åœ¨æœåŠ¡èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå°†è‡ªå·±çš„urlåœ°å€æ³¨å†Œåˆ°è¯¥èŠ‚ç‚¹ã€‚æ­¤æ—¶æ¶ˆè´¹è€…ä¼šè¯»å–å¹¶è®¢é˜…ç”Ÿäº§è€…æ ¹èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œè§£æå‡ºæ‰€æœ‰ç”Ÿäº§è€…çš„urlåœ°å€æ¥ä½œä¸ºè¯¥æœåŠ¡åœ°å€åˆ—è¡¨ï¼Œç„¶åå‘èµ·æ­£å¸¸è°ƒç”¨ï¼ŒåŒæ—¶åœ¨æ¶ˆè´¹è€…æ ¹èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªå­èŠ‚ç‚¹å†™å…¥è‡ªå·±çš„urlåœ°å€ï¼Œä»£è¡¨äº†ä½¿ç”¨ç”Ÿäº§è€…æœåŠ¡çš„æ¶ˆè´¹è€…ã€‚ç›‘æ§ä¸­å¿ƒæŒ‡å‘æ­¤æ—¶çš„æœåŠ¡è·å–æ‰€æœ‰ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„urlåœ°å€ï¼Œå¹¶ç›‘å¬å…¶å­èŠ‚ç‚¹çš„å˜åŒ–è¿›è¡Œè®¡æ•°ã€‚</p>
<p>rpcæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ»¡è¶³åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ä¸åŒçš„ç³»ç»Ÿä¹‹é—´çš„è¿œç¨‹é€šä¿¡å’Œç›¸äº’è°ƒç”¨ã€‚ä»¥zookeeperæœåŠ¡ä¸ºåŸºç¡€,ä½¿ç”¨dubboç›‘è§†å’Œè°ƒåº¦å„ä¸ªæœåŠ¡ï¼Œç”Ÿäº§è€…åœ¨zookeeperä¸Šæ³¨å†ŒæœåŠ¡ï¼Œæ¶ˆè´¹è€…å»zookeeperä¸Šè°ƒç”¨æœåŠ¡ï¼Œä»¥æ­¤å®ç°rpcæ¡†æ¶ã€‚</p>
<h2 id="å®éªŒè¿‡ç¨‹"><a href="#å®éªŒè¿‡ç¨‹" class="headerlink" title="å®éªŒè¿‡ç¨‹"></a>å®éªŒè¿‡ç¨‹</h2><p>é¡¹ç›®å®ç°åŠŸèƒ½ï¼šç”Ÿäº§è€…å®ç°æ–¹æ³•èƒ½å¤Ÿåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºè‡ªå·±å–œæ¬¢çœ‹çš„ä¹¦ï¼šæ­¦ä¾ å°è¯´ï¼Œæ¶ˆè´¹è€…é€šè¿‡è¿œç¨‹è°ƒç”¨ç”Ÿäº§è€…çš„æ¥å£ï¼Œåœ¨é¡µé¢ä¸ŠæŸ¥çœ‹ç”Ÿäº§è€…å–œæ¬¢çœ‹çš„ä¹¦ç±ã€‚</p>
<h3 id="å®‰è£…é…ç½®zookeeper"><a href="#å®‰è£…é…ç½®zookeeper" class="headerlink" title="å®‰è£…é…ç½®zookeeper"></a>å®‰è£…é…ç½®zookeeper</h3><p>åœ¨<a href="http://zookeeper.apache.org/" target="_blank" rel="external nofollow noopener noreferrer">å®˜ç½‘</a>é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ä¸‹è½½ï¼Œæˆ‘ä¸‹è½½çš„æ˜¯zookeeper-3.5.7ï¼Œè§£å‹å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­dataDiræˆ‘æˆ‘ä½¿ç”¨çš„é»˜è®¤è·¯å¾„/bmp/zookeeperã€‚åˆ‡æ¢è‡³binç›®å½•ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤./zkServer.sh startï¼Œå¯åŠ¨æœåŠ¡</p>
<p>å‡ºç°å¦‚ä¸‹å­—æ ·è¯´æ˜æœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /Users/Local/Resource/zookeeper/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br></pre></td></tr></table></figure>

<h3 id="æ–°å»ºç”Ÿäº§è€…provideré¡¹ç›®"><a href="#æ–°å»ºç”Ÿäº§è€…provideré¡¹ç›®" class="headerlink" title="æ–°å»ºç”Ÿäº§è€…provideré¡¹ç›®"></a>æ–°å»ºç”Ÿäº§è€…provideré¡¹ç›®</h3><p>ï¼ˆ1ï¼‰æä¾›æ¥å£</p>
<p>åœ¨provideré¡¹ç›®ä¸­æ–°å»ºclientæ¨¡å—ï¼Œå…¶ä¸­å®šä¹‰IBookæ¥å£ï¼Œè¯¥æ¥å£å°±æ˜¯è¦æ³¨å†Œåˆ°zookeeperä¸­å¿ƒã€‚ä¾›è¿œç¨‹æ¶ˆè´¹è€…è°ƒç”¨ã€‚</p>
<p>IBookæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IBook</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">getBookName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">æ¥å£æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œæ–¹æ³•å†…è¿”å›ç”Ÿäº§è€…å–œæ¬¢çœ‹çš„ä¹¦ç±åç§°ï¼š</span><br><span class="line"><span class="meta">@Service</span>(<span class="string">"book"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookImp</span> <span class="keyword">implements</span> <span class="title">IBook</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBookName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æ­¦ä¾ å°è¯´"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨ç«¯å£è®¾ç½®ä¸ºï¼šserver.port=8082</p>
<p>ï¼ˆ2ï¼‰å¼•ç”¨æœåŠ¡</p>
<p>ç”Ÿäº§è€…é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æœåŠ¡å¼•ç”¨ï¼Œéœ€è¦é…ç½®dubboä¾èµ–å’Œzookeeperä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--dubboä¾èµ–--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--zkclientä¾èµ–--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.101tec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ç”Ÿäº§è€…åœ¨zookeeperä¸Šæ³¨å†Œ</p>
<p>åœ¨é¡¹ç›®å†…æ–°å»ºé…ç½®æ–‡ä»¶provider.xmlï¼ŒæŒ‡å®šå½“å‰æœåŠ¡çš„åå­—ï¼ŒæŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œè¿™é‡Œé»˜è®¤æ³¨å†Œä¸­å¿ƒåœ¨æœ¬åœ°ï¼ŒæŒ‡å®šé€šä¿¡è§„åˆ™æ˜¯dubboï¼Œé€šä¿¡ç«¯å£ä¸º20880ï¼Œå£°æ˜éœ€è¦æš´éœ²çš„æœåŠ¡æ¥å£ï¼ŒåŒæ—¶æŒ‡å‘å®¹å™¨ä¸­çš„æ¥å£å®ç°å¯¹è±¡ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"user-provider"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"zookeeper://localhost:2181"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"20880"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">ref</span>=<span class="string">"book"</span> <span class="attr">interface</span>=<span class="string">"com.cl.client.inter.IBook"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨zkui-masteræŸ¥çœ‹æ³¨å†Œä¸­å¿ƒä¸Šå·²æ³¨å†Œçš„ç”Ÿäº§è€…èŠ‚ç‚¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507205643.png" alt></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨bubboèŠ‚ç‚¹ä¸‹çš„providersç”Ÿäº§è€…èŠ‚ç‚¹ä¸­åŒ…å«äº†å½“å‰æä¾›æœåŠ¡çš„èŠ‚ç‚¹çš„urlåœ°å€ã€æ¥å£åç§°å’Œæ¥å£å†…æ–¹æ³•ã€‚</p>
<p>åœ¨æœ¬åœ°å¯¹provideré¡¹ç›®æµ‹è¯•ï¼Œè¾“å…¥<a href="http://localhost:8082/provider/sayBookï¼š" target="_blank" rel="external nofollow noopener noreferrer">http://localhost:8082/provider/sayBookï¼š</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507205656.png" alt></p>
<p>æµ‹è¯•ç»“æœæ˜¾ç¤ºæ­£ç¡®åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºäº†ä¹¦ç±çš„åç§°ï¼Œè¯´æ˜provideré¡¹ç›®è¿è¡Œç»“æœæ— è¯¯ã€‚</p>
<p>æµ‹è¯•ç»“æŸåï¼Œå•ç‹¬å°†æ¥å£è¿›è¡Œç¼–è¯‘ï¼Œå¯¼å‡ºå¯¹åº”jaråŒ…ï¼Œåç§°ä¸ºclient.jarã€‚</p>
<h3 id="æ–°å»ºæ¶ˆè´¹è€…consumeré¡¹ç›®"><a href="#æ–°å»ºæ¶ˆè´¹è€…consumeré¡¹ç›®" class="headerlink" title="æ–°å»ºæ¶ˆè´¹è€…consumeré¡¹ç›®"></a>æ–°å»ºæ¶ˆè´¹è€…consumeré¡¹ç›®</h3><p>ï¼ˆ1ï¼‰æ¶ˆè´¹è€…åœ¨zookeeperä¸Šè°ƒç”¨</p>
<p>åœ¨é¡¹ç›®å†…æ–°å»ºé…ç½®æ–‡ä»¶consumer.xmlï¼ŒæŒ‡å®šå½“å‰æœåŠ¡çš„åå­—ï¼ŒæŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼ŒæŒ‡å®šéœ€è¦è°ƒç”¨çš„æœåŠ¡çš„æ¥å£åç§°ï¼Œä»¥ä¾¿è°ƒç”¨ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"user-consumer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"zookeeper://localhost:2181"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">"book"</span> <span class="attr">interface</span>=<span class="string">"com.cl.client.inter.IBook"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å®ç°è¿œç¨‹è°ƒç”¨</p>
<p>å°†client.jaråŒ…å¯¼å…¥consumeré¡¹ç›®ä¸­ï¼ŒåŒæ—¶å°†IBookæ¥å£å®ä¾‹åŒ–ï¼Œç¼–å†™æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/consumer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IBook book;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/getBook"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBook</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ç”Ÿäº§è€…å–œæ¬¢çš„ä¹¦æ˜¯ï¼š"</span>+book.getBookName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆå¯åŠ¨providerç«¯ï¼Œç„¶ååœ¨å¯åŠ¨consumerç«¯ï¼Œæ‰“å¼€ç½‘é¡µï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200507205705.png" alt></p>
<p>å¯åŠ¨åï¼Œproviderç«¯é€šè¿‡dubboæœåŠ¡å°†è‡ªå·±çš„urlåœ°å€æ³¨å†Œåˆ°zookeeperä¸Šï¼Œconsumerç«¯é€šè¿‡è°ƒç”¨dubboæœåŠ¡ï¼Œæ ¹æ®é…ç½®çš„æ³¨å†Œä¸­å¿ƒä»¥åŠæ¥å£åç§°åˆ°zookeeperä¸ŠæŸ¥æ‰¾å¯¹åº”çš„proviederç«¯ä¸­çš„æ¥å£å®ç°ï¼Œä»è€Œå®ç°äº†è¿œç¨‹è°ƒç”¨ã€‚</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>å­—èŠ‚ç å¢å¼ºæŠ€æœ¯-javassist</title>
    <url>/blogs/javassist/</url>
    <content><![CDATA[<p>javassiståŠ¨æ€ä¿®æ”¹å­—èŠ‚ç </p><p>ç›´æ¥ä¸Šä»£ç ï¼Œä¿®æ”¹Hello.sayæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ClassPool classPool = ClassPool.getDefault();</span></span><br><span class="line">ClassPool classPool = <span class="keyword">new</span> ClassPool(<span class="keyword">true</span>);</span><br><span class="line">CtClass ctClass = classPool.get(<span class="string">"com.xpf.study.javassit.Hello"</span>);</span><br><span class="line"><span class="comment">//CtClass ctClass = classPool.get(aClass.getName());</span></span><br><span class="line">CtMethod ctMethod = ctClass.getDeclaredMethod(<span class="string">"say"</span>);</span><br><span class="line">ctMethod.setBody(<span class="string">"System.out.println(\"nihao:\" + $1);"</span>);</span><br><span class="line"><span class="comment">//ctClass.writeFile("./aaaa/");</span></span><br><span class="line">Object instance = ctClass.toClass().newInstance();</span><br><span class="line">Method say = instance.getClass().getDeclaredMethod(<span class="string">"say"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">say.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">say.invoke(instance, <span class="string">"java2"</span>);</span><br></pre></td></tr></table></figure><a id="more"></a>



<p>æ³¨æ„ï¼šctClass.toClass()ï¼ŒctClass.writeFileç­‰æ“ä½œåï¼Œä¼šå†»ç»“å­—èŠ‚ç ï¼Œä¸åœ¨å…è®¸ä¿®æ”¹å­—èŠ‚ç ï¼Œæ‰€ä»¥è¦è§£å†»ï¼Œå¯ä»¥ä½¿ç”¨ctClass.defrost();</p>
<p>å¦‚æœåœ¨ä½¿ç”¨Helloä¹‹å‰ï¼Œjvmä¸­å·²ç»åŠ è½½äº†Hello</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Hello hello = new Hello();</span><br><span class="line">//ä¿®æ”¹å­—èŠ‚ç ã€‚ã€‚ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure>

<p>ä¼šæŠ¥é”™ï¼Œå› ä¸ºåŒä¸€ä¸ªç±»åŠ è½½å™¨ä¸èƒ½åŒæ—¶åŠ è½½ä¸¤ä¸ªç›¸åŒçš„class</p>
<p>æ‰€ä»¥ï¼Œåšå¦‚ä¸‹ä¿®æ”¹ï¼Œå¢åŠ ä¸€ä¸ªåŠ è½½å™¨ï¼Œä»å¦ä¸€ä¸ªåŠ è½½å™¨ä¸­åŠ è½½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ClassPool classPool = ClassPool.getDefault();</span></span><br><span class="line">ClassPool classPool = <span class="keyword">new</span> ClassPool(<span class="keyword">true</span>);</span><br><span class="line">Loader loader = <span class="keyword">new</span> Loader(classPool);</span><br><span class="line">Class&lt;?&gt; clazz = loader.loadClass(<span class="string">"com.xpf.study.javassit.Hello"</span>);</span><br><span class="line">Object instance3 = clazz.newInstance();</span><br><span class="line">Method say3 = instance3.getClass().getDeclaredMethod(<span class="string">"say"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">say3.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">say3.invoke(instance3, <span class="string">"java"</span>);</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶loaderè·å–çš„classä¸å†æ˜¯CtClassç±»å‹ï¼Œè€Œæ˜¯æ™®é€šçš„Classç±»å‹ï¼Œæ‰€ä»¥ä¸å†å¯ä»¥ä½¿ç”¨javassisçš„api</p>
<p>åŒæ—¶åŸæ¥çš„Helloä»£ç ä¸å˜ã€‚æ­¤ç§æ–¹å¼å–å‡ºæ¥çš„instanceè™½ç„¶è¡¨é¢æ˜¯Helloç±»å‹ï¼Œä½†æ˜¯å´ä¸ instance of Hello</p>
<p>å¦ä¸€ä¸ªå˜é€šæ–¹æ³•ï¼Œä¿®æ”¹classåç§°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">CtClass ctClass2 = classPool.getAndRename(<span class="string">"com.xpf.study.javassit.Hello"</span>, <span class="string">"com.xpf.study.javassit.HelloCopy"</span>);</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œå¯ä»¥è¿”å›ç±»å‹è¿˜æ˜¯CtClassï¼Œå¯ä»¥è‡ªç”±ä½¿ç”¨ç›¸åº”api</p>
<p>æ³¨æ„ï¼Œä½¿ç”¨æ­¤æ–¹å¼è·å–CtClassåï¼Œå¦‚æœå¢åŠ æ–¹æ³•ï¼Œjdkå’Œå…¶ä»–jvmä¸­å·²ç»åŠ è½½çš„ç±»åº“ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å¼•ç”¨ï¼Œæˆ–è€…ä½¿ç”¨å…¨è·¯å¾„çš„æ–¹å¼ï¼Œå¦‚Listï¼Œéœ€è¦ä½¿ç”¨java.util.Listï¼Œå› ä¸ºæ­¤åŠ è½½å™¨ä¸­ï¼Œå¹¶æ²¡æœ‰åŠ è½½å…¶ä»–ç±»åº“ã€‚</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>å­—èŠ‚ç </tag>
      </tags>
  </entry>
  <entry>
    <title>ç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰â€”â€”åˆ©ç”¨AdaBoostå…ƒç®—æ³•æé«˜åˆ†ç±»æ€§èƒ½</title>
    <url>/blogs/adaboost/</url>
    <content><![CDATA[<p>å…ƒç®—æ³•æˆ–è€…é›†æˆç®—æ³•æ˜¯å°†ä¸åŒçš„åˆ†ç±»å™¨ç»„åˆèµ·æ¥ï¼Œç»„åˆçš„æ–¹å¼å¯ä»¥ä¸ºï¼šå°†ä¸åŒç®—æ³•ç»„åˆèµ·æ¥ï¼Œæˆ–è€…å°†æ•°æ®é›†ä¸åŒéƒ¨åˆ†ç»™ä¸åŒçš„ç®—æ³•ï¼ŒåŒä¸€ç§ç®—æ³•åœ¨ä¸åŒè®¾ç½®ä¸‹è¿›è¡Œé›†æˆã€‚ç®€è¨€ä¹‹ï¼Œå…ƒç®—æ³•æ˜¯å°†åˆ†ç±»å™¨è¿›è¡Œé‡æ–°é›†æˆï¼Œæé«˜åˆ†ç±»æ•ˆæœï¼Œå°±åƒç”Ÿæ´»ä¸­å†³å®šä¸€ä»¶äº‹éœ€è¦å¬å¤šæ–¹é¢çš„æ„è§ã€‚</p><h2 id="æ„å»ºåˆ†ç±»å™¨æ–¹æ³•"><a href="#æ„å»ºåˆ†ç±»å™¨æ–¹æ³•" class="headerlink" title="æ„å»ºåˆ†ç±»å™¨æ–¹æ³•"></a>æ„å»ºåˆ†ç±»å™¨æ–¹æ³•</h2><h3 id="bagging"><a href="#bagging" class="headerlink" title="bagging"></a>bagging</h3><p>åœ¨æºæ•°æ®é›†ä¸­é€‰æ‹©Sæ¬¡ï¼Œå¾—åˆ°Sä¸ªæ•°æ®é›†ï¼ˆå¯èƒ½ä¼šæœ‰é‡å¤çš„ï¼‰ï¼Œé€‰æ‹©æŸç§ç®—æ³•å’Œè¿™Sä¸ªæ•°æ®é›†è®­ç»ƒå¾—åˆ°Sä¸ªåˆ†ç±»å™¨ï¼Œæœ€ç»ˆçš„ç»“æœç”±å„åˆ†ç±»å™¨æŠ•ç¥¨ç»“æœäº§ç”Ÿï¼Œå¦‚éšæœºæ£®æ—ç®—æ³•ã€‚</p><a id="more"></a>

<h3 id="boosting"><a href="#boosting" class="headerlink" title="boosting"></a>boosting</h3><p>boostingæ˜¯é€šè¿‡åˆ†ç±»å™¨åŠ æƒæ±‚å’Œå¾—åˆ°ç»“æœï¼Œé€‰æ‹©nä¸ªåˆ†ç±»å™¨ï¼Œåˆå§‹çŠ¶æ€æƒé‡ç›¸åŒï¼Œæ¯ä¸ªæ ¹æ®åˆ†ç±»å™¨åˆ†é”™çš„ç»“æœè°ƒæ•´æƒé‡ï¼Œæƒé‡ä»£è¡¨ä¸Šä¸€ä¸ªåˆ†ç±»å™¨è¿­ä»£çš„æˆåŠŸåº¦ã€‚</p>
<h2 id="AdaBoostç®—æ³•"><a href="#AdaBoostç®—æ³•" class="headerlink" title="AdaBoostç®—æ³•"></a>AdaBoostç®—æ³•</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>é€šè¿‡å¤šä¸ªå¼±åˆ†ç±»å™¨æ„é€ ä¸€ä¸ªå¼ºåˆ†ç±»å™¨ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒä¸€ä¸ªå¼±åˆ†ç±»å™¨ï¼Œå¹¶å¾—å‡ºå…¶é”™è¯¯ç‡ï¼Œåœ¨ç¬¬äºŒæ¬¡è®­ç»ƒçš„æ—¶å€™ï¼Œå¯¹ç¬¬ä¸€æ¬¡åˆ†é”™çš„æ ·æœ¬æé«˜å…¶æƒé‡ï¼Œæœ€ç»ˆå°†æ‰€æœ‰åˆ†ç±»å™¨çš„ç»“æœåŠ æƒå¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚</p>
<p>æ¯ä¸ªåˆ†ç±»å™¨çš„æƒå€¼è°ƒæ•´alpha<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426164427.png" alt>,å…¶ä¸­Îµæ˜¯å½“å‰åˆ†ç±»å™¨çš„é”™è¯¯ç‡</p>
<p>å½“æ ·æœ¬è¢«æ­£ç¡®åˆ†ç±»ï¼Œæ ·æœ¬çš„æƒé‡è¢«æ›´æ–°ä¸º<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426164638.png" alt></p>
<p>å½“æ ·æœ¬è¢«é”™è¯¯åˆ†ç±»ï¼Œæ ·æœ¬çš„æƒé‡è¢«æ›´æ–°ä¸º<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426164745.png" alt></p>
<h3 id="æ„å»ºå¼±åˆ†ç±»å™¨"><a href="#æ„å»ºå¼±åˆ†ç±»å™¨" class="headerlink" title="æ„å»ºå¼±åˆ†ç±»å™¨"></a>æ„å»ºå¼±åˆ†ç±»å™¨</h3><p>å•å±‚å†³ç­–æ ‘ï¼šè¿™é‡Œçš„åŸºåˆ†ç±»å™¨é€‰æ‹©äº†å•å±‚å†³ç­–æ ‘ï¼Œå°†åˆ†ç±»å™¨ç»“æœè®¾ç½®ä¸º1ï¼Œå½“ä¸æ»¡è¶³é˜ˆå€¼æ¡ä»¶æ—¶ï¼Œèµ‹å€¼ä¸º-1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å•å±‚å†³ç­–æ ‘ç”Ÿæˆå‡½æ•°</span></span><br><span class="line"><span class="comment">#é€šè¿‡é˜ˆå€¼æ¯”è¾ƒæ¥åˆ’åˆ†æ•°æ®</span></span><br><span class="line"><span class="comment">#è¾“å…¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stumpClassify</span><span class="params">(dataMat,dime,threVal,threInq)</span>:</span></span><br><span class="line">	m=shape(dataMat)[<span class="number">0</span>] <span class="comment">#mè¡Œæ•°æ®</span></span><br><span class="line">	returnMat=ones((m,<span class="number">1</span>))</span><br><span class="line">	<span class="comment">#print(dime)</span></span><br><span class="line">	<span class="comment">#ä¸æ»¡è¶³ç­‰å¼è¦æ±‚çš„è®¾ç½®ä¸º-1</span></span><br><span class="line">	<span class="keyword">if</span> threInq==<span class="string">"lt"</span>: </span><br><span class="line">		returnMat[dataMat[:,dime]&lt;=threVal]=<span class="number">-1.0</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		returnMat[dataMat[:,dime]&gt;threVal]=<span class="number">-1.0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> returnMat</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°æœ€ä½³å•å±‚å†³ç­–æ ‘ï¼š</p>
<p>ï¼ˆ1ï¼‰åœ¨æ‰€æœ‰è¾“å…¥çš„æ•°æ®ç‰¹å¾ä¸Šè¿›è¡Œéå†ï¼Œæ ¹æ®æ¯ä¸ªæ ·æœ¬çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œä»¥åŠæ­¥é•¿å¾—å‡ºé˜ˆå€¼ï¼Œä»è€Œå¾—åˆ°å½“å‰çš„å•å±‚å†³ç­–æ ‘å³å¼±åˆ†ç±»å™¨</p>
<p>ï¼ˆ2ï¼‰æ¯ä¸ªå¼±åˆ†ç±»å™¨è®¾ç½®ä¸€ä¸ªé”™è¯¯ç‡çŸ©é˜µï¼Œå½“å½“å‰é¢„æµ‹çš„æ­£ç¡®ï¼Œåˆ™è®¾ç½®ä¸º0ï¼Œå°†åˆ†ç±»å™¨çš„æƒé‡ä¹˜ä»¥é”™è¯¯ç‡ï¼Œå¾—åˆ°æ–°çš„æƒé‡çŸ©é˜µï¼ˆæ ·æœ¬çš„ï¼‰</p>
<p>ï¼ˆ3ï¼‰æ¯æ¬¡æ¯”è¾ƒå½“å‰åˆ†ç±»å™¨çš„æ ·æœ¬çš„é”™è¯¯ç‡ï¼Œæ‰¾åˆ°æœ€å°çš„é”™è¯¯ç‡å³æœ€ä½³å•å±‚å†³ç­–æ ‘åˆ†ç±»å™¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.éå†æ¯ä¸ªç‰¹å¾ï¼Œæ ¹æ®æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå¾—å‡ºéå†çš„æ­¥é•¿</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">	minVal=min(dataMat[:,i])</span><br><span class="line">	maxVal=max(dataMat[:,i])</span><br><span class="line">	stepSize=(maxVal-minVal)/numSize</span><br><span class="line">	<span class="comment">#æšä¸¾æ­¥æ•°ï¼Œä»è€Œç¡®å®šé˜ˆå€¼</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(numSize+<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">for</span> inq <span class="keyword">in</span> [<span class="string">"lt"</span>,<span class="string">"gt"</span>]:</span><br><span class="line">			threVal=minVal+stepSize*j</span><br><span class="line">			<span class="comment">#2.è°ƒç”¨é˜ˆå€¼åˆ†ç±»ç»“æœ</span></span><br><span class="line">			predictVal=stumpClassify(dataMat,i,threVal,inq)</span><br><span class="line">			errorMat=mat(ones((m,<span class="number">1</span>)))</span><br><span class="line">			errorMat[predictVal==classMat]=<span class="number">0</span></span><br><span class="line">       </span><br><span class="line">			<span class="comment">#3.å¾—å‡ºé”™è¯¯åˆ†ç±»çš„å‘é‡ adaboostå’Œåˆ†ç±»å™¨äº¤äº’çš„åœ°æ–¹</span></span><br><span class="line">			error=D.T*errorMat</span><br><span class="line"></span><br><span class="line">			<span class="comment">#å› ä¸ºæ˜¯â€œå•å±‚å†³ç­–æ ‘â€ï¼Œå³åªåˆ†è£‚ä¸€æ¬¡å°±å¯ç›´æ¥å¾—åˆ°åˆ†ç±»ç»“æœäº†ã€‚æ‰€ä»¥ç›´æ¥ç”¨åˆ†ç±»é”™è¯¯çš„æ¯”ç‡æ¥è¡¡é‡å†³ç­–æ ‘çš„å¥½åå°±å¯</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">#print("split:dim: %d\t,threshVal: %f\t,threshVal ineq: %s\t,error: %f" % (i,threVal,inq,error))</span></span><br><span class="line">			<span class="keyword">if</span>(error&lt;minError):</span><br><span class="line">				minError=error</span><br><span class="line">				bestClass=predictVal.copy()</span><br><span class="line">				<span class="comment">#4.å¾—å‡ºæœ€ä½³å†³ç­–æ ‘çš„ä¿¡æ¯</span></span><br><span class="line">				bestStump[<span class="string">'dim'</span>]=i</span><br><span class="line">				bestStump[<span class="string">'thresh'</span>]=threVal</span><br><span class="line">				bestStump[<span class="string">'ineq'</span>]=inq</span><br></pre></td></tr></table></figure>



<h3 id="è°ƒæ•´æƒé‡å¾—åˆ°æœ€ç»ˆç»“æœ"><a href="#è°ƒæ•´æƒé‡å¾—åˆ°æœ€ç»ˆç»“æœ" class="headerlink" title="è°ƒæ•´æƒé‡å¾—åˆ°æœ€ç»ˆç»“æœ"></a>è°ƒæ•´æƒé‡å¾—åˆ°æœ€ç»ˆç»“æœ</h3><p>ï¼ˆ1ï¼‰å‡è®¾è¿­ä»£numiteræ¬¡ï¼ˆnumiterä¸ªå¼±åˆ†ç±»å™¨ï¼‰ï¼Œæ¯æ¬¡è¿­ä»£éƒ½å¾—åˆ°ä¸€ä¸ªæœ€ä½³åˆ†ç±»å™¨çš„é”™è¯¯ç‡ï¼Œæ ¹æ®é”™è¯¯ç‡ï¼Œè®¡ç®—å‡ºåˆ†ç±»å™¨çš„æƒé‡å¹¶è¿›è¡Œä¿å­˜</p>
<p>ï¼ˆ2ï¼‰æ ¹æ®åˆ†ç±»å™¨æƒé‡è°ƒæ•´æ¯ä¸ªæ ·æœ¬çš„æƒé‡</p>
<p>ï¼ˆ3ï¼‰æ ¹æ®åˆ†ç±»å™¨æƒé‡å¾—å‡ºç»“æœï¼Œæ¯æ¬¡å°†é”™è¯¯ç‡ç´¯ç§¯ï¼ˆå³ç”¨åˆ†ç±»å™¨æƒé‡å¾—å‡ºçš„ç»“æœå’ŒçœŸå®å€¼æ¯”è¾ƒï¼Œå½“æ»¡è¶³æ¡ä»¶æ—¶åˆ™è¾“å‡ºç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆå§‹åŒ–æ•°æ®æƒé‡</span></span><br><span class="line">	D=mat(ones((m,<span class="number">1</span>))/m)</span><br><span class="line">	weakAdaList=[]</span><br><span class="line">	adaClassEst=mat(zeros((m,<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">		<span class="comment">#1.å¾—å‡ºå½“å‰å¼±åˆ†ç±»å™¨</span></span><br><span class="line">		bestStump,error,bestClass=buildStump(dataMat,classLabels,D)</span><br><span class="line">		<span class="comment">#print(D.T)</span></span><br><span class="line">		<span class="comment">#2.å¼±åˆ†ç±»å™¨æƒé‡</span></span><br><span class="line">		alpha=float(<span class="number">0.5</span>*log((<span class="number">1</span>-error)/max(error,<span class="number">1e-16</span>))) <span class="comment">#1e-6æ˜¯ä¸ºäº†é˜²æ­¢æº¢å‡ºalpha=1.2*ln(1-error/error)</span></span><br><span class="line">		bestStump[<span class="string">'alpha'</span>]=alpha</span><br><span class="line">		<span class="comment">#æ›´æ–°å¼±åˆ†ç±»å™¨é›†åˆ</span></span><br><span class="line">		weakAdaList.append(bestStump)</span><br><span class="line">		<span class="comment">#print("bestClass:",bestClass.T)</span></span><br><span class="line">		<span class="comment">#3.æ›´æ–°æ•°æ®æƒé‡,å°†ç°åœ¨çš„å’ŒåŸæ¥çš„å¯¹æ¯”</span></span><br><span class="line">		expon=multiply(<span class="number">-1</span>*alpha*mat(classLabels).T,bestClass)</span><br><span class="line">		D=multiply(D,exp(expon))</span><br><span class="line">		D=D/sum(D)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#3.æ›´æ–°ç»“æœ</span></span><br><span class="line">		<span class="comment">#print(alpha)</span></span><br><span class="line">		adaClassEst+=alpha*bestClass</span><br><span class="line">		<span class="comment">#print("adaClassEst:",adaClassEst.T)</span></span><br><span class="line">		<span class="comment">#é€šè¿‡äºŒå€¼åˆ†ç±»å™¨ï¼Œåˆ¤æ–­æ˜¯å¦ç›¸åŒï¼Œä¸åŒçš„åˆ™å¢åŠ é”™è¯¯ç‡</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#sign(x)å‡½æ•°è¡¨ç¤ºx&gt;0,è¿”å›0;x=0,è¿”å›0;x&lt;0;è¿”å›-1</span></span><br><span class="line">		<span class="comment">#sign(aggClassEst) != mat(classLabels) è¿”å›boolçŸ©é˜µ,å¯¹åº”å…ƒç´ ç›¸ç­‰åˆ™ä¸ºTrue,ä¸ç­‰åˆ™ä¸ºFalse</span></span><br><span class="line">		<span class="comment">#multiply(),Falseç›¸å½“äº0ï¼ŒTrueç›¸å½“äº1ï¼Œè¡¨ç¤ºç´¯åŠ åˆ†ç±»é”™è¯¯ä¸ªæ•°</span></span><br><span class="line"> </span><br><span class="line">		adaError=multiply(sign(adaClassEst)!=mat(classLabels).T,ones((m,<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">		errorRate=sum(adaError)/m</span><br><span class="line">		print(<span class="string">"total error rate:"</span>,errorRate)</span><br><span class="line">		<span class="keyword">if</span>(errorRate==<span class="number">0</span>):</span><br><span class="line">			<span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨æ¡ˆä¾‹"><a href="#åº”ç”¨æ¡ˆä¾‹" class="headerlink" title="åº”ç”¨æ¡ˆä¾‹"></a>åº”ç”¨æ¡ˆä¾‹</h2><p>æµ‹è¯•åŸºäºadaboostçš„åˆ†ç±»</p>
<p>åˆ©ç”¨ä¸Šè¿°æ„é€ å¾—åˆ°çš„åˆ†ç±»å™¨ï¼Œåº”ç”¨å•å±‚å†³ç­–æ ‘å¾—åˆ°æ²¡é¥¿åˆ†ç±»å™¨çš„ç±»åˆ«å€¼ï¼Œå¹¶è¿›è¡Œç´¯åŠ å¾—åˆ°æœ€åçš„ç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆ©ç”¨å¾—å‡ºçš„å¤šä¸ªå¼±åˆ†ç±»å™¨å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adaClassify</span><span class="params">(dataToClass,classfier)</span>:</span></span><br><span class="line">	dataToClass=mat(dataToClass)</span><br><span class="line">	m,n=shape(dataToClass)</span><br><span class="line">	<span class="comment">#ç´¯åŠ åˆ†ç±»çš„ç»“æœ</span></span><br><span class="line">	adaClassEst=mat(zeros((m,<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#éå†æ‰€æœ‰çš„å¼±åˆ†ç±»å™¨  å¾—åˆ°ä¸€ä¸ªç±»åˆ«çš„ä¼°è®¡å€¼</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(classfier)):</span><br><span class="line">		<span class="comment">#ç”¨å•å±‚å†³ç­–æ ‘å¾—å‡ºç±»åˆ«ä¼°è®¡å€¼</span></span><br><span class="line">		classEst=stumpClassify(dataToClass,classfier[i][<span class="string">'dim'</span>],classfier[i][<span class="string">'thresh'</span>],classfier[i][<span class="string">'ineq'</span>])</span><br><span class="line">		adaClassEst+=classfier[i][<span class="string">'alpha'</span>]*classEst</span><br><span class="line">		<span class="comment">#print(adaClassEst)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> sign(adaClassEst)</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥ç—…é©¬ç–æ°”ç—…æ•°æ®é›†</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426210006.png" alt></p>
<p>é€‰æ‹©10ä¸ªåˆ†ç±»å™¨ï¼Œå°†xçš„å€¼è¾“å…¥ï¼Œå¾—åˆ°é¢„æµ‹å€¼ï¼Œå°†é¢„æµ‹å€¼å’Œå®é™…å€¼ç›¸ç­‰çš„è®¾ç½®ä¸º0ï¼Œæ±‚å’Œå¾—å‡ºé”™è¯¯é¢„æµ‹å¾—æ ·æœ¬æ•°é‡ä¸º16ä¸ªã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">weakAdaList=adaboost.adaBoostTrainDS(dataSet,classLabels,<span class="number">10</span>)</span><br><span class="line">test,ctest=adaboost.loadDtaSet(<span class="string">"horseColicTest2.txt"</span>)</span><br><span class="line">predict10=adaboost.adaClassify(test,weakAdaList)</span><br><span class="line"></span><br><span class="line">ctest=mat(ctest).T</span><br><span class="line">m,n=ctest.shape</span><br><span class="line">error=mat(ones((m,n)))</span><br><span class="line">error[predict10==ctest]=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">print(sum(error))</span><br></pre></td></tr></table></figure>

<p>10ä¸ªåˆ†ç±»å™¨çš„é”™è¯¯ç‡ä¸º</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426210138.png" alt></p>
<h2 id="å¦‚ä½•è¡¡é‡åˆ†ç±»çš„æ€§èƒ½"><a href="#å¦‚ä½•è¡¡é‡åˆ†ç±»çš„æ€§èƒ½" class="headerlink" title="å¦‚ä½•è¡¡é‡åˆ†ç±»çš„æ€§èƒ½"></a>å¦‚ä½•è¡¡é‡åˆ†ç±»çš„æ€§èƒ½</h2><p>ä¹‹å‰çš„ç®—æ³•éƒ½æ˜¯ç”¨é”™è¯¯ç‡æ¥è¡¡é‡ç®—æ³•ï¼Œä½†æ˜¯ä¸å…¨é¢ï¼Œä¸€èˆ¬è¡¡é‡åˆ†ç±»çš„æ€§èƒ½ä½¿ç”¨æ··æ·†çŸ©é˜µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426211129.png" alt></p>
<h3 id="æ­£ç¡®ç‡å’Œå¬å›ç‡"><a href="#æ­£ç¡®ç‡å’Œå¬å›ç‡" class="headerlink" title="æ­£ç¡®ç‡å’Œå¬å›ç‡"></a>æ­£ç¡®ç‡å’Œå¬å›ç‡</h3><p>æ­£ç¡®ç‡ï¼šTP/(TP+FP) ä»£è¡¨é¢„æµ‹ç»“æœä¸ºçœŸçš„å æ€»æ ·æœ¬çš„æ¯”ä¾‹</p>
<p>å¬å›ç‡ï¼šTP/(TP+FNï¼‰ä»£è¡¨é¢„æµ‹ç»“æœä¸ºçœŸå æ€»æ ·æœ¬ä¸­æ‰€æœ‰ä¸ºçœŸçš„æ ·æœ¬çš„æ¯”ä¾‹ã€‚å¬å›ç‡å¤§çš„åˆ†ç±»ç®—æ³•ä¸­ï¼ŒçœŸçš„æ ·æœ¬åˆ¤é”™çš„å°‘</p>
<p>ä¸€èˆ¬å¥½çš„åˆ†ç±»æ˜¯æ­£ç¡®ç‡é«˜ï¼Œå¬å›ç‡ä¹Ÿé«˜ï¼Œä½†æ˜¯ä¸¤è€…å­˜åœ¨åˆ¶çº¦å…³ç³»</p>
<h3 id="ROCæ›²çº¿"><a href="#ROCæ›²çº¿" class="headerlink" title="ROCæ›²çº¿"></a>ROCæ›²çº¿</h3><p>ROCæ›²çº¿æ¨ªè½´ä»£è¡¨å‡é˜³ç‡ï¼šFP/(FP+TN)ï¼Œçºµè½´ä»£è¡¨çœŸé˜³ç‡ï¼šTP/(TP+FN)ï¼Œå·¦ä¸‹è§’ä»£è¡¨æŠŠæ‰€æœ‰æ ·æœ¬åˆ¤æ–­ä¸ºåä¾‹ï¼Œå³ä¸Šè§’ä»£è¡¨æŠŠæ‰€æœ‰æ ·æœ¬åˆ¤æ–­ä¸ºçœŸä¾‹ï¼Œè¾ƒå¥½çš„åˆ†ç±»å™¨é›†ä¸­åœ¨å·¦ä¸Šè§’ï¼Œå³çœŸé˜³ç‡é«˜ï¼Œå‡é˜³ç‡ä½</p>
<p>ï¼ˆ1ï¼‰åˆ’å®šèµ·å§‹ç‚¹ï¼Œç¡®å®šxè½´æ­¥é•¿ï¼ˆåˆ†ç±»ä¸ºå‡çš„ä¸ªæ•°ï¼‰ï¼Œyè½´æ­¥é•¿ï¼ˆåˆ†ç±»ä¸ºçœŸçš„ä¸ªæ•°ï¼‰</p>
<p>ï¼ˆ2ï¼‰å°†åˆ†ç±»æ ·æœ¬æŒ‰ç…§é¢„æµ‹å¼ºåº¦æ’åºï¼Œä»ä½åˆ°é«˜ï¼Œä»æ’åæœ€ä½çš„é˜³ä¾‹å¼€å§‹ï¼Œï¼ˆæ‰€æœ‰æ’åæ›´ä½çš„é˜³ä¾‹éƒ½è¢«åˆ¤ä¸ºåä¾‹ï¼Œæ’åæ›´é«˜çš„æ ·ä¾‹åˆ¤ä¸ºæ­£ä¾‹ï¼Œ-&gt;æ’åé«˜çš„æ ·ä¾‹çœŸé˜³ç‡é«˜å‡é˜³ç‡ä½ï¼Œæ‰€ä»¥ä»ï¼ˆ1ï¼Œ1ï¼‰å¼€å§‹ï¼Œå…ˆæŠŠä½å¼ºåº¦çš„æ ·ä¾‹åˆ¤æ–­ï¼‰å¦‚æœæ ·ä¾‹ä¸ºçœŸï¼Œå¯¹çœŸé˜³ç‡ä¿®æ”¹ï¼Œå¦‚æœæ ·ä¾‹ä¸ºå‡ï¼Œå¯¹å‡é˜³ç‡ä¿®æ”¹</p>
<p>ï¼ˆï¼‰å½“é‡åˆ°çœŸå€¼å‘ä¸‹èµ°ï¼Œå³æ²¿ç€çºµè½´èµ°ï¼Œé‡åˆ°å‡å€¼å‘å·¦èµ°ï¼Œå³æ²¿ç€æ¨ªè½´èµ°ï¼Œå°†å˜åŠ¨çš„åæ ‡ç”»ä¸‹æ¥</p>
<p>ï¼ˆ4ï¼‰åˆ’å®šæ€»ä½“èŒƒå›´ï¼Œè¿›è¡Œå›¾åƒæ˜¾ç¤º</p>
<p>AUCï¼šä¸­é—´è¿‡ç¨‹å¯¹æ›²çº¿ä¸‹çš„é¢ç§¯è¿›è¡Œç´¯è®¡ï¼Œè¿™ä¸ªç»™å‡ºäº†åˆ†ç±»å™¨çš„å¹³å‡æ€§èƒ½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ROCæ›²çº¿çš„ç»˜åˆ¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotROC</span><span class="params">(predStrength,classLabels)</span>:</span></span><br><span class="line">	<span class="comment">#å…‰æ ‡èµ·å§‹ç‚¹</span></span><br><span class="line">	cur=(<span class="number">1.0</span>,<span class="number">1.0</span>)</span><br><span class="line">	<span class="comment">#AUCé¢ç§¯å€¼</span></span><br><span class="line">	ySum=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#xè½´yè½´æ­¥é•¿</span></span><br><span class="line">	numPos=sum(array(classLabels)==<span class="number">1.0</span>)</span><br><span class="line">	ystep=<span class="number">1</span>/numPos</span><br><span class="line">	xstep=<span class="number">1</span>/(len(classLabels)-numPos)</span><br><span class="line">	sortPred=predStrength.argsort()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#ç”»å›¾</span></span><br><span class="line">	<span class="comment">#fig=plt.figure()</span></span><br><span class="line">	ax=plt.subplot(<span class="number">111</span>)</span><br><span class="line">	print(sortPred)</span><br><span class="line">	print(sortPred.tolist())</span><br><span class="line">	print(sortPred.tolist()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#å¯¹çœŸå€¼åˆ™å‘ä¸‹èµ°ï¼Œå¯¹å‡å€¼å‘å·¦è¾¹èµ°  å…‰æ ‡ä»1ï¼Œ1å¼€å§‹</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> sortPred.tolist()[<span class="number">0</span>]:</span><br><span class="line">		<span class="keyword">if</span>(classLabels[i]==<span class="number">1</span>):</span><br><span class="line">			detX=<span class="number">0</span></span><br><span class="line">			detY=ystep</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			detX=xstep</span><br><span class="line">			detY=<span class="number">0</span></span><br><span class="line">			ySum+=cur[<span class="number">1</span>]</span><br><span class="line">		<span class="comment">#xä»å“ªé‡Œå˜åˆ°å“ªé‡Œï¼Œyä»å“ªé‡Œå˜åˆ°å“ªé‡Œ</span></span><br><span class="line">		ax.plot((cur[<span class="number">0</span>],cur[<span class="number">0</span>]-detX),(cur[<span class="number">1</span>],cur[<span class="number">1</span>]-detY),<span class="string">"b"</span>)</span><br><span class="line">		cur=(cur[<span class="number">0</span>]-detX,cur[<span class="number">1</span>]-detY)</span><br><span class="line"></span><br><span class="line">	print(<span class="string">"the average of roc:"</span>+str(ySum*xstep))</span><br><span class="line">	ax.plot((<span class="number">0</span>,<span class="number">1</span>),(<span class="number">0</span>,<span class="number">1</span>),<span class="string">"b--"</span>)</span><br><span class="line">	plt.title(<span class="string">"roc"</span>)</span><br><span class="line">	plt.xlabel(<span class="string">"false postive"</span>)</span><br><span class="line">	plt.ylabel(<span class="string">"true postive"</span>)</span><br><span class="line">	ax.axis([<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>]) <span class="comment">#x,yè½´èŒƒå›´</span></span><br><span class="line">	plt.show()</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¦‚ä¸‹å›¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426213015.png" alt></p>
<p>è®¡ç®—å¹³å‡æ€§èƒ½æ—¶ï¼Œæ¯æ¬¡å¯¹é«˜åº¦ç´¯åŠ ï¼ŒçŸ©å½¢çš„å®½åº¦æ˜¯xstep,æœ€ç»ˆä¸¤è€…ç›¸ä¹˜å¾—åˆ°é¢ç§¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200426220255.png" alt></p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>boost</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ â€”â€”ç¬¬ä¸‰å‘¨ç¼–ç¨‹ä½œä¸š</title>
    <url>/blogs/NNet3/</url>
    <content><![CDATA[<p>ä¸»è¦å­¦ä¹ æ„å»ºä¸€ä¸ªæµ…å±‚ç¥ç»ç½‘ç»œ</p><p>logisticå›å½’å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå•å±‚çš„ç½‘ç»œï¼Œè¿™é‡Œæ„é€ ä¸€ä¸ªéšè—å±‚ä¸€ä¸ªè¾“å‡ºå±‚çš„ç½‘ç»œï¼Œå³ä¸¤å±‚ç½‘ç»œï¼ˆç½‘ç»œå±‚æ•°è®¡ç®—ä¸åŠ å…¥è¾“å…¥å±‚ï¼‰</p><h2 id="ç½‘ç»œç»“æ„"><a href="#ç½‘ç»œç»“æ„" class="headerlink" title="ç½‘ç»œç»“æ„"></a>ç½‘ç»œç»“æ„</h2><p>æµ…å±‚ç¥ç»ç½‘ç»œæœ‰è¾“å…¥å±‚ï¼Œä¸€ä¸ªéšè—å±‚ï¼Œä¸€ä¸ªè¾“å‡ºå±‚</p><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427142410.png" alt></p><p>çº¦å®šï¼šaiä»£è¡¨ç¬¬iå±‚ï¼Œai[j]ä»£è¡¨ç¬¬iå±‚ç¬¬jä¸ªç¥ç»å…ƒ</p><h2 id="å‚æ•°åˆå§‹åŒ–"><a href="#å‚æ•°åˆå§‹åŒ–" class="headerlink" title="å‚æ•°åˆå§‹åŒ–"></a>å‚æ•°åˆå§‹åŒ–</h2><p>ç½‘ç»œæ­å»ºçš„æ—¶å€™éœ€è¦åˆå§‹åŒ–æƒå€¼å’Œåç½®é‡</p><a id="more"></a>





<p>ï¼ˆ1ï¼‰æƒå€¼ä¸èƒ½åˆå§‹åŒ–å…¨ä¸º0</p>
<p>å…¨éƒ½åˆå§‹åŒ–ä¸º0ï¼Œåœ¨ç¬¬ä¸€ä¸ªéšè—å±‚æ¯ä¸ªç¥ç»å…ƒæ‰§è¡Œç›¸åŒçš„è¿ç®—ï¼Œå³ä½¿åé¢è¿›è¡Œæ¢¯åº¦ä¸‹é™æ“ä½œï¼Œæ¯ä¸ªç¥ç»å…ƒéƒ½ä¼šä¸å…¶ä»–ç¥ç»å…ƒçš„è¾“å‡ºä¸€æ ·</p>
<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–çš„æ•°æ®éœ€è¦æ˜¯å¾ˆå°çš„æ•°</p>
<p>å½“æ¿€æ´»å‡½æ•°é€‰æ‹©sigmoidæˆ–è€…tanhçš„æ—¶å€™ï¼Œå½“åˆå§‹æƒé‡å–å€¼å¾ˆå¤§ï¼Œé‚£ä¹ˆä¹˜ä¸Šxå¾—åˆ°çš„zä¹Ÿä¼šå¾ˆå¤§ï¼Œæ­¤æ—¶æ¿€æ´»å‡½æ•°çš„å€¼è¶‹è¿‘ä¸1æˆ–è€…0ï¼Œè¿™æ—¶å€™æ¢¯åº¦å˜åŒ–å¾ˆå°ï¼Œä¼šå¯¼è‡´ç®—æ³•å­¦ä¹ èµ·æ¥å¾ˆæ…¢</p>
<h2 id="å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"><a href="#å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­" class="headerlink" title="å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"></a>å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</h2><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427142845.png" alt></p>
<p>å…¶ä¸­è¾“å…¥x,w[1],b[1]ï¼Œéšè—å±‚è®¡ç®—z[1],a[1]ï¼Œè¾“å‡ºå±‚è®¡ç®—z[2],a[2]ï¼ˆè¿™é‡Œéœ€è¦æ ¹æ®w[2],b[2]è®¡ç®—ï¼‰</p>
<p>é»‘è‰²ç®­å¤´ä»£è¡¨å‰å‘ä¼ æ’­ï¼Œçº¢è‰²ç®­å¤´ä»£è¡¨åå‘ä¼ æ’­</p>
<p>å°†Xæ ·æœ¬å…¨éƒ¨éƒ½ç«–å‘æ’åˆ—ï¼Œå³æ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼ŒXæ˜¯ï¼ˆnx,m)ç»´å‘é‡ï¼Œå…¶ä¸­nxä»£è¡¨è¾“å…¥ç‰¹å¾çš„ä¸ªæ•°ï¼Œmä»£è¡¨æ ·æœ¬çš„æ€»æ•°é‡ã€‚</p>
<p>å‰å‘ä¼ æ’­çš„å…¬å¼ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427144106.png" alt></p>
<p>åå‘ä¼ æ’­çš„ä¸ºï¼š</p>
<h2 id="åå‘ä¼ æ’­"><a href="#åå‘ä¼ æ’­" class="headerlink" title="åå‘ä¼ æ’­"></a>åå‘ä¼ æ’­</h2><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427144504.png" alt></p>
<p>å…¶ä¸­dz[l]=dA[l]*g^â€™(dz[l])ï¼Œåˆå› ä¸ºdA[l-1]=W[l]T * dz[l]ï¼Œå³dz[l]=W[l+1]T  dz[l+1] * g^â€™(dz[l])ï¼Œæ‰€ä»¥å¾—å‡ºäº†éšè—å±‚ä¸­dz[1]</p>
<h2 id="æ¿€æ´»å‡½æ•°çš„é€‰æ‹©"><a href="#æ¿€æ´»å‡½æ•°çš„é€‰æ‹©" class="headerlink" title="æ¿€æ´»å‡½æ•°çš„é€‰æ‹©"></a>æ¿€æ´»å‡½æ•°çš„é€‰æ‹©</h2><p>ç½‘ç»œæ¯å±‚çš„æ¿€æ´»å‡½æ•°å¯ä»¥ä¸åŒï¼Œæ ¹æ®æ¯å±‚ç‰¹ç‚¹æ¥é€‰æ‹©</p>
<h3 id="ä¸åŒçš„æ¿€æ´»å‡½æ•°"><a href="#ä¸åŒçš„æ¿€æ´»å‡½æ•°" class="headerlink" title="ä¸åŒçš„æ¿€æ´»å‡½æ•°"></a>ä¸åŒçš„æ¿€æ´»å‡½æ•°</h3><p>ï¼ˆ1ï¼‰sigmoidå‡½æ•°</p>
<p>å½“éœ€è¦è¾“å‡ºçš„æ˜¯äºŒåˆ†ç±»é—®é¢˜æ—¶ï¼Œä½¿ç”¨sigmoidå‡½æ•°ï¼Œæœ€ç»ˆè¾“å‡ºä¸¤ä¸ªå€¼0æˆ–è€…1ï¼Œå½“zçš„å€¼å¤§äº0.5è¾“å‡º1ï¼Œåä¹‹è¾“å‡º0ã€‚</p>
<p>ä¸€èˆ¬ç”¨åœ¨æœ€åçš„è¾“å‡ºå±‚ï¼Œæ¿€æ´»å‡½æ•°çš„å¯¼æ•°ä¸ºaï¼ˆ1-aï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427142719.png" alt></p>
<p>ï¼ˆ2ï¼‰tanhå‡½æ•°</p>
<p>è¯¥å‡½æ•°ç”¨åœ¨éšè—å±‚æ¯”sigmoidå‡½æ•°å¥½ï¼Œå› ä¸ºå…¶è¾“å‡ºçš„æ•°æ®å€¼å¹³å‡ä¸º0ã€‚</p>
<p>ä¸€èˆ¬ç”¨åœ¨éšè—å±‚ï¼Œæ¿€æ´»å‡½æ•°çš„å¯¼æ•°ä¸º1-a**2</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427145057.png" alt></p>
<p>ï¼ˆ3ï¼‰ReLuå‡½æ•°</p>
<p>æ–œç‡å˜åŒ–å¾ˆå¿«ï¼Œç®—æ³•å­¦ä¹ é€Ÿåº¦å¿«ã€‚</p>
<p>æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ä¸ºï¼Œå½“z&lt;0ï¼Œå¯¼æ•°ä¸º0ï¼Œåä¹‹ä¸º1</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427145121.png" alt></p>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°"><a href="#ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°"></a>ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°</h3><p>å¦‚æœç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œç›¸å½“äºæ˜¯æŠŠè¾“å…¥é‡æ–°çº¿æ€§ç»„åˆäº†ï¼Œéšè—å±‚æ ¹æœ¬æ²¡ç”¨</p>
<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>æ­å»ºä¸€ä¸ªæµ…å±‚ç½‘ç»œï¼Œå¯¹å¯¼å…¥çš„æ•°æ®è¿›è¡Œåˆ†ç±»</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h3 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h3><p>æ•°æ®é›†ä½¿ç”¨planar_utilsä¸­çš„load_planar_datasetï¼Œå°†æ•°æ®æ‰“å°å‡ºæ¥å¯çŸ¥ï¼Œè¾“å…¥çš„æ ·æœ¬xæ˜¯2 * 400çš„å‘é‡ï¼Œæ¯ä¸€åˆ—ä»£è¡¨å…¶åæ ‡ï¼Œæ ‡ç­¾åˆ—yæ˜¯0å’Œ1</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427145525.png" alt></p>
<p>å°æŠ€å·§ï¼šå°†ä¸åŒæ ‡ç­¾çš„ç‚¹æŒ‰ç…§ä¸åŒé¢œè‰²æ‰“å°å‡ºæ¥åœ¨scatterä¸­ç”¨cmap=plt.cm.spectral</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.scatter(X[<span class="number">0</span>,:],X[<span class="number">1</span>,:],c=squeeze(Y),cmap=plt.cm.Spectral)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>squeezeæ˜¯å°†æ•°æ®å˜ä¸º1ç»´ï¼Œscatterä¸èƒ½æ˜¾ç¤ºäºŒç»´çš„æ•°æ®</p>
<h3 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h3><p>ç”¨sklearnè‡ªå¸¦çš„logisticå›å½’æµ‹è¯•åˆ†ç±»æ•ˆæœ</p>
<p>é¦–å…ˆå¾—åˆ°åˆ†ç±»å™¨ï¼Œå¯¹X,Yè¿›è¡Œè®­ç»ƒï¼Œæ‰“å°å‡ºå†³ç­–è¾¹ç•Œï¼Œæ ¹æ®å¾—åˆ°çš„é¢„æµ‹å€¼å’ŒçœŸå®å€¼ç›¸ä¹˜å¯ä»¥å¾—åˆ°é”™è¯¯ç‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.æµ‹è¯•ä½¿ç”¨logisticå›å½’çš„å‡†ç¡®åº¦ï¼Œå¹¶ç”»å‡ºå†³ç­–è¾¹ç•Œ</span></span><br><span class="line">clt=linear_model.LogisticRegressionCV()</span><br><span class="line">clt.fit(X.T,Y.T)</span><br><span class="line">plot_decision_boundary(<span class="keyword">lambda</span> x:clt.predict(x),X,Y)</span><br><span class="line">m=shape(Y)[<span class="number">1</span>]</span><br><span class="line">rate=(dot(Y,clt.predict(X.T))+dot((<span class="number">1</span>-Y),(<span class="number">1</span>-clt.predict(X.T))))/m</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š"</span>+str(rate))</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ˜¯äºŒåˆ†ç±»é—®é¢˜ï¼Œé¢„æµ‹å€¼ä¸­ä¸º1çš„å’ŒçœŸå®å€¼ä¸º1çš„ç›¸ä¹˜ï¼Œå¾—åˆ°åˆ¤æ–­ä¸º1çš„æ•°æ®ï¼ŒåŒç†å¾—åˆ°åˆ¤æ–­ä¸º0çš„æ•°æ®ï¼Œé™¤ä»¥æ€»æ•°å¾—åˆ°é¢„æµ‹å¾—å‡†ç¡®ç‡ä¸º47%</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427145626.png" alt></p>
<p>é™„ï¼šå†³ç­–è¾¹ç•Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_decision_boundary</span><span class="params">(model, X, y)</span>:</span></span><br><span class="line">    <span class="comment"># Set min and max values and give it some padding</span></span><br><span class="line">    x_min, x_max = X[<span class="number">0</span>, :].min() - <span class="number">1</span>, X[<span class="number">0</span>, :].max() + <span class="number">1</span></span><br><span class="line">    y_min, y_max = X[<span class="number">1</span>, :].min() - <span class="number">1</span>, X[<span class="number">1</span>, :].max() + <span class="number">1</span></span><br><span class="line">    h = <span class="number">0.01</span></span><br><span class="line">    <span class="comment"># Generate a grid of points with distance h between them</span></span><br><span class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</span><br><span class="line">    <span class="comment"># Predict the function value for the whole grid</span></span><br><span class="line">    Z = model(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">    Z = Z.reshape(xx.shape)</span><br><span class="line">    <span class="comment"># Plot the contour and training examples</span></span><br><span class="line">    plt.contourf(xx, yy, Z, cmap=plt.cm.Spectral)</span><br><span class="line">    plt.ylabel(<span class="string">'x2'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">'x1'</span>)</span><br><span class="line">    plt.scatter(X[<span class="number">0</span>, :], X[<span class="number">1</span>, :], c=np.squeeze(y), cmap=plt.cm.Spectral)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆåˆ©ç”¨logisticå¾—å‡ºçš„åˆ†ç±»ä¸º</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427145550.png" alt></p>
<p>ç”±ç»“æœå¯ä»¥çœ‹å‡ºï¼Œlogisticåˆ†ç±»æ•ˆæœä¸å¥½ï¼Œå› ä¸ºç»™å‡ºçš„æ•°æ®æ˜¯çº¿æ€§ä¸å¯åˆ†çš„ï¼Œæ‰€ä»¥åˆ†ç±»ä¸ç†æƒ³ã€‚</p>
<p>ä¸‹é¢ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œåˆ†ç±»</p>
<h3 id="æ­å»ºç½‘ç»œç»“æ„"><a href="#æ­å»ºç½‘ç»œç»“æ„" class="headerlink" title="æ­å»ºç½‘ç»œç»“æ„"></a>æ­å»ºç½‘ç»œç»“æ„</h3><p>è®¾å®šè¾“å…¥å±‚ï¼Œéšè—å±‚ï¼Œè¾“å‡ºå±‚çš„ç¥ç»å…ƒä¸ªæ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.åˆå§‹åŒ–ç½‘ç»œç»“æ„</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initial_layer_size</span><span class="params">(X,Y,n_h)</span>:</span></span><br><span class="line">	<span class="comment">#è¾“å…¥æ ·æœ¬çš„ç‰¹è´¨æ•°é‡</span></span><br><span class="line">	m=shape(X)[<span class="number">0</span>]</span><br><span class="line">	n=shape(Y)[<span class="number">0</span>]</span><br><span class="line">	n_x=m</span><br><span class="line">	n_h=n_h</span><br><span class="line">	n_y=n</span><br><span class="line">	<span class="keyword">return</span> n_x,n_h,n_y</span><br></pre></td></tr></table></figure>

<h3 id="åˆå§‹åŒ–å‚æ•°"><a href="#åˆå§‹åŒ–å‚æ•°" class="headerlink" title="åˆå§‹åŒ–å‚æ•°"></a>åˆå§‹åŒ–å‚æ•°</h3><p>åˆå§‹åŒ–å„å±‚çš„wå’Œbçš„åˆå§‹å€¼ï¼Œè¿™é‡Œçš„wç”¨æ­£æ€åˆ†å¸ƒéšæœºæ•°ä¹˜ä»¥ä¸€ä¸ªå¾ˆå°çš„æ•°æ¥åˆå§‹åŒ–ï¼Œä»¥æ­¤ä¿è¯è®­ç»ƒçš„é€Ÿåº¦ï¼ˆå¾ˆå°çš„æ•°ï¼Œæ¢¯åº¦å˜åŒ–å¿«ï¼‰ï¼Œè¿™é‡Œå°†æ¯å±‚çš„w,bä½œä¸ºparametersä¿å­˜ä¸‹æ¥ï¼Œä¾¿äºå‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ã€æ›´æ–°å‚æ•°ä¸­ä½¿ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initial_parameters</span><span class="params">(n_x,n_h,n_y)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–w1,b1,w2,b2</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–æˆä¸€ä¸ªå¾ˆå°çš„æ•°</span></span><br><span class="line">	random.seed(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">	W1=random.randn(n_h,n_x)*<span class="number">0.01</span></span><br><span class="line">	b1=zeros((n_h,<span class="number">1</span>))</span><br><span class="line">	W2=random.randn(n_y,n_h)*<span class="number">0.01</span></span><br><span class="line">	b2=zeros((n_y,<span class="number">1</span>))</span><br><span class="line">	parameters=&#123;<span class="string">"W1"</span>:W1,<span class="string">"W2"</span>:W2,<span class="string">"b1"</span>:b1,<span class="string">"b2"</span>:b2&#125;</span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<h3 id="å‰å‘ä¼ æ’­"><a href="#å‰å‘ä¼ æ’­" class="headerlink" title="å‰å‘ä¼ æ’­"></a>å‰å‘ä¼ æ’­</h3><p>æ ¹æ®å…¬å¼ï¼Œè®¡ç®—æ¯å±‚Zï¼ŒAçš„å€¼ï¼Œå¹¶è¿›è¡Œä¿å­˜åœ¨cacheä¸­ï¼Œä¾¿äºåå‘ä¼ æ’­ä¸­è®¡ç®—å¯¼æ•°ä½¿ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_progation</span><span class="params">(X,parameters)</span>:</span></span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line">	b1=parameters[<span class="string">"b1"</span>]</span><br><span class="line">	b2=parameters[<span class="string">"b2"</span>]</span><br><span class="line">	Z1=dot(W1,X)+b1</span><br><span class="line">	A1=tanh(Z1)</span><br><span class="line">	Z2=dot(W2,A1)+b2</span><br><span class="line">	A2=sigmoid(Z2)</span><br><span class="line">	cache=&#123;<span class="string">"Z1"</span>:Z1,<span class="string">"Z2"</span>:Z2,<span class="string">"A1"</span>:A1,<span class="string">"A2"</span>:A2&#125;</span><br><span class="line">	<span class="keyword">return</span> A2,cache</span><br></pre></td></tr></table></figure>

<h3 id="è®¡ç®—æŸå¤±"><a href="#è®¡ç®—æŸå¤±" class="headerlink" title="è®¡ç®—æŸå¤±"></a>è®¡ç®—æŸå¤±</h3><p>æŸå¤±å‡½æ•°å’Œlogisticä¸­ä¸€æ ·ï¼Œä½¿ç”¨äº¤å‰ç†µå‡½æ•°ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°æœ€åä¸€å±‚ä¸­çš„è¾“å‡º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#4.è®¡ç®—æŸå¤±å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(Y,yhat)</span>:</span></span><br><span class="line">	<span class="comment">#yhat=cache["A2"]</span></span><br><span class="line">	m=shape(Y)[<span class="number">1</span>]</span><br><span class="line">	multiplyc=multiply(Y,log(yhat))+multiply((<span class="number">1</span>-Y),log(<span class="number">1</span>-yhat))</span><br><span class="line">	cost=-sum(multiplyc)/m</span><br><span class="line">	<span class="keyword">return</span> cost</span><br></pre></td></tr></table></figure>

<h3 id="åå‘ä¼ æ’­-1"><a href="#åå‘ä¼ æ’­-1" class="headerlink" title="åå‘ä¼ æ’­"></a>åå‘ä¼ æ’­</h3><p>æ ¹æ®å…¬å¼ï¼Œå¾—åˆ°æ¯å±‚çš„dz,dw,dbï¼Œå¹¶å°†æ¢¯åº¦å˜åŒ–ç”¨gradä¿å­˜ä¸‹æ¥ï¼Œæ–¹ä¾¿æ›´æ–°å‚æ•°ä¸­ä½¿ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#5.è®¡ç®—åå‘ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">back_progation</span><span class="params">(X,Y,parameters,cache)</span>:</span></span><br><span class="line">	m=shape(X)[<span class="number">1</span>]</span><br><span class="line">	<span class="comment">#è®¡ç®—æ¢¯åº¦</span></span><br><span class="line">	A2=cache[<span class="string">"A2"</span>]</span><br><span class="line">	Z2=cache[<span class="string">"Z2"</span>]</span><br><span class="line">	A1=cache[<span class="string">"A1"</span>]</span><br><span class="line">	Z1=cache[<span class="string">"Z1"</span>]</span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line"></span><br><span class="line">	dZ2=A2-Y</span><br><span class="line">	dW2=(<span class="number">1</span>/m)*dot(dZ2,A1.T)</span><br><span class="line">	db2=(<span class="number">1</span>/m)*sum(dZ2,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	dZ1=multiply(dot(W2.T,dZ2),(<span class="number">1</span>-A1**<span class="number">2</span>))</span><br><span class="line">	dW1=(<span class="number">1</span>/m)*dot(dZ1,X.T)</span><br><span class="line">	db1=(<span class="number">1</span>/m)*sum(dZ1,axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">	grads=&#123;<span class="string">"dW1"</span>:dW1,<span class="string">"dW2"</span>:dW2,<span class="string">"db1"</span>:db1,<span class="string">"db2"</span>:db2&#125;</span><br></pre></td></tr></table></figure>

<p>é™„ï¼šdotæ˜¯ç‚¹ä¹˜ï¼ˆæ•°å­—ç›¸ä¹˜ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œmultiplyæ˜¯å„ä¸ªä½ç½®ç›¸ä¹˜ï¼ˆçŸ©é˜µç›¸ä¹˜ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªçŸ©é˜µ</p>
<h3 id="æ›´æ–°å‚æ•°"><a href="#æ›´æ–°å‚æ•°" class="headerlink" title="æ›´æ–°å‚æ•°"></a>æ›´æ–°å‚æ•°</h3><p>æ ¹æ®æ¢¯åº¦è®¡ç®—æ¯æ¬¡æ›´æ–°çš„w,bï¼Œå¹¶åœ¨parametersä¸­ä¿å­˜ï¼Œæ¯æ¬¡æ ¹æ®æ–°çš„wå’Œbé‡æ–°å‰å‘ä¼ æ’­è®¡ç®—æŸå¤±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#6.æ›´æ–°å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_parameters</span><span class="params">(parameters,grads,alpha)</span>:</span></span><br><span class="line">	W1=parameters[<span class="string">"W1"</span>]</span><br><span class="line">	W2=parameters[<span class="string">"W2"</span>]</span><br><span class="line">	b1=parameters[<span class="string">"b1"</span>]</span><br><span class="line">	b2=parameters[<span class="string">"b2"</span>]</span><br><span class="line"></span><br><span class="line">	dW1=grads[<span class="string">"dW1"</span>]</span><br><span class="line">	dW2=grads[<span class="string">"dW2"</span>]</span><br><span class="line">	db1=grads[<span class="string">"db1"</span>]</span><br><span class="line">	db2=grads[<span class="string">"db2"</span>]</span><br><span class="line"></span><br><span class="line">	W1=W1-alpha*dW1</span><br><span class="line">	W2=W2-alpha*dW2</span><br><span class="line">	b1=b1-alpha*db1</span><br><span class="line">	b2=b2-alpha*db2</span><br><span class="line">	parameters=&#123;<span class="string">"W1"</span>:W1,<span class="string">"W2"</span>:W2,<span class="string">"b1"</span>:b1,<span class="string">"b2"</span>:b2&#125;</span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<h3 id="ç”Ÿæˆæ¨¡å‹"><a href="#ç”Ÿæˆæ¨¡å‹" class="headerlink" title="ç”Ÿæˆæ¨¡å‹"></a>ç”Ÿæˆæ¨¡å‹</h3><p>ï¼ˆ1ï¼‰åˆå§‹åŒ–ç½‘ç»œç»“æ„</p>
<p>ï¼ˆ2ï¼‰åˆå§‹åŒ–å‚æ•°</p>
<p>ï¼ˆ3ï¼‰æ¯æ¬¡å¾ªç¯ä¸­</p>
<p>1Â°å…ˆæ­£å‘ä¼ æ’­ï¼Œæ ¹æ®åˆå§‹åŒ–çš„å‚æ•°ï¼ˆparametersï¼‰ï¼Œå¾—åˆ°cacheï¼ˆä¿å­˜äº†æ¯å±‚çš„A,Zï¼‰</p>
<p>Â°å†æ ¹æ®è¾“å‡ºå±‚ç»“æœå¾—å‡ºæŸå¤±å‡½æ•°</p>
<p>3Â°æ¥ç€ï¼Œè¿›è¡Œåå‘ä¼ æ’­ï¼Œæ ¹æ®cacheå¾—å‡ºæ¯å±‚çš„æ¢¯åº¦ä¿å­˜åœ¨gradä¸­</p>
<p>Â°æœ€åè¿›è¡Œå‚æ•°æ›´æ–°ï¼ŒæŒ‰ç…§æ¢¯åº¦ï¼Œåˆ©ç”¨w=w-alpha * dwï¼ˆbåŒç†ï¼‰å¾—å‡ºæ›´æ–°çš„å‚æ•°</p>
<p>æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤è¿›è¡Œå¾ªç¯ï¼Œæ¯1000æ¬¡è¾“å‡ºæŸå¤±ï¼Œæœ€ç»ˆå¾—åˆ°è®­ç»ƒå‡ºçš„æ¨¡å‹ï¼Œå³parameters</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#7.æ¨¡å‹æ•´åˆ è®­ç»ƒæ¨¡å‹ï¼ŒæŒ‰ç…§æ¬¡æ•°è¾“å‡ºæŸå¤±å‡½æ•°çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nn_model</span><span class="params">(X,Y,n_h,numIter,alpha)</span>:</span></span><br><span class="line">	random.seed(<span class="number">3</span>)</span><br><span class="line">	n_x,n_h,n_y=initial_layer_size(X,Y,n_h)</span><br><span class="line">	parameters=initial_parameters(n_x,n_h,n_y)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">		A2,cache=forward_progation(X,parameters)</span><br><span class="line">		cost=compute_cost(Y,A2)</span><br><span class="line">		grads=back_progation(X,Y,parameters,cache)</span><br><span class="line">		parameters=update_parameters(parameters,grads,alpha)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">1000</span>==<span class="number">0</span>):</span><br><span class="line">			print(<span class="string">"ç¬¬"</span>+str(i)+<span class="string">"æ¬¡,æŸå¤±æ˜¯ï¼š"</span>+str(cost))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>

<h4 id="æ¨¡å‹é¢„æµ‹"><a href="#æ¨¡å‹é¢„æµ‹" class="headerlink" title="æ¨¡å‹é¢„æµ‹"></a>æ¨¡å‹é¢„æµ‹</h4><p>æ ¹æ®å¾—åˆ°çš„æ¨¡å‹ï¼Œè¿›è¡Œä¸€æ¬¡å‰å‘ä¼ æ’­å¾—åˆ°è¾“å‡ºå±‚çš„å€¼ï¼Œå³ä¸ºé¢„æµ‹å€¼ï¼Œè¿›è¡Œå››èˆäº”å…¥å¾—åˆ°æ¨¡å‹é¢„æµ‹å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#8.æ¨¡å‹é¢„æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nn_predict</span><span class="params">(X,parameters)</span>:</span></span><br><span class="line">	A2,cache=forward_progation(X,parameters)</span><br><span class="line">	<span class="comment"># prediction=cache["A2"]</span></span><br><span class="line">	<span class="comment"># print(prediction)</span></span><br><span class="line">	prediction=numpy.round(A2)</span><br><span class="line">	<span class="keyword">return</span> prediction</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆï¼Œå…ˆè®­ç»ƒå‡ºæ¨¡å‹ï¼Œå†å¯¹æ¨¡å‹é¢„æµ‹ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœï¼Œç”»å‡ºå†³ç­–è¾¹ç•Œï¼ˆå†³ç­–è¾¹ç•Œä¸­è¾“å…¥çš„å‚æ•°æ˜¯é¢„æµ‹å‡½æ•°æ¨¡å‹ï¼Œå³å°†é¢„æµ‹å¾—å€¼è¾“å…¥ï¼Œå’ŒçœŸå®å€¼æ¯”è¾ƒï¼Œä»è€Œç”»å‡ºè¾¹ç•Œï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427153130.png" alt></p>
<p>å¯ä»¥çœ‹å‡ºæ•ˆæœæ¯”logisticå¥½å¾ˆå¤šï¼ŒåŸºæœ¬éƒ½åˆ†ç±»æ­£ç¡®ã€‚</p>
<p>æœ€ç»ˆåˆ†ç±»æ­£ç¡®ç‡ä¸º90.5%</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200427153234.png" alt></p>
<p>æ³¨ï¼šè¿™é‡Œçš„éšè—å±‚ç¥ç»å…ƒä¸ªæ•°é€‰æ‹©äº†4ä¸ªï¼Œå¯ä»¥é€‰æ‹©ä¸åŒçš„ç¥ç»å…ƒæŸ¥çœ‹æ•ˆæœã€‚</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>æµ…å±‚ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ â€”â€”ç¬¬äºŒå‘¨ç¼–ç¨‹ä½œä¸š</title>
    <url>/blogs/NNet2/</url>
    <content><![CDATA[<h2 id="ç¥ç»ç½‘ç»œä¸­çš„è®¾å®š"><a href="#ç¥ç»ç½‘ç»œä¸­çš„è®¾å®š" class="headerlink" title="ç¥ç»ç½‘ç»œä¸­çš„è®¾å®š"></a>ç¥ç»ç½‘ç»œä¸­çš„è®¾å®š</h2><p>è®¾å®š(x,y)æ˜¯å•ç‹¬çš„ä¸€ä¸ªæ ·æœ¬ï¼Œmä¸ªè®­ç»ƒæ ·æœ¬ä¸º{ ((x(1),y(1)), ((x(12),y(2)), â€¦.((x(m),y(m))}</p><p>è®¾å®šè¾“å…¥çš„æ ·æœ¬ä¸º</p><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417221326.png" alt></p><p>å³å°†Xä¸­æ‰€æœ‰è¾“å…¥çš„æ ·æœ¬éƒ½çºµå‘æ’åˆ—ï¼ˆä¸ä½¿ç”¨æ¨ªå‘æ’åˆ—çš„æ–¹å¼ï¼‰ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€æ¡æ•°æ®ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªè¾“å…¥ç‰¹å¾ï¼Œå¦‚åŸè¾“å…¥æ ·æœ¬x1ä¸­çš„ç‰¹å¾ä¸ºa,b,cï¼Œa,b,cåˆ†åˆ«å¯¹åº”äº†æ•°å€¼ï¼Œè¾“å…¥æ ·æœ¬x2ä¸­ä¹Ÿæœ‰è¿™ä¸‰ä¸ªç‰¹å¾ï¼Œä½†æ˜¯æ•°å€¼å¯èƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥Xæ˜¯nxç»´å‘é‡ï¼Œæœ‰mä¸ªåˆ—ï¼ˆä»£è¡¨mæ¡æ•°æ®ï¼‰</p><a id="more"></a>



<p>Yåˆ™å°†æ‰€æœ‰æ ·æœ¬è¾“å‡ºä¾æ¬¡æ’åˆ—æˆmç»´è¡Œå‘é‡</p>
<h2 id="logisticåŸç†"><a href="#logisticåŸç†" class="headerlink" title="logisticåŸç†"></a>logisticåŸç†</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>logisticæ˜¯ç”¨ä¸€æ¡ç›´çº¿å»æ‹Ÿåˆæ•°æ®ç‚¹ï¼Œå³éœ€è¦å¾—åˆ°y=wx+bè¿™æ¡ç›´çº¿ï¼Œå½“å·²çŸ¥è¾“å…¥æ ·æœ¬ä¸º{ ((x(1),y(1)), ((x(12),y(2)), â€¦.((x(m),y(m))}ï¼Œé€šè¿‡ä¸æ–­è°ƒæ•´wå’Œbçš„å€¼ï¼Œè®©é¢„æµ‹è¾“å‡ºyhatè¿‘ä¼¼ç­‰äºå®é™…è¾“å‡ºyã€‚</p>
<p>å…¶ä¸­wå¯¹åº”æ¯ä¸ªè¾“å…¥ç‰¹å¾ï¼Œå³éœ€è¦æ„å»ºçš„wæ˜¯ä¸ªnxç»´çš„åˆ—å‘é‡ï¼Œåˆ™éœ€è¦å¾—åˆ°çš„ç›´çº¿ä¸ºy=w.T*X+b</p>
<h3 id="æ¨¡å‹å…¬å¼"><a href="#æ¨¡å‹å…¬å¼" class="headerlink" title="æ¨¡å‹å…¬å¼"></a>æ¨¡å‹å…¬å¼</h3><p>y=w.T*X+b</p>
<p>ç”±äºlogisticæ˜¯ä¸ªäºŒåˆ†ç±»å™¨ï¼Œéœ€è¦åˆ†ç±»å‡½æ•°ï¼Œè¿™é‡Œé€‰æ‹©sigmoidï¼Œå³a=sigmoid(z)ï¼Œå…¶ä¸­z=y</p>
<p>åŒæ—¶ï¼Œè¡¡é‡ä¸€ä¸ªç®—æ³•è¿è¡Œæƒ…å†µä½¿ç”¨è¯¯å·®å‡½æ•°ï¼Œå¸¸ç”¨çš„è¯¯å·®å‡½æ•°ä¸ºå‡æ–¹å·®å‡½æ•°ï¼Œå³L=1/2(yhat-y)2ï¼Œä½†æ˜¯è¯¥å‡½æ•°ä¸æ˜¯å‡¸å‡½æ•°ï¼Œlogisticä¸­ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œæ‰¾åˆ°æœ€ä¼˜çš„wå’Œbï¼Œé€‚åˆç”¨å‡¸å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªæœ€ä¼˜è§£ï¼Œå‡æ–¹å·®å‡½æ•°æœ‰å¤šä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œä¸é€‚åˆè¯¥æ±‚è§£æ–¹æ³•ï¼Œè¿™é‡Œé€‰æ‹©çš„æŸå¤±å‡½æ•°ä¸ºL=-(ylogyhat+(1-y)log(1-yhat))ï¼Œè¿™æ˜¯è®­ç»ƒä¸€ä¸ªæ ·æœ¬æ—¶ç®—æ³•çš„è¡¨ç°ï¼Œè¦è¡¡é‡å…¨éƒ¨æ ·æœ¬çš„è¡¨ç°éœ€è¦ç”¨åˆ°æˆæœ¬å‡½æ•°J=1/m*âˆ‘L=-1/mâˆ‘-(ylogyhat+(1-y)log(1-yhat))ï¼Œå³é€šè¿‡Jçš„å€¼åˆ¤æ–­æ‰¾åˆ°çš„w,bæ˜¯å¦åˆé€‚ã€‚Jæ˜¯è¡¡é‡ç®—æ³•å¥½åçš„ä¾æ®</p>
<p>ç»¼ä¸Šï¼Œlogisticæ¨¡å‹å…¬å¼ä¸º</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417225111.png" alt></p>
<p>æ³¨ï¼šé€‰æ‹©è¯¥æˆæœ¬å‡½æ•°çš„åŸå› </p>
<p>ç”±ä¸Šé¢ä¸¤ä¸ªå…¬å¼ï¼Œçº¦å®šyhat=p(y=1|x),å³ç»™å®šè®­ç»ƒæ ·æœ¬x,yå–1çš„æ¦‚ç‡</p>
<p>å½“y=0æ—¶ï¼Œp(y|x)=1-yhatï¼›å½“y=1æ—¶ï¼Œp(y|x)=yhatï¼Œåˆ™å¯ä»¥å°†è¯¥è¡¨è¾¾å¼è¿›è¡Œåˆå¹¶ä¸ºp(y|x)=yhat^(y)+(1-yhat)^(1-y)ï¼Œæ ¹æ®æå¤§ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°å¾—åˆ°ç¬¬ä¸‰ä¸ªå¼å­ï¼Œä¸ºäº†è¿›è¡Œç¼©æ”¾åŠ ä¸Šäº†1/mï¼Œæœ€ç»ˆå¾—å‡ºäº†æˆæœ¬å‡½æ•°</p>
<h3 id="æ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"><a href="#æ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­" class="headerlink" title="æ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"></a>æ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</h3><p>logisticç®—æ³•é‡‡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼šæ¯æ¬¡éƒ½æœç€ä¸‹é™çš„å¿«çš„åå‘ç§»åŠ¨ï¼Œå› æ­¤éœ€è¦è®¡ç®—æ¢¯åº¦ï¼Œæ²¿ç€æ¢¯åº¦æ”¾ä¸‹ä¿®æ­£wå’Œbçš„å€¼</p>
<p>æ­£å‘ä¼ æ’­ä¸­ï¼Œæ ¹æ®è¾“å…¥çš„x1,x2â€¦,w,bçš„å€¼ï¼Œè®¡ç®—zï¼Œç”±zå†è®¡ç®—å‡ºaï¼Œæ ¹æ®açš„å€¼å¾—å‡ºæŸå¤±å‡½æ•°L</p>
<p>åå‘ä¼ æ’­ä¸­</p>
<p>æ ¹æ®å¾—å‡ºçš„Lçš„å€¼ï¼Œåå‘å¾—å‡ºå„ä¸ªæ¢¯åº¦å€¼ï¼Œæœ€ç»ˆå¾—å‡ºdw,dbï¼Œå³éœ€è¦æ²¿ç€è¿™ä¸ªæ¢¯åº¦å˜åŒ–ã€‚é¦–å…ˆä»æŸå¤±å‡½æ•°Lå¾—å‡ºaçš„æ¢¯åº¦da=-y/a+(1-y)/(1-a)ï¼Œå†ç”±aå¾—åˆ°dzï¼Œdz=dL/dz=dL/da * da/dzï¼ˆé“¾å¼æ³•åˆ™ï¼‰=a-yï¼ŒåŒç†å¾—å‡ºdw=x * dzï¼Œdb=dzã€‚</p>
<p>æ ¹æ®æ¢¯åº¦ä¸‹é™å…¬å¼w:=w-alpha * dw   b:=b-alpha * dbæ¯æ¬¡æ¥ä¿®æ”¹wå’Œbçš„å€¼</p>
<p>åå‘ä¼ æ’­è¿‡ç¨‹å›¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417231506.png" alt></p>
<h3 id="æå‡ç®—æ³•æ€§èƒ½"><a href="#æå‡ç®—æ³•æ€§èƒ½" class="headerlink" title="æå‡ç®—æ³•æ€§èƒ½"></a>æå‡ç®—æ³•æ€§èƒ½</h3><p>ï¼ˆ1ï¼‰ä¸ä½¿ç”¨æ˜¾ç¤ºçš„forå¾ªç¯æ”¹ç”¨å‘é‡åŒ–</p>
<p>æ ¹æ®ä¸Šè¿°å…¬å¼ï¼Œä¸ºäº†æ±‚å‡ºzï¼Œéœ€è¦å¯¹æ¯ä¸ªx(i)ï¼Œæ±‚å‡ºz(i)ï¼Œå†ä¾æ¬¡å¾—å‡ºyhat(i),L(i)ï¼Œå½“æœ‰mä¸ªæ ·æœ¬æ—¶ï¼Œå°±éœ€è¦å¾ªç¯mæ¬¡ï¼Œæ•°æ®é›†å¾ˆå¤§çš„æƒ…å†µä¸‹æ•ˆç‡å¾ˆä½ï¼Œå› æ­¤å°†è¯¥forå¾ªç¯å®ç°çš„åŠŸèƒ½å‘é‡åŒ–ï¼Œåªéœ€è¦æŠŠxç”¨å‘é‡è¡¨ç¤ºï¼Œå³å°†æ¯ä¸ªæ ·æœ¬çºµå‘æ’åˆ—å¾—åˆ°ä¸€ä¸ªm * nxçš„çŸ©é˜µï¼Œè¿™æ ·ç›´æ¥é€šè¿‡dot(w.T,X)ï¼Œå³å¯ä»¥è®¡ç®—å‡ºzçš„å€¼ï¼Œçœå»äº†éå†æ•°æ®é›†çš„å¾ªç¯</p>
<p>ï¼ˆ2ï¼‰åˆ©ç”¨numpyä¸­çš„åº“å‡½æ•°çš„å¹¿æ’­åŠŸèƒ½</p>
<p>å½“m * nçš„çŸ©é˜µå’Œ1 * nçš„çŸ©é˜µç›¸åŠ æ—¶ï¼Œåé¢çš„çŸ©é˜µè‡ªåŠ¨æ‰©å±•æˆm * nè¿›è¡Œè®¡ç®—ï¼Œå¦‚ä¸Šè¿°å¼å­ä¸­çš„å¸¸æ•°bï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨æ‰©å±•</p>
<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>åˆ©ç”¨logisticå›å½’æ­å»ºä¸€ä¸ªå¯ä»¥è¯†åˆ«çŒ«çš„ç¥ç»ç½‘ç»œ</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h3 id="å¤„ç†æ•°æ®"><a href="#å¤„ç†æ•°æ®" class="headerlink" title="å¤„ç†æ•°æ®"></a>å¤„ç†æ•°æ®</h3><p>è¿™é‡ŒçŒ«çš„å›¾ç‰‡æ•°æ®ä¿å­˜åœ¨h5æ–‡ä»¶ä¸­ï¼Œä»¥64*64çš„ä¸‰é€šé“æ•°æ®ä¿å­˜</p>
<p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œä»h5æ–‡ä»¶ä¸­è¯»å…¥è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¤„ç†æ•°æ®</span></span><br><span class="line">train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes=load_dataset()</span><br></pre></td></tr></table></figure>

<p>ä»¥è®­ç»ƒæ•°æ®ä½åˆ—ï¼ŒæŸ¥çœ‹æ•°æ®çº¬åº¦ï¼Œå‘ç°çº¬åº¦ä¸ºï¼ˆ290ï¼Œ64ï¼Œ64ï¼Œ3ï¼‰ä»£è¡¨æœ‰290ä¸ªå›¾åƒï¼Œæ¯ä¸ªå›¾åƒéƒ½æ˜¯64 * 64çš„ï¼Œé‡Œé¢åŒ…å«äº†çº¢ç»¿è“ä¸‰ä¸ªé€šé“æ•°å­—ï¼Œå› æ­¤éœ€è¦å°†å•ä¸ªå›¾ç‰‡ä¸­çº¢ç»¿è“çŸ©é˜µåˆå¹¶ä¸ºä¸€ä¸ªåˆ—å‘é‡ï¼Œå³</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417232700.png" alt></p>
<p>ï¼ˆ2ï¼‰å› æ­¤ï¼Œç¬¬äºŒæ­¥éœ€è¦è¿›è¡Œæ•°æ®é™ç»´</p>
<p>éœ€è¦å°†æ¯ä¸ªå›¾ç‰‡æ•°æ®å˜ä¸º64 * 64 * 3=12288ç»´çš„åˆ—å‘é‡ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ä¸æŒ‡å®šåˆ—æ•°ï¼Œç›´æ¥ç»™ä¸ª-1ï¼Œè®©ç¨‹åºè‡ªå·±è®¡ç®—</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">train_set_x=train_set_x_orig.reshape(train_set_x_orig.shape[<span class="number">0</span>],<span class="number">-1</span>).T <span class="comment">#å°†æ¯ä¸ªå›¾ç‰‡ç«–ç€æ’æ”¾</span></span><br><span class="line">test_set_x=test_set_x_orig.reshape(test_set_x_orig.shape[<span class="number">0</span>],<span class="number">-1</span>).T</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æ•°æ®æ ‡å‡†åŒ–</p>
<p>å›¾åƒä¸­çš„åƒç´ ç‚¹äº‹0~255ä¹‹é—´ï¼Œåªéœ€è¦æŠŠè¾“å…¥çš„æ•°æ®é™¤ä»¥255å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">train_set_x=train_set_x/<span class="number">255</span></span><br><span class="line">test_set_x=test_set_x/<span class="number">255</span></span><br></pre></td></tr></table></figure>

<h3 id="æ­å»ºç¥ç»ç½‘ç»œ"><a href="#æ­å»ºç¥ç»ç½‘ç»œ" class="headerlink" title="æ­å»ºç¥ç»ç½‘ç»œ"></a>æ­å»ºç¥ç»ç½‘ç»œ</h3><p>ï¼ˆ0ï¼‰ç¡®å®šåˆ†ç±»å‡½æ•°</p>
<p>å› ä¸ºlogisticæ˜¯äºŒå€¼åˆ†ç±»å™¨ï¼Œè¿™é‡Œé€‰æ‹©sigmoidå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(z)</span>:</span></span><br><span class="line">	sig=<span class="number">1</span>/(<span class="number">1</span>+exp(-z))</span><br><span class="line">	<span class="keyword">return</span> sig</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–w,b</p>
<p>æ ¹æ®è¾“å…¥æ•°æ®çš„ç‰¹å¾çº¬åº¦ï¼Œå»ºç«‹wçŸ©é˜µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inital_wPara_bPara</span><span class="params">(dim)</span>:</span></span><br><span class="line">	w=zeros((dim,<span class="number">1</span>))<span class="comment">#åˆå§‹åŒ–ä¸ºåˆ—å‘é‡</span></span><br><span class="line">	b=<span class="number">0</span></span><br><span class="line">	<span class="keyword">return</span> w,b</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ­å»ºæ¨¡å‹</p>
<p>å¯¹æ¯æ¬¡å¾ªç¯</p>
<p>1Â°æ­£å‘ä¼ æ’­</p>
<p>æ ¹æ®è¾“å…¥çš„å€¼ï¼Œè®¡ç®—å‡ºå½“å‰çš„zï¼Œaï¼ŒJï¼Œä»è€Œå¾—å‡ºdw,dbçš„æ¢¯åº¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">progation</span><span class="params">(w,b,x,y)</span>:</span></span><br><span class="line">	<span class="comment">#logicticå…¬å¼</span></span><br><span class="line">	z=dot(w.T,x)+b</span><br><span class="line">	a=sigmoid(z)</span><br><span class="line">	m=x.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">	loss=(<span class="number">-1</span>/m)*sum((y*log(a)+(<span class="number">1</span>-y)*log(<span class="number">1</span>-a)))</span><br><span class="line">	dz=a-y</span><br><span class="line">	dw=<span class="number">1</span>/m*dot(x,dz.T)</span><br><span class="line">	db=<span class="number">1</span>/m*sum(dz)</span><br><span class="line"></span><br><span class="line">	grad=&#123;<span class="string">"dw"</span>:dw,<span class="string">"db"</span>:db&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> grad,loss</span><br></pre></td></tr></table></figure>

<p>2Â°åå‘ä¼ æ’­</p>
<p>æ ¹æ®dw,dbçš„æ¢¯åº¦ï¼Œè®¡ç®—æ–°çš„wï¼Œbçš„å€¼</p>
<p>3Â°è®°å½•æŸå¤±å’Œæœ€ç»ˆæ‰¾å‡ºçš„æœ€åˆé€‚çš„w,bçš„å€¼</p>
<p>æ¯æ¬¡æ ¹æ®è¿­ä»£æ¬¡æ•°è®°å½•æŸå¤±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">optimize</span><span class="params">(w,b,x,y,alpha,numIter,print_cost=False)</span>:</span></span><br><span class="line"></span><br><span class="line">	costs=[]</span><br><span class="line">	<span class="comment">#éå†numiteræ¬¡</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">		<span class="comment">#å¾—å‡ºæ¯æ¬¡çš„æ¢¯åº¦ï¼Œè¿›è¡Œä¿®æ­£</span></span><br><span class="line">		grad,cost=progation(w,b,x,y)</span><br><span class="line">		dw=grad[<span class="string">'dw'</span>]</span><br><span class="line">		db=grad[<span class="string">'db'</span>]</span><br><span class="line">		w=w-alpha*dw</span><br><span class="line">		b=b-alpha*db</span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">100</span>==<span class="number">0</span>):</span><br><span class="line">			costs.append(cost)</span><br><span class="line">		<span class="keyword">if</span>(print_cost) <span class="keyword">and</span> (i%<span class="number">100</span>==<span class="number">0</span>):</span><br><span class="line">			print(<span class="string">"i:"</span>+str(i)+<span class="string">"  è¯¯å·®æ˜¯ï¼š"</span>+str(cost))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	params=&#123;<span class="string">"w"</span>:w,<span class="string">"b"</span>:b&#125;</span><br><span class="line">	grads=&#123;<span class="string">"dw"</span>:dw,<span class="string">"db"</span>:db&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> params,grads,costs</span><br></pre></td></tr></table></figure>

<p>4Â°å¯¹æ¨¡å‹ç»“æœè¿›è¡Œé¢„æµ‹</p>
<p>æ ¹æ®è®­ç»ƒå¾—å‡ºçš„æ¨¡å‹w,b,è®¡ç®—z=w*x+bï¼Œæ±‚å‡ºzçš„å€¼ï¼Œåˆ™å¾—å‡ºa=sigmoid(z)ï¼Œæ ¹æ®açš„å€¼è®°å½•æœ€ç»ˆçš„è¾“å‡ºæ˜¯1è¿˜æ˜¯0ï¼ˆa&gt;0.5æ˜¯1ï¼Œåä¹‹æ˜¯0ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(w,b,x)</span>:</span></span><br><span class="line">	a=sigmoid(dot(w.T,x)+b)</span><br><span class="line">	m=a.shape[<span class="number">1</span>]</span><br><span class="line">	yPredict=zeros((<span class="number">1</span>,m))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		<span class="keyword">if</span>(a[:,i]&gt;<span class="number">0.5</span>):</span><br><span class="line">			yPredict[<span class="number">0</span>,i]=<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			yPredict[<span class="number">0</span>,i]=<span class="number">0</span></span><br><span class="line">	<span class="keyword">return</span> yPredict</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æœ€ç»ˆå½¢æˆæ¨¡å‹ï¼Œå¯¹è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„æ•°æ®æŸ¥çœ‹å‡†ç¡®ç‡</p>
<p>å¯¹å¾—å‡ºçš„é¢„æµ‹å€¼å‡å»å®é™…çš„è¾“å‡ºå¹¶å–ç»å¯¹å€¼ï¼Œå½“é¢„æµ‹ç›¸åŒï¼Œåˆ™å¯¹åº”ä½ç½®ä¸º0ï¼Œä¸åŒåˆ™ä¸º1ï¼Œæ‰€æœ‰æ•°ç›¸åŠ èµ·æ¥é™¤ä»¥æ€»æ•°ï¼Œå³å¯¹æ‰€æœ‰å…ƒç´ å–å¹³å‡ï¼Œåˆ™æ˜¯è¯¯å·®ç‡ï¼Œç”¨1å‡å»è¿™ä¸ªæ•°ï¼Œåˆ™æ˜¯æ­£ç¡®ç‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(trainX,trainY,testX,testY,alpha=<span class="number">0.005</span>,numIter=<span class="number">2000</span>,print_cost=True)</span>:</span></span><br><span class="line">	<span class="comment">#åˆå§‹åŒ–</span></span><br><span class="line">	<span class="comment">#è¡Œå‘é‡æ˜¯å¤šå°‘æ•°æ®ç‰¹å¾ï¼Œåˆ—å‘é‡æ˜¯å¤šå°‘æ¡æ•°æ®ï¼Œwçš„ä¸ªæ•°å¯¹åº”æ•°æ®ç‰¹å¾çš„ä¸ªæ•°</span></span><br><span class="line">	m=trainX.shape[<span class="number">0</span>]</span><br><span class="line">	w,b=inital_wPara_bPara(m)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">	params,grads,costs=optimize(w,b,trainX,trainY,alpha,numIter,print_cost)</span><br><span class="line"></span><br><span class="line">	w=params[<span class="string">"w"</span>]</span><br><span class="line">	b=params[<span class="string">"b"</span>]</span><br><span class="line">	trainPredict=predict(w,b,trainX)</span><br><span class="line">	testPredict=predict(w,b,testX)</span><br><span class="line"></span><br><span class="line">	print(<span class="string">"è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š"</span>,<span class="number">100</span>-mean(abs(trainPredict-trainY))*<span class="number">100</span>)</span><br><span class="line">	print(<span class="string">"æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š"</span>,<span class="number">100</span>-mean(abs(testPredict-testY))*<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">	d=&#123;<span class="string">"costs"</span>:costs,<span class="string">"trainPredict:"</span>:trainPredict,<span class="string">"testPredict:"</span>:testPredict,<span class="string">"w"</span>:w,<span class="string">"b"</span>:b,<span class="string">"alpha"</span>:alpha,<span class="string">"numIter"</span>:numIter&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> d</span><br></pre></td></tr></table></figure>

<h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><p>ï¼ˆ1ï¼‰å›ºå®šå­¦ä¹ ç‡</p>
<p>è¯»å…¥costsçš„å€¼ï¼Œè¿›è¡Œæ˜¾ç¤ºï¼Œå¾—å‡ºæ¯ä¸€ç™¾æ¬¡costsè¯¯å·®çš„å˜åŒ–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d=model(train_set_x,train_set_y_orig,test_set_x,test_set_y_orig)</span><br><span class="line">costs=d[<span class="string">"costs"</span>]</span><br><span class="line">plt.plot(costs)</span><br><span class="line">plt.xlabel(<span class="string">"iter"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"costs"</span>)</span><br><span class="line">plt.title(<span class="string">"alpha="</span>+str(d[<span class="string">"alpha"</span>]))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿­ä»£æ¬¡æ•°2000ï¼Œå­¦ä¹ ç‡ä¸º0.005ä¸‹è¯¯å·®çš„å˜åŒ–</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417234704.png" alt></p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417234727.png" alt></p>
<p>å¯ä»¥çœ‹å‡ºè®­ç»ƒé›†å‡†ç¡®ç‡å¾ˆé«˜ï¼Œä½†æ˜¯æµ‹è¯•é›†å‡†ç¡®ç‡æœ‰æ‰€é™ä½ï¼Œè¯´æ˜è®­ç»ƒçš„æ¨¡å‹å­˜åœ¨è¿‡æ‹Ÿåˆçš„ç°è±¡</p>
<p>ï¼ˆ2ï¼‰ä¸åŒå­¦ä¹ ç‡</p>
<p>è¾“å…¥ä¸åŒçš„å­¦ä¹ ç‡ï¼ŒæŸ¥çœ‹è¯¯å·®çš„å˜åŒ–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alpha=[<span class="number">0.01</span>,<span class="number">0.001</span>,<span class="number">0.0001</span>]</span><br><span class="line">m=shape(alpha)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">	print(<span class="string">"alpha="</span>+str(alpha[i]))</span><br><span class="line">	d=model(train_set_x,train_set_y_orig,test_set_x,test_set_y_orig,alpha[i])</span><br><span class="line">	costs=d[<span class="string">"costs"</span>]</span><br><span class="line">	plt.plot(costs,label=str(d[<span class="string">"alpha"</span>]))</span><br><span class="line">	print(<span class="string">"------------------------------------------------"</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">"iter"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"costs"</span>)</span><br><span class="line">legend = plt.legend(loc=<span class="string">'upper center'</span>, shadow=<span class="literal">True</span>)</span><br><span class="line">frame = legend.get_frame()</span><br><span class="line">frame.set_facecolor(<span class="string">'0.90'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>ç»“æœä¸º</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200417235032.png" alt></p>
<p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œå½“å­¦ä¹ ç‡å¾ˆå°çš„æ—¶å€™ï¼Œè¯¯å·®åŸºæœ¬ä¸æ€ä¹ˆå˜åŒ–ï¼Œå³ä¸€ç›´æ²¡åˆ°å˜´æœ‰ç‚¹ï¼Œå½“å­¦ä¹ ç‡å¾ˆå¤§çš„æ—¶å€™ï¼Œå‰é¢ç”±äºå­¦ä¹ ç‡å¤§ï¼Œæ‰€æœ‰è¯¯å·®å˜åŒ–å¿«ï¼Œå‡ºç°é™¡é™ï¼Œå½“èµ°åˆ°æœ€ä¼˜è§£ä¹‹åï¼Œè¯¯å·®è¶‹å‘å¹³ç¼“</p>
]]></content>
      <categories>
        <category>ç¥ç»ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeå­¦ä¹ ç¬”è®°ï¼ˆå…­ï¼‰â€”â€”ç³»ç»Ÿè®¾è®¡é¢˜</title>
    <url>/blogs/sysDesignNote/</url>
    <content><![CDATA[<h2 id="ç¼“å­˜æœºåˆ¶"><a href="#ç¼“å­˜æœºåˆ¶" class="headerlink" title="ç¼“å­˜æœºåˆ¶"></a>ç¼“å­˜æœºåˆ¶</h2><p>ï¼ˆ1ï¼‰LRU</p><p>least recently use:æœ€è¿‘æœ€å°‘ä½¿ç”¨</p><p>åˆ é™¤ç¼“å­˜ä¾æ®ï¼šæŒ‰ç…§æ—¶é—´è®¡ç®—ï¼Œæ¯æ¬¡åˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ã€‚</p><p>ï¼ˆ2ï¼‰LFU</p><p>least frequently useï¼šæœ€è¿‘æœ€ä¸å¸¸ä½¿ç”¨</p><p>åˆ é™¤ç¼“å­˜ä¾æ®ï¼šæŒ‰ç…§æ—¶é—´å’Œä½¿ç”¨é¢‘ç‡è®¡ç®—ï¼Œä»¥ä½¿ç”¨é¢‘ç‡ä¸ºä¸»ï¼Œæ¯æ¬¡åˆ é™¤æ•°æ®æ—¶ï¼ŒæŸ¥çœ‹ä½¿ç”¨é¢‘ç‡æœ€å°çš„æ•°æ®è¿›è¡Œåˆ é™¤ï¼Œå½“ä½¿ç”¨é¢‘ç‡ç›¸åŒæ—¶ï¼Œæ ¹æ®æœ€ä¹…æœªä½¿ç”¨å³æ—¶é—´æ¥åˆ é™¤ã€‚</p><a id="more"></a>





<p>æ€»ä½“æ€è·¯ï¼š</p>
<p>ç¼“å­˜ä¸»è¦æ˜¯ä¸ºäº†è·å–æ•°æ®å’Œæ’å…¥æ•°æ®ï¼Œå› æ­¤éœ€è¦å¯¹ç¼“å­˜æ•°æ®è¿›è¡ŒèŠ‚ç‚¹è®¾è®¡ï¼Œæ ¹æ®å…¶ç‰¹æ€§è®¾ç½®key.valueç”¨äºæ ¹æ®keyæŸ¥æ‰¾å€¼ï¼ŒåŒæ—¶éœ€è¦è®¾ç½®ä½¿ç”¨æ—¶é—´time,ä½¿ç”¨é¢‘ç‡cnt.</p>
<p>ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾å¯ä»¥ä½¿ç”¨hashè¡¨å­˜å‚¨keyä»¥åŠnode,å¯ä»¥æ–¹ä¾¿çš„åœ¨hashè¡¨å†…é€šè¿‡node-&gt;keyæŸ¥æ‰¾åˆ°nodeï¼Œä½†æ˜¯å“ˆå¸Œè¡¨æ— åºï¼Œå› æ­¤è¿˜éœ€è¦å­˜å‚¨èŠ‚ç‚¹çš„ä½¿ç”¨æ—¶é—´/é¢‘ç‡ï¼Œè¿™æ—¶å€™æœ‰ä¸¤ç§æ€è·¯ï¼š</p>
<p>ç¬¬ä¸€ç§æ˜¯åˆ©ç”¨setå®¹å™¨ï¼Œc++å†…ç½®çš„setæ˜¯ä½¿ç”¨çº¢é»‘æ ‘æ’åºï¼Œå³ä¼šå½¢æˆå¹³è¡¡äºŒå‰æ ‘ï¼Œä½¿ç”¨è¿ç®—ç¬¦é‡è½½ï¼Œå°†setå†…éƒ¨æ ¹æ®æ—¶é—´å’Œé¢‘ç‡æ¥è¿›è¡Œæ’åºï¼Œä½¿ç”¨é¢‘ç‡æœ€å°‘æˆ–è€…æ—¶é—´æœ€å°‘çš„ä¼šæ’åœ¨å‰é¢ï¼Œä»¥setè®°å½•æ—¶é—´/é¢‘ç‡ï¼Œä½†æ˜¯æœç´¢æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆlognï¼‰ã€‚</p>
<p>ç¬¬äºŒç§æ€è·¯æ˜¯å»ºç«‹åŒé“¾è¡¨listå­˜å‚¨èŠ‚ç‚¹ï¼Œå“ˆå¸Œè¡¨ä¸­å­˜å‚¨keyæ˜ å°„åˆ°listèŠ‚ç‚¹çš„è¿­ä»£å™¨ï¼Œå½“æ•°æ®ä½¿ç”¨æ˜¯ï¼Œå°†å…¶ä»åŸæ¥ä½ç½®åˆ é™¤ï¼Œæ’å…¥æœ€å‰é¢ï¼Œå½“éœ€è¦åˆ é™¤æ•°æ®çš„æ—¶å€™ï¼Œä»æœ«ä½åˆ é™¤ï¼Œé“¾è¡¨æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆ1ï¼‰ã€‚</p>
<p>è·å–æ•°æ®ï¼ˆæ ¹æ®å¯†é’¥è·å¾—å€¼ï¼‰ï¼š</p>
<p>æ ¹æ®å“ˆå¸Œè¡¨ä¸­çš„keyæŸ¥æ‰¾èŠ‚ç‚¹ï¼Œå¹¶è¿›è¡Œç¼“å­˜æ•°æ®æ›´æ–°ã€‚</p>
<p>ï¼ˆ2ï¼‰æ’å…¥æ•°æ®ï¼ˆå°†key,valueæ’å…¥ï¼‰ï¼š</p>
<p>åˆ¤æ–­keyæ˜¯å¦å­˜å‚¨è¿‡äº†ï¼Œå½“å­˜å‚¨è¿‡ä¹‹åæ›´æ–°æ•°æ®å€¼ï¼Œåä¹‹éœ€è¦æ’å…¥æ•°æ®ï¼Œæ­¤æ—¶éœ€è¦åˆ¤æ–­æ˜¯å¦å·²ç»è¾¾åˆ°å®¹é‡é¡¶ç«¯ï¼Œè¾¾åˆ°äº†ï¼Œéœ€è¦åˆ é™¤æœ€ä¸å¸¸ä½¿ç”¨çš„æ•°æ®ã€‚ï¼Œå¹¶è¿›è¡Œç¼“å­˜æ•°æ®æ›´æ–°ã€‚</p>
<p>æ³¨ï¼šæ¯æ¬¡æ“ä½œè¿‡åéƒ½éœ€è¦è¿›è¡Œç¼“å­˜æ•°æ®æ›´æ–°ï¼Œå³åœ¨å“ˆå¸Œè¡¨ä¸­æ›´æ–°æ•°æ®èŠ‚ç‚¹ä»¥åŠset/åŒå‘é“¾è¡¨listè¿›è¡Œæ›´æ–°ã€‚</p>
<h2 id="è®¾è®¡ç®€å•æ¨ç‰¹"><a href="#è®¾è®¡ç®€å•æ¨ç‰¹" class="headerlink" title="è®¾è®¡ç®€å•æ¨ç‰¹"></a>è®¾è®¡ç®€å•æ¨ç‰¹</h2><p>é¢˜ç›®ï¼š355. è®¾è®¡æ¨ç‰¹è®¾è®¡ä¸€ä¸ªç®€åŒ–ç‰ˆçš„æ¨ç‰¹(Twitter)ï¼Œå¯ä»¥è®©ç”¨æˆ·å®ç°å‘é€æ¨æ–‡ï¼Œå…³æ³¨/å–æ¶ˆå…³æ³¨å…¶ä»–ç”¨æˆ·ï¼Œèƒ½å¤Ÿçœ‹è§å…³æ³¨äººï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰çš„æœ€è¿‘åæ¡æ¨æ–‡ã€‚ä½ çš„è®¾è®¡éœ€è¦æ”¯æŒä»¥ä¸‹çš„å‡ ä¸ªåŠŸèƒ½ï¼špostTweet(userId, tweetId): åˆ›å»ºä¸€æ¡æ–°çš„æ¨æ–‡,getNewsFeed(userId): æ£€ç´¢æœ€è¿‘çš„åæ¡æ¨æ–‡ã€‚æ¯ä¸ªæ¨æ–‡éƒ½å¿…é¡»æ˜¯ç”±æ­¤ç”¨æˆ·å…³æ³¨çš„äººæˆ–è€…æ˜¯ç”¨æˆ·è‡ªå·±å‘å‡ºçš„ã€‚æ¨æ–‡å¿…é¡»æŒ‰ç…§æ—¶é—´é¡ºåºç”±æœ€è¿‘çš„å¼€å§‹æ’åºã€‚,follow(followerId, followeeId): å…³æ³¨ä¸€ä¸ªç”¨æˆ·,unfollow(followerId, followeeId): å–æ¶ˆå…³æ³¨ä¸€ä¸ªç”¨æˆ·</p>
<p>æ€è·¯ï¼š</p>
<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–ä¸¤ä¸ªhashè¡¨</p>
<p>é¢˜ç›®è¦æ±‚ä¸­åŠŸèƒ½3ï¼Œ4æ˜¯éœ€è¦èƒ½å¤Ÿå…³æ³¨å’Œå–æ¶ˆå…³æ³¨ä¸€ä¸ªç”¨æˆ·ï¼Œé‚£ä¹ˆå°±éœ€è¦å­˜å‚¨å½“å‰ç”¨æˆ·åˆ°è‡ªå·±å…³æ³¨çš„äººä¹‹é—´çš„æ˜ å°„ï¼Œéœ€è¦ç”¨åˆ°hashè¡¨ã€‚</p>
<p>é¢˜ç›®è¦æ±‚ä¸­çš„åŠŸèƒ½1ï¼Œ2æ˜¯éœ€è¦å¯¹æ¨æ–‡è¿›è¡Œæ“ä½œï¼Œéœ€è¦å­˜å‚¨å½“å‰ç”¨æˆ·åœ¨æŸä¸ªæ—¶åˆ»å†™çš„æ¨æ–‡ï¼ˆè¿™é‡Œçš„æ¨æ–‡ç”¨æ•°å­—ä»£æ›¿ï¼‰ï¼Œä¸ºäº†æ–¹ä¾¿é€šè¿‡idæŸ¥æ‰¾æ¨æ–‡ï¼Œåé¢çš„æ•°æ®ç”¨pairå½¢å¼å­˜å‚¨æ—¶é—´å’Œæ¨æ–‡ã€‚è¿™é‡Œéœ€è¦ä¸€ä¸ªå…¨å±€å˜é‡æ¥è®¡ç®—å‘æ¨çš„æ—¶é—´ã€‚åˆå§‹åŒ–æ—¶é—´ä¸º0ï¼Œç¦»ç°åœ¨è¶Šè¿‘ï¼Œæ—¶é—´è¶Šå¤§ã€‚</p>
<p>å­˜å‚¨å½“å‰ç”¨æˆ·åˆ°è‡ªå·±å…³æ³¨çš„äººä¹‹é—´çš„æ˜ å°„ map1&lt;int,set<int>&gt;</int></p>
<p>å­˜å‚¨å½“å‰ç”¨æˆ·åœ¨æŸä¸ªæ—¶åˆ»å†™çš„æ¨æ–‡çš„æ˜ å°„ map2&lt;int,vector&lt;pair&lt;int,int&gt;&gt; ï¼Œä¸ºäº†æ–¹ä¾¿é€šè¿‡idæŸ¥æ‰¾æ¨æ–‡ï¼Œåé¢çš„æ•°æ®ç”¨pairå½¢å¼å­˜å‚¨æ—¶é—´å’Œæ¨æ–‡</p>
<p>ï¼ˆ2ï¼‰å…³æ³¨å’Œå–æ¶ˆå…³æ³¨</p>
<p>ç›´æ¥æ“ä½œmap1ï¼ŒåŠ å…¥å½“å‰ç”¨æˆ·å…³æ³¨çš„idå’Œåˆ é™¤å–æ¶ˆå…³æ³¨çš„id</p>
<p>ï¼ˆ3ï¼‰åˆ›å»ºæ¨æ–‡</p>
<p>ç›´æ¥æ“ä½œmap2ï¼ŒåŠ å…¥å½“å‰ç”¨æˆ·ï¼Œåœ¨å½“å‰æ—¶é—´ï¼Œå†™ä¸‹çš„æ¨æ–‡</p>
<p>ï¼ˆ4ï¼‰æ£€ç´¢æ¨æ–‡</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯æœç´¢æ¨æ–‡çš„æ—¶å€™éœ€è¦æŠŠè‡ªå·±ä¹ŸåŠ ä¸Šã€‚æ£€ç´¢æ¨æ–‡çš„æ—¶å€™éœ€è¦è¿›è¡Œæ¯”è¾ƒï¼Œå–å‰10æ¡ï¼Œè¿™é‡Œå¯ä»¥å»ºç«‹ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ ¹æ®æ—¶é—´è¿›è¡Œè‡ªåŠ¨æ’åºã€‚</p>
<p>å»ºç«‹ä¼˜å…ˆçº§é˜Ÿåˆ—å³å¤§é¡¶å †priori_queue&lt;pair&lt;int,int&gt;&gt;ï¼Œè¿™é‡Œä¼šæ ¹æ®pairä¸­ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡Œé™åºæ’åˆ—ï¼Œå½“ç¬¬ä¸€ä¸ªå…ƒç´ ç›¸ç­‰ä¼šæ ¹æ®ç¬¬äºŒä¸ªå…ƒç´ æ’åºï¼Œä½†ç”±äºæ—¶é—´è‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™é‡Œé»˜è®¤æ˜¯å¯¹æ—¶é—´è¿›è¡Œè‡ªåŠ¨æ’åºï¼Œç¦»ç°åœ¨è¶Šè¿‘ï¼Œæ—¶é—´è¶Šå¤§ã€‚</p>
<p>é¦–å…ˆå°†è‡ªå·±åŠ å…¥è‡ªå·±å…³æ³¨çš„ç”¨æˆ·åˆ—è¡¨ä¸­ï¼Œé€šè¿‡å½“å‰ç”¨æˆ·çš„idæŸ¥åˆ°æ‰€æœ‰å…³æ³¨çš„äººï¼ˆè¿™é‡Œéœ€è¦åŒ…æ‹¬è‡ªå·±ï¼‰ï¼Œå†é€šè¿‡æŸ¥åˆ°å…³æ³¨çš„ç”¨æˆ·çš„idï¼Œæ‰¾åˆ°ä»–ä»¬åœ¨æŸä¸ªæ—¶é—´å‘çš„æ¨æ–‡ï¼Œå°†å…¶æ’å…¥é˜Ÿåˆ—ä¸­ã€‚è¿™æ—¶å€™è¾“å‡ºå †é¡¶å‰10ä¸ªå°±æ˜¯æœ€è¿‘çš„æ¨æ–‡ã€‚</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>ç³»ç»Ÿè®¾è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>macä¸‹ä½¿ç”¨nginxå®ç°è´Ÿè½½å‡è¡¡</title>
    <url>/blogs/nginx/</url>
    <content><![CDATA[<h2 id="å®‰è£…æµç¨‹"><a href="#å®‰è£…æµç¨‹" class="headerlink" title="å®‰è£…æµç¨‹"></a>å®‰è£…æµç¨‹</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install nginx</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ"></a>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</h3><p>nginxé»˜è®¤çš„ç«¯å£å·ä¸º8080ï¼Œé»˜è®¤çš„å¯åŠ¨é¡µé¢ä¸ºindex.htmlï¼Œåˆå§‹é¡µé¢çš„é»˜è®¤è·¯å¾„ä¸º/usr/local/var/www/index.htmlï¼Œåœ¨å‘½ä»¤è¡Œå†…è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å·²å¯åŠ¨nginxæœåŠ¡ï¼Œæ‰“å¼€æµè§ˆå™¨è¾“å…¥localhose:8080ï¼Œæ˜¾ç¤ºå¦‚ä¸‹é¡µé¢è¯´æ˜å®‰è£…æˆåŠŸã€‚</p><a id="more"></a>





<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410142258.png" alt></p>
<p>é…ç½®æ–‡ä»¶é»˜è®¤çš„è·¯å¾„ä¸º/usr/local/ect/nginx/nginx.confï¼Œå¯¹nginxçš„æ“ä½œä¸»è¦æ˜¯ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</p>
<h2 id="å®ç°è´Ÿè½½å‡è¡¡"><a href="#å®ç°è´Ÿè½½å‡è¡¡" class="headerlink" title="å®ç°è´Ÿè½½å‡è¡¡"></a>å®ç°è´Ÿè½½å‡è¡¡</h2><p>nginxå¯ä»¥æŠ½è±¡çš„ç†è§£ä¸ºæ—¶ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ƒé€šè¿‡æ¥æ”¶ç½‘é¡µç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶æŒ‰ç…§ä¸€å®šç­–ç•¥è½¬å‘åˆ°æœåŠ¡å™¨ä¸­ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚è¿™é‡Œç­–ç•¥ä¸»è¦æ˜¯æŒ‰ç…§æƒé‡è®¾ç½®æ¯å°æœåŠ¡å™¨ï¼Œæƒé‡è¶Šå¤§è¯´æ˜è½¬å‘ç»™å…¶çš„è¯·æ±‚çš„å¯èƒ½æ€§è¶Šå¤§ï¼ŒåŒæ—¶è¿˜å¯ä»¥è®¾ç½®å¤‡ç”¨æœåŠ¡å™¨ï¼Œå¹³æ—¶ä¸ç»™å¤‡ç”¨æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä¸€æ—¦å…¶ä»–æœåŠ¡å™¨å®•æœºï¼Œå°†ä¼šä½¿ç”¨å¤‡ç”¨æœåŠ¡å™¨ï¼Œæ¥ä¿è¯æœåŠ¡å™¨ä¸­æœåŠ¡çš„è¿ç»­æ€§ã€‚</p>
<h3 id="è®¾ç½®æœåŠ¡å™¨"><a href="#è®¾ç½®æœåŠ¡å™¨" class="headerlink" title="è®¾ç½®æœåŠ¡å™¨"></a>è®¾ç½®æœåŠ¡å™¨</h3><p>åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æ–°å»ºä¸‰ä¸ªå¯åŠ¨é¡¹ï¼Œä½œä¸ºä¸‰ä¸ªæœåŠ¡å™¨ï¼Œå¹¶åˆ†åˆ«è®¾ç½®ç«¯å£å·ä¸º9091ï¼Œ9092ï¼Œ9093ï¼Œå°†ç«¯å£å·åˆ†åˆ«ä¿å­˜ä¸ºapplication.propertiesï¼Œapplication.properties2ï¼Œapplication.properties3ï¼Œå¹¶åœ¨å¯åŠ¨ç¯å¢ƒå˜é‡ä¸­å°†æ¯ä¸ªæœåŠ¡å™¨å¯¹åº”çš„ç«¯å£å·è¿›è¡ŒåŠ è½½ã€‚</p>
<p>é€‰æ‹©edit configurations</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410141413.png" alt></p>
<p>åˆ†åˆ«è®¾ç½®æ¯ä¸ªæœåŠ¡å™¨çš„ç«¯å£</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410141518.png" alt></p>
<p>è¿™æ ·ä¸‰ä¸ªæœåŠ¡ç«¯å°±è®¾ç½®å¥½äº†ï¼Œå½“è°ƒç”¨å“ªä¸ªæœåŠ¡å™¨æ—¶ä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºå…¶ç«¯å£ã€‚</p>
<h3 id="è®¾ç½®nginx"><a href="#è®¾ç½®nginx" class="headerlink" title="è®¾ç½®nginx"></a>è®¾ç½®nginx</h3><p>ä¸»è¦æ˜¯é€šè¿‡è®¾ç½®é…ç½®æ–‡ä»¶ï¼Œè´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡å…³é”®å­—upstreamè®¾ç½®ï¼Œæ‰“å¼€nginx.confé…ç½®æ–‡ä»¶ï¼Œåœ¨httpé¡¹ç›®ä¸‹å¢åŠ upstreamï¼ŒæŠŠä¹‹å‰è®¾ç½®çš„æœåŠ¡å™¨çš„ç«¯å£å·åŠ å…¥ï¼Œå¹¶è®¾ç½®æ¯ä¸ªæœåŠ¡å™¨çš„æƒå€¼å’Œå¤‡ç”¨æœåŠ¡å™¨æƒ…å†µï¼Œè¿™é‡Œè®¾ç½®ç¬¬ä¸€å°æœåŠ¡å™¨æ—¶ä¸»æœåŠ¡å™¨ï¼Œå…¶ä»–ä¸¤å°æœåŠ¡å™¨æ—¶å¤‡ç”¨æœåŠ¡å™¨ã€‚</p>
<p>ï¼ˆ1ï¼‰upstreamåé¢è·Ÿç€çš„æ˜¯å½“å‰åˆ†å‘è¯·æ±‚çš„å…¥å£åç§°ï¼Œéœ€è¦åœ¨locationä¸­å¢åŠ è¯¥åç§°</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410142229.png" alt></p>
<p>ï¼ˆ2ï¼‰æ‰¾åˆ°serveré¡¹ç›®ä¸‹çš„locationï¼Œnginxæ¥æ”¶è¯·æ±‚ä¹‹åä¼šä»locationä¸­æ‰¾è¿”å›çš„é¡µé¢ï¼Œå› ä¸ºnginxé»˜è®¤ç›‘å¬çš„ç«¯å£æ˜¯8080ï¼Œå¯åŠ¨å…¥å£æ˜¯index.htmlï¼Œä¸ºäº†è®©nginxä»è®¾ç½®çš„webpootsä¸­æ‰¾æœåŠ¡å™¨ï¼Œéœ€è¦æŠŠåŸæ¥çš„ç«¯å£è®¾ç½®ä¸º80,åŸæ¥çš„å…¥å£é¡µé¢æ³¨é‡Šæ‰ï¼Œå¹¶å¢åŠ è®¾ç½®çš„æ¥æ”¶è¯·æ±‚çš„æœåŠ¡å™¨çš„åç§°</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410142558.png" alt></p>
<p>è¿™é‡Œproxy_passåé¢çš„åç§°éœ€è¦å’Œupstreamåè®¾ç½®çš„åç§°è¦ä¸€è‡´ï¼Œä¸ç„¶nginxæ‰¾ä¸åˆ°æ¥æ”¶è¯·æ±‚çš„å…¥å£æœåŠ¡å™¨</p>
<p>æ³¨ï¼šupstreamåé¢è·Ÿçš„æœåŠ¡å™¨å…¥å£åç§°ä¸èƒ½æœ‰ä¸‹åˆ’çº¿ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</p>
<p>ï¼ˆ3ï¼‰ä¿®æ”¹å®Œnginxé…ç½®æ–‡ä»¶åï¼Œè¾“å…¥å‘½ä»¤ï¼Œè®©é…ç½®èµ·ä½œç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>ï¼ˆ1ï¼‰æˆ‘è¿™é‡ŒæœåŠ¡å™¨å®ç°çš„åŠŸèƒ½æ˜¯åœ¨ç½‘é¡µç«¯è¾“å…¥å¯¹åº”æ‰‹æœºåç§°ï¼Œè¿”å›æ‰‹æœºçš„ä¿¡æ¯ï¼Œè¢«è°ƒç”¨çš„æœåŠ¡å™¨ä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºè‡ªå·±çš„ç«¯å£å·ã€‚æ‰“å¼€æµè§ˆå™¨è¾“å…¥localhost/xiaomiï¼Œç½‘é¡µæ˜¾ç¤ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410143131.png" alt></p>
<p>ï¼ˆ2ï¼‰è¿™æ˜¯åªæœ‰ç¬¬ä¸€å°æœåŠ¡å™¨ä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºè‡ªå·±çš„ç«¯å£å·ï¼Œç‚¹å‡»åˆ·æ–°ï¼Œå…¶ä»–ä¸¤ä¸ªæœåŠ¡å™¨ä¸ä¼šæ˜¾ç¤ºç«¯å£å·ï¼Œå³æ²¡æœ‰å°†è¯·æ±‚è½¬å‘ç»™å¤‡ç”¨æœåŠ¡å™¨ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410143329.png" alt></p>
<p>ï¼ˆ3ï¼‰å½“å°†ç¬¬ä¸€å°æœåŠ¡å™¨åœæ­¢è¿è¡Œåï¼Œç½‘é¡µç«¯ä»ä¸ä¼šæŠ¥é”™ï¼Œè¿™æ—¶å€™è°ƒç”¨äº†å¦å¤–ä¸¤å°æœåŠ¡å™¨ï¼Œå¹¶æŒ‰æƒå€¼æ¥æ”¶åˆ†å‘è¿‡æ¥çš„è¯·æ±‚ã€‚</p>
<p>æš‚åœç¬¬ä¸€ä¸ªæœåŠ¡å™¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410143527.png" alt></p>
<p>å…¶ä»–ä¸¤ä¸ªæœåŠ¡å™¨èµ·ä½œç”¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200410143539.png" alt></p>
]]></content>
      <categories>
        <category>è´Ÿè½½å‡è¡¡</category>
      </categories>
      <tags>
        <tag>è´Ÿè½½å‡è¡¡</tag>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>éç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”ä½¿ç”¨Apriorç®—æ³•è¿›è¡Œå…³è”åˆ†æ</title>
    <url>/blogs/apriori/</url>
    <content><![CDATA[<h2 id="ç®—æ³•ç›®çš„"><a href="#ç®—æ³•ç›®çš„" class="headerlink" title="ç®—æ³•ç›®çš„"></a>ç®—æ³•ç›®çš„</h2><p>ä»æ•°æ®ä¸­æ‰¾åˆ°å„å±æ€§ä¹‹é—´çš„éšå«å…³ç³»ï¼ŒApriorç®—æ³•å°±æ˜¯åœ¨æ•°æ®é›†ä¸­æ„é€ å‡ºé¢‘ç¹é¡¹é›†ï¼Œä»å…¶ä¸­æ‰¾å‡ºå…³è”è§„åˆ™ã€‚</p><p>è¿™é‡Œçš„é¢‘ç¹é¡¹é›†æ˜¯æŒ‡ç»å¸¸å‡ºç°åœ¨ä¸€èµ·çš„æ•°æ®å±æ€§ï¼Œé€šè¿‡å‡ºç°çš„é¢‘ç‡æ¥è¡¡é‡é¢‘ç¹é¡¹é›†ã€‚</p><p>å…³è”è§„åˆ™æ˜¯æŒ‡ä¸¤ä¸ªé›†åˆä¹‹é—´å­˜åœ¨çš„è”ç³»ï¼Œå¦‚p-&gt;qå°±æ˜¯ä¸€ç§å…³è”è§„åˆ™ï¼Œå…³è”è§„åˆ™é€šè¿‡ç½®ä¿¡åº¦è¡¡é‡ï¼Œä¸¤ä¸ªé›†åˆä¹‹é—´çš„ç½®ä¿¡åº¦=på’Œqå¹¶é›†çš„æ”¯æŒåº¦/pçš„æ”¯æŒåº¦ã€‚</p><a id="more"></a>


<p>å› æ­¤Apriorç®—æ³•ä¸»è¦ç›®çš„å°±æ˜¯ä»æ•°æ®ä¸­æ‰¾åˆ°é¢‘ç¹é›†åˆï¼Œä»é¢‘ç¹é›†åˆä¸­æ‰¾å‡ºå…³è”è§„åˆ™ã€‚ç”¨æˆ·è¾“å…¥æœ€å°æ”¯æŒåº¦å¾—å‡ºé¢‘ç¹é›†åˆï¼Œæ ¹æ®è®¾å®šçš„æœ€å°ç½®ä¿¡åº¦å¾—å‡ºæƒ³è¦çš„å…³è”è§„åˆ™</p>
<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><h3 id="æ„é€ é¢‘ç¹é›†"><a href="#æ„é€ é¢‘ç¹é›†" class="headerlink" title="æ„é€ é¢‘ç¹é›†"></a>æ„é€ é¢‘ç¹é›†</h3><p>æ€»ä½“æ€è·¯ï¼š</p>
<p>ä»é›†åˆå…ƒç´ ä¸ªæ•°ä¸º1å¼€å§‹æ„é€ é¢‘ç¹é›†ï¼Œéé¢‘ç¹é›†çš„å•ä¸ªå…ƒç´ ä¸åŠ å…¥åç»­æ„é€ é¢‘ç¹é›†ä¸­ï¼Œå› ä¸ºéé¢‘ç¹é›†çš„è¶…é›†ä¹Ÿæ˜¯éé¢‘ç¹é›†ã€‚</p>
<p>å½“é›†åˆä¸ªæ•°å¤§äºç­‰äº2ä¸ªæ—¶ï¼Œæ¯æ¬¡å–å‰k-2ä¸ªé›†åˆè¿›è¡Œåˆå¹¶ï¼Œå¾—å‡ºå€™é€‰é›†ï¼Œå†æ ¹æ®æœ€å°ç½®ä¿¡åº¦æ±‚å‡ºé¢‘ç¹é›†åˆ</p>
<p>1.æ„é€ å•ä¸ªå…ƒç´ çš„é›†åˆ</p>
<p>è¾“å…¥æ•°å€¼ä¸ºæ•´ä¸ªæ•°æ®é›†åˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.å¯¹æ¯ä¸€ä¸ªåˆ—è¡¨æ•°æ®</span></span><br><span class="line"><span class="keyword">for</span> tran <span class="keyword">in</span> dataSet:</span><br><span class="line"><span class="comment">#2.å¯¹æ¯ä¸ªå•ä¸ªæ•°æ®é¡¹</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> tran:</span><br><span class="line">	<span class="keyword">if</span> [item] <span class="keyword">not</span> <span class="keyword">in</span> C1:</span><br><span class="line">		C1.append([item])</span><br></pre></td></tr></table></figure>

<p>2.è®¡ç®—å„ä¸ªæ•°æ®é›†åˆçš„å‡ºç°æ¦‚ç‡ï¼Œå¹¶æŠŠå¤§äºæœ€å°æ”¯æŒåº¦çš„é›†åˆä¿å­˜ï¼Œä½œä¸ºé¢‘ç¹é›†</p>
<p>2.1è®¡ç®—å„ä¸ªæ•°æ®é›†åˆçš„å‡ºç°æ¦‚ç‡</p>
<p>è¾“å…¥å€™é€‰é›†åˆï¼Œå¯¹æ¯ä¸ªå€™é€‰é›†åˆåˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰é›†åˆçš„å­é›†ï¼Œå¦‚æœæ˜¯å°±éœ€è¦å¢åŠ å…¶å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœæ˜¯é¦–æ¬¡å‡ºç°åˆ™è®¾ç½®ä¸º1</p>
<p>æ³¨ï¼šA.issubset(B):åˆ¤æ–­aæ˜¯å¦æ˜¯bçš„å­é›†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.è®¡ç®—æ‰€æœ‰æ•°æ®é¡¹åœ¨åŸå§‹æ•°æ®é›†ä¸­å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">sSet=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> tran <span class="keyword">in</span> D:</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> C1:</span><br><span class="line">	<span class="comment">#åˆ¤æ–­itemæ˜¯å¦æ˜¯trançš„å­é›†</span></span><br><span class="line">	<span class="keyword">if</span> item.issubset(tran):</span><br><span class="line">		<span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> sSet:<span class="comment">#åˆå§‹å­—å…¸ä¸­æ²¡æœ‰è¿™ä¸ªé”®</span></span><br><span class="line">			sSet[item]=<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			sSet[item]+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>2.2æ ¹æ®æœ€å°æ”¯æŒåº¦ä¿å­˜é¢‘ç¹é›†åˆ</p>
<p>å°†æ¯ä¸ªå€™é€‰é›†åˆå‡ºç°çš„æ¬¡æ•°é™¤ä»¥é›†åˆæ€»æ•°ï¼Œå¾—å‡ºå‡ºç°çš„æ¦‚ç‡ï¼Œå†å’Œæœ€å°æ”¯æŒåº¦æ¯”è¾ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#2.è®¡ç®—æ¯ä¸ªæ•°æ®é¡¹çš„æ”¯æŒåº¦ï¼Œå¹¶æŠŠå°äºæœ€å°æ”¯æŒåº¦çš„æ•°æ®é¡¹åˆ é™¤</span></span><br><span class="line">numLen=len(D)</span><br><span class="line">retList=[]</span><br><span class="line">supportData=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> sSet:</span><br><span class="line">	support=sSet[key]/numLen</span><br><span class="line">	<span class="keyword">if</span>(support&gt;=minSupport):</span><br><span class="line">		<span class="comment">#åœ¨ç´¢å¼•ä¸º0çš„ä½ç½®ä¹‹å‰æ’å…¥</span></span><br><span class="line">		retList.insert(<span class="number">0</span>,key)</span><br><span class="line">		supportData[key]=support</span><br></pre></td></tr></table></figure>

<p>3.aprioriç®—æ³•å¾—å‡ºé¢‘ç¹é›†åˆ</p>
<p>æ³¨ï¼šå½“ä¸€ä¸ªé›†åˆä¸æ˜¯é¢‘ç¹é›†ï¼Œé‚£ä¹ˆä»–çš„è¶…é›†ä¹Ÿä¸æ˜¯é¢‘ç¹é›†ï¼Œä»¥è¿™ä¸ªåŸåˆ™æ¥å‡å°‘éœ€è¦æ„é€ çš„é›†åˆæ•°ã€‚æ‰€ä»¥æ¯æ¬¡ä»ä¸€ä¸ªå…ƒç´ çš„é›†åˆå¼€å§‹å¯»æ‰¾é¢‘ç¹é›†ï¼Œéé¢‘ç¹é›†çš„å…ƒç´ é›†åˆä¸ä¿å­˜ï¼Œä¾æ¬¡ä½œä¸ºåˆå§‹æ„é€ èµ·ç‚¹ï¼Œéé¢‘ç¹é›†çš„å…ƒç´ è‡ªç„¶ä¸ä¼šåŠ å…¥åˆ°åç»­ç­›é€‰å¤šä¸ªå…ƒç´ çš„é›†åˆä¸­å»ã€‚</p>
<p>3.1 ä»é•¿åº¦ä¸º1çš„é›†åˆå¼€å§‹æ‰¾åˆ°é¢‘ç¹é›†åˆ</p>
<p>ï¼ˆ1ï¼‰æ„é€ æ•°æ® ä»åŸå§‹æ•°æ®é›†ä¸­å¾—å‡ºä¸é‡å¤çš„æ€»çš„æ•°æ®é›†åˆ</p>
<p>ï¼ˆ2ï¼‰æ„é€ åˆå§‹é¢‘ç¹é›†åˆ</p>
<p>å¾—å‡ºå•ä¸ªæ•°æ®é›†ä¸­çš„é¢‘ç¹é›†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#1.æ„é€ æ•°æ®</span></span><br><span class="line">D=list(map(set,dataSet))</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.æ„é€ åˆå§‹æ•°æ®é¡¹</span></span><br><span class="line">C1=createC1(dataSet)</span><br><span class="line">L1,supportData=scanD(D,C1,minSupport)</span><br><span class="line">L=[L1]</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æ„é€ å…ƒç´ æ•°å¤šäº2ä¸ªçš„é¢‘ç¹é›†åˆ</p>
<p>ä»¤k=2,å‡è®¾åˆå§‹é¢‘ç¹é›†ä¸ºL=[L1],å½“L[K-2]å³å‰ä¸€ä¸ªå…ƒç´ æ•°é‡æœ‰é¢‘ç¹é›†åˆï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾ªç¯æŸ¥çœ‹å½“å‰é•¿åº¦çš„å…ƒç´ æ•°é‡æ˜¯å¦ä¹Ÿæœ‰é¢‘ç¹é›†åˆï¼ˆå‡è®¾å‰ä¸€ä¸ªå…ƒç´ æ•°é‡æ˜¯1ï¼Œé¢‘ç¹é›†åˆä¸­å…ƒç´ æ•°ä¸º1ï¼‰ï¼Œä»L[K-2]ä¸­æ„é€ å½“å‰çš„å€™é€‰é›†åˆï¼Œå¹¶è¿›è¡Œæ”¯æŒåº¦åˆ¤æ–­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#3.æ„é€ é•¿åº¦ä¸º2å¼€å§‹çš„é¢‘ç¹æ•°æ®é›†</span></span><br><span class="line">k=<span class="number">2</span></span><br><span class="line"><span class="keyword">while</span>(len(L[k<span class="number">-2</span>])&gt;<span class="number">0</span>):</span><br><span class="line"><span class="comment">#3.1å¾—åˆ°æ„é€ çš„é¢‘ç¹æ•°æ®é›†</span></span><br><span class="line">Ck=aprioriGen(L[k<span class="number">-2</span>],k)</span><br><span class="line"><span class="comment">#3.2åˆ¤æ–­æ˜¯å¦æ˜¯é¢‘ç¹é¡¹</span></span><br><span class="line">Lk,Suk=scanD(D,Ck,minSupport)</span><br><span class="line"></span><br><span class="line">L.append(Lk)</span><br><span class="line"><span class="comment">#å­—å…¸æ’å…¥/æ›´æ–°æ•°å€¼</span></span><br><span class="line">supportData.update(Suk)</span><br><span class="line">k=k+<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>3.2 æ„é€ é•¿åº¦å¤§äº2çš„é¢‘ç¹é›†åˆ</p>
<p>æ³¨ï¼šè¿™é‡Œæœ‰ä¸ªå°æŠ€å·§ï¼šå–å‰k-2ä¸ªé›†åˆï¼Œå½“é•¿åº¦ç›¸åŒæ—¶åˆå¹¶åˆ™ä¸ºè¯¥æ•°é‡ä¸‹é›†åˆæ„æˆçš„å€™é€‰é›†ï¼Œå¦‚k=2æ—¶ï¼Œæ­¤æ—¶è¾“å…¥çš„L[k-2]={1},{2},{3},å–å‰k-2ä¸ªï¼Œåˆ™æ˜¯{1},{2},åˆå¹¶ä¸º{1,2}ï¼Œæ¯æ¬¡iä»0å¼€å§‹å–å€¼ï¼Œä¸‹ä¸€å±‚å¾ªç¯jä»i+1å¼€å§‹å–å€¼ï¼Œåˆ™å¾—åˆ°k=2æ—¶çš„å€™é€‰é›†ä¸º{1,2},{1,3},{2,3}</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(L)):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>,len(L)):</span><br><span class="line">		<span class="comment">#å–å‰k-2ä¸ªä½œä¸ºé›†åˆï¼Œå¦‚æœç›¸åŒåˆ™åˆå¹¶ï¼Œå³ä¸ºä¸Šä¸€å±‚å¾—å‡ºä¸‹ä¸€å±‚çš„é›†åˆ</span></span><br><span class="line">		L1=list(L[i])[:k<span class="number">-2</span>]<span class="comment">#å–å‡ºä¸¤ä¸ªé›†åˆå‰k-1ä¸ªå…ƒç´ list[:]ä»å¼€å§‹åˆ°æœ«å°¾ä½ç½®</span></span><br><span class="line">		L2=list(L[j])[:k<span class="number">-2</span>]</span><br><span class="line">		L1.sort()</span><br><span class="line">		L2.sort()</span><br><span class="line">		<span class="keyword">if</span>(L1==L2):</span><br><span class="line">			retList.append(L[i]|L[j])</span><br></pre></td></tr></table></figure>



<h3 id="æŒ–æ˜å…³è”è§„åˆ™"><a href="#æŒ–æ˜å…³è”è§„åˆ™" class="headerlink" title="æŒ–æ˜å…³è”è§„åˆ™"></a>æŒ–æ˜å…³è”è§„åˆ™</h3><p>æ ¹æ®pçš„ç½®ä¿¡åº¦=supprot (p|q) /support (p)æ±‚å‡ºé¢‘ç¹é›†çš„ç½®ä¿¡åº¦</p>
<p>æ€»ä½“æ€è·¯ï¼š</p>
<p>è¾“å…¥çš„é¢‘ç¹é›†åˆï¼Œæ”¯æŒåº¦</p>
<p>ï¼ˆ1ï¼‰å•å…ƒç´ çš„é¢‘ç¹é›†æ²¡æœ‰å…³è”è§„åˆ™ï¼Œæ‰€ä»¥ä»L[1]å¼€å§‹éå†</p>
<p>ï¼ˆ2ï¼‰å¯¹L[i]ä¸­çš„æ¯ä¸ªå•é¡¹ï¼Œæ„é€ å‡ºä¸é‡å¤çš„å•ä¸ªå…ƒç´ é›†åˆç»„æˆçš„åˆ—è¡¨H</p>
<p>å½“åªæœ‰ä¸¤ä¸ªå…ƒç´ æ—¶ï¼Œç›´æ¥å¾—åˆ°å…³è”è§„åˆ™</p>
<p>å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å…ƒç´ æ—¶ï¼Œä¸æ–­æ„é€ 2ä¸ªå…ƒç´ åŠä»¥ä¸Šçš„ä¸é‡å¤å­é›†æ¥å¾—å‡ºå…³è”è§„åˆ™</p>
<p>1.æ„é€ 2ä¸ªå…ƒç´ çš„é¢‘ç¹é›†åˆçš„ç½®ä¿¡åº¦</p>
<p>è¾“å…¥é¢‘ç¹é¡¹é›†å’Œåªæœ‰å•ä¸ªå…ƒç´ çš„åˆ—è¡¨H</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> freq <span class="keyword">in</span> H:</span><br><span class="line">		conf=supportData[freqSet]/supportData[freqSet-freq]</span><br><span class="line">		<span class="keyword">if</span>(conf&gt;minConf):</span><br><span class="line">			print(freqSet-freq,<span class="string">"-&gt;"</span>,freq,<span class="string">":"</span>,conf)</span><br><span class="line">			br1.append((freqSet-freq,freq,conf))</span><br><span class="line">			cbr1.append(freq)</span><br></pre></td></tr></table></figure>

<p>2.æ„é€ 2ä¸ªå…ƒç´ ä»¥ä¸Šçš„é¢‘ç¹é›†åˆçš„ç½®ä¿¡åº¦</p>
<p>è¾“å…¥å•å…ƒç´ çš„é¢‘ç¹é›†åˆï¼Œåœ¨æ­¤åŸºç¡€ä¸Šä¸æ–­æ ¹æ®2ä¸ªå…ƒç´ ä»¥ä¸Šçš„é¢‘ç¹é›†åˆåˆå¹¶ï¼Œå¾—å‡ºä¸é‡å¤çš„é›†åˆå…ƒç´ ï¼Œå¹¶å¾—å‡ºå…³è”è§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m=len(H[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">if</span>(len(freqSet)&gt;(m+<span class="number">1</span>)):</span><br><span class="line">	hmq=aprioriGen(H,m+<span class="number">1</span>) <span class="comment">#å¾—å‡º2ä¸ªå…ƒç´ ä»¥ä¸Šçš„é¢‘ç¹é›†åˆ</span></span><br><span class="line">	hmq=calConf(freqSet,hmq,supportData,br1,minConf)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(len(hmq)&gt;<span class="number">1</span>):</span><br><span class="line">		ruleFromConf(freqSet,hmq,supportData,br1,minConf)</span><br></pre></td></tr></table></figure>

<p>3.å°†å•ä¸ªå…ƒç´ å¾—å‡ºçš„å…³è”è§„åˆ™å’Œå¤šä¸ªå…ƒç´ çš„é¢‘ç¹é›†å¾—å‡ºçš„å…³è”è§„åˆ™åˆå¹¶</p>
<p>æ ¹æ®è¾“å…¥çš„é¢‘ç¹é›†åˆï¼Œæ”¯æŒåº¦ä¸­ï¼ŒL[1]æ˜¯åŒ…å«2ä¸ªå…ƒç´ çš„é¢‘ç¹é›†ï¼ŒL[2]æ˜¯åŒ…å«3ä¸ªå…ƒç´ çš„é¢‘ç¹é›†</p>
<p>å½“æ—¶2ä¸ªå…ƒç´ çš„é¢‘ç¹é›†åˆæ—¶ï¼Œç›´æ¥æ ¹æ®å…¬å¼å¾—å‡ºç½®ä¿¡åº¦ï¼Œå³å…³è”è§„åˆ™ï¼Œå½“æ—¶å¤šä¸ªå…ƒç´ çš„é¢‘ç¹é›†åˆæ—¶ï¼Œéœ€è¦å°†å­é›†åˆå¹¶å¾—å‡ºå…³è”è§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(L)):</span><br><span class="line">	<span class="keyword">for</span> freq <span class="keyword">in</span> L[i]:</span><br><span class="line">		H1=[frozenset([item]) <span class="keyword">for</span> item <span class="keyword">in</span> freq]</span><br><span class="line">     <span class="comment">#å¤šä¸ªå…ƒç´ çš„é¢‘ç¹é›†åˆ</span></span><br><span class="line">		<span class="keyword">if</span>(i&gt;<span class="number">1</span>):</span><br><span class="line">			ruleFromConf(freq,H1,supportData,bigRulesList,minConf)</span><br><span class="line">     <span class="comment">#å•ä¸ªå…ƒç´ çš„é¢‘ç¹é›†åˆ</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			calConf(freq,H1,supportData,bigRulesList,minConf)</span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨å®ä¾‹"><a href="#åº”ç”¨å®ä¾‹" class="headerlink" title="åº”ç”¨å®ä¾‹"></a>åº”ç”¨å®ä¾‹</h2><p>é—®é¢˜ï¼šå‘ç°æ¯’è˜‘è‡çš„ç›¸ä¼¼ç‰¹å¾</p>
<p>æ•°æ®é›†ï¼šåŸå§‹æ•°æ®é›†åœ¨UCIä¸Šï¼Œä½¿ç”¨å…³è”è§„åˆ™éœ€è¦æŠŠæ ·æœ¬æ•°æ®è½¬æ¢ä¸ºç‰¹å¾é›†åˆï¼Œæœ‰äººåšäº†è§£æï¼Œç›´æ¥ä½¿ç”¨è¯¥æ•°æ®é›†</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200409183650.png" alt="æ¯’è˜‘è‡æ•°æ®"></p>
<p>ç¬¬ä¸€åˆ—1ä»£è¡¨æ— æ¯’ï¼Œ2ä»£è¡¨æœ‰æ¯’ã€‚</p>
<p>åˆ©ç”¨aprioriç®—æ³•å¾—å‡ºé¢‘ç¹é›†åˆï¼ŒæŸ¥çœ‹æœ‰æ¯’ç‰¹å¾ä¸€èˆ¬å’Œå“ªäº›ç‰¹å¾ä¸€èµ·å‡ºç°ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡å…¶ä»–ç‰¹å¾åˆ†è¾¨å‡ºæ¯’è˜‘è‡ã€‚</p>
<p>æ ¹æ®å¾—å‡ºçš„é¢‘ç¹é¡¹é›†ï¼Œæ‰¾åˆ°é•¿åº¦ä¸º2çš„é¢‘ç¹é¡¹é›†ä¸­æœ‰æ¯’è˜‘è‡ç‰¹å¾çš„é›†åˆä¸º</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200409184446.png" alt="æ¯’è˜‘è‡é¢‘ç¹é›†"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data=apriori.loadMushroomData(<span class="string">"mushroom.dat"</span>)</span><br><span class="line">L,supportData=apriori.apriori(data,<span class="number">0.3</span>)</span><br><span class="line">print(L)</span><br><span class="line">print(supportData)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> L[<span class="number">1</span>]:</span><br><span class="line">	<span class="keyword">if</span> &#123;<span class="number">2</span>&#125;.issubset(item):</span><br><span class="line">		print(item)</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–é•¿åº¦çš„é¢‘ç¹é¡¹é›†æŸ¥çœ‹</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>å…³è”åˆ†æ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰â€”â€”åˆ©ç”¨å›å½’é¢„æµ‹æ•°å€¼å‹æ•°å€¼</title>
    <url>/blogs/regression/</url>
    <content><![CDATA[<h2 id="ç®—æ³•ä½œç”¨"><a href="#ç®—æ³•ä½œç”¨" class="headerlink" title="ç®—æ³•ä½œç”¨"></a>ç®—æ³•ä½œç”¨</h2><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>ä¹‹å‰çš„ç›‘ç£å­¦ä¹ æ–¹æ³•å¦‚ï¼šè´å¶æ–¯åˆ†ç±»ã€logisticå›å½’ã€svmæ”¯æŒå‘é‡æœºéƒ½æ˜¯å°†æ•°æ®ç‚¹åˆ†æˆå¯¹åº”ç±»ï¼Œè¿™é‡Œæ˜¯åˆ©ç”¨å›å½’å¯¹è¿ç»­å‹æ•°å€¼é¢„æµ‹ï¼Œå³ç»™å‡ºä¸€ä¸ªæ•°æ®èƒ½é¢„æµ‹å…¶è¾“å‡ºã€‚</p><p>è¿™é‡Œä¸»è¦è®¨è®ºçº¿æ€§å›å½’ï¼Œé€šè¿‡æ‰¾åˆ°çº¿æ€§å›å½’ä¸­çš„ç³»æ•°æ„é€ å›å½’æ–¹ç¨‹æ¥é¢„æµ‹æ•°å€¼ã€‚ç®—æ³•æ ¸å¿ƒï¼šæ±‚å›å½’ç³»æ•°ã€‚</p><h3 id="â€œå›å½’â€çš„å«ä¹‰"><a href="#â€œå›å½’â€çš„å«ä¹‰" class="headerlink" title="â€œå›å½’â€çš„å«ä¹‰"></a>â€œå›å½’â€çš„å«ä¹‰</h3><p>å›å½’æ˜¯ç”¨æ¥é¢„æµ‹ç›®æ ‡å€¼çš„è¾“å‡ºï¼Œä¾‹å¦‚ç»™å®šä¸€ä¸ªxï¼Œå®ƒæ»¡è¶³æ–¹ç¨‹y=a*x+bï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½é€šè¿‡å…¬å¼å¾—å‡ºxçš„è¾“å‡ºã€‚ç”¨å›å½’æ¥é¢„æµ‹ä¹Ÿç±»ä¼¼äºè¿™ä¸ªè¿‡ç¨‹ï¼Œä¸Šé¢æåˆ°çš„æ–¹ç¨‹æ˜¯å›å½’ä¸­çš„å›é¡¾æ–¹ç¨‹ï¼Œä¸»è¦æ˜¯éœ€è¦ç¡®å®šå›å½’ç³»æ•°aã€bï¼Œè¿™é‡Œè®°ä¸ºwï¼Œå°†æ‰€æœ‰ç‰¹å¾ä¹˜ä»¥å›å½’ç³»æ•°å³å¯ä»¥å¾—åˆ°é¢„æµ‹å€¼ã€‚</p><a id="more"></a>


<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><p>å›å½’çš„ç›®çš„æ˜¯ä¸ºç¡®å®šå›å½’ç³»æ•°wï¼Œå³æ‰¾åˆ°è¯¯å·®æœ€å°çš„wï¼Œè¯¯å·®æ˜¯æŒ‡å®é™…å€¼yå‡å»é¢„æµ‹å€¼yhatï¼Œä¸ºäº†ä½¿å¾—è¯¯å·®ä¸­çš„æ­£å€¼å’Œè´Ÿå€¼æŠµæ¶ˆæ‰ï¼Œä¸€èˆ¬é‡‡ç”¨å¹³æ–¹è¯¯å·®æ¥æ‰¾åˆ°æœ€ä¼˜wï¼Œå¹³æ–¹è¯¯å·®å®šä¹‰ä¸ºï¼šâˆ‘ï¼ˆy-w * x)^2ï¼Œå¯¹è¯¥å¼å­æ±‚å¯¼åŒ–ç®€å¯å¾—w=(x^T * x)^-1 * x^T * yï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¾“å…¥çš„xå’Œyçš„å€¼æ±‚å¾—wï¼Œè¿™æ ·å°±èƒ½å»ºç«‹å‡ºå›å½’æ–¹ç¨‹å³å­¦ä¹ æ¨¡å‹ã€‚</p>
<p>wçš„ç­‰å¼ä¸­éœ€è¦å¯¹x^T * xæ±‚é€†çŸ©é˜µï¼Œå› æ­¤åœ¨è®¡ç®—ä¹‹å‰éœ€è¦åˆ¤æ–­è¯¥çŸ©é˜µæ˜¯å¦å¯é€†ï¼Œå¯ä»¥é€šè¿‡è¡Œåˆ—å¼çš„å€¼åˆ¤æ–­ã€‚</p>
<h3 id="æ ‡å‡†çº¿æ€§å›å½’"><a href="#æ ‡å‡†çº¿æ€§å›å½’" class="headerlink" title="æ ‡å‡†çº¿æ€§å›å½’"></a>æ ‡å‡†çº¿æ€§å›å½’</h3><p>ï¼ˆ1ï¼‰åº”ç”¨åœºæ™¯åŠåŸç†</p>
<p>åº”ç”¨åœºæ™¯ï¼šå‡ ä¹æ‰€æœ‰æ•°æ®éƒ½å¯ä»¥ç”¨çº¿æ€§å›å½’æ¥æ‹Ÿåˆæ•°æ®</p>
<p>åŸç†ï¼šä½¿ç”¨w=(x^T * x)^-1 * x^T * yæ±‚è§£å›å½’ç³»æ•°</p>
<p>ï¼ˆ2ï¼‰ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standRegres</span><span class="params">(x,y)</span>:</span></span><br><span class="line">  xMat=mat(x)</span><br><span class="line">  yMat=mat(y).transpose()</span><br><span class="line">  m,n=shape(xMat)</span><br><span class="line">  xTx=xMat.T*xMat</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#åˆ¤æ–­æ˜¯å¦å¯é€†</span></span><br><span class="line">  <span class="keyword">if</span>(linalg.det(xTx)==<span class="number">0</span>):</span><br><span class="line">    print(<span class="string">"è¡Œåˆ—å¼ä¸å¯é€†"</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    inv=linalg.inv(xTx)</span><br><span class="line">    ws=inv*xMat.T*yMat</span><br><span class="line">    <span class="keyword">return</span> ws</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥å¦‚å›¾æ‰€ç¤ºçš„æ•°æ®</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200401155534.png" alt="æ•°æ®"></p>
<p>æ•°æ®é›†ä¸­å‰ä¸¤åˆ—ä¸ºè¾“å…¥çš„ç‰¹å¾ï¼Œæœ€åä¸€åˆ—æ˜¯é¢„æµ‹å€¼ï¼Œå…¶ä¸­ç¬¬0åˆ—æ˜¯æ‰‹åŠ¨è®¾ç½®ä¸º1ï¼Œä¸ºäº†å¾—å‡ºå›å½’æ–¹ç¨‹ä¸­çš„å¸¸æ•°é¡¹ï¼Œä½¿ç”¨xMat*wså³å¯å¾—åˆ°é¢„æµ‹å€¼ï¼Œåœ¨å›¾åƒä¸­å¯¹ç¬¬ä¸€åˆ—æ•°æ®ç”»å‡ºæ‹Ÿåˆçš„ç›´çº¿ï¼šplot(xMat[:,1],yhat)</p>
<p>ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200401161414.png" alt="çº¿æ€§å›å½’"></p>
<p>åˆ¤æ–­æ¨¡å‹çš„å¥½åå¯ä»¥é€šè¿‡ç›¸å…³ç³»æ•°ï¼Œä½¿ç”¨corrcoef(yMat,yHat)ï¼Œå¯å¾—</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200401161238.png" alt="ç›¸å…³ç³»æ•°"></p>
<p>å¯ä»¥çœ‹å‡ºæ¨¡å‹å¤§è‡´è´´åˆæ•°æ®ã€‚</p>
<h3 id="å±€éƒ¨åŠ æƒçº¿æ€§å›å½’"><a href="#å±€éƒ¨åŠ æƒçº¿æ€§å›å½’" class="headerlink" title="å±€éƒ¨åŠ æƒçº¿æ€§å›å½’"></a>å±€éƒ¨åŠ æƒçº¿æ€§å›å½’</h3><p>ï¼ˆ1ï¼‰åº”ç”¨åœºæ™¯åŠåŸç†</p>
<p>åº”ç”¨åœºæ™¯ï¼šç”±æ ‡å‡†çº¿æ€§å›å½’æ•ˆæœå¯ä»¥çœ‹å‡ºæ¨¡å‹å­˜åœ¨æ¬ æ‹Ÿåˆï¼Œæ•°æ®ç‚¹å’Œç›´çº¿åªèƒ½å¤§è‡´åŒ¹é…ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å±€éƒ¨åŠ æƒçº¿æ€§å›å½’ï¼Œå¯¹æ¯ä¸ªæ•°æ®ç‚¹å¼•å…¥æƒé‡ï¼Œé€šè¿‡æ ¸å‡½æ•°å¯¹å‘¨å›´çš„ç‚¹èµ‹æƒé‡w(i,i)=exp(|x(i)-x)|/-2k^2ï¼Œè¿™é‡Œçš„kæ˜¯ç”±ç”¨æˆ·å„å¤„éœ€è¦ç»™å‘¨å›´çš„ç‚¹èµ‹äºˆå¤šå¤§çš„æƒé‡ã€‚</p>
<p>åŸç†ï¼šå›å½’ç³»æ•°w=(x^T * w * x)^-1 * w *x^T * y</p>
<p>ï¼ˆ2ï¼‰ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å±€éƒ¨åŠ æƒçº¿æ€§å›å½’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lwlr</span><span class="params">(testPoint,x,y,k)</span>:</span></span><br><span class="line">  xMat=mat(x)</span><br><span class="line">  yMat=mat(y).transpose()</span><br><span class="line">  m,n=shape(xMat)</span><br><span class="line">  <span class="comment">#åˆ›å»ºæƒé‡å¯¹è§’çŸ©é˜µ</span></span><br><span class="line">  w=mat(eye(m))</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    diff=testPoint-xMat[i,:]</span><br><span class="line">    <span class="comment">#é€šè¿‡é«˜æ–¯æ ¸èµ‹äºˆæƒé‡ï¼Œè¶Šé è¿‘ç‚¹(iï¼Œi),æƒé‡è¶Šå¤§</span></span><br><span class="line">    w[i,i]=exp(diff*diff.T)/(<span class="number">-2</span>*k**<span class="number">2</span>)</span><br><span class="line">  xTx=xMat.T*w*xMat</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#åˆ¤æ–­æ˜¯å¦å¯é€†</span></span><br><span class="line">  <span class="keyword">if</span>(linalg.det(xTx)==<span class="number">0</span>):</span><br><span class="line">    print(<span class="string">"è¡Œåˆ—å¼ä¸å¯é€†"</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    inv=linalg.inv(xTx)</span><br><span class="line">    ws=inv*w*xMat.T*yMat</span><br><span class="line">    <span class="keyword">return</span> testPoint*ws <span class="comment">#è¿”å›å¯¹è¯¥ç‚¹çš„é¢„æµ‹å€¼ï¼Œéå†æ•°æ®é›†xmatï¼Œåˆ™å¯ä»¥å¾—åˆ°æ‰€æœ‰æ•°çš„é¢„æµ‹è¾“å‡º</span></span><br></pre></td></tr></table></figure>

<p>ç”»å›¾æ—¶éœ€è¦å°†æ•°æ®é‡æ–°æ’åº</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sid=argsort(xmat[:,<span class="number">1</span>],axis=<span class="number">0</span>)<span class="comment">#ç¬¬ä¸€åˆ—æ•°æ®æŒ‰åºæ’åˆ—è·å¾—ä½ç½®</span></span><br><span class="line">xcopy=xmat[sid][:,<span class="number">0</span>,:]<span class="comment">#å–ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—</span></span><br><span class="line">plot(xcopy[:,<span class="number">1</span>],yhat[sid])</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200401170052.png" alt="å±€éƒ¨å›å½’"></p>
<p>å¯¹uciä¸Šé²é±¼å¹´é¾„è¿›è¡Œæµ‹è¯•ï¼Œå½“ä½¿ç”¨ä¸åŒçš„å‚æ•°è¿è¡Œå¯å¾—ï¼Œå½“å‚æ•°è¶Šå¤§ï¼Œåœ¨æµ‹è¯•é›†ä¸Šè¯¯å·®è¶Šå¤§ï¼Œä½†æ˜¯å½“å‚æ•°è¶Šå¤§ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè¯¯å·®è¶Šå°ï¼Œå› æ­¤éœ€è¦æ ¹æ®æµ‹è¯•é›†è¯¯å·®é€‰æ‹©åˆé€‚æ¨¡å‹ã€‚</p>
<p>è¿™é‡Œå‚æ•°é€‰æ‹©0.1ã€1ã€10ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200401170423.png" alt="ä¸åŒå‚æ•°"></p>
<h3 id="ç¼©å‡ç³»æ•°"><a href="#ç¼©å‡ç³»æ•°" class="headerlink" title="ç¼©å‡ç³»æ•°"></a>ç¼©å‡ç³»æ•°</h3><p>ä»¥ä¸‹ä¸¤ç§ç®—æ³•å±äºç¼©å‡ç³»æ•°ï¼Œå³é€šè¿‡å°†ä¸€äº›ä¸é‡è¦çš„ç‰¹å¾ç¼©å‡è‡³0ï¼Œæ¥é™ä½æ¨¡å‹å¤æ‚åº¦ï¼Œå‡å°è¯¯å·®ã€‚å› ä¸ºå½“æ¨¡å‹è¶Šå¤æ‚ï¼Œè¯¯å·®å°±ä¼šè¶Šå¤§ã€‚ç¼©å‡ç³»æ•°ä¹Ÿéœ€è¦æ ¹æ®å…·ä½“æ•°æ®é›†é€‰æ‹©è¯¯å·®å°çš„æ¨¡å‹ã€‚</p>
<h3 id="å²­å›å½’"><a href="#å²­å›å½’" class="headerlink" title="å²­å›å½’"></a>å²­å›å½’</h3><p>ï¼ˆ1ï¼‰åº”ç”¨åœºæ™¯åŠåŸç†</p>
<p>åº”ç”¨åœºæ™¯ï¼šå½“æ•°æ®ç‰¹å¾å¤šä½™æ•°æ®ç‚¹ä¸ªæ•°æ—¶ï¼Œæ±‚è§£wçš„å…¬å¼ä¸­xtxä¼šæ˜¯å¥‡å¼‚çŸ©é˜µï¼›æˆ–è€…å½“å‡ºç°æ•°æ®ç‚¹ç‰¹å¾è¿‡å¤šï¼Œéœ€è¦ç¼©å‡ç‰¹å¾çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨å²­å›å½’ã€‚å²­å›å½’å› ä¸ºå¼•å…¥äº†å¯¹è§’çŸ©é˜µIï¼Œå…¶ä¸­å¯¹è§’çŸ©é˜µä¸ºn*nçŸ©é˜µï¼Œå…¶ä¸­n=æ•°æ®é›†ä¸­ç‰¹å¾çš„æ•°é‡ï¼Œå¯¹è§’çº¿ä¸Šå‡æ˜¯1ï¼Œå½¢ä¼¼å²­ï¼Œæ‰€ä»¥ç§°ä¸ºå²­å›å½’ã€‚å½“å¼•å…¥å•ä½çŸ©é˜µIä¹‹åï¼Œå¯ä»¥ä¿è¯çŸ©é˜µå¯é€†ã€‚</p>
<p>åŸç†ï¼šåœ¨å•ä½çŸ©é˜µå‰éœ€è¦ä¹˜ä»¥ä¸€ä¸ªç³»æ•°Î»ï¼Œè¿™é‡Œçš„ç³»æ•°éœ€è¦ç”¨æˆ·ç»™å‡ºã€‚</p>
<p>å›å½’ç³»æ•°w=(x^T * x+Î»I)^-1  *x^T * y</p>
<p>ï¼ˆ2ï¼‰ä»£ç </p>
<p>æ•´ä½“è¿‡ç¨‹ç±»ä¼¼äºæ ‡å‡†çº¿æ€§å›å½’ï¼Œè™½ç„¶åŠ å…¥äº†å¯¹è§’çŸ©é˜µä¹Ÿéœ€è¦åˆ¤æ–­x^T * x+Î»Iæ˜¯å¦å¯é€†ï¼Œå› ä¸ºç»™å‡ºçš„ç³»æ•°å¯èƒ½ä¸º0ï¼Œå› ä¸ºæ ¹æ®è¾“å…¥çš„Î»ä¸åŒï¼Œwsçš„ç»“æœä¼šä¸åŒï¼Œå› æ­¤ï¼Œæµ‹è¯•æ—¶å¯ä»¥è¾“å…¥30ç»„Î»ï¼Œæ ¹æ®Î»å–å€¼é€‰æ‹©è¯¯å·®æœ€å°çš„å›å½’ç³»æ•°wsã€‚</p>
<p>ï¼ˆ3ï¼‰æ³¨æ„ç‚¹â€”â€”æ•°æ®æ ‡å‡†åŒ–ä¸è¿˜åŸ</p>
<p>å› ä¸ºå²­å›å½’å¯ä»¥ç”¨æ¥ç¼©å‡æ•°æ®ç‰¹å¾ï¼Œå½“æ ‡å‡†åŒ–ä¹‹åæ‰€æœ‰æ•°æ®ç‰¹å¾åŒç­‰é‡è¦ï¼Œæ¯ä¸ªæ•°æ®ç‰¹å¾åœ¨æœ€ç»ˆå›å½’æ–¹ç¨‹ä¸­çš„å¤§å°ä¼šä¸åŒï¼Œå°çš„æ•°æ®è¯´æ˜è¯¥å¯¹åº”ç‰¹å¾ç›¸æ¯”äºå…¶ä»–æ›´ä¸é‡è¦ï¼Œå¦‚æœéœ€è¦ä¸¢å¼ƒç‰¹å¾ï¼Œå¯ä»¥ä»å°çš„æ•°æ®å¼€å§‹ã€‚</p>
<p>æ‰€ä»¥ï¼Œå²­å›å½’ä¸­éœ€è¦å°†æ‰€æœ‰æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæœ€ç»ˆæ±‚å¾—wsä¹‹åï¼Œéœ€è¦è¿›è¡Œæ•°æ®è¿˜åŸæ‰èƒ½å¾—å‡ºæœ€ç»ˆçš„å›å½’çŸ©é˜µã€‚</p>
<p>ç”¨æ ‡å‡†åŒ–æ•°æ®è¿›è¡Œæ¨¡å‹å»ºç«‹ï¼šx=(x-xmean)/xvarï¼Œy=y-ymean</p>
<p>å½“å¾—å‡ºwsæ—¶ï¼Œå›å½’æ–¹ç¨‹åº”ä¸ºy=((x-xmean) / xvar) * ws+ymeanï¼Œå…¶ä¸­(x-xmean) /xvar * wsæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–åçš„xå¾—å‡ºé¢„æµ‹yå€¼ï¼ˆæ ‡å‡†åŒ–åçš„å€¼ï¼‰ï¼ŒåŠ ä¸Šymeanå°±æ˜¯å®é™…å€¼ã€‚</p>
<p>ï¼ˆ4ï¼‰ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standRidge</span><span class="params">(xMat,yMat,lam)</span>:</span></span><br><span class="line">  <span class="comment">#xMat=mat(x)</span></span><br><span class="line">  <span class="comment">#yMat=mat(y).transpose()</span></span><br><span class="line">  m,n=shape(xMat)</span><br><span class="line">  xTx=xMat.T*xMat+lam*eye(n)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#åˆ¤æ–­æ˜¯å¦å¯é€†</span></span><br><span class="line">  <span class="keyword">if</span>(linalg.det(xTx)==<span class="number">0</span>):</span><br><span class="line">    print(<span class="string">"è¡Œåˆ—å¼ä¸å¯é€†"</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    inv=linalg.inv(xTx)</span><br><span class="line">    ws=inv*xMat.T*yMat</span><br><span class="line">    <span class="keyword">return</span> ws</span><br><span class="line">  </span><br><span class="line"><span class="comment">#å¾—åˆ°30ä¸ªç³»æ•°ä¸­wsçš„å˜åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ridgeTest</span><span class="params">(x,y)</span>:</span></span><br><span class="line">  numIter=<span class="number">30</span></span><br><span class="line">  xMat=mat(x)</span><br><span class="line">  yMat=mat(y).transpose()</span><br><span class="line">  m,n=shape(xMat)</span><br><span class="line">  xMean=mean(xMat,axis=<span class="number">0</span>)</span><br><span class="line">  xVar=var(xMat,axis=<span class="number">0</span>)</span><br><span class="line">  yMean=mean(yMat,axis=<span class="number">0</span>)</span><br><span class="line">  xTest=(xMat-xMean)/xVar</span><br><span class="line">  yTest=yMat-yMean</span><br><span class="line">  <span class="comment">#å°†30æ¬¡ç³»æ•°ä¿å­˜ä¸‹æ¥</span></span><br><span class="line">  returnMat=zeros((numIter,n))</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">    ws=standRidge(xTest,yTest,exp(i<span class="number">-10</span>))</span><br><span class="line">    returnMat[i,:]=ws</span><br><span class="line">   <span class="keyword">return</span> returnMat</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—å‡ºlogÎ»å’Œå›å½’ç³»æ•°ä¹‹é—´çš„å…³ç³»</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200402165626.png" alt="logÎ»å’Œå›å½’ç³»æ•°å…³ç³»å›¾"></p>
<p>å®é™…åº”ç”¨ä¸­å¯ä»¥é€šè¿‡å¯¹wsMatçŸ©é˜µæ±‚é¢„æµ‹å€¼ï¼Œæ ¹æ®é¢„æµ‹å€¼-çœŸå®å€¼çš„å¹³æ–¹ï¼Œå†æ±‚å’Œå¾—å‡ºå¹³æ³•è¯¯å·®ï¼Œæ‰¾åˆ°ä½¿å¾—å¹³æ³•è¯¯å·®æœ€å°çš„å›å½’ç³»æ•°çŸ©é˜µå¯¹åº”çš„Î»åˆ™ä¸ºæœ€ä½³ç³»æ•°ã€‚</p>
<h3 id="å‰å‘é€æ­¥å›å½’"><a href="#å‰å‘é€æ­¥å›å½’" class="headerlink" title="å‰å‘é€æ­¥å›å½’"></a>å‰å‘é€æ­¥å›å½’</h3><p>ï¼ˆ1ï¼‰åº”ç”¨åœºæ™¯åŠåŸç†</p>
<p>åº”ç”¨åœºæ™¯ï¼šè¯¥ç®—æ³•å±äºè´ªå¿ƒç®—æ³•ï¼Œæ¯æ¬¡éƒ½é€‰æ‹©æ­£æ–¹å‘å’Œè´Ÿæ–¹å‘å˜åŒ–å¾ˆå°çš„æ­¥é•¿ï¼Œæ¥è®¡ç®—å›å½’ç³»æ•°ï¼Œæ¯æ¬¡é€‰æ‹©è¯¯å·®æœ€å°çš„å›å½’ç³»æ•°ï¼Œå‰å‘é€æ­¥å›å½’ä¹Ÿç”¨äºç¼©å‡ç‰¹å¾ï¼Œå½“ä¸é‡è¦çš„ç‰¹å¾åœ¨è¿­ä»£æ¬¡æ•°å¾ˆå°çš„æ—¶å€™ä¸ä¼šå¯¹æ•°æ®äº§ç”Ÿå½±å“å³å¯¹äºç‰¹å¾å‘é‡åœ¨å›å½’æ–¹ç¨‹ä¸­ç³»æ•°ç­‰äº0ï¼Œå› ä¸ºéœ€è¦ç¼©å‡ç‰¹å¾ï¼Œè§‚å¯Ÿç‰¹å¾çš„é‡è¦æ€§ï¼Œæ•°æ®ä¹Ÿéœ€è¦è¿›è¡Œæ ‡å‡†åŒ–ã€‚</p>
<p>ï¼ˆ2ï¼‰ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standWise</span><span class="params">(x,y,eps=<span class="number">0.001</span>,numIter=<span class="number">300</span>)</span>:</span></span><br><span class="line">  xMat=mat(x)</span><br><span class="line">  yMat=mat(y).transpose()</span><br><span class="line">  m,n=shape(xMat)</span><br><span class="line">  xMean=mean(xMat,axis=<span class="number">0</span>)</span><br><span class="line">  xVar=var(xMat,axis=<span class="number">0</span>)</span><br><span class="line">  yMean=mean(yMat,axis=<span class="number">0</span>)</span><br><span class="line">  xMat=(xMat-xMean)/xVar</span><br><span class="line">  yMat=yMat-yMean</span><br><span class="line">  <span class="comment">#å›å½’ç³»æ•°åˆå§‹åŒ–</span></span><br><span class="line">  ws=zeros((n,<span class="number">1</span>))</span><br><span class="line">  wsMax=ws.copy()</span><br><span class="line">  returnMat=zeros((numIter))</span><br><span class="line">  <span class="comment">#åœ¨è¿­ä»£æ¬¡æ•°ä¸­è¿›è¡Œç§»åŠ¨wsæ–¹å‘</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">    lossErr=inf</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">      <span class="keyword">for</span> sign <span class="keyword">in</span> [<span class="number">-1</span>,<span class="number">1</span>]:</span><br><span class="line">        wsTest=ws.copy()</span><br><span class="line">        wsTest[j]+=eps*sign</span><br><span class="line">        yHat=xMat*ws</span><br><span class="line">        err=rssRrr(yMat.A,yHat.A)</span><br><span class="line">        <span class="keyword">if</span>(err&lt;lossErr):</span><br><span class="line">          lossErr=err</span><br><span class="line">          wsMax=ws</span><br><span class="line">      ws=wsMax</span><br><span class="line">      returnMat[i,:]=ws.T</span><br><span class="line">    <span class="keyword">return</span> returnMat</span><br></pre></td></tr></table></figure>

<p>å¾—å‡ºåœ¨é²é±¼æ•°æ®é›†ä¸Šï¼Œæ­¥é•¿0.001ï¼Œè¿­ä»£300æ¬¡åå›å½’ç³»æ•°å’Œè¿­ä»£æ¬¡æ•°çš„æ•ˆæœå›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200402173125.png" alt="å›å½’ç³»æ•°å’Œè¿­ä»£æ¬¡æ•°å…³ç³»å›¾"></p>
<h3 id="è¡¡é‡è¯¯å·®"><a href="#è¡¡é‡è¯¯å·®" class="headerlink" title="è¡¡é‡è¯¯å·®"></a>è¡¡é‡è¯¯å·®</h3><p>åˆ¤æ–­ä¸€ä¸ªæ¨¡å‹çš„å¥½åï¼Œéœ€è¦é€šè¿‡é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å€¼è¿›è¡Œè®¡ç®—ï¼Œä¸ºäº†æŠµæ¶ˆæ­£è´Ÿå€¼ï¼Œè¿™é‡Œé‡‡ç”¨å¹³æ–¹å’Œå½¢å¼ï¼Œå‡è®¾çœŸå®å€¼ä¸ºymatï¼Œé¢„æµ‹å€¼ä¸ºyhatï¼Œåˆ™è¯¯å·®error=sum(ymat-yhat)**2ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„æ˜¯å¯¹åº”ä½ç½®ç›¸åŠ ï¼Œæ‰€ä»¥çœŸå®å€¼å’Œé¢„æµ‹å€¼éƒ½éœ€è¦è½¬æ¢ä¸ºæ•°ç»„å½¢å¼è¿›è¡Œè®¡ç®—ã€‚</p>
<p>ymatå’Œyhatéœ€è¦æ ¼å¼ä¸€è‡´ï¼Œå‡è®¾ymatä¸ºçŸ©é˜µï¼Œåˆ™äºŒè€…éœ€è¦è½¬æ¢ä¸ºymat.Aï¼Œyhat.Aï¼›å¦‚æœymatæ˜¯åˆ—è¡¨ï¼Œåˆ™åˆ™äºŒè€…éœ€è¦è½¬æ¢ä¸ºarray(ymat)ï¼Œyhat.T.A</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rssRrr</span><span class="params">(ymat,yhat)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> sum((ymat-yhat)**<span class="number">2</span>)<span class="comment">#ymatå’Œyhatéƒ½éœ€è¦è½¬æ¢ä¸ºæ•°ç»„å½¢å¼è¿›è¡Œè®¡ç®—</span></span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨å®ä¾‹"><a href="#åº”ç”¨å®ä¾‹" class="headerlink" title="åº”ç”¨å®ä¾‹"></a>åº”ç”¨å®ä¾‹</h2><h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h3><p>é¢„æµ‹ä¹é«˜ç©å…·çš„ä»·æ ¼ï¼šæ ¹æ®ç»™å‡ºçš„ä¹é«˜é”€å”®ç½‘é¡µä¸­ä¸åŒå¹´ä»½çš„ä¹é«˜å¥—è£…çš„ä»·æ ¼å»ºç«‹å›å½’æ¨¡å‹ï¼Œä»è€Œé¢„æµ‹ç©å…·ä»·æ ¼ã€‚</p>
<h3 id="å®ç°ç»“æœ"><a href="#å®ç°ç»“æœ" class="headerlink" title="å®ç°ç»“æœ"></a>å®ç°ç»“æœ</h3><p>ï¼ˆ1ï¼‰ç½‘é¡µæ•°æ®è·å–</p>
<p>å¯¼å…¥bs4ä¸­çš„BeautifulSoupï¼Œè¯¥æ¨¡å—å¯ä»¥ç”¨æ¥è·å–ç½‘é¡µä¸­çš„æ•°æ®ï¼Œä¸»è¦æ˜¯è¯»å–htmlæ–‡ä»¶ï¼Œfind_allå¯ä»¥å¾—å‡ºå„ä¸ªå±æ€§æ¨¡å—ä¸­çš„å€¼ï¼Œå› ä¸ºä¹é«˜é”€å”®ç½‘é¡µä¸­çš„ç©å…·éƒ½æ˜¯æ”¾åœ¨tableä¸­ï¼Œå¯ä»¥è¯»å–æ¯ä¸ªtableï¼Œè·å–ç©å…·çš„æ ‡é¢˜ï¼Œæ˜¯å¦å…¨æ–°ï¼Œæ˜¯å¦å”®å‡ºï¼ˆè¡¨æ ¼ç¬¬ä¸‰åˆ—ï¼‰ï¼Œå”®å‡ºçš„ä»·æ ¼ï¼ˆè¡¨æ ¼ç¬¬4åˆ—ï¼‰ç­‰ã€‚å°†ç©å…·çš„å¹´ä»½ã€å¥—è£…æ•°é‡ã€æ˜¯å¦å…¨æ–°ã€ä»·æ ¼å­˜åˆ°åˆ—è¡¨ä¸­ï¼Œä½œä¸ºæ¨¡å‹æ•°æ®é›†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">è·å–æ•°æ®</span><br><span class="line"><span class="comment">#ä»é¡µé¢è¯»å–æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scrapePage</span><span class="params">(retX,retY,fileName,yr,numPce,OriPrice)</span>:</span></span><br><span class="line">	<span class="comment">#1.è¯»å–ç½‘é¡µ</span></span><br><span class="line">	fr=open(fileName)</span><br><span class="line">	<span class="comment">#2.ç”¨beautifulSoupå¤„ç†,æŠŠè¯»å–çš„ç½‘é¡µè½¬æ¢ä¸ºæ•°æ®</span></span><br><span class="line">	soup=BeautifulSoup(fr)</span><br><span class="line">	i=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#soupæ•°æ®å…¨éƒ¨ä»¥åˆ—è¡¨å½¢å¼è¿”å›</span></span><br><span class="line">	<span class="comment">#3.è¯»å–tableçš„é•¿åº¦ï¼Œå½“è¿˜æœ‰tableå³è¿˜æœ‰å•†å“çš„æ—¶å€™å¾ªç¯</span></span><br><span class="line">	tableCur=soup.find_all(<span class="string">'table'</span>,r=i)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(len(tableCur)&gt;<span class="number">0</span>):</span><br><span class="line">		<span class="comment">#è¯»å–å•†å“æ¯æ¬¡ï¼Œæ ¹æ®æœ‰æ— å”®å‡ºæ¥è·å–ä»·æ ¼</span></span><br><span class="line">		title=tableCur[<span class="number">0</span>].find_all(<span class="string">'a'</span>)[<span class="number">1</span>].text.lower()<span class="comment">#aæ ‡ç­¾ä¸­ç¬¬ä¸€ä¸ªæœ‰åç§°,è·å–æ–‡æœ¬å¹¶è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#3.1åˆ¤æ–­æ˜¯å¦å…¨æ–°</span></span><br><span class="line">		<span class="keyword">if</span>(title.find(<span class="string">'new'</span>)!=<span class="number">-1</span>) <span class="keyword">or</span> (title.find(<span class="string">'nstd'</span>)!=<span class="number">-1</span>):</span><br><span class="line">			newFlag=<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			newFlag=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#3.2åˆ¤æ–­æ˜¯å¦å–å‡º</span></span><br><span class="line">		<span class="comment">#è¯»å–td</span></span><br><span class="line">		sellFlag=tableCur[<span class="number">0</span>].find_all(<span class="string">'td'</span>)[<span class="number">3</span>].find_all(<span class="string">"span"</span>)</span><br><span class="line">		<span class="keyword">if</span>(len(sellFlag)==<span class="number">0</span>):<span class="comment">#æ­¤æ—¶æ²¡æœ‰å–å‡º</span></span><br><span class="line">			print(<span class="string">"the item"</span>+str(i)+<span class="string">" do not sell out"</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			soldPrice=tableCur[<span class="number">0</span>].find_all(<span class="string">'td'</span>)[<span class="number">4</span>]</span><br><span class="line">			price=soldPrice.text</span><br><span class="line">			price=price.replace(<span class="string">'$'</span>,<span class="string">''</span>)</span><br><span class="line">			price=price.replace(<span class="string">','</span>,<span class="string">''</span>)</span><br><span class="line">			<span class="keyword">if</span>(len(soldPrice)&gt;<span class="number">1</span>):</span><br><span class="line">				price=price.replace(<span class="string">'Free shipping'</span>,<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">		sellPrice=float(price)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#3.3å»æ‰ä¸å®Œæ•´çš„ä»·æ ¼</span></span><br><span class="line">		<span class="keyword">if</span>(sellPrice&gt;OriPrice*<span class="number">0.5</span>):</span><br><span class="line">			retX.append([yr,numPce,newFlag,OriPrice])</span><br><span class="line">			<span class="comment">#print(str(price)+"\t"+str(newFlag)+"\t"+title)</span></span><br><span class="line">			retY.append(sellPrice)</span><br><span class="line"></span><br><span class="line">		i=i+<span class="number">1</span></span><br><span class="line">		tableCur=soup.find_all(<span class="string">'table'</span>,r=i)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> retX,retY</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ç®—æ³•é€‰æ‹©</p>
<p>å¯ä»¥é‡‡ç”¨åæŠ˜äº¤å‰éªŒè¯ï¼šå¯ä»¥å»ºç«‹éšæœºæ•°æ®randomList=list(range(m))ï¼Œä½¿ç”¨random.shuffleæ‰“ä¹±åºåˆ—ä¸­çš„å…ƒç´ ï¼Œ90%ä½œä¸ºè®­ç»ƒé›†ï¼Œ10%ä½œä¸ºæµ‹è¯•é›†ã€‚</p>
<p>aï¼‰æ ‡å‡†çº¿æ€§å›å½’</p>
<p>ä¸ºäº†å¾—å‡ºå›å½’æ–¹ç¨‹ä¸­çš„å¸¸æ•°é¡¹ï¼Œéœ€è¦åœ¨åŸæœ‰æ•°æ®ä¸Šæ’å…¥å¸¸æ•°1ï¼Œæ–°å»ºä¸€ä¸ªå…¨ä¸º1çš„çŸ©é˜µï¼Œé™¤äº†ç¬¬ä¸€åˆ—ä¹‹å¤–å…¶ä½™åˆ—ç”¨åŸæœ‰æ•°æ®å¡«å……ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m,n=shape(lgX)</span><br><span class="line">retX=mat(ones((m,n+<span class="number">1</span>)))</span><br><span class="line">retX[:,<span class="number">1</span>:<span class="number">5</span>]=mat(lgX)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®standRegreså¾—å‡ºå›å½’ç³»æ•°ï¼Œå›å½’ç³»æ•°æ¯ä¸€åˆ—å¯¹åº”æ–¹ç¨‹ä¸­çš„ç³»æ•°å€¼ï¼Œä»¥ä¹é«˜æ•°æ®ä¸­4åˆ—æ•°æ®ä¸ºä¾‹ï¼Œy=ws[0]+ws[1] * å¹´ä»½+ws[1] * å¥—è£…æ•°é‡+ws[2] * æ˜¯å¦å…¨æ–°+ws[3] * ä»·æ ¼ï¼Œå¾—å‡ºæ–¹ç¨‹ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200402180915.png" alt="æ ‡å‡†çº¿æ€§å›å½’æ–¹ç¨‹"></p>
<p>å¯ä»¥çœ‹å‡ºæ ‡å‡†çº¿æ€§å›å½’å¾—å‡ºçš„å›å½’ç³»æ•°æœ‰äº›ä¸åˆç†çš„åœ°æ–¹ï¼Œå½“éƒ¨ä»¶æ•°é‡å¤šï¼Œä»·æ ¼ä¼šæ›´ä½ï¼Œå› æ­¤é€‰æ‹©å²­å›å½’æŸ¥çœ‹æ•ˆæœã€‚</p>
<p>bï¼‰å²­å›å½’</p>
<p>å› ä¸ºå²­å›å½’ä¸­å«æœ‰å‚æ•°ï¼Œæ ¹æ®æµ‹è¯•é›†å¾—å‡ºè¯¯å·®æœ€å°çš„å‚æ•°ï¼Œå¯¹è¯¯å·®é›†æ±‚å¹³å‡ï¼Œå¾—å‡ºæœ€å°çš„è¯¯å·®æ‰€åœ¨çš„è¡Œå³ä¸ºæœ€ä½³å›å½’ç³»æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æœ€å°çš„è¯¯å·®ä¸‹çš„å›å½’ç³»æ•°</span></span><br><span class="line">meanError=mean(testErr,axis=<span class="number">0</span>)</span><br><span class="line">minErr=min(meanError)</span><br><span class="line">minWs=wsMat[nonzero(meanError=minErr)]</span><br></pre></td></tr></table></figure>

<p>å¾—å‡ºå›å½’ç³»æ•°åéœ€è¦å¾—å‡ºå›å½’æ–¹ç¨‹ï¼Œå› ä¸ºæ˜¯ç”¨æ ‡å‡†åŒ–æ•°æ®è¿›è¡Œæ¨¡å‹å»ºç«‹ï¼šx=(x-xmean)/xvarï¼Œy=y-ymeanã€‚</p>
<p>å½“å¾—å‡ºwsæ—¶ï¼Œå›å½’æ–¹ç¨‹åº”ä¸ºy=((x-xmean) / xvar) * ws+ymeanï¼Œå…¶ä¸­(x-xmean) /xvar * wsæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–åçš„xå¾—å‡ºé¢„æµ‹yå€¼ï¼ˆæ ‡å‡†åŒ–åçš„å€¼ï¼‰ï¼ŒåŠ ä¸Šymeanå°±æ˜¯å®é™…å€¼ã€‚</p>
<p>æ‰€æœ‰å›å½’æ–¹ç¨‹å¯ä»¥å†™æˆï¼šy=x * ws/xvar -(xmean/xvar) * ws+ymeanï¼Œåé¢-(xmean/xvar) * ws+ymeanæ˜¯æ–¹ç¨‹å¾—å¸¸æ•°é¡¹ã€‚è®°ureg=ws/xvarï¼Œä»¥ä¹é«˜æ•°æ®ä¸­4åˆ—æ•°æ®ä¸ºä¾‹ï¼Œy=å¸¸æ•°é¡¹+ureg[0,0] * å¹´ä»½+ureg[0,1] * å¥—è£…æ•°é‡+ureg[0,2] * æ˜¯å¦å…¨æ–°+ureg[0,3] * ä»·æ ¼ï¼Œå¾—å‡ºæ–¹ç¨‹ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200402182822.png" alt="å²­å›å½’"></p>
<p>å› ä¸ºæµ‹è¯•é›†éšæœºé€‰å–ï¼Œæ¯æ¬¡ç»“æœç•¥æœ‰ä¸åŒã€‚å¯ä»¥çœ‹å‡ºå²­å›å½’çš„æ–¹ç¨‹æ¯”æ ‡å‡†å›å½’æ–¹ç¨‹æ‹Ÿåˆæ•ˆæœè¦å¥½ï¼Œæ›´ç¬¦åˆå®é™…ã€‚</p>
<p>è¿™æ˜¯wsç¼©å‡ç³»æ•°ä¸­ç¬¬ä¸€æ¬¡å¾—å‡ºçš„å›å½’ç³»æ•°ï¼š</p>
<blockquote>
<p>[[-1.07635546e+02]<br> [-1.54119215e+04]<br> [-1.42998055e+01]<br> [ 4.32941501e+04]]</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºç¬¬4ä¸ªç³»æ•°æœ€å¤§ï¼Œè¯´æ˜å…¶æœ€é‡è¦ï¼Œå½“åªèƒ½é€‰æ‹©ä¸€ä¸ªç‰¹å¾æ—¶ï¼Œå¯ä»¥é€‰æ‹©ç¬¬4ä¸ªç‰¹å¾ï¼Œå¦‚æœè¦é€‰æ‹©ä¸¤ä¸ªç‰¹å¾ï¼Œå¯ä»¥é€‰æ‹©ç¬¬2ä¸ªå’Œç¬¬4ä¸ªç‰¹å¾ã€‚</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”logisticå›å½’</title>
    <url>/blogs/logistic/</url>
    <content><![CDATA[<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><h3 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h3><p>ï¼ˆ1ï¼‰æ•°æ®æ‹Ÿåˆ</p><p>ç»™å‡ºä¸€äº›æ•°æ®ï¼Œç”¨ä¸€æ¡ç›´çº¿æ¥æ‹Ÿåˆè¿™äº›æ•°æ®ç§°ä¸ºlogicticå›å½’</p><p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324153824.png" alt="ç›´çº¿æ‹Ÿåˆ"></p><p>ç”¨logisticå›å½’æ¥è¿›è¡Œæ•°æ®åˆ†ç±»æ˜¯é€šè¿‡ç»™å‡ºçš„æ‰€æœ‰æ•°æ®ç‚¹æ‹Ÿåˆå‡ºåˆ†ç±»è¾¹ç•Œçš„ç›´çº¿ï¼Œç¡®å®šè¿™æ¡ç›´çº¿çš„ç³»æ•°å°±ç§°ä¸ºå›å½’ç³»æ•°ï¼Œå½“ç”¨å›å½’ç³»æ•°ä¹˜ä»¥å½“å‰ç‰¹å¾åˆ™å¾—å‡ºè¯¥æ¡ç›´çº¿ï¼š</p><p>z=w0 * x0+w1 * x1+â€¦+wn * xnï¼Œå…¶ä¸­w0 - wnæ˜¯å›å½’ç³»æ•°ï¼Œx0 - xnæ˜¯å„ä¸ªç‰¹å¾ï¼Œå¾—å‡ºçš„zæ˜¯å½“å‰ç‰¹å¾ä¸‹çš„é¢„æµ‹å€¼ã€‚</p><a id="more"></a>




<p>ä¸ºäº†è¡¨ç¤ºç›´çº¿ä¸Šä¸‹çš„æµ®åŠ¨ï¼Œéœ€è¦å°†x0è®¾ç½®ä¸º1ï¼Œè¿™æ—¶çš„w0å°±ç›¸å½“äºç›´çº¿æ–¹ç¨‹ä¸­çš„åç½®bã€‚</p>
<p>ï¼ˆ2ï¼‰åˆ†ç±»å‡½æ•°</p>
<p>å½“logisticå›å½’ç”¨ä½œäºŒå€¼åˆ†ç±»å™¨çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨sigmoidå‡½æ•°è¿›è¡Œç±»åˆ«åˆ¤å®šï¼Œsigmoidï¼ˆx)=1/1+e-xï¼Œå›¾åƒå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324154722.png" alt="sigmoid"></p>
<p>å½“z&gt;0.5æ—¶ï¼Œå‡½æ•°å€¼è¶‹è¿‘ä¸1ï¼Œå½“z&lt;0.5æ—¶ï¼Œå‡½æ•°è¶‹è¿‘äº0ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯¹å°†æ¯ä¸ªç‰¹å¾ä¹˜ä»¥å›å½’ç³»æ•°å¾—åˆ°çš„è¾“å‡ºç±»åˆ«è¿›è¡Œåˆ¤å®šã€‚</p>
<p>å› æ­¤logisticå›å½’å°±æ˜¯è¦æ±‚æœ€ä½³çš„å›å½’ç³»æ•°ï¼Œè¿™æ˜¯æ±‚è§£æœ€ä¼˜é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸Šå‡çš„æ–¹æ³•ã€‚</p>
<p>ï¼ˆ3ï¼‰å¯»æ±‚æœ€ä¼˜</p>
<p>æ¢¯åº¦ä¸Šå‡ç®—æ³•æ˜¯é€šè¿‡æ¯æ¬¡éƒ½å‘æ¢¯åº¦å˜åŒ–æœ€ä½³çš„çš„åœ°æ–¹èµ°ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜å€¼ï¼Œè¿­ä»£å…¬å¼ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324155903.png" alt="è¿­ä»£å…¬å¼"></p>
<p>å…¶ä¸­wæ˜¯å›å½’ç³»æ•°ï¼Œalphaæ˜¯æ¯æ¬¡æ²¿ç€æ¢¯åº¦æ–¹å‘å˜åŒ–çš„æ­¥é•¿ï¼Œf(w)æ˜¯æ¢¯åº¦å˜åŒ–å‡½æ•°ï¼Œå³æŸå¤±å‡½æ•°ã€‚è¿™é‡Œæ˜ç¡®ä¸€ç‚¹ï¼Œæ±‚æœ€ä½³çš„å›å½’ç³»æ•°çš„è¿‡ç¨‹ä¸­æ²¿ç€æ¢¯åº¦å˜åŒ–æœ€ä½³çš„æ–¹å‘å˜åŒ–ï¼Œè¿™é‡Œçš„æœ€ä½³å¯ä»¥ç†è§£ä¸ºæ˜¯è¯¯å·®æœ€å°ï¼Œä¹Ÿå°±æ˜¯w0 * x0+w1 * x1+â€¦+wn * xnå¾—å‡ºçš„é¢„æµ‹å€¼få’Œå®é™…å€¼ä¹‹é—´çš„è¯¯å·®æœ€å°ï¼Œé‚£ä¹ˆå°±æ˜¯æœ€ä½³çš„æ–¹å‘ï¼Œå³å¯¹æ‰€æœ‰ç‰¹å¾æ¥è¯´ f(w)=âˆ‘ï¼ˆy-f)xiï¼Œè¿™æ˜¯å¯¹å…¬å¼çš„ç›´è§‚ç†è§£ï¼Œ<a href="https://blog.csdn.net/CharlieLincy/article/details/70767791" target="_blank" rel="external nofollow noopener noreferrer">è¿™é‡Œä¹Ÿæœ‰å¯¹äººåšäº†å¯¹æ•´ä¸ªè¿‡ç¨‹çš„è¯¦ç»†æ¨å¯¼</a>ã€‚åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œlogisticå›å½’çš„æ ¸å¿ƒæ€æƒ³å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œå¯¹æ‰€æœ‰çš„å‘é‡ä¹˜ä»¥å½“å‰çš„å›å½’ç³»æ•°ï¼Œæ ¹æ®å¾—å‡ºçš„è¯¯å·®è°ƒæ•´å›å½’ç³»æ•°ï¼Œä¸æ–­å¾ªç¯ï¼Œç›´è‡³å›å½’ç³»æ•°ç¨³å®šã€‚</p>
<h3 id="å’ŒSVMçš„åŒºåˆ«"><a href="#å’ŒSVMçš„åŒºåˆ«" class="headerlink" title="å’ŒSVMçš„åŒºåˆ«"></a>å’ŒSVMçš„åŒºåˆ«</h3><p>ç›¸åŒç‚¹ï¼šäºŒè€…éƒ½æ˜¯åˆ†ç±»å™¨</p>
<p>ä¸åŒç‚¹ï¼š</p>
<p>logisticå›å½’ç”¨åˆ°äº†æ‰€æœ‰æ•°æ®ç‚¹ï¼Œsvmåªç”¨äº†é è¿‘åˆ†ç±»å¹³é¢çš„ç‚¹å³æ”¯æŒå‘é‡ã€‚</p>
<p>logisticå›å½’åˆ©ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ€æƒ³æ±‚è§£å‚æ•°ï¼Œsvmé€šè¿‡æœ€å¤§åŒ–å‡ ä½•é—´éš”æ±‚å¾—æœ€ä¼˜å¹³é¢</p>
<h2 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h2><h3 id="æ¢¯åº¦ä¸Šå‡"><a href="#æ¢¯åº¦ä¸Šå‡" class="headerlink" title="æ¢¯åº¦ä¸Šå‡"></a>æ¢¯åº¦ä¸Šå‡</h3><p>æ‰¹å¤„ç†çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰æ•°æ®ç‚¹ä¸€æ¬¡è¾“å…¥å¤„ç†</p>
<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–å›å½’ç³»æ•°ï¼Œä»¥åŠæ¯æ¬¡å‘æ¢¯åº¦æ–¹å‘å˜åŒ–çš„æ­¥é•¿</p>
<p>æ ¹æ®æ¯ä¸ªç‰¹å¾çš„ä¸ªæ•°ï¼Œå°†å›å½’ç³»æ•°åˆå§‹åŒ–ä¸º1ï¼Œå‡è®¾æœ‰3ä¸ªç‰¹å¾ï¼Œåˆ™å›å½’ç³»æ•°è¢«åˆå§‹åŒ–ä¸º3*1çš„åˆ—å‘é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m,n=shape(dataMat)</span><br><span class="line">weights=ones((n,<span class="number">1</span>))</span><br><span class="line">alpha=<span class="number">0.01</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ä¸æ–­è¿­ä»£ï¼Œç›´è‡³å›å½’ç³»æ•°ç¨³å®š</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå›å½’ç³»æ•°ç¨³å®šå¾ˆéš¾åˆ¤å®šï¼Œå› æ­¤é€šè¿‡æ§åˆ¶è¿­ä»£æ¬¡æ•°æ¥ä¿®æ­£å›å½’ç³»æ•°</p>
<p>è¿™é‡Œçš„dataMatæ ¼å¼ä¸º<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324163550.png" alt="dataMat">æ¯ä¸ªæ•°æ®ç‚¹éƒ½æœ‰ä¸‰ä¸ªç‰¹å¾</p>
<p>weightçš„æ ¼å¼ä¸º<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324164025.png" alt="weights">dataMatå’Œweightä¸¤è€…ç›¸ä¹˜ï¼Œæ‹¿ç¬¬ä¸€è¡Œæ¥è¯´å¾—åˆ°x01w0+x11w1+x21*w0ï¼Œæ¯è¡Œéƒ½å¾—å‡ºè¿™ä¸ªå€¼ï¼Œå°†æ¯è¡Œçš„ç»“æœé€šè¿‡sigmoidå‡½æ•°é¢„æµ‹å³å¯å¾—åˆ°é¢„æµ‹å¾—å€¼ï¼Œç”¨å®é™…å€¼å‡å»è¯¥å€¼ï¼Œåˆ™ä¸ºè¯¯å·®å€¼ã€‚å› ä¸ºè¿™ä¸ªç»“æœæ—¶100 *1 çš„çŸ©é˜µï¼Œæ‰€ä»¥å®é™…æ ‡ç­¾çŸ©é˜µä¹Ÿåº”è¯¥æ˜¯100 * 1çš„çŸ©é˜µï¼Œå› æ­¤ï¼Œè¾“å…¥çš„labelMatéœ€è¦è¿›è¡Œè½¬ç½®ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œå¤„ç†</span></span><br><span class="line">labelMat=labelMat.transpose()</span><br><span class="line">numIter=<span class="number">500</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(numIter):</span><br><span class="line">  h=sigmoid(dataMat*weight)</span><br><span class="line">  error=y-h</span><br><span class="line">  weights=weights+alpha*dataMat.transpose()*error <span class="comment">#è¿™é‡Œerroræ˜¯100 *1 çš„çŸ©é˜µï¼ŒçŸ©é˜µä¹˜æ³•è¦æ±‚è¡Œåˆ—ç›¸åŒï¼Œå› æ­¤xåº”è¯¥è½¬æ¢ä¸º3*100çš„çŸ©é˜µè¿›è¡Œè®¡ç®—</span></span><br></pre></td></tr></table></figure>

<h3 id="éšæœºæ¢¯åº¦ä¸Šå‡"><a href="#éšæœºæ¢¯åº¦ä¸Šå‡" class="headerlink" title="éšæœºæ¢¯åº¦ä¸Šå‡"></a>éšæœºæ¢¯åº¦ä¸Šå‡</h3><p>ä¸Šé¢çš„æ‰¹å¤„ç†æ–¹å¼çš„æ¢¯åº¦ä¸Šå‡æ–¹æ³•æ¯æ¬¡éƒ½è¦éå†æ•´ä¸ªæ•°æ®é›†ï¼Œå½“æ•°æ®é‡å¤§çš„æ—¶å€™å°±æ¯”è¾ƒè´¹æ—¶ï¼Œå› æ­¤å¼•å…¥ä¸€ç§åœ¨çº¿å­¦ä¹ æ–¹å¼çš„æ¢¯åº¦ä¸Šå‡ï¼Œæ¯æ¬¡éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬å¯¹å›å½’ç³»æ•°è¿›è¡Œä¿®æ­£</p>
<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–å›å½’ç³»æ•°</p>
<p>å› ä¸ºæ¯æ¬¡æ˜¯å¯¹ä¸€ä¸ªæ•°æ®ç‚¹å¤„ç†ï¼Œå› æ­¤ï¼Œåªéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œnæ˜¯æ•°æ®é›†ä¸­æ•°æ®ç‰¹å¾çš„ä¸ªæ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m,n=shape(dataMat)</span><br><span class="line">weights=ones(n)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æ¯æ¬¡çš„æ­¥é•¿éƒ½æ›´æ–°</p>
<p>å½“åˆšå¼€å§‹çš„æ—¶å€™ç¦»æœ€ä¼˜å€¼å¾ˆè¿œï¼Œå¯ä»¥æ­¥é•¿å¤§ç‚¹ï¼Œå¿«é€Ÿå‘æœ€ä¼˜å€¼é€¼è¿‘ï¼Œå½“åˆ°åé¢çš„æ—¶å€™ï¼Œéœ€è¦å‡å°æ­¥é•¿ï¼Œæ…¢æ…¢é€¼è¿‘ï¼Œä¸ç„¶å¯èƒ½ä¼šé”™è¿‡æœ€ä¼˜å€¼ã€‚</p>
<p>jæ§åˆ¶è¿­ä»£æ¬¡æ•°ï¼Œiæ§åˆ¶æ¯ä¸ªæ ·æœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alpha=<span class="number">4</span>/(<span class="number">1</span>+i+j)+<span class="number">0.01</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰éšæœºé€‰æ‹©æ ·æœ¬ä¿®æ­£å›å½’ç³»æ•°</p>
<p>è®¾ç½®ä¸€ä¸ªdataIndexé‡Œé¢å­˜å‚¨0 - m-1çš„æ•°å­—ï¼Œæ¯æ¬¡é€šè¿‡random.uniformç”Ÿæˆä¸€ä¸ªåœ¨0 - len(dataIndex)ä¹‹é—´çš„éšæœºæ•°ï¼Œä»£è¡¨æ­¤æ¬¡é€‰æ‹©è¿™è¡Œçš„æ ·æœ¬è¿›è¡Œå›å½’ç³»æ•°çš„ä¿®æ­£ï¼Œæ¯æ¬¡å°†è¯¥æ¬¡é€‰æ‹©çš„éšæœºæ•°åœ¨dataIndexä¸­åˆ é™¤ï¼Œé˜²æ­¢ä¸‹æ¬¡é‡å¤é€‰æ‹©</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä¸ºäº†å®ç°å¯¹åº”ä½ç½®ç›¸ä¹˜dataMatéœ€è¦è½¬æ¢ä¸ºæ•°ç»„</span></span><br><span class="line">dataArr=array(dataMat)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(numIter):</span><br><span class="line">  dataIndex=list(range(m))</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">    alpha=<span class="number">4</span>/(<span class="number">1</span>+i+j)+<span class="number">0.01</span></span><br><span class="line">    </span><br><span class="line">    randomIndex=int(random.uniform(<span class="number">0</span>,len(dataIndex)))</span><br><span class="line">    chooseIndex=dataIndex[randomIndex]</span><br><span class="line">    h=sigmoid(dataArr[chooseIndex]*weights) <span class="comment">#datamat[i]æ˜¯1*3æ•°ç»„ï¼Œweightsæ˜¯1*3æ•°ç»„ï¼Œå¯¹åº”ä½ç½®ç›¸ä¹˜</span></span><br><span class="line">    error=labelMat[chooseIndex]-h</span><br><span class="line">    weights=weights+alpha*error*dataMat[]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">del</span>(dataIndex[randomIndex])</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•ä¸éœ€è¦å¯¹çŸ©é˜µè¿›è¡Œè½¬ç½®ï¼Œè¿ç®—ç®€æ´ï¼ŒåŒæ—¶æ¯æ¬¡è¿­ä»£å°±ä¿®æ”¹å›å½’ç³»æ•°mæ¬¡ï¼Œè€Œæ‰¹å¤„ç†çš„æ–¹æ³•æ¯æ¬¡åªèƒ½ä¿®æ”¹ä¸€æ¬¡ï¼Œè¿™ç§æ–¹æ³•åªéœ€è¦è¿­ä»£å¾ˆå°‘çš„æ¬¡æ•°ï¼Œå›å½’ç³»æ•°å°±è¶‹äºç¨³å®šäº†ã€‚</p>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>å› ä¸ºæ•°æ®é›†æœ¬èº«åªæœ‰ä¸¤åˆ—ï¼Œå³ä¸¤ä¸ªæ•°æ®ç‰¹å¾ï¼Œå› æ­¤x0è®¾ç½®ä¸º1ï¼Œw0ä½œä¸ºåç½®ï¼Œæœ€ç»ˆå¾—å‡ºçš„æ‹Ÿå’Œç›´çº¿ä¸ºy=w0+w1x1+w2x2ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯sigmoidå‡½æ•°ï¼Œåˆ†å‰²çš„ç›´çº¿çš„yå€¼åº”è¯¥æ˜¯0ï¼Œå› ä¸ºsigmoid(0)=0.5ï¼Œç›´çº¿è½¬æ¢ä¸ºw0+w1x1+w2x2=0 =&gt; x2=-w0-w1x1/w2ï¼Œç”¨plt.plot(x,x2)ï¼Œè¿™é‡Œçš„xå¯ä»¥åœ¨xçš„å–å€¼èŒƒå›´å†…ï¼Œå–ä¸€å®šæ­¥é•¿è¿›è¡Œæ˜¾ç¤ºï¼ˆåˆ©ç”¨arangeï¼‰ï¼Œå¯ä»¥å°†å›¾åƒç”»å‡ºæ¥ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200324170500.png" alt="æ•ˆæœå›¾"></p>
<h2 id="åº”ç”¨å®ä¾‹"><a href="#åº”ç”¨å®ä¾‹" class="headerlink" title="åº”ç”¨å®ä¾‹"></a>åº”ç”¨å®ä¾‹</h2><p>é—®é¢˜ï¼šç”¨logisticå›å½’é¢„æµ‹å¾—ç–æ°”ç—…çš„ç—…é©¬æ­»äº¡ç‡</p>
<h3 id="æ•°æ®é›†æè¿°"><a href="#æ•°æ®é›†æè¿°" class="headerlink" title="æ•°æ®é›†æè¿°"></a>æ•°æ®é›†æè¿°</h3><p>æ•°æ®é›†æ˜¯ä»UCIä¸Šä¸‹è½½çš„ï¼Œé‡Œé¢åŒ…å«22åˆ—å±æ€§ï¼Œå…¶ä¸­å‰21åˆ—æ˜¯é©¬çš„ä¸€äº›ç”Ÿç†ç‰¹å¾ï¼Œæœ€åä¸€åˆ—æ˜¯æ˜¯å¦å­˜æ´»ï¼Œå±äºç±»åˆ«æ ‡ç­¾ã€‚è¯¥æ¡ˆä¾‹æ˜¯ä»å‰21åˆ—çš„ç‰¹å¾ä¸­çš„å‡ºå›å½’ç³»æ•°ï¼Œå¾—åˆ°æ‹Ÿåˆçš„å›å½’ç›´çº¿ï¼Œå¯¹é©¬æ˜¯å¦å­˜æ´»è¿›è¡Œåˆ†ç±»ã€‚</p>
<p>è¯¥æ•°æ®é›†ä¸­éƒ¨åˆ†æ•°æ®ï¼ˆçº¦30%ï¼‰ä¸¢å¤±ï¼Œå¯¹ç‰¹å¾ä¸¢å¤±çš„æƒ…å†µè¿›è¡Œå¤„ç†ï¼šç”±äºlogisticå›å½’ä¸­z=w0x0+w1x1+â€¦ï¼Œå…¶ä¸­å½“ç‰¹å¾ç­‰äº0çš„æ—¶å€™ä¸å½±å“ç­‰å¼çš„ç»“æœï¼ŒåŒæ—¶å› ä¸ºä½¿ç”¨çš„åˆ¤å®šç±»åˆ«çš„å‡½æ•°ä¸ºsigmoidå‡½æ•°ï¼Œå½“å–å€¼ä¸º0ï¼Œå³simoid(0)=0.5ï¼Œä¸å½±å“åˆ†ç±»ï¼Œæ‰€æœ‰ä¸¢å¤±çš„ç‰¹è´¨å‡è®¾ç½®ä¸º0ï¼›å¯¹ç±»åˆ«æ ‡ç­¾ä¸¢å¤±çš„æƒ…å†µè¿›è¡Œå¤„ç†ï¼šå½“ç±»åˆ«æ ‡ç­¾ä¸¢å¤±çš„æ—¶å€™æ— æ³•åˆ¤æ–­é©¬çš„å­˜æ´»æƒ…å†µï¼Œå› æ­¤å°†è¯¥æ¡æ•°æ®ä¸¢å¼ƒã€‚</p>
<h3 id="åº”ç”¨æè¿°"><a href="#åº”ç”¨æè¿°" class="headerlink" title="åº”ç”¨æè¿°"></a>åº”ç”¨æè¿°</h3><p>ï¼ˆ1ï¼‰ç±»åˆ«åˆ¤å®š</p>
<p>å¯¹è¾“å…¥çš„å‘é‡ä¹˜ä»¥å›å½’ç³»æ•°æ±‚å’Œï¼Œå¦‚æœå¤§äº0.5ï¼Œåˆ™åˆ†ç±»ä¸º1ï¼Œåä¹‹åˆ†ç±»ä¸º0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">prob=sigmoid(sum(inX*weights))</span><br><span class="line"><span class="keyword">if</span> prob&gt;<span class="number">0.5</span>:</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å»ºç«‹logisticå›å½’æ¨¡å‹å¹¶è¿›è¡Œæµ‹è¯•</p>
<p>è®­ç»ƒé›†å»ºç«‹æ¨¡å‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">trainingFile=open(<span class="string">"horseColicTraining.txt"</span>)</span><br><span class="line">trainingMat=[]</span><br><span class="line">trainingLabels=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> curLine <span class="keyword">in</span> trainingFile.readlines():</span><br><span class="line">	pstLine=curLine.strip().split(<span class="string">"\t"</span>)</span><br><span class="line">	dataList=[]</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">21</span>):</span><br><span class="line">		dataList.append(float(pstLine[j]))</span><br><span class="line">	trainingMat.append(dataList)</span><br><span class="line">	trainingLabels.append(float(pstLine[<span class="number">21</span>]))</span><br><span class="line"></span><br><span class="line">weights=stoGradAscent1(trainingMat,trainingLabels,<span class="number">500</span>)</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æ¬¡æµ‹è¯•é”™è¯¯ç‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">testFile=open(<span class="string">"horseColicTest.txt"</span>)</span><br><span class="line"></span><br><span class="line">testMat=[]</span><br><span class="line">testLabels=[]</span><br><span class="line"><span class="keyword">for</span> curLine <span class="keyword">in</span> testFile.readlines():</span><br><span class="line">	pstLine=curLine.strip().split(<span class="string">"\t"</span>)</span><br><span class="line">	dataList=[]</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">21</span>):</span><br><span class="line">		dataList.append(float(pstLine[j]))</span><br><span class="line">	testMat.append(dataList)</span><br><span class="line">	testLabels.append(float(pstLine[<span class="number">21</span>]))</span><br><span class="line"></span><br><span class="line">error=<span class="number">0</span></span><br><span class="line">n=shape(testMat)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">	predictData=classfyVec(testMat[i],weights)</span><br><span class="line">	<span class="keyword">if</span>(predictData!=testLabels[i]):</span><br><span class="line">		error+=<span class="number">1</span></span><br><span class="line">errorRate=float(error)/n</span><br><span class="line">print(<span class="string">"error rate is:"</span>+str(errorRate))</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰å–å¹³å‡æ•°</p>
<p>ä¸€æ¬¡æ•°æ®å¯èƒ½å­˜åœ¨å¶ç„¶æ€§ï¼Œå› æ­¤è¿è¡Œ10æ¬¡å–å¹³å‡å€¼ï¼Œä½œä¸ºè¯¥æ¨¡å‹çš„åˆ†ç±»æ­£ç¡®ç‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">numTest=<span class="number">10</span></span><br><span class="line">errorCount=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(numTest):</span><br><span class="line">	errorCount+=colicTest()</span><br><span class="line"></span><br><span class="line">allError=float(errorCount/<span class="number">10</span>)</span><br><span class="line">print(<span class="string">"the average of ten times error is:"</span>)</span><br><span class="line">print(allError)</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆè¿è¡Œ10æ¬¡çš„ç»“æœä¸ºï¼š</p>
<blockquote>
<p>error rate is:0.6268656716417911<br>error rate is:0.3582089552238806<br>error rate is:0.26865671641791045<br>error rate is:0.2537313432835821<br>error rate is:0.44776119402985076<br>error rate is:0.29850746268656714<br>error rate is:0.47761194029850745<br>error rate is:0.26865671641791045<br>error rate is:0.26865671641791045<br>error rate is:0.5522388059701493<br>the average of ten times error is:<br>25.6</p>
</blockquote>
<p>å¹³å‡é”™è¯¯ç‡25%å·¦å³ï¼Œå› ä¸ºæ•°æ®é›†æœ‰30%çš„æ•°æ®ä¸¢å¤±ï¼Œå› æ­¤é”™è¯¯ç‡ç›¸å¯¹è¾ƒé«˜ã€‚</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é¢è¯•é«˜é¢‘é¢˜â€”â€”topké—®é¢˜</title>
    <url>/blogs/topK/</url>
    <content><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>ç»™å‡ºä¸€ä¸ªæ•°ç»„ï¼Œæ±‚æ•°ç»„ä¸­å‰kä¸ªæœ€å¤§/æœ€å°çš„æ•°æˆ–è€…æ±‚æ•°ç»„ä¸­ç¬¬kä¸ªæœ€å¤§/æœ€å°çš„æ•°ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><h3 id="æš´åŠ›æ³•"><a href="#æš´åŠ›æ³•" class="headerlink" title="æš´åŠ›æ³•"></a>æš´åŠ›æ³•</h3><p>ï¼ˆ1ï¼‰æ€è·¯ï¼šè°ƒç”¨sortå‡½æ•°å°†æ•°ç»„æ’åºï¼Œé€‰æ‹©å‰kä¸ªæˆ–è€…ç¬¬kä¸ªè¾“å‡º</p><p>ï¼ˆ2ï¼‰å¤æ‚åº¦åˆ†æï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šä¸»è¦æ˜¯åœ¨æ¯”è¾ƒæ’åºä¸Šäº†ï¼Œè¯¥æ–¹æ³•å¯¹æ•´ä¸ªæ•°ç»„æ’åºï¼Œc++ä¸­çš„sortä½¿ç”¨çš„æ˜¯å¿«é€Ÿæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)</p><p>ç©ºé—´å¤æ‚åº¦ï¼šæ²¡æœ‰ç”¨åˆ°é¢å¤–çš„ç©ºé—´ï¼Œå¤æ‚åº¦ä¸ºOï¼ˆ1ï¼‰</p><a id="more"></a>




<p>ï¼ˆ3ï¼‰ä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">sort(num.<span class="built_in">begin</span>(),num.<span class="built_in">end</span>())</span><br></pre></td></tr></table></figure>



<h3 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h3><p>ï¼ˆ1ï¼‰æ€è·¯ï¼š</p>
<p>ç»´æŠ¤ä¸€ä¸ªkä¸ªå…ƒç´ çš„å †ï¼Œå°†æ•°ç»„ä¸­å…ƒç´ å’Œé˜Ÿé¦–å…ƒç´ æ¯”è¾ƒï¼Œå½¢æˆæœ€ç»ˆç¨³å®šçš„å †ï¼š</p>
<p>æ±‚å‰kä¸ªæœ€å¤§çš„æ•°å³éœ€è¦ç»´æŠ¤ä¸€ä¸ªå°é¡¶å †ï¼Œé˜Ÿé¦–æ˜¯æœ€å°çš„å…ƒç´ ï¼Œå½“è¯»å…¥çš„æ•°æ®å¤§äºç­‰äºé˜Ÿé¦–å…ƒç´ ï¼Œåˆ™åŠ å…¥å †ä¸­ï¼Œä¿è¯å…¶ä½™å…ƒç´ éƒ½å¤§äºé˜Ÿé¦–çš„å…ƒç´ ï¼Œæ¯æ¬¡ä»…éœ€æ¯”è¾ƒé˜Ÿé¦–å…ƒç´ å³å¯ï¼Œå½“éå†åˆ°æœ€åï¼Œå †ä¸­å‰©ä¸‹å‰kä¸ªæœ€å¤§çš„æ•°ï¼›</p>
<p>å½“æ±‚å‰kä¸ªæœ€å°çš„æ•°å³éœ€è¦ç»´æŠ¤ä¸€ä¸ªå¤§é¡¶å †ï¼Œé˜Ÿé¦–æ˜¯æœ€å¤§çš„å…ƒç´ ï¼Œå½“è¯»å…¥çš„æ•°æ®å°äºç­‰äºé˜Ÿé¦–å…ƒç´ ï¼Œåˆ™åŠ å…¥å †ä¸­ï¼Œä¿è¯å…¶ä»–å…ƒç´ éƒ½å°äºé˜Ÿé¦–çš„å…ƒç´ ï¼Œæœ€ç»ˆï¼Œå †ä¸­å‰©ä¸‹å‰kä¸ªæœ€å°çš„æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰å¤æ‚åº¦åˆ†æï¼š</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šæ¯æ¬¡ç»´æŠ¤ä¸€ä¸ªkä¸ªå…ƒç´ çš„å †ï¼Œç›¸å½“äºå»ºç«‹ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ·±åº¦æ˜¯logkï¼Œæœ€å·®çš„æƒ…å†µæ˜¯nä¸ªæ•°éƒ½éœ€è¦æ’åºæ¯”è¾ƒï¼Œåˆ™å¤æ‚åº¦æ˜¯Oï¼ˆnlogkï¼‰</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šç”¨åˆ°äº†kå¤§å°çš„å †ï¼Œå¤æ‚åº¦ä¸ºOï¼ˆkï¼‰</p>
<p>ï¼ˆ3ï¼‰ä»£ç ï¼š</p>
<p>ä»¥æ±‚å‰kä¸ªæœ€å¤§çš„å…ƒç´ ä¸ºä¾‹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.å»ºå°é¡¶å † åä¸¤ä¸ªå…ƒç´ ç¼ºçœï¼Œè‡ªåŠ¨å»ºç«‹å¤§é¡¶å †</span></span><br><span class="line">prioriy_queue&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;,greater&lt;<span class="keyword">int</span>&gt;&gt; p;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i++)</span><br><span class="line">  p.push(num[i])</span><br><span class="line">  </span><br><span class="line"> <span class="comment">//2.é˜Ÿé¦–å…ƒç´ æ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=k;i&lt;num.<span class="built_in">size</span>();i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//é˜Ÿé¦–å…ƒç´ å°ï¼Œåˆ™æŠŠæ–°å…ƒç´ åŠ å…¥</span></span><br><span class="line">  <span class="keyword">if</span>(p.top()&lt;num[i])</span><br><span class="line">  &#123;</span><br><span class="line">    p.pop();</span><br><span class="line">    p.push(num[i]);</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h3><p>ï¼ˆ1ï¼‰æ€è·¯ï¼šå¿«é€Ÿæ’åºæ˜¯ä»¥ä¸€ä¸ªåŸºå‡†ç‚¹è¿›è¡Œæ’åºï¼Œå½“åœ¨åŸºå‡†ç‚¹çš„å·¦è¾¹éƒ½æ˜¯å°äºè¯¥æ•°çš„ï¼Œå³è¾¹éƒ½æ˜¯å¤§äºè¯¥æ•°çš„ã€‚ä»è¿™ä¸ªæ€è·¯å‡ºå‘å¯ä»¥æƒ³åˆ°ï¼Œæ±‚å‰kä¸ªæœ€å°çš„æ•°å¯ä»¥è½¬æ¢ä¸ºåœ¨ç¬¬kä¸ªä½ç½®è¿›è¡Œæ’åºï¼Œå·¦è¾¹æ˜¯å°äºçš„æ•°ï¼Œå³è¾¹æ˜¯å¤§äºçš„æ•°ï¼Œæ±‚å‰kä¸ªæœ€å°çš„æ•°å°±æ˜¯å‰kä¸ªæ•°ã€‚å› ä¸ºå¿«é€Ÿæ’åºæ—¶æ¯æ¬¡æ’åºå¯ä»¥å¾—åˆ°å½“å‰åŸºå‡†ç‚¹çš„ä½ç½®ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦åœ¨ç¬¬kä¸ªä½ç½®ã€‚è¿™ç§æ–¹æ³•ä¸ç”¨éå†æ•´ä¸ªæ•°ç»„ï¼Œæ’åºçš„æ¬¡æ•°å‡å°‘äº†ã€‚å¿«é€Ÿæ’åºå¤„ç†ä¸¤è¾¹çš„æ•°ï¼Œè¿™è¾¹åªéœ€è¦å¯¹ä¸€è¾¹çš„æ•°è¿›è¡Œæ’åºã€‚</p>
<p>å½“æ±‚å‰kä¸ªæœ€å¤§çš„æ•°æ—¶å¯ä»¥è¿›è¡Œè½¬æ¢ï¼šé¦–å…ˆç¬¬kä¸ªæœ€å¤§çš„æ•°ï¼Œå¦‚æœ6ä¸ªæ•°ï¼Œä»å°åˆ°å¤§æ’åˆ—ï¼Œåˆ™ç´¢å¼•æ˜¯6-kï¼Œå³æ±‚ç¬¬6-kä¸ªæœ€å°çš„æ•°ï¼Œå‰kä¸ªæœ€å¤§çš„æ•°ï¼Œå°±æ˜¯ä»è¯¥ä½ç½®åˆ°æ•°ç»„æœ«å°¾ã€‚</p>
<p>eg.å‡è®¾æœ‰6ä¸ªæ•°å­—2ï¼Œ5ï¼Œ7ï¼Œ1ï¼Œ3ï¼Œ9ï¼Œæ’åºä¹‹åä¸º1ï¼Œ2ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œæ±‚ç¬¬3å¤§çš„æ•°å­—å³5ï¼Œä»å·¦å¾€å³æ•°ï¼Œå…ƒç´ 5çš„ç´¢å¼•ä¸º3ï¼Œ3=6-3ï¼ˆkçš„å€¼ï¼‰ï¼Œæ‰€ä»¥ç¬¬kä¸ªæœ€å¤§çš„æ•°=ç¬¬6-kä¸ªæœ€å°çš„æ•°</p>
<p>ï¼ˆ2ï¼‰å¤æ‚åº¦åˆ†æï¼š</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šç›¸æ¯”è¾ƒsortæ–¹æ³•æ¥è¯´ï¼Œå‡å°‘äº†æ’åºçš„æ¬¡æ•°ï¼Œè·å–æ¯æ¬¡æ’åºçš„ä½ç½®ï¼Œå½“è¯¥ä½ç½®å°äºkï¼Œåˆ™è¯´æ˜ä¸‹ä¸€æ¬¡æ’åºéœ€è¦åœ¨å½“å‰ä½ç½®å’Œrightä½ç½®ä¹‹é—´å¯»æ‰¾ç¬¬kä¸ªä½ç½®ï¼Œåä¹‹éœ€è¦åœ¨leftå’Œå½“å‰ä½ç½®ä¹‹é—´å¯»æ‰¾ã€‚æ¯æ¬¡å‡å°‘ä¸€åŠéœ€è¦æ’åºçš„æ•°å­—ï¼Œåˆ™ä¸ºn+n/2+â€¦=Oï¼ˆnï¼‰</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šé€’å½’è°ƒç”¨æ ˆï¼Œå¤æ‚åº¦ä¸ºOï¼ˆnï¼‰</p>
<p>ï¼ˆ3ï¼‰ä»£ç ï¼š</p>
<p>ä»¥æ±‚å‰kä¸ªæœ€å¤§çš„å…ƒç´ ä¸ºä¾‹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸»å‡½æ•°</span></span><br><span class="line"><span class="keyword">int</span> pos=num.<span class="built_in">size</span>()-k <span class="comment">//è¿›è¡Œä½ç½®è½¬æ¢</span></span><br><span class="line">quickSort(num,<span class="number">0</span>,num.<span class="built_in">size</span>(),pos)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¿«é€Ÿæ’åºå‡½æ•°</span></span><br><span class="line"><span class="keyword">void</span> quickSort(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;num,<span class="keyword">int</span> lef,<span class="keyword">int</span> right,<span class="keyword">int</span> k)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> p=partition(num,left,right);</span><br><span class="line">  <span class="keyword">if</span>(p==k)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p&gt;k)</span><br><span class="line">      quickSort(num,left,p<span class="number">-1</span>,k)</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">       quickSort(num,p+<span class="number">1</span>,right,k)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’åºä½ç½®å‡½æ•°</span></span><br><span class="line"><span class="keyword">int</span> partition(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;num,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> i=left;</span><br><span class="line">  <span class="keyword">int</span> j=right;</span><br><span class="line">  <span class="keyword">int</span> base=num[i];</span><br><span class="line">  <span class="comment">//æ‰¾åˆ°åŸºå‡†å€¼çš„ä½ç½®</span></span><br><span class="line">  <span class="keyword">while</span>(i&lt;j)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°æ¯”åŸºå‡†å€¼å°çš„</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;j&amp;&amp;num[j]&gt;=base)</span><br><span class="line">      j--;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°æ¯”åŸºå‡†å€¼å¤§çš„</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;j&amp;&amp;num[i]&lt;=base)</span><br><span class="line">      i++;</span><br><span class="line">    <span class="comment">//äº¤æ¢</span></span><br><span class="line">    <span class="keyword">if</span>(i&lt;j)</span><br><span class="line">      swap(num[i],num[j]);</span><br><span class="line">  &#125;</span><br><span class="line">  num[left]=num[i];</span><br><span class="line">  num[i]=base;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>topK</tag>
      </tags>
  </entry>
  <entry>
    <title>éç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”Kå‡å€¼èšç±»</title>
    <url>/blogs/kMeans/</url>
    <content><![CDATA[<p>éç›‘ç£å­¦ä¹ å’Œç›‘ç£å­¦ä¹ ä¸åŒï¼Œç›‘ç£å­¦ä¹ çŸ¥é“éœ€è¦å¯»æ‰¾çš„å†…å®¹ï¼Œå³ç›®æ ‡å˜é‡ï¼Œä¼šé€šè¿‡æ•°æ®è®­ç»ƒå‡ºèƒ½å¾—å‡ºç›®æ ‡å˜é‡å­¦ä¹ æ¨¡å‹ï¼Œè€Œç›‘ç£å­¦ä¹ ä¸çŸ¥é“ç›®æ ‡å˜é‡ï¼Œéç›‘ç£å­¦ä¹ ä¸­æœ‰ä¸€ç§èšç±»æ–¹æ³•ï¼ŒæŠŠç›¸ä¼¼çš„ç‚¹æ”¾åœ¨ä¸€ä¸ªç°‡ï¼ˆç±»ï¼‰ä¸­ï¼Œç±»ä¼¼äºå…¨è‡ªåŠ¨åˆ†ç±»ï¼Œåº¦é‡æ•°æ®çš„ç›¸ä¼¼æœ‰å¾ˆå¤šå‡½æ•°ï¼ŒåŒ…æ‹¬æ¬§å¼è·ç¦»ï¼Œçƒé¢è·ç¦»ç­‰ã€‚</p><h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>kå‡å€¼èšç±»å±äºä¸€ç§èšç±»ç®—æ³•ï¼Œé€šè¿‡ç»™å®šçš„æ•°å€¼kï¼Œå°†æ•°æ®ç‚¹åˆ†ä¸ºkç±»ï¼Œåˆ†ç±»ä¾æ®ä¸ºç›¸ä¼¼çš„æ•°æ®ç‚¹æ”¾åˆ°ä¸€ä¸ªç°‡é‡Œï¼Œè¿™é‡Œç°‡çš„ä¸­å¿ƒç§°ä¸ºè´¨å¿ƒï¼Œä¸€èˆ¬å¯ä»¥ç”¨è·ç¦»å…¬å¼æ¥åº¦é‡æ•°æ®ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚å‡è®¾ä»¥æ¬§å¼è·ç¦»ä½œä¸ºç›¸ä¼¼åº¦è¯„ä»·ä¾æ®ï¼Œåˆ™ç‚¹åˆ°å„ä¸ªè´¨å¿ƒä¸­çš„æœ€å°è·ç¦»çš„é‚£ä¸ªç°‡æ˜¯è¯¥æ•°æ®ç‚¹æ‰€åœ¨çš„ä½ç½®ï¼Œæœ€ç»ˆå¯ä»¥å°†æ•°æ®åˆ†ä¸ºkç±»ã€‚</p><a id="more"></a>

<h2 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h2><p>æ³¨ï¼šå› ä¸ºåº¦é‡æ•°æ®ä¹‹é—´ç›¸ä¼¼åº¦çš„å‡½æ•°é€šå¸¸éƒ½éœ€è¦å°†æ•°æ®è½¬æ¢ä¸ºçŸ©é˜µè¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥ç¨‹åºä¸­éœ€è¦æ³¨æ„æ•°æ®çš„å­˜å‚¨å½¢å¼ï¼Œå¦‚æœæ˜¯åˆ—è¡¨å½¢å¼éœ€è¦è½¬æ¢ä¸ºçŸ©é˜µè¿›è¡Œå¤„ç†ã€‚</p>
<p>å½“æœ‰èµ‹å€¼æ“ä½œçš„æ—¶å€™ï¼Œmatç±»å‹ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œéœ€è¦è½¬æ¢ä¸ºlistç±»å‹ã€‚ä¾‹å¦‚ï¼Œmatop=matop.tolist()[0]</p>
<p>ï¼ˆ1ï¼‰è¯»å…¥æ•°æ®</p>
<p>æ ¹æ®è¾“å…¥çš„æ–‡ä»¶åè¯»å…¥æ•°æ®ï¼Œæ ¹æ®ç›¸ä¼¼åº¦è®¡ç®—æ–¹æ³•ï¼Œéœ€è¦æŠŠæ•°æ®è½¬æ¢ä¸ºfloatæ•°å€¼ç±»å‹ï¼ŒåŒæ—¶è½¬æ¢ä¸ºçŸ©é˜µ</p>
<p>ï¼ˆ2ï¼‰ç¡®å®šç›¸ä¼¼åº¦è®¡ç®—æ–¹æ³•</p>
<p>ä»¥æ¬§å¼è·ç¦»ä¸ºä¾‹ï¼šè®¡ç®—ä¸¤ä¸ªçŸ©é˜µå¯¹åº”ä½ç½®ç›¸å‡å¹³æ–¹æ±‚å’Œï¼Œæœ€åå†å¼€æ ¹å·ä½œä¸ºä¸¤ä¸ªçŸ©é˜µä¹‹é—´çš„è·ç¦»</p>
<p>sqrt(sum(power)(veca-vecb))   åˆ—è¡¨æˆ–è€…çŸ©é˜µä¹‹é—´æ±‚æ¬¡æ–¹ç”¨powerå‡½æ•°</p>
<p>ï¼ˆ3ï¼‰ç¡®å®šåˆå§‹è´¨å¿ƒé€‰æ‹©æ–¹æ³•</p>
<p>è®¾å®šè¾“å…¥çš„æ•°æ®å½¢å¼ä¸ºï¼ˆx,yï¼‰</p>
<p>ä¸€èˆ¬åˆå§‹è´¨å¿ƒä½¿ç”¨éšæœºé€‰æ‹©çš„æ–¹æ³•ï¼Œä¸ºäº†å°†éšæœºçŸ©é˜µçš„å€¼æ§åˆ¶åœ¨æ•°æ®èŒƒå›´å†…ï¼Œæ ¹æ®æ¯åˆ—çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œç”Ÿæˆk*nï¼ˆnæ­¤æ—¶ä¸º2ï¼‰ä¸ªéšæœºæ•°æ®ï¼Œä»¥æ­¤ä½œä¸ºåˆå§‹çš„kä¸ªè´¨å¿ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è·å–æ•°æ®ç‚¹çš„åˆ—æ•°</span></span><br><span class="line">n=shape(data)[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#éšæœºæ•°ç»„</span></span><br><span class="line">centroids=mat(zeros((k,n)))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">  minI=min(data[:,i])</span><br><span class="line">  maxI=max(data[:,i])</span><br><span class="line">  rangeI=float(maxI-minI)</span><br><span class="line">  centroids[:,i]=mat(minI+rangeI*rand(k,<span class="number">1</span>))<span class="comment">#è¿”å›k*1ä¸ª0~1ä¹‹é—´çš„éšæœºæ•°</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰æ ¹æ®ç›¸ä¼¼åº¦å°†æ•°æ®åˆ†ç±»</p>
<p>aï¼‰åˆå§‹åŒ–è´¨å¿ƒï¼šä»¥éšæœºé€‰æ‹©çš„æ–¹å¼</p>
<p>bï¼‰å½“ç°‡ä»åœ¨å‘ç”Ÿå˜åŒ–</p>
<p>å¯¹æ¯ä¸ªæ•°æ®ç‚¹ï¼Œè®¡ç®—å½“å‰ç‚¹åˆ°å„ä¸ªè´¨å¿ƒçš„è·ç¦»ï¼Œé€‰æ‹©æœ€è¿‘çš„è·ç¦»ï¼Œå°†è¯¥ç‚¹æ”¾å…¥</p>
<p>å°†ç°‡å†…æ‰€æœ‰æ•°æ®ç‚¹å–å‡å€¼ï¼Œé‡æ–°è®¡ç®—å½“å‰çš„è´¨å¿ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n=shape(data)[<span class="number">0</span>]</span><br><span class="line">clusterAssment=mat(zeros((n,<span class="number">2</span>)))<span class="comment">#å­˜å‚¨å¯¹åº”è¡Œçš„ç‚¹å±äºå“ªä¸ªç°‡ï¼Œä»¥åŠè¯¯å·®</span></span><br><span class="line"><span class="keyword">while</span>(ç°‡åœ¨å˜åŒ–):</span><br><span class="line">  flag=false<span class="comment">#æ ‡è®°ç°‡æ˜¯å¦åœ¨å˜åŒ–</span></span><br><span class="line">  <span class="comment">#1.å¯¹æ¯ä¸ªæ•°æ®ç‚¹</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">    minDist=inf</span><br><span class="line">    minIndex=<span class="number">-1</span></span><br><span class="line">    <span class="comment">#è®¡ç®—è¯¥ç‚¹åˆ°å„ä¸ªè´¨å¿ƒçš„è·ç¦»		</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">      pstCurret=distmes(centroids[k,:],data[i,:])<span class="comment">#distmesä¸ºç›¸ä¼¼åº¦è®¡ç®—æ–¹æ³•</span></span><br><span class="line">      <span class="keyword">if</span>(pstCurret&lt;minDist):</span><br><span class="line">        æœ€å°å€¼äº¤æ¢</span><br><span class="line">   	 <span class="keyword">if</span>(clusterAssment[i,<span class="number">0</span>]!=minIndex):</span><br><span class="line">      flag=true<span class="comment">#è¯´æ˜ç°‡è¿˜åœ¨å˜åŒ–</span></span><br><span class="line">     <span class="comment">#2.å°†ç‚¹åŠ å…¥åˆ°ç°‡ä¸­</span></span><br><span class="line">    clusterAssment[i,:]=minIndex,minDist**<span class="number">2</span></span><br><span class="line">  <span class="comment">#3.å¯¹æ¯ä¸ªç°‡ï¼ˆå³è´¨å¿ƒï¼‰ï¼Œå¯¹ç°‡å†…æ•°æ®ç‚¹å–å‡å€¼</span></span><br><span class="line">  <span class="keyword">for</span> cent <span class="keyword">in</span> range(k):</span><br><span class="line">    pstCurret=data[nonzero(clusterAssment[:,<span class="number">0</span>].A[<span class="number">0</span>]==cent)]</span><br><span class="line">    centroids[cent,:]=mean(pstCurret,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h2 id="ç®—æ³•æ”¹è¿›"><a href="#ç®—æ³•æ”¹è¿›" class="headerlink" title="ç®—æ³•æ”¹è¿›"></a>ç®—æ³•æ”¹è¿›</h2><p>kå‡å€¼èšç±»ç®—æ³•ä¾èµ–ä¸ç”¨æˆ·ç»™å®šçš„æ•°å€¼kï¼Œæ­¤æ—¶æ— æ³•ç¡®å®šæ ¹æ®kå¾—å‡ºçš„ç°‡æ˜¯æœ€ä¼˜çš„ã€‚è¯„ä»·ç®—æ³•çš„ä¼˜åŠ£æ˜¯æ ¹æ®è¯¯å·®å¹³æ–¹å’Œï¼ˆç§°SSEï¼‰ï¼Œå³æ•°æ®çœŸå®å€¼ä¸ºyï¼Œé¢„æµ‹å€¼ä¸ºy1ï¼Œåˆ™è¯¯å·®å¹³æ–¹å’Œä¸ºï¼ˆy-y1ï¼‰2ï¼Œkå‡å€¼èšç±»ç®—æ³•çš„æ”¹è¿›æ˜¯æ ¹æ®SSEæœ€å°æ—¶ï¼Œå°†æ•°æ®åˆ†ä¸ºkä¸ªç±»ã€‚</p>
<p>åˆå§‹æ—¶å°†æ‰€æœ‰æ•°æ®ç‚¹ä½œä¸ºä¸€ä¸ªç°‡ï¼Œæ¯æ¬¡å°†ç°‡ä¸€åˆ†ä¸ºäºŒï¼Œé€‰æ‹©å“ªä¸ªç°‡è¿›è¡Œåˆ’åˆ†è¦çœ‹èƒ½å¦æœ€å¤§åŒ–å‡å°‘sseï¼Œå½“åˆ’åˆ†ä¹‹åçš„sseæ¯”åŸæ¥çš„å°ï¼Œåˆ™ä¿å­˜å½“å‰çš„è´¨å¿ƒï¼Œæœ€ç»ˆå¾—åˆ°çš„ç°‡è¯¯å·®å¹³æ–¹å’Œæœ€å°ï¼Œæ”¹è¿›çš„ç®—æ³•ä¹Ÿç§°äºŒåˆ†kå‡å€¼èšç±»ã€‚</p>
<p>ï¼ˆ1ï¼‰å°†æ‰€æœ‰æ•°æ®ä½œä¸ºä¸€ä¸ªç°‡ï¼Œå–å‡å€¼å¾—åˆ°åˆå§‹çš„è´¨å¿ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ‰€æœ‰æ•°æ®å–å‡å€¼</span></span><br><span class="line">centroids0=mean(data,axis=<span class="number">0</span>).tolist[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#è½¬æ¢ä¸ºçŸ©é˜µå½¢å¼</span></span><br><span class="line">centroids=mat(centroids0)</span><br><span class="line"><span class="comment">#æ±‚åˆå§‹è´¨å¿ƒåˆ°å„ç‚¹çš„è·ç¦»</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">  clusterAssment[i,<span class="number">1</span>]=distmes(centroids,data[i,:])**<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å½“ç°‡çš„é•¿åº¦å°äºk</p>
<p>aï¼‰å¯¹æ‰€æœ‰ç°‡</p>
<p>å°†ç°‡ä¸€åˆ†ä¸ºäºŒï¼Œå¾—åˆ°æ­¤æ—¶çš„è¯¯å·®ï¼Œæ‰¾åˆ°ä¸€åˆ†ä¸ºäºŒä¹‹åè¯¯å·®æœ€å°çš„ç°‡</p>
<p>bï¼‰è¯¯å·®æœ€å°çš„ç°‡ï¼Œå°†å…¶ä¿å­˜</p>
<p>æ³¨ï¼šå½“æœ‰èµ‹å€¼æ“ä½œçš„æ—¶å€™ï¼Œmatç±»å‹ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œéœ€è¦è½¬æ¢ä¸ºlistç±»å‹ã€‚ä¾‹å¦‚ï¼Œmatop=matop.tolist()[0]</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†æ¯ä¸ªè´¨å¿ƒæ”¾å…¥ä¸€ä¸ªå¤§åˆ—è¡¨ä¸­è¿›è¡Œæ“ä½œ</span></span><br><span class="line">centroList=[centroids0]</span><br><span class="line"><span class="keyword">while</span>(len(centroList)&lt;k):</span><br><span class="line">  lossSSE=inf</span><br><span class="line">  <span class="comment">#1.å¯¹æ‰€æœ‰ç°‡ï¼Œæ‰¾è¯¯å·®æœ€å°çš„</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(centroList)):</span><br><span class="line">    <span class="comment">#å½“å‰ç°‡çš„æ‰€æœ‰æ•°æ®ç‚¹ clusterAssmentç¬¬0åˆ—</span></span><br><span class="line">    pstCurrent=data[nonzero(clusterAssment[:,<span class="number">0</span>].A==i)[<span class="number">0</span>],:]</span><br><span class="line">    <span class="comment">#äºŒåˆ†ç°‡</span></span><br><span class="line">    centroids,splitCluster=kmeans(pstCurrent,<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#æ±‚è¯¯å·®</span></span><br><span class="line">    sseSplit=sum(splitCluster[:,<span class="number">1</span>])</span><br><span class="line">    sseNotSplit=sum(clusterAssment[nonzero(clusterAssment[:,<span class="number">0</span>].A!=i)[<span class="number">0</span>],<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span>(sseSplit+sseNotSplit&lt;lossSSE):</span><br><span class="line">      bestCent=i</span><br><span class="line">      bestCluster=splitCluster.copy()</span><br><span class="line">      bestCentroid=centroids</span><br><span class="line">      lossSSE=sseSplit+sseNotSplit</span><br><span class="line">   <span class="comment">#2.æ›´æ–°ç°‡çš„ç»“æœï¼Œä¸€ä¸ªå–ä»£æˆä¸ºç¬¬iä¸ªç°‡ï¼Œå¦ä¸€ä¸ªæˆä¸ºç¬¬m+1ä¸ªç°‡ï¼ŒåŸæ¥ä¸€å…±æœ‰mä¸ªç°‡</span></span><br><span class="line">  bestCluster[nonzero(bestCluster[:,<span class="number">0</span>].A==<span class="number">0</span>)[<span class="number">0</span>],<span class="number">0</span>]=bestCent</span><br><span class="line">  bestCluster[nonzero(bestCluster[:,<span class="number">0</span>].A==<span class="number">1</span>)[<span class="number">0</span>],<span class="number">0</span>]=len(centroList)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#3.å°†æœ€ä½³åˆ†ç±»çš„è´¨å¿ƒåŠ å…¥ç°‡åˆ—è¡¨ äºŒåˆ†ç±»æ‰€ä»¥è´¨å¿ƒæ˜¯ä¸¤ä¸ª</span></span><br><span class="line">  centroList[bestCent]=bestCentroid[<span class="number">0</span>,:].tolist()[<span class="number">0</span>]</span><br><span class="line">  centroList.append(bestCentroid[<span class="number">1</span>,:].tolist()[<span class="number">0</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#4.å°†ç°‡åˆ†ç±»çš„ç»“æœåŠ å…¥åˆ—è¡¨ä¸­</span></span><br><span class="line">  clusterAssment[nonzero(clusterAssment[:,<span class="number">0</span>].A==bestCent)[<span class="number">0</span>],:]=bestCluster</span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨å®ä¾‹"><a href="#åº”ç”¨å®ä¾‹" class="headerlink" title="åº”ç”¨å®ä¾‹"></a>åº”ç”¨å®ä¾‹</h2><p>ç»™å‡ºåœ°å›¾ä¸Šä¸€äº›ç‚¹çš„ç»åº¦å’Œçº¬åº¦ï¼Œå°†å…¶åˆ†ä¸ºåˆé€‚çš„ç±»ï¼Œä½¿å¾—é€šè¿‡ä¸­å¿ƒç‚¹èƒ½å¾ˆå¿«åˆ°è¾¾å…¶ä½™ç‚¹ã€‚åŒæ—¶è§‚å¯Ÿä¸åŒçš„ç°‡æ•°ç›®kçš„åˆ†ç±»æ•ˆæœã€‚</p>
<p>ï¼ˆ1ï¼‰æ•°æ®æ¥æº</p>
<p>ä»è°·æ­Œapiä¸Šè·å–ä¸€äº›clubçš„ç»åº¦å’Œçº¬åº¦ä¿å­˜ä¸ºplace.txtï¼Œå…¶ä¸­æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªclubçš„ä½ç½®ï¼Œæœ€åä¸¤è¡Œä¿å­˜äº†å¯¹åº”åœ°ç‚¹çš„çº¬åº¦å’Œç»åº¦</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200319144017.png" alt="æ•°æ®ç‚¹"></p>
<p>ï¼ˆ2ï¼‰è¿è¡Œkmeans.clubsCluster(â€œplace.txtâ€,5)</p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200319150954.png" alt="æ•ˆæœå›¾"></p>
<p>å¯ä»¥çœ‹å‡ºæ•°æ®ç‚¹è¢«åˆ†æˆäº†5ä¸ªç°‡ï¼Œæ¯ä¸ªç°‡çš„ä¸­å¿ƒç”¨â€œ+â€å·æ ‡è®°å‡ºæ¥äº†ï¼Œæ­¤æ—¶ä»ç°‡çš„ä¸­å¿ƒåˆ°å…¶ä½™ç‚¹æ˜¯æœ€è¿‘çš„ã€‚</p>
<p>ï¼ˆ3ï¼‰è§‚å¯Ÿä¸åŒkä¸‹çš„è¿è¡Œç»“æœ</p>
<p>å½“åˆ†çš„ç°‡è¶Šå¤šï¼Œç°‡çš„è¯¯å·®å°±è¶Šå°ï¼Œä½†æ˜¯æ•°é‡è¶Šå¤šä¸ç¬¦åˆå®é™…ï¼Œå› æ­¤éœ€è¦æ‰¾ä¸€ä¸ªæŠ˜ä¸­ç‚¹ã€‚</p>
<p>ï¼ˆ4ï¼‰ç¨‹åºï¼š</p>
<p>aï¼‰ç›¸ä¼¼åº¦è®¡ç®—æ–¹æ³•ä½¿ç”¨çƒé¢è·ç¦»å…¬å¼ï¼š</p>
<p>è®¾æ‰€æ±‚ç‚¹Açº¬åº¦è§’Î²1ï¼Œç»åº¦è§’Î±1ï¼Œ ç‚¹B çº¬åº¦è§’Î²2ï¼Œ ç»åº¦è§’Î±2  R*arccos[cosÎ²1cosÎ²2cosï¼ˆÎ±1-Î±2ï¼‰+sinÎ²1sinÎ²2] </p>
<p>bï¼‰èšç±»ï¼š</p>
<p>1.è¯»å…¥æ–‡ä»¶ä¸­æœ€åä¸¤è¡Œæ•°æ®ï¼Œå¹¶è½¬æ¢ä¸ºæ•°å€¼ç±»å‹çš„matç±»å‹çŸ©é˜µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fr=open(filename)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> fr.readlines():</span><br><span class="line">  <span class="comment">#ä»¥\tåˆ†å‰²æ¯è¡Œæ•°æ®ï¼Œå¹¶ä¸”å»æ‰æ¯è¡Œæœ€åçš„å›è½¦ç¬¦</span></span><br><span class="line">  lineList=line.rstrip(<span class="string">"\n"</span>).split(<span class="string">"\t"</span>)</span><br><span class="line">  dataList.append((float(lineList[<span class="number">4</span>],float(lineList[<span class="number">5</span>])))</span><br><span class="line">dataList=mat(dataList)</span><br></pre></td></tr></table></figure>

<p>2.ä½¿ç”¨äºŒåˆ†kå‡å€¼åˆ†ç±»ï¼Œå¾—å‡ºæœ€ä½³åˆ†ç±»ç°‡centroids</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">centroids,clusterAssment=biKmeans(dataList,k,distMes=çƒé¢è·ç¦»å…¬å¼)</span><br></pre></td></tr></table></figure>

<p>3.ç”»å›¾</p>
<p>å°†å¾—åˆ°çš„åˆ†ç±»ç»“æœå±•ç¤ºå‡ºæ¥ï¼Œä½¿ç”¨matplotlibåº“ä¸­çš„pyplotè¿›è¡Œç”»å›¾</p>
<p>ç”»å›¾å‡†å¤‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig=plt.figure()</span><br><span class="line"><span class="comment">#è®¾ç½®æ˜¾ç¤ºå›¾å½¢çš„ä½ç½®å’Œæ¯”ä¾‹</span></span><br><span class="line">ret=[<span class="number">0.1</span>,<span class="number">0.1</span>,<span class="number">0.8</span>,<span class="number">0.8</span>]</span><br><span class="line">.....</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>ç”»èƒŒæ™¯</p>
<p>è¯»å…¥èƒŒæ™¯å›¾ç‰‡ï¼Œå¹¶æ˜¾ç¤º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img=plt.imread(èƒŒæ™¯å›¾ç‰‡)</span><br><span class="line"><span class="comment">#æŒ‰ç…§æ¨ªçºµåæ ‡æ•°æ®æ¯”åˆ—è®¾ç½®åæ ‡è½´,å¹¶ä¼šå»æ‰é¢„è®¾åæ ‡æ•°å­—</span></span><br><span class="line">axpos=dict[xticks[],yticks[]]</span><br><span class="line"><span class="comment">#ä¸ºæ˜¾ç¤ºçš„å›¾åƒè®¾ç½®åº•å±‚åŒºåŸŸ</span></span><br><span class="line">axis0=fig.add_axis(ret,label=<span class="string">""</span>,**axpos)</span><br><span class="line">axis0.imshow(img)</span><br></pre></td></tr></table></figure>

<p>åŠ ä¸Š**axposæ•ˆæœï¼Œæ­¤æ—¶æŒ‰ç…§æ•°æ®ç‚¹æ•°å€¼å¤§å°è®¾ç½®åæ ‡è½´</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200319150954.png" alt="åŠ ä¸Š**axpos"></p>
<p>å»æ‰**axposæ•ˆæœï¼Œå‘ç°åæ ‡è½´æ•°å­—å‡ºç°é‡å </p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200319151338.png" alt="å»æ‰**axpos"></p>
<p>ç”»æ•°æ®ç‚¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è®¾ç½®å›¾æ¡ˆæ ‡è®°</span></span><br><span class="line">markerList=[<span class="string">'s'</span>,....]</span><br><span class="line"><span class="comment">#ä¸ºæ˜¾ç¤ºçš„å›¾åƒå¢åŠ å­åŒºåŸŸ,frameonè®¾ç½®æ˜¯å¦è¦†ç›–ä¸‹é¢çš„åŒºåŸŸ</span></span><br><span class="line">axis1=fig.add_axis(ret,label=<span class="string">""</span>,frameon=false)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">  <span class="comment">#è·å–ç¬¬iä¸ªç°‡çš„æ•°æ®ç‚¹</span></span><br><span class="line">  pstCurrent=dataList[nonzero(clusterAssment[:,<span class="number">0</span>].A==i)[<span class="number">0</span>],:]</span><br><span class="line">  pstMarker=markerList[i/len]</span><br><span class="line">  <span class="comment">#äºŒç»´è½¬æ¢ä¸ºä¸€ç»´æ˜¾ç¤º</span></span><br><span class="line"> axis1.scatter(pstCurrent[:,<span class="number">0</span>].flattern().A[<span class="number">0</span>],pstCurrent[:,<span class="number">1</span>].flattern().A[<span class="number">0</span>],marker=pstMarker,s=<span class="number">90</span>)</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼š</p>
<p>1.subplotï¼Œadd_axisçš„åŒºåˆ«</p>
<p>subplotæ˜¯è®¾ç½®ä¸€æ•´ä¸ªåŒºåŸŸä¸­çš„å­å›¾ï¼Œä¸å­˜åœ¨é‡å ï¼šsubplot(221)è¡¨ç¤ºå°†æ˜¾ç¤ºå›¾åƒçš„åŒºåŸŸåˆ†ä¸º2*2ä¸ªï¼Œå½“å‰å›¾æ¡ˆæ˜¾ç¤ºåœ¨ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p>add_axisæ˜¯è®¾ç½®åŒä¸€ä¸ªå›¾åƒä¸­çš„åŒºåŸŸï¼Œå­˜åœ¨é‡å ã€‚</p>
<p>2.scatterï¼Œplotçš„åŒºåˆ«</p>
<p>scatteræ˜¯ç»˜åˆ¶æ•°æ®ç‚¹ï¼Œå±äºç¦»æ•£å‹å›¾æ¡ˆ</p>
<p>plotæ˜¯å°†æ•°æ®ç‚¹è¿æ¥èµ·æ¥ï¼Œå±äºè¿ç»­å‹å›¾æ¡ˆ</p>
<p>ç”»æ¯ä¸ªç°‡çš„ä¸­å¿ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(k):  </span><br><span class="line">  axis1.scatter(centroids[i,<span class="number">0</span>],centroids[i,<span class="number">1</span>],marker=<span class="string">"+"</span>,s=<span class="number">300</span>)<span class="comment">#æ¯ä¸ªè´¨å¿ƒé¢œè‰²ä¼šä¸ä¸€æ ·</span></span><br><span class="line">  æˆ–è€… axis1.scatter(centroids[:,<span class="number">0</span>].flattern().A[<span class="number">0</span>],centroids[:,<span class="number">1</span>].flattern().A[<span class="number">0</span>],marker=<span class="string">"+"</span>,s=<span class="number">300</span>)<span class="comment">#æ¯ä¸ªè´¨å¿ƒé¢œè‰²ä¸€æ ·</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>kå‡å€¼èšç±»</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</title>
    <url>/blogs/bayes/</url>
    <content><![CDATA[<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><p>ï¼ˆ1ï¼‰é—®é¢˜åŸç†ï¼šæœ´ç´ è´å¶æ–¯åˆ†ç±»çš„ä¾æ®æ˜¯æ¦‚ç‡ï¼Œå‡è®¾éœ€è¦åˆ†ä¸ºä¸¤ç±»c1å’Œc2ï¼Œåˆ™æŸä¸ªæ•°æ®ç‚¹å±äºå“ªä¸€ç±»ï¼Œéœ€è¦è®¡ç®—p(c1|x)å’Œp{c2|x)ï¼Œå³è®¡ç®—æ•°æ®ç‚¹xæ¥è‡ªc1å’Œæ¥è‡ªc2ä¸­çš„æ¦‚ç‡å“ªä¸ªå¤§ï¼Œå¦‚æœp(c1|x)&gt;p{c2|x)ï¼Œåˆ™xè¢«åˆ†åˆ°c1ç±»åˆ«ä¸­ï¼Œåä¹‹è¢«åˆ†åˆ°c2ç±»åˆ«ä¸­ã€‚</p><p>ï¼ˆ2ï¼‰è®¡ç®—åŸç†ï¼šä¸Šè¿°æ¦‚ç‡å±äºæ¡ä»¶æ¦‚ç‡ï¼Œæ ¹æ®å…¬å¼p(c|x)=p(x|c) * p(c)/ p(x)å¯ä»¥å¾—åˆ°ï¼Œå½“æ±‚ï¼ˆx,yï¼‰æ¥è‡ªå“ªä¸ªç±»åˆ«æ—¶ï¼Œå³ç”¨ï¼ˆx,yï¼‰æ›¿æ¢xï¼Œå³æ±‚p(c|x,y),ä»£å…¥æ¡ä»¶æ¦‚ç‡å…¬å¼ä¸­å¾—ï¼Œp(c|x,y)=p(x,y|c) * p(c)/p(x,y)ï¼Œå› æ­¤é—®é¢˜è½¬æ¢ä¸ºæ±‚p(x,y|c) * p(c)/p(x,y)ä¸­ä¸‰ä¸ªæ¦‚ç‡çš„å€¼ã€‚</p><a id="more"></a>

<p>æ±‚p(c)ï¼šå¯¹äºæ‰€æœ‰æ•°æ®ç‚¹æ¥è¯´ï¼Œp(c)æ˜¯å‡ºç°æŸç±»åˆ«çš„æ•°æ®/æ€»æ•°æ®</p>
<p>æ±‚p(x,y|c)ï¼šå› ä¸ºæœ´ç´ è´å¶æ–¯çš„å‡è®¾æ˜¯æ‰€æœ‰ç‰¹å¾æ˜¯ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆp(x,y|c)=p(x1,y1|c) * p(x2,y2|c) *â€¦ * p(xn,yn|c)ï¼Œp(xi,yi|c)æ˜¯æ±‚åœ¨æŸä¸ªç±»åˆ«ä¸‹ï¼Œæ¯ä¸ªç‰¹å¾çš„æ•°æ®å å½“å‰ç±»åˆ«æ€»æ•°æ®çš„æ¦‚ç‡ï¼Œæ¯ä¸ªç‰¹å¾çš„æ¦‚ç‡æ±‚è§£å‡ºåè¿ä¹˜å³å¯å¾—åˆ°è¯¥æ¦‚ç‡</p>
<p>æ±‚p(x,y)ï¼šå› ä¸ºå¯¹äºæ‰€æœ‰ç±»åˆ«æ¥è¯´p(x,y)éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥åªè¦æ¯”è¾ƒä¸Šé¢ä¸¤ä¸ªæ¦‚ç‡ä¹˜ç§¯çš„å¤§å°å³å¯</p>
<h2 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h2><p>ä»¥äºŒåˆ†ç±»ä¸ºä¾‹å­ï¼š</p>
<p>ï¼ˆ1ï¼‰è½½å…¥æ•°æ®é›†</p>
<p>1.è¯»å–æ–‡ä»¶è·¯å¾„ï¼Œå¹¶å°†è¯»å–çš„æ–‡ä»¶æŒ‰ç…§å•è¯è¿›è¡Œåˆ’åˆ†ï¼Œåˆ’åˆ†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">regex=re.compile(<span class="string">"\\W+"</span>)</span><br><span class="line">listToken=regex.split(file)</span><br></pre></td></tr></table></figure>

<p>2.å°†æ•°æ®è¿›è¡Œå­˜å‚¨ï¼ŒåŒæ—¶å­˜å‚¨æ•°æ®æ ‡ç­¾</p>
<p>æ³¨ï¼šå› ä¸ºæ­¤æ—¶å­˜å‚¨çš„æ•°æ®é›†æ˜¯æ–‡æœ¬ï¼Œåœ¨æµ‹è¯•å’Œè®­ç»ƒçš„æ—¶å€™éœ€è¦è½¬æ¢ä¸ºå•è¯å‘é‡çš„å½¢å¼</p>
<p>è¾“å…¥è¯æ±‡è¡¨å’Œéœ€è¦å˜ä¸ºå•è¯å‘é‡çš„æ–‡æœ¬ï¼Œåœ¨è¯æ±‡è¡¨ä¸­å‡ºç°çš„å•è¯çš„ä½ç½®ï¼Œåœ¨å•è¯å‘é‡ä¸­å¯¹åº”è®¾ç½®ä¸º1ï¼Œå…¶ä½™ä¸º0ï¼Œè¿™æ ·å°±èƒ½æ„é€ å‡ºå•è¯å‘é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> inputWord:</span><br><span class="line">  <span class="keyword">if</span> word <span class="keyword">in</span> vocabList:</span><br><span class="line">    returnVec[vocaList.index(word)]+=<span class="number">1</span><span class="comment">#åœ¨è¯æ±‡è¡¨ä¸­å•è¯çš„ä½ç½®çš„ï¼Œå¯¹åº”çš„å•è¯å‘é‡çš„ä½ç½®è®¾ç½®ä¸º1</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ * ï¼‰å¯å¢åŠ çš„éƒ¨åˆ†ï¼šåˆ é™¤é«˜é¢‘è¯</p>
<p>å› ä¸ºæœ‰äº›è¯ä¾‹å¦‚a,about,theç­‰è¿™äº›å¸¸ç”¨è¯åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå‡ºç°ï¼Œè¿™äº›é«˜é¢‘å‡ºç°çš„è¯ï¼Œå¯èƒ½ä¼šå¯¹åˆ†ç±»çš„æ¦‚ç‡äº§ç”Ÿå½±å“ï¼Œå¯ä»¥å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œéå†ï¼Œæ‰¾åˆ°å‡ºç°é¢‘ç‡æœ€é«˜çš„å•è¯åœ¨è¯æ±‡è¡¨ä¸­åˆ é™¤ï¼ˆå¯ä»¥å–å‰20æˆ–30ç­‰ï¼Œæ ¹æ®æ•°æ®é‡å†³å®šï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcTopWord</span><span class="params">(fullText,vocabList)</span>:</span></span><br><span class="line">  //å­˜å‚¨å‡ºç°æ¦‚ç‡åŠå•è¯ï¼Œç”¨åˆ°é”®å€¼å¯¹</span><br><span class="line">  wordList=&#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> word <span class="keyword">in</span> fullText:</span><br><span class="line">    wordlist[word]=fullText.(word)<span class="comment">#åœ¨æ•´ç¯‡æ–‡æ¡£è®¡ç®—å•è¯å‡ºç°çš„æ¬¡æ•°ï¼Œcount</span></span><br><span class="line">  //ä»å¤§åˆ°å°æ’åº,ç”¨å€¼æ’åº</span><br><span class="line">  rankList=sorted(wordList.items(),key=operator.itemgetter(<span class="number">1</span>),reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¾—å‡ºè¯æ±‡è¡¨</p>
<p>æ‰¾åˆ°æ•°æ®é›†ä¸­ä¸é‡å¤çš„å•è¯ä½œä¸ºè¯æ±‡è¡¨ï¼Œä¸ºåç»­ç»Ÿè®¡æ¯ä¸ªå•è¯å‡ºç°çš„é¢‘ç‡ï¼ˆå³æ¯ä¸ªç‰¹å¾çš„æ¦‚ç‡ï¼‰åšå‡†å¤‡</p>
<p>ç”¨setå¾—åˆ°ä¸é‡å¤çš„å•è¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> dataWord <span class="keyword">in</span> dataSet:</span><br><span class="line">		vocaList=vocaList|set(dataWord)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰éšæœºé€‰æ‹©ä¸€éƒ¨åˆ†ä½œä¸ºæµ‹è¯•é›†å’Œè®­ç»ƒé›†</p>
<p>å°†è®­ç»ƒé›†è®¾ç½®ä¸ºæ€»æ•°æ®é›†æ•°é‡ï¼Œæµ‹è¯•é›†ç”¨éšæœºæ•°è®¾ç½®ï¼ˆrandom.uniformï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">trainSet=list(range(lenData))</span><br><span class="line"><span class="comment">#å‡è®¾éšæœºé€‰æ‹©5ä¸ªæµ‹è¯•é›†</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">  <span class="comment">#å¾—å‡ºä½ç½® intç±»å‹</span></span><br><span class="line">  testIndex=(int)(random.uniform(<span class="number">0</span>,len(trainSet)))</span><br><span class="line">  <span class="comment">#æµ‹è¯•é›†çš„æ•°æ®ä½ç½®</span></span><br><span class="line">  testSet.appen(trainSet[testIndex])</span><br><span class="line">  <span class="comment">#è®­ç»ƒé›†çš„æ•°æ®ä½ç½®</span></span><br><span class="line">  <span class="keyword">del</span>(trainSet[testIndex])</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰æ ¹æ®è®­ç»ƒé›†è®­ç»ƒè´å¶æ–¯åˆ†ç±»å™¨</p>
<p>1.è®¡ç®—p(c)ã€p(x,y|c)</p>
<p>è®¡ç®—p(c)ï¼šå› ä¸ºæ˜¯ä¸¤ä¸ªç±»åˆ«ï¼Œåªéœ€è¦è®¡ç®—p(c)ï¼Œç”¨1-p(c)å¯ä»¥å¾—å‡ºå¦ä¸€ä¸ªç±»åˆ«å‡ºç°çš„æ¦‚ç‡ã€‚p(c)é€šè¿‡å¯¹ç±»åˆ«æ ‡è®°ä¸­1å‡ºç°çš„æ¬¡æ•°æ±‚å’Œå³ä¸º1ç±»åˆ«å‡ºç°çš„æ¬¡æ•°ï¼Œå†é™¤ä»¥æ–‡æ¡£æ€»æ•°ï¼Œå³ä¸ºp(c)</p>
<p>è®¡ç®—p(x,y|c)ï¼šå¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œéå†ï¼Œåˆ†å¸ƒå¯¹0ç±»åˆ«å’Œ1ç±»åˆ«ä¸‹ï¼Œæ‰€æœ‰å•è¯å‡ºç°çš„æ¦‚ç‡è¿›è¡Œè®¡ç®—</p>
<p>æ³¨ï¼šä¸ºé˜²æ­¢å‡ºç°å¾ˆå¤šå¾ˆå°çš„æ•°ï¼šè®¡ç®—æ¦‚ç‡æ—¶ç”¨logï¼Œå³p(x,y|c)ç”¨logp(x,y|c)è¡¨ç¤º</p>
<p>ä¸ºé˜²æ­¢å„ä¸ªç‰¹å¾çš„æ¦‚ç‡ç›¸ä¹˜å‡ºç°0ï¼šåˆå§‹è®¾ç½®p(x,y|c)=1ï¼Œp(c)=2</p>
<p>2.è®­ç»ƒçš„ç»“æœå°±æ˜¯å¾—å‡ºè®­ç»ƒé›†ä¸‹æ•°æ®å±äºä¸åŒç±»åˆ«çš„æ¦‚ç‡</p>
<p>ä»¥ä¸¤ä¸ªç±»åˆ«ä¸ºä¾‹ï¼Œå³æœ€ç»ˆå¾—å‡ºåœ¨0ç±»åˆ«å’Œ1ç±»åˆ«ä¸‹æ‰€æœ‰ç‰¹å¾çš„å‡ºç°çš„æ¦‚ç‡p(x,y|c0)ï¼Œp(x,y|c1)å’Œ0ç±»åˆ«ã€1ç±»åˆ«æ•°æ®å‡ºç°çš„æ¦‚ç‡p(c)ï¼Œå¾—å‡ºè¿™ä¸¤ä¸ªæ¦‚ç‡åï¼Œç”¨æµ‹è¯•é›†æ•°æ®ä¹˜ä»¥ä¸åŒç±»åˆ«ä¸‹çš„p(ci|x,y)ï¼ˆå³ç”¨æ•°æ® *p(x,y|ci) * p(c)ï¼‰ï¼Œæ¯”è¾ƒp(x,y|c0)å’Œp(x,y|c1)å¾—å‡ºåˆ†å±çš„ç±»åˆ«ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å·²æ±‚å‡ºp0V,p1V,pAuixs</span></span><br><span class="line"><span class="comment">#å±äºä¸¤ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œè¿›è¡Œæ¯”è¾ƒå³å¯</span></span><br><span class="line">p1=sum(inputMatrix*p1V)+log(pAuixs)</span><br><span class="line">p0=sum(inputMatrix*p0V)+log(<span class="number">1</span>-pAuixs)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ5ï¼‰åœ¨æµ‹è¯•é›†ä¸Šï¼Œä½¿ç”¨è´å¶æ–¯åˆ†ç±»å™¨ï¼Œåˆ†ç±»ç»“æœå’Œå®é™…æ ‡è®°å¯¹æ¯”ï¼Œå¾—å‡ºæ€»ä½“é”™è¯¯ç‡</p>
<p>1.è®¡ç®—æ¡ä»¶æ¦‚ç‡ï¼Œå³æ¯”è¾ƒä¸¤ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œç¡®å®šåˆ†ç±»çš„ç»“æœ</p>
<p>2.ä¸å®é™…ç»“æœæ¯”å¯¹ï¼Œåˆ†ç±»é”™è¯¯åˆ™è¿›è¡Œæ ‡è®°</p>
<h2 id="åº”ç”¨æ¡ˆä¾‹"><a href="#åº”ç”¨æ¡ˆä¾‹" class="headerlink" title="åº”ç”¨æ¡ˆä¾‹"></a>åº”ç”¨æ¡ˆä¾‹</h2><p>å¹¿å‘Šå†…å®¹å€¾å‘åˆ†ç±»</p>
<p>è¯¥æ¡ˆä¾‹ä½¿ç”¨feedparseè·å–ç½‘é¡µçš„rssæºï¼Œå¯¹ç½‘é¡µæ‰€æœ‰ç›®å½•çš„åˆ—è¡¨è¯»å–å…¶ä¸­çš„æ¦‚è¦ï¼Œè¾“å…¥ä¸¤ä¸ªç½‘é¡µï¼Œæ ¹æ®ä¸¤ä¸ªç½‘é¡µä¸­å•è¯å‡ºç°çš„æ¦‚ç‡æ¥è¿›è¡Œåˆ†ç±»ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#è·å¾—ä¸é‡å¤çš„å•è¯åˆ—è¡¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createVocabList</span><span class="params">(dataSet)</span>:</span></span><br><span class="line">	<span class="comment">#setè¿”å›çš„æ˜¯ä¸é‡å¤çš„æ•°æ®</span></span><br><span class="line">	vocaList=set([])</span><br><span class="line">	<span class="keyword">for</span> dataWord <span class="keyword">in</span> dataSet:</span><br><span class="line">		vocaList=vocaList|set(dataWord)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> list(vocaList)<span class="comment">#è¿”å›åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.0è¯è¢‹æ¨¡å‹ï¼Œæ¯ä¸ªè¯å¯ä»¥å‡ºç°å¤šæ¬¡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bagOfWords2Vec</span><span class="params">(vocaList,inputWord)</span>:</span></span><br><span class="line">	returnVec=[<span class="number">0</span>]*len(vocaList)</span><br><span class="line">	<span class="keyword">for</span> word <span class="keyword">in</span> inputWord:</span><br><span class="line">		<span class="keyword">if</span>(word <span class="keyword">in</span> vocaList):</span><br><span class="line">			returnVec[vocaList.index(word)]+=<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			print(<span class="string">"the word:"</span>+str(word)+<span class="string">" is not in the vocaList"</span>)</span><br><span class="line">	<span class="keyword">return</span> returnVec</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æ¡£åˆ†ç±»</span></span><br><span class="line"><span class="comment">#ä¸»è¦æ˜¯è¿›è¡Œæ¦‚ç‡æ¯”è¾ƒï¼Œæ¡ä»¶æ¦‚ç‡å®šä¹‰ä¸ºp(c|w)=p(w|c)*p(c)/p(w),å¯¹æ‰€æœ‰ç±»åˆ«æ¥è¯´ï¼Œp(w)éƒ½æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤å¯ä»¥ä¸è®¡ç®—</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainNB0</span><span class="params">(trainMatrix,trainCatalog)</span>:</span></span><br><span class="line">	<span class="comment">#0.è®¡ç®—ä¸åŒç±»åˆ«ä¸‹çš„æ–‡æ¡£æ¦‚ç‡å³p(c)</span></span><br><span class="line">	<span class="comment">#æ­¤å¤„æ˜¯äºŒå€¼åˆ†ç±»ï¼Œå¦ä¸€ä¸ªæ¦‚ç‡å¯ä»¥ç”¨1-p(c)æ¥è®¡ç®—</span></span><br><span class="line">	<span class="comment">#0.0æ–‡æ¡£çš„ä¸ªæ•°</span></span><br><span class="line">	numDocu=len(trainMatrix)</span><br><span class="line">	<span class="comment">#0.1ä¾®è¾±æ€§æ–‡æ¡£çš„æ¦‚ç‡</span></span><br><span class="line"></span><br><span class="line">	pAuixs=sum(trainCatalog)/numDocu</span><br><span class="line">	<span class="comment">#0.2åˆå§‹åŒ–ç´¯åŠ å€¼</span></span><br><span class="line">	<span class="comment">#æ¯è¡Œè¯æ±‡çš„é•¿åº¦</span></span><br><span class="line">	numWords=len(trainMatrix[<span class="number">0</span>])</span><br><span class="line">	<span class="comment">#å› ä¸ºæ˜¯ç‹¬ç«‹çš„æ¦‚ç‡ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªä¸º0ï¼Œæ•´ä¸ªä¸º0ï¼Œé¿å…è¿™ç§æƒ…å†µï¼Œåˆå§‹åŒ–ä¸º1</span></span><br><span class="line">	<span class="comment">#p1num=zeros((numWords))</span></span><br><span class="line">	<span class="comment">#p0num=zeros(numWords)</span></span><br><span class="line">	<span class="comment">#p1Denom=0</span></span><br><span class="line">	<span class="comment">#p0Denom=0</span></span><br><span class="line">	p1num=ones((numWords))</span><br><span class="line">	p0num=ones(numWords)</span><br><span class="line">	p1Denom=<span class="number">2</span></span><br><span class="line">	p0Denom=<span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.æŒ‰ç…§ä¸åŒç±»åˆ«è®¡ç®—p(w|c)å³è®¡ç®—ä¸åŒç±»åˆ«ä¸‹è¯å‘é‡å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">	<span class="comment">#æ ¹æ®å½“å‰ç±»åˆ«ä¸‹æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°é™¤ä»¥åœ¨è¯¥ç±»åˆ«ä¸‹æ‰€æœ‰å•è¯å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(numDocu):</span><br><span class="line">		<span class="comment">#1.0 ä¾®è¾±ç±»åˆ«</span></span><br><span class="line">		<span class="keyword">if</span>(trainCatalog[i]==<span class="number">1</span>):</span><br><span class="line">			p1num+=trainMatrix[i]</span><br><span class="line">			p1Denom+=sum(trainMatrix[i])</span><br><span class="line">		<span class="comment">#1.1 éä¾®è¾±ç±»åˆ«</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			p0num+=trainMatrix[i]</span><br><span class="line">			p0Denom+=sum(trainMatrix[i])</span><br><span class="line"></span><br><span class="line">	<span class="comment">#ä¸ºäº†é¿å…å‡ºç°è¿‡å°çš„æ•°,å‡ºç°ä¸‹æº¢å‡ºï¼Œä½¿ç”¨log</span></span><br><span class="line">	p1Vec=log(p1num/p1Denom)</span><br><span class="line">	p0Vec=log(p0num/p0Denom)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> p0Vec,p1Vec,pAuixs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classfyNB</span><span class="params">(wordVec,p0Vec,p1Vec,pAuixs)</span>:</span></span><br><span class="line">	<span class="comment">#æ¯”è¾ƒå•è¯å‘é‡ä¹˜ä»¥p(w|c)*p(c),å› ä¸ºp(w|c)ä½¿ç”¨äº†logå¤„ç†ï¼Œæ‰€ä»¥ï¼Œè¿™è¾¹çš„pauixsä¹Ÿéœ€è¦åŠ ä¸Šlog,logç›¸åŠ ä»£è¡¨ç›¸ä¹˜</span></span><br><span class="line">	<span class="comment">#å› ä¸ºæ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥è®¡ç®—æ¯ä¸ªå•è¯å‡ºç°çš„æ¦‚ç‡p(wi|c)ï¼Œå› ä¸ºåšäº†logå¤„ç†ï¼Œè¿™é‡Œsumç­‰åŒäºå»æ‰logåæ¦‚ç‡ç›¸ä¹˜</span></span><br><span class="line">	p1=sum(wordVec*p1Vec)+log(pAuixs)</span><br><span class="line">	p0=sum(wordVec*p0Vec)+log(<span class="number">1</span>-pAuixs)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(p1&gt;p0):</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•åˆ†ç±»å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testingNB</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="comment">#0.è½½å…¥å®éªŒæ ·æœ¬</span></span><br><span class="line">	listPosts,listLabels=loadDataSet();</span><br><span class="line">	<span class="comment">#1.ç”Ÿæˆè¯æ±‡è¡¨</span></span><br><span class="line">	vocabList=createVocabList(listPosts)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#2.æ–‡æœ¬è½¬æ¢ä¸ºå•è¯å‘é‡ï¼Œæ–¹æ³•ä¸­æ˜¯å¯¹æ¯è¡Œæ–‡æœ¬è¿›è¡Œè½¬æ¢</span></span><br><span class="line">	m=len(listPosts)</span><br><span class="line">	wordVec=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		wordVec.append(setOfWords2Vec(vocabList,listPosts[i]))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.æ„é€ è´å¶æ–¯åˆ†ç±»å™¨</span></span><br><span class="line">	p0Vec,p1Vec,pAuixs=trainNB0(wordVec,listLabels)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#4.æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">	<span class="comment">#4.0æ„é€ æµ‹è¯•æ•°æ®</span></span><br><span class="line">	testList=[<span class="string">'love'</span>, <span class="string">'my'</span>, <span class="string">'dalmation'</span>]</span><br><span class="line">	<span class="comment">#4.1è½¬æ¢ä¸ºå•è¯å‘é‡</span></span><br><span class="line">	testVec=setOfWords2Vec(vocabList,testList)</span><br><span class="line">	<span class="comment">#4.2è®¡ç®—æ¦‚ç‡</span></span><br><span class="line">	testP=classfyNB(testVec,p0Vec,p1Vec,pAuixs)</span><br><span class="line">	print(str(testList)+<span class="string">" is:"</span>+str(testP))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#4.æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">	<span class="comment">#4.0æ„é€ æµ‹è¯•æ•°æ®</span></span><br><span class="line">	testList=[<span class="string">'stupid'</span>, <span class="string">'garbage'</span>]</span><br><span class="line">	<span class="comment">#4.1è½¬æ¢ä¸ºå•è¯å‘é‡</span></span><br><span class="line">	testVec=setOfWords2Vec(vocabList,testList)</span><br><span class="line">	<span class="comment">#4.2è®¡ç®—æ¦‚ç‡</span></span><br><span class="line">	testP=classfyNB(testVec,p0Vec,p1Vec,pAuixs)</span><br><span class="line">	print(str(testList)+<span class="string">" is:"</span>+str(testP))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨è´å¶æ–¯åˆ†ç±»å™¨è¿›è¡Œåƒåœ¾é‚®ä»¶è¿‡æ»¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯»å–æ–‡ä»¶å†…çš„æ–‡æœ¬ï¼Œå¯¹é•¿åº¦å°äºä¸¤ä¸ªçš„å•è¯è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">textParse</span><span class="params">(file)</span>:</span></span><br><span class="line">	<span class="keyword">import</span> re</span><br><span class="line">	<span class="comment">#0.æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">	regex=re.compile(<span class="string">"\\W+"</span>)</span><br><span class="line">	<span class="comment">#1.å¯¹è¯»å…¥çš„é—®æ´¥è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">	<span class="comment">#file=file.encode('utf-8')</span></span><br><span class="line"></span><br><span class="line">	listTokens=regex.split(file)</span><br><span class="line">	<span class="keyword">return</span> [token.lower() <span class="keyword">for</span> token <span class="keyword">in</span> listTokens <span class="keyword">if</span> len(token)&gt;<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”¨æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å¯¹ä¸ªäººå¹¿å‘ŠåŒºåŸŸè¿›è¡Œå€¾å‘åˆ†ç±»</span></span><br><span class="line"><span class="comment">#ä»rssä¸­è·å–æ–‡æœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†æ–‡æœ¬ä¸­å‡ºç°é¢‘ç‡å‰30çš„å»æ‰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcMostFreq</span><span class="params">(vocabList,fullList)</span>:</span></span><br><span class="line">	<span class="keyword">import</span> operator</span><br><span class="line">	<span class="comment">#ä»£è¡¨é”®å€¼å¯¹</span></span><br><span class="line">	wordFreq=&#123;&#125;</span><br><span class="line">	<span class="comment">#å¯¹æ•´ç¯‡æ–‡æ¡£è®¡ç®—å•è¯è¡¨ä¸­å•è¯å‡ºç°çš„é¢‘ç‡</span></span><br><span class="line">	<span class="keyword">for</span> token <span class="keyword">in</span> vocabList:</span><br><span class="line">		wordFreq[token]=fullList.count(token)</span><br><span class="line">	<span class="comment">#æŒ‰ç…§å­—å…¸ä¸­å€¼è¿›è¡Œæ’åºï¼ˆå³å‡ºç°çš„æ¬¡æ•°ï¼‰ï¼Œä»¥ç¬¬å‡ ä¸ªåŸŸæ’åºï¼ŒæŒ‰ç…§é™åºæ’åˆ—</span></span><br><span class="line">	<span class="comment">#æ­¤æ—¶å˜ä¸ºäº†åˆ—è¡¨ï¼Œå¯ä»¥è¿”å›å‰30ä¸ª</span></span><br><span class="line">	freqList=sorted(wordFreq.items(),key=operator.itemgetter(<span class="number">1</span>),reverse=<span class="literal">True</span>)</span><br><span class="line">	<span class="keyword">return</span> freqList[:<span class="number">30</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å…¥çš„å‚æ•°ä¸ºï¼šä»feedparseä¸­è·å–çš„ç½‘é¡µçš„rssæºï¼Œfeed0æ˜¯0ç½‘é¡µï¼Œé‡Œé¢çš„å†…å®¹æ ‡è®°ä¸º0ï¼Œfeed1æ˜¯1ç½‘é¡µï¼Œé‡Œé¢çš„å†…å®¹æ ‡è®°ä¸º1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loacWords</span><span class="params">(feed0,feed1)</span>:</span></span><br><span class="line">	<span class="keyword">import</span> feedparser</span><br><span class="line">	<span class="comment">#0.è·å–æ–‡æœ¬</span></span><br><span class="line">	docList=[]</span><br><span class="line">	classList=[]</span><br><span class="line">	wordList=[]</span><br><span class="line">	fullList=[]</span><br><span class="line">	<span class="comment">#feed0['entries']æ˜¯è·å–æ‰€æœ‰æ¡ç›®çš„åˆ—è¡¨</span></span><br><span class="line">	minlen=min(len(feed0[<span class="string">'entries'</span>]),len(feed1[<span class="string">'entries'</span>]))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(minlen):</span><br><span class="line">		<span class="comment">#å¯¹ç¬¬iä¸ªæ¡ç›®çš„æ¦‚è¦æå–å†…å®¹ï¼Œå¹¶è¿›è¡Œå•è¯åˆ’åˆ†</span></span><br><span class="line">		wordList=textParse(feed0[<span class="string">'entries'</span>][i][<span class="string">'summary'</span>])</span><br><span class="line">		docList.append(wordList)</span><br><span class="line">		classList.append(<span class="string">"0"</span>)</span><br><span class="line">		<span class="comment">#æŠŠæ‰€æœ‰å•è¯åŠ å…¥åˆ°ä¸€ä¸ªåˆ—è¡¨æ–¹ä¾¿è®¡æ•°</span></span><br><span class="line">		fullList.extend(wordList)</span><br><span class="line"></span><br><span class="line">		wordList=textParse(feed1[<span class="string">'entries'</span>][i][<span class="string">'summary'</span>])</span><br><span class="line">		docList.append(wordList)</span><br><span class="line">		classList.append(<span class="string">"1"</span>)</span><br><span class="line">		<span class="comment">#æŠŠæ‰€æœ‰å•è¯åŠ å…¥åˆ°ä¸€ä¸ªåˆ—è¡¨æ–¹ä¾¿è®¡æ•°</span></span><br><span class="line">		fullList.extend(wordList)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.æ„å»ºè¯æ±‡è¡¨</span></span><br><span class="line">	vocabList=createVocabList(docList);</span><br><span class="line"></span><br><span class="line">	<span class="comment">##0000.å¢åŠ çš„éƒ¨åˆ†ï¼Œå°†æ–‡æœ¬ä¸­é«˜é¢‘å‡ºç°çš„å‰30ä¸ªå•è¯ä»è¯æ±‡è¡¨ä¸­å»é™¤</span></span><br><span class="line">	mostFreq=calcMostFreq(vocabList,fullList)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#freqæ˜¯é”®å€¼å¯¹ï¼Œ[0]ç¬¬0ä¸ªä»£è¡¨å•è¯ï¼Œ[1]ç¬¬ä¸€ä¸ªä»£è¡¨å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">	<span class="keyword">for</span> freq <span class="keyword">in</span> mostFreq:</span><br><span class="line">		<span class="keyword">if</span> freq[<span class="number">0</span>] <span class="keyword">in</span> vocabList:</span><br><span class="line">			vocabList.remove(freq[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">#2.æ–‡æœ¬è½¬æ¢ä¸ºå•è¯å‘é‡</span></span><br><span class="line">	<span class="comment">#inputWord=[]</span></span><br><span class="line">	<span class="comment">#for i in range(2*minlen):</span></span><br><span class="line">	<span class="comment">#	inputWord[i]=bagOfWords2Vec(vocabList,docList[i])</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#3.éšæœºé€‰å–20ä¸ªä½œä¸ºæµ‹è¯•é›†</span></span><br><span class="line">	trainingSet=list(range(<span class="number">2</span>*minlen))</span><br><span class="line">	testingSet=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">		<span class="comment">#ç”Ÿæˆéšæœºæµ®ç‚¹æ•° random.uniform</span></span><br><span class="line">		testIndex=(int)(random.uniform(<span class="number">0</span>,len(trainingSet)))</span><br><span class="line">		testingSet.append(trainingSet[testIndex])</span><br><span class="line">		<span class="keyword">del</span>(trainingSet[testIndex])</span><br><span class="line"></span><br><span class="line">	<span class="comment">#å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—</span></span><br><span class="line">	classList=[int(x) <span class="keyword">for</span> x <span class="keyword">in</span> classList]</span><br><span class="line">	<span class="comment">#4.å‰©ä½™çš„ä½œä¸ºè®­ç»ƒé›†ï¼Œè®¡ç®—åˆ†ç±»å™¨çš„æ¦‚ç‡ï¼Œç”¨äºåˆ†ç±»</span></span><br><span class="line">	traingData=[]</span><br><span class="line">	traingLabels=[]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> trainingSet:</span><br><span class="line">		<span class="comment">#2.æ–‡æœ¬è½¬æ¢ä¸ºå•è¯å‘é‡</span></span><br><span class="line">		traingData.append(bagOfWords2Vec(vocabList,docList[i]))</span><br><span class="line">		traingLabels.append(classList[i])</span><br><span class="line">	p0Vec,p1Vec,pAuixs=trainNB0(traingData,traingLabels)</span><br><span class="line">	<span class="comment">#5.å¯¹æµ‹è¯•é›†è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">	error=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> testingSet:</span><br><span class="line">		testingData=bagOfWords2Vec(vocabList,docList[i])</span><br><span class="line">		testResult=classfyNB(testingData,p0Vec,p1Vec,pAuixs)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(testResult!=classList[i]):</span><br><span class="line">			error+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	print(<span class="string">"the error rate is:"</span>+str((float)(error)/<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> vocabList,p0Vec,p1Vec</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>è´å¶æ–¯åˆ†ç±»</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›‘ç£å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”æ”¯æŒå‘é‡æœº</title>
    <url>/blogs/svm/</url>
    <content><![CDATA[<h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>ï¼ˆ1ï¼‰æ”¯æŒå‘é‡ï¼šæ”¯æŒå‘é‡æœºç”¨äºè§£å†³åˆ†ç±»é—®é¢˜ï¼Œå½“ç»™å‡ºä¸€ç»„çº¿æ€§å¯åˆ†çš„æ•°æ®æ—¶ï¼Œæ­¤æ—¶å¯ä»¥å¾—å‡ºä¸€æ¡ç›´çº¿å°†æ•°æ®åˆ†éš”å¼€ï¼Œè¦æ±‚è¿™æ¡ç›´çº¿å³æ±‚å‡ºäº†åˆ†ç±»çš„ä¾æ®ï¼Œå½“æ ¹æ®è·ç¦»åˆ†éš”çº¿æœ€è¿‘çš„ç‚¹ï¼Œå–å…¶è·ç¦»çš„æœ€å¤§å€¼å°±èƒ½å¾—åˆ°æœ€ä¼˜åˆ†å‰²çš„ç›´çº¿ã€‚å…¶ä¸­è·ç¦»åˆ†éš”çº¿æœ€è¿‘çš„ç‚¹ç§°ä¸ºæ”¯æŒå‘é‡ã€‚</p><p>ï¼ˆ2ï¼‰æœºï¼šæœºæ˜¯æŒ‡è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œä¼šäº§ç”ŸäºŒå€¼å†³ç­–æœºã€‚</p><p>ï¼ˆ3ï¼‰ä¼˜ç‚¹ï¼šæ”¯æŒå‘é‡æœºæ–¹æ³•åªä½¿ç”¨æ”¯æŒå‘é‡ï¼Œå¹¶æ²¡æœ‰ç”¨å…¨éƒ¨çš„æ•°æ®ç‚¹ï¼Œæ‰€ä»¥å†…å­˜æ–¹é¢ä¼˜äºknnã€‚</p><a id="more"></a>


<p>ï¼ˆ4ï¼‰ç¼ºç‚¹ï¼šæ”¯æŒå‘é‡æœºä¸€èˆ¬ç”¨äºçº¿æ€§å¯åˆ†çš„æ•°æ®ï¼Œå½“æ•°æ®çº¿æ€§ä¸å¯åˆ†æ—¶æ— æ³•ä½¿ç”¨ã€‚å¯¹äºå¤æ‚æ•°æ®éœ€è¦å€ŸåŠ©æ ¸å‡½æ•°ï¼Œå°†å¤æ‚æ•°æ®æ˜ å°„åˆ°é«˜ç»´ç©ºé—´è¿›è¡Œå¤„ç†</p>
<h2 id="æ±‚è§£çš„ç†è®ºä¾æ®"><a href="#æ±‚è§£çš„ç†è®ºä¾æ®" class="headerlink" title="æ±‚è§£çš„ç†è®ºä¾æ®"></a>æ±‚è§£çš„ç†è®ºä¾æ®</h2><p>ï¼ˆ1ï¼‰ç¡®å®šåˆ†éš”å¹³é¢å’Œè¾“å‡ºå‡½æ•°</p>
<p>åˆ†éš”å¹³é¢ï¼šwT*x+bï¼Œå…¶ä¸­wå’Œbæè¿°äº†æ‰€ç»™æ•°æ®çš„åˆ†éš”å¹³é¢</p>
<p>å› ä¸ºæ˜¯äºŒå€¼åˆ†ç±»å™¨ï¼Œè¾“å‡ºå€¼æ˜¯-1å’Œ+1ï¼Œæ‰€ä»¥ä½¿ç”¨signmoidå‡½æ•°ï¼Œå½“ç‚¹åˆ°ç›´çº¿çš„è·ç¦»f(wT*x+b)&gt;0æ—¶å±äº +1ç±»ï¼Œåä¹‹å±äº-1ç±»ã€‚</p>
<p>ï¼ˆ2ï¼‰æ±‚è·ç¦»ï¼š</p>
<p>æ•°æ®ç‚¹åˆ°åˆ†éš”å¹³é¢çš„è·ç¦»è®°ä¸º<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306150346.png" alt="ç‚¹åˆ°å¹³é¢çš„å‡ ä½•è·ç¦»"></p>
<p>è¦æ±‚å¾—æœ€ä½³åˆ†éš”å¹³é¢å°±è¦æ‰¾åˆ°è·ç¦»å¹³é¢æœ€ä½³çš„ç‚¹çš„è·ç¦»å°†å…¶æœ€å¤§åŒ–ï¼Œåˆ™ä¸ºæœ€ä½³åˆ†ç±»ï¼Œæ‰€ä»¥å³æ±‚<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306150600.png" alt="æ±‚è§£ç›®æ ‡"></p>
<p>ä½†æ˜¯è¯¥ç›®æ ‡å‡½æ•°æ±‚è§£å›°éš¾ï¼Œå› æ­¤ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•è¿›è¡Œè½¬æ¢å¸¦çº¦æŸè°ƒèŠ‚çš„ç›®æ ‡å‡½æ•°ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306150813.png" alt="è½¬æ¢å‡½æ•°"></p>
<p>å…¶ä¸­çº¦æŸæ¡ä»¶ä¸ºï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306151016.png" alt="çº¦æŸæ¡ä»¶"></p>
<p>å› ä¸ºå®é™…æ•°æ®ä¸å¯èƒ½å­˜åœ¨100%çº¿æ€§å¯åˆ†æ‰€ä»¥æ­¤æ—¶åŠ ä¸Šä¸€ä¸ªæ¾å¼›å˜é‡ï¼Œå¯ä»¥å…è®¸ä¸€äº›ç‚¹åœ¨åˆ†éš”å¹³é¢çš„å¦ä¸€è¾¹ï¼Œæ­¤æ—¶å‰ä¸€ä¸ªçº¦æŸæ¡ä»¶å˜ä¸º0&lt;=alpha&lt;=Cï¼Œè¿™é‡Œçš„å¸¸æ•°Cç¡®ä¿ç‚¹è·ç¦»å¹³é¢çš„æœ€å¤§é—´éš”å’Œæ‰€æœ‰æ•°æ®ç‚¹çš„å‡½æ•°é—´éš”å°äº1.0ï¼ˆå› ä¸ºæ˜¯æ”¯æŒå‘é‡ï¼‰</p>
<p>ï¼ˆ3ï¼‰é—®é¢˜è½¬æ¢</p>
<p>æ ¹æ®ï¼ˆ2ï¼‰ä¸­è½¬æ¢åçš„ç›®æ ‡å‡½æ•°å’Œçº¦æŸæ¡ä»¶å¯ä»¥çœ‹å‡ºï¼ŒSVMï¼ˆæ”¯æŒå‘é‡æœºï¼Œä»¥ä¸‹å‡ç®€ç§°ä¸ºSVMï¼‰çš„ä¸»è¦æ±‚è§£ç›®æ ‡è½¬æ¢ä¸ºæ±‚alphaçš„å€¼ï¼Œé€šè¿‡alphaå¯ä»¥è¡¨ç¤ºåˆ†éš”å¹³é¢ã€‚</p>
<h2 id="ä½¿ç”¨çš„ç®—æ³•"><a href="#ä½¿ç”¨çš„ç®—æ³•" class="headerlink" title="ä½¿ç”¨çš„ç®—æ³•"></a>ä½¿ç”¨çš„ç®—æ³•</h2><p>ç”±æ±‚è§£çš„ç†è®ºä¾æ®ä¸­å¯çŸ¥ï¼ŒSVMéœ€è¦æ±‚è§£çš„ç›®æ ‡ä¸ºå¸¦æœ‰çº¦æŸæ¡ä»¶çš„å‡½æ•°ï¼Œä¸€èˆ¬é‡‡ç”¨äºŒæ¬¡è§„åˆ’æ±‚è§£æ–¹æ³•ï¼Œä½†æ˜¯è®¡ç®—å¤æ‚ï¼Œè¿™é‡Œä½¿ç”¨platt SMOç®—æ³•æ±‚è§£ã€‚</p>
<p>ï¼ˆ1ï¼‰ç®—æ³•æ€è·¯ï¼šæ¯æ¬¡é€‰æ‹©ä¸€å¯¹alphaè¿›è¡Œä¼˜åŒ–ï¼Œå½“æ‰¾åˆ°åˆé€‚çš„ä¸¤ä¸ªalphaåï¼Œéœ€è¦å¢å¤§ä¸€ä¸ªå‡å°å¦ä¸€ä¸ªï¼Œå› ä¸ºéœ€è¦æ»¡è¶³çº¦æŸæ¡ä»¶ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306151016.png" alt="çº¦æŸæ¡ä»¶">ï¼Œåˆé€‚æ˜¯æŒ‡ä¸¤ä¸ªalphaå€¼è¦åœ¨é—´éš”è¾¹ç•Œä¹‹å¤–ï¼ŒåŒæ—¶æ²¡æœ‰è¢«åŒºé—´åŒ–å¤„ç†æˆ–è€…ä¸åœ¨è¾¹ç•Œä¸Š</p>
<p>ï¼ˆ2ï¼‰åŸºæœ¬ç®—æ³•æµç¨‹ï¼šä»¥ç®€å•smoç®—æ³•ä¸ºä¾‹</p>
<blockquote>
<p>#0.åˆå§‹åŒ–alphaå‘é‡ä¸º0</p>
<p>#1.å½“è¿­ä»£æ¬¡æ•°å°äºæœ€å¤§è¿­ä»£æ¬¡æ•°ï¼ˆå¤–å¾ªç¯ï¼‰<br>    #2.å¯¹æ•°æ®é›†ä¸­æ¯ä¸ªå‘é‡ï¼ˆå†…å¾ªç¯ï¼‰<br>        #3.å¦‚æœè¯¥å‘é‡å¯ä»¥è¢«ä¼˜åŒ–<br>            #4.éšæœºæ‰¾å¦ä¸€ä¸ªå‘é‡<br>            #5.ä¼˜åŒ–è¿™ä¸¤ä¸ªå‘é‡<br>            #6.å¦‚æœè¿™ä¸¤ä¸ªå‘é‡ä¸èƒ½è¢«ä¼˜åŒ–ï¼Œè·³å‡ºå†…å¾ªç¯</p>
<p>#7.å¦‚æœæ‰€æœ‰å‘é‡éƒ½ä¸èƒ½è¢«ä¼˜åŒ–ï¼Œå¢åŠ è¿­ä»£æ¬¡æ•°ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡çš„å¾ªç¯</p>
</blockquote>
<p>ï¼ˆ3ï¼‰å®Œæ•´platt smo ç®—æ³•</p>
<p>platt smoç®—æ³•åœ¨ç®€åŒ–smoç®—æ³•åŸºç¡€ä¸Šæå‡æ—¶é—´ï¼Œå¯¹æ•°æ®é‡å¤§çš„æ•°æ®é›†æ‰§è¡Œæ—¶é—´å¤§å¤§å‡å°‘ã€‚</p>
<p>ç›¸æ¯”äºä¼ ç»Ÿçš„äºŒæ¬¡è§„åˆ’æ±‚è§£æ–¹æ³•ï¼Œæ¯æ¬¡é€‰å–ä¸¤ä¸ªalphaè¿›è¡Œä¼˜åŒ–ï¼Œæ—¶é—´æ•ˆç‡å¤§å¹…æé«˜ã€‚</p>
<p>ç®—æ³•æµç¨‹ï¼š</p>
<blockquote>
<p>#å¤–å¾ªç¯ ä½¿ç”¨ä¸¤ç§æ–¹å¼äº¤æ›¿å¾—åˆ°ç¬¬ä¸€ä¸ªalphaçš„å€¼</p>
<p>#1.0 å¯¹æ‰€æœ‰æ•°æ®ç‚¹è¿›è¡Œéå†æ‰«æ</p>
<p>#2.0 å¯¹éè¾¹ç•Œå€¼å³0&lt;alphaå¹¶ä¸”alpha&gt;cçš„alphaè¿›è¡Œæ‰«æ</p>
<p>#å†…å¾ªç¯ é‡‡ç”¨æœ€å¤§åŒ–æ­¥é•¿çš„æ–¹å¼å¾—åˆ°ç¬¬äºŒä¸ªalphaçš„å€¼</p>
</blockquote>
<h2 id="æ ¸å‡½æ•°çš„å¼•å…¥"><a href="#æ ¸å‡½æ•°çš„å¼•å…¥" class="headerlink" title="æ ¸å‡½æ•°çš„å¼•å…¥"></a>æ ¸å‡½æ•°çš„å¼•å…¥</h2><p>å½“é¢å¯¹éçº¿æ€§æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨æ ¸å‡½æ•°ï¼Œå°†å¤æ‚æ•°æ®æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œæ­¤æ—¶åˆ†ç±»å™¨æ˜“äºç†è§£ï¼Œå³å¯ä½¿ç”¨SVMæ–¹æ³•ã€‚</p>
<p>ä¸»è¦ä½¿ç”¨å¾„å‘åŸºå‡½æ•°çš„é«˜æ–¯ç‰ˆæœ¬ï¼š<img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200306155004.png" alt="å¾„å‘åŸºå‡½æ•°"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernelTrans</span><span class="params">(X,A,kTup=<span class="params">()</span>)</span>:</span></span><br><span class="line">  m=shape(X)[<span class="number">0</span>]</span><br><span class="line">  K=zeros((m,<span class="number">1</span>))</span><br><span class="line">  <span class="comment">#å¯¹æ ¸å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¸åŒæƒ…å†µçš„è®¨è®º</span></span><br><span class="line">  <span class="comment">#1.çº¿æ€§æ ¸</span></span><br><span class="line">  <span class="keyword">if</span>(kTup[<span class="number">0</span>]=<span class="string">"lin"</span>):</span><br><span class="line">    K=X*A.T</span><br><span class="line">  <span class="comment">#2.å¾„å‘åŸºæ ¸</span></span><br><span class="line">  <span class="keyword">elif</span>(kTup[<span class="number">0</span>]=<span class="string">"rbf"</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">      delta=X[i,:]-A</span><br><span class="line">      K[i]=delta*delta.T</span><br><span class="line">     K=exp(K/(<span class="number">-1</span>*kTup[<span class="number">1</span>]**<span class="number">2</span>))      </span><br><span class="line">  <span class="comment">#3.æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> NameError()</span><br><span class="line">  <span class="keyword">return</span></span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨å®ä¾‹â€”â€”æ‰‹å†™æ•°å­—è¯†åˆ«"><a href="#åº”ç”¨å®ä¾‹â€”â€”æ‰‹å†™æ•°å­—è¯†åˆ«" class="headerlink" title="åº”ç”¨å®ä¾‹â€”â€”æ‰‹å†™æ•°å­—è¯†åˆ«"></a>åº”ç”¨å®ä¾‹â€”â€”æ‰‹å†™æ•°å­—è¯†åˆ«</h2><p>è¯†åˆ«æ‰‹å†™å­—â€”â€”ä½¿ç”¨svmæ¯”knnæ•ˆç‡é«˜ï¼Œå å†…å­˜å°ï¼Œå› ä¸ºsvmåªéœ€ç”¨åˆ°æ”¯æŒå‘é‡æ¥è¿›è¡Œåˆ†ç±»</p>
<p>ï¼ˆ1ï¼‰å°†å›¾åƒè½¬æ¢ä¸ºå‘é‡</p>
<p>ï¼ˆ2ï¼‰è¯»å–æ–‡ä»¶å¤¹åˆ—è¡¨ä¸­å„ä¸ªå›¾åƒæ–‡ä»¶</p>
<p>ï¼ˆ3ï¼‰å¤„ç†åˆ†ç±»é—®é¢˜</p>
<p>ä¸ºæ–¹ä¾¿å¤„ç†ï¼Œåªä¿ç•™äº†1å’Œ9ä¸¤ä¸ªæ•°å­—ï¼Œå½“æ˜¯æ•°å­—1æ—¶ï¼Œåˆ†ç±»ä¸º+1ï¼Œå½“æ˜¯æ•°å­—9æ—¶åˆ†ç±»ä¸º-1</p>
<blockquote>
<p>#1.è¯»å…¥å›¾åƒè½¬æ¢åçš„æ•°æ®å‘é‡å’Œæ ‡ç­¾å±æ€§</p>
<p>#2.è°ƒç”¨platt smoç®—æ³•å¾—å‡ºalphaå’Œbçš„å€¼</p>
<p>#3.æ ¹æ®æ”¯æŒå‘é‡å¤§äº0çš„ç‰¹æ€§å¾—å‡ºå…¶ä¸­alpha&gt;0çš„æ”¯æŒå‘é‡ï¼Œå¹¶å¾—å‡ºæ”¯æŒå‘é‡çš„æ•°æ®ç‚¹å’Œæ ‡ç­¾æ•°æ®</p>
<p>#4.åœ¨è®­ç»ƒé›†ä¸Šå¾—å‡ºåˆ†ç±»ç»“æœ</p>
<p>#5.å°†åˆ†ç±»çš„ç»“æœåº”ç”¨äºæµ‹è¯•é›†</p>
</blockquote>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#plat smoå¯ä»¥å¤„ç†æ•°æ®é‡å¤§çš„ï¼Œä¸Šé¢simplesmoåªèƒ½å¤„ç†æ•°æ®é‡è¾ƒå°çš„æ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#platsmoçš„æ”¯æŒå‡½æ•°</span></span><br><span class="line"><span class="comment">#å»ºç«‹ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">optStruct</span>:</span></span><br><span class="line">	<span class="comment">#å„ç§å˜é‡åˆå§‹åŒ–</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,dataMat,lableMat,C,toler,kTup)</span>:</span><span class="comment">#å¢åŠ æ ¸å‡½æ•°åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">		self.dataMat=dataMat</span><br><span class="line">		self.lableMat=lableMat</span><br><span class="line">		self.C=C</span><br><span class="line">		self.toler=toler</span><br><span class="line">		self.m=shape(dataMat)[<span class="number">0</span>]</span><br><span class="line">		self.alpha=mat(zeros((self.m,<span class="number">1</span>)))</span><br><span class="line">		self.b=<span class="number">0</span></span><br><span class="line">		self.echache=mat(zeros((self.m,<span class="number">2</span>)))<span class="comment">#ç¬¬ä¸€åˆ—è¡¨ç¤ºcacheæ˜¯å¦æœ‰æ•ˆï¼Œç¬¬äºŒåˆ—æ˜¯å®é™…çš„Eï¼ˆè¯¯å·®ï¼‰å€¼</span></span><br><span class="line">		<span class="comment">#æ„å»ºk</span></span><br><span class="line">		self.k=mat(zeros((self.m,self.m)))</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(self.m):</span><br><span class="line">			<span class="comment">#è°ƒç”¨å‡½æ•°ï¼Œå¡«å……k</span></span><br><span class="line">			self.k[:,i]=kernelTras(self.dataMat,self.dataMat[i,:],kTup)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿å­˜è¯¯å·®ç¼“å­˜</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcEK</span><span class="params">(oS,ke)</span>:</span></span><br><span class="line">	fk=float(multiply(oS.alpha,oS.lableMat).T*oS.k[:,ke]+oS.b)</span><br><span class="line">	EK=fk-float(oS.lableMat[ke])</span><br><span class="line">	<span class="keyword">return</span> EK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¡ç®—è¯¯å·®ï¼Œå¹¶ä¸”å­˜å…¥ç¼“å­˜</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">updateEK</span><span class="params">(oS,k)</span>:</span></span><br><span class="line">	EK=calcEK(oS,k)</span><br><span class="line">	oS.echache[k]=[<span class="number">1</span>,EK]</span><br><span class="line"></span><br><span class="line"><span class="comment">#å†…å¾ªç¯ä¸­çš„å¯å‘æ–¹å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é€‰æ‹©ç¬¬äºŒä¸ªalphaå€¼ï¼Œä¿è¯æ¯æ¬¡ä¼˜åŒ–éƒ½æ˜¯æœ€å¤§çš„æ­¥é•¿ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥å¾ªç¯å°±å…ˆéšæœºé€‰æ‹©ä¸€ä¸ªalpha[j],åä¹‹è¿›å…¥å¾ªç¯ï¼Œæ ¹æ®æœ€å¤§æ­¥é•¿é€‰æ‹©alpha[j]çš„å€¼</span></span><br><span class="line"><span class="comment">#alphajçš„å€¼å’Œå‰ä¸€ä¸ªalphaiçš„ä¸‹æ ‡å’Œè¯¯å·®Eiæœ‰å…³</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">selectJ</span><span class="params">(i,oS,Ei)</span>:</span></span><br><span class="line">	maxk=<span class="number">-1</span></span><br><span class="line">	maxDeltaE=<span class="number">0</span></span><br><span class="line">	Ej=<span class="number">0</span></span><br><span class="line">	oS.echache[i]=[<span class="number">1</span>,Ei]</span><br><span class="line">	<span class="comment">#è¾“å…¥åˆ—è¡¨ä¸ºç›®æ ‡çš„åˆ—è¡¨å€¼ï¼Œnozeroè¿”å›ä¸ä¸ºç©ºçš„å€¼å³éé›¶alphaå€¼</span></span><br><span class="line">	validDeltaList=nonzero(oS.echache[:,<span class="number">0</span>].A)[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> (len(validDeltaList))&gt;<span class="number">1</span>:</span><br><span class="line">		<span class="keyword">for</span> k <span class="keyword">in</span> validDeltaList:</span><br><span class="line">			<span class="keyword">if</span>(k==i):</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			Ek=calcEK(oS,k)</span><br><span class="line">			delta=abs(Ek-Ei)</span><br><span class="line">			<span class="keyword">if</span>(delta&gt;maxDeltaE):</span><br><span class="line">				maxk=k</span><br><span class="line">				maxDeltaE=delta</span><br><span class="line">				Ej=Ek</span><br><span class="line">		<span class="keyword">return</span> maxk,Ej</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		j=selectRandom(i,oS.m)</span><br><span class="line">		Ej=calcEK(oS,j)</span><br><span class="line">	<span class="keyword">return</span> j,Ej</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">innerI</span><span class="params">(oS,i)</span>:</span></span><br><span class="line">	exi=calcEK(oS,i)</span><br><span class="line">	<span class="keyword">if</span> ((oS.lableMat[i]*exi&lt;-oS.toler) <span class="keyword">and</span> (oS.alpha[i]&lt;oS.C)) <span class="keyword">or</span> ((oS.lableMat[i]*exi&gt;oS.toler) <span class="keyword">and</span> (oS.alpha[i]&gt;<span class="number">0</span>)):</span><br><span class="line">		<span class="comment">#1.3å¯å‘å¼æ‰¾å¦ä¸€ä¸ªå‘é‡</span></span><br><span class="line">		j,exj=selectJ(i,oS,exi)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#1.4ä¼˜åŒ–è¿™ä¸¤ä¸ªå‘é‡</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#è®°å½•æ—§çš„ï¼Œçœ‹ä¼˜åŒ–ä¹‹åæœ‰æ— å˜æ¢</span></span><br><span class="line">		alphaJold=oS.alpha[j].copy()</span><br><span class="line">		alphaIold=oS.alpha[i].copy()</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(oS.lableMat[i]!=oS.lableMat[j]):</span><br><span class="line">			L=max(<span class="number">0</span>,oS.alpha[j]-oS.alpha[i])</span><br><span class="line">			H=min(oS.C,oS.C+oS.alpha[j]-oS.alpha[i])</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			L=max(<span class="number">0</span>,oS.alpha[j]+oS.alpha[i]-oS.C)</span><br><span class="line">			H=min(oS.C,oS.C+oS.alpha[j]+oS.alpha[i]-oS.C)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(L==H):</span><br><span class="line">			print(<span class="string">"L==H"</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#æœ€ä¼˜ä¿®æ”¹é‡</span></span><br><span class="line">		<span class="comment">#eta=2.0*oS.dataMat[i,:]*oS.dataMat[j,:].T-oS.dataMat[i,:]*oS.dataMat[i,:].T-oS.dataMat[j,:]*oS.dataMat[j,:].T</span></span><br><span class="line">		<span class="comment">#ä½¿ç”¨æ ¸å‡½æ•°ä¹‹åï¼Œä¿®æ­£etaçš„å€¼</span></span><br><span class="line">		eta=<span class="number">2.0</span>*oS.k[i,j]-oS.k[i,i]-oS.k[j,j]</span><br><span class="line">		<span class="keyword">if</span>(eta&gt;=<span class="number">0</span>):</span><br><span class="line">			print(<span class="string">"eta&gt;=0"</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">		oS.alpha[j]-=oS.lableMat[j]*(exi-exj)/eta</span><br><span class="line">		oS.alpha[j]=adjustBig(oS.alpha[j],H,L)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#å°†jçš„æ›´æ–°å­˜åˆ°ç¼“å­˜</span></span><br><span class="line">		updateEK(oS,j)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#ä¼˜åŒ–jä¹‹åæ— å˜æ¢</span></span><br><span class="line">		<span class="keyword">if</span> abs(alphaJold-oS.alpha[j])&lt;<span class="number">0.00001</span>:</span><br><span class="line">			print(<span class="string">"alphaJold-alpha[j])&lt;0.00001"</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#ä¼˜åŒ–jæœ‰å˜åŒ–ï¼Œæ¥ç€ä¼˜åŒ–i</span></span><br><span class="line">		oS.alpha[i]+=oS.lableMat[j]*oS.lableMat[i]*(alphaJold-oS.alpha[j])</span><br><span class="line"></span><br><span class="line">		<span class="comment">#å°†içš„æ›´æ–°å­˜åˆ°ç¼“å­˜</span></span><br><span class="line">		updateEK(oS,i)</span><br><span class="line"></span><br><span class="line">		<span class="comment">#è®¾ç½®åç½®é‡</span></span><br><span class="line">		<span class="comment">#b1=oS.b-exi-oS.lableMat[i]*(oS.alpha[i]-alphaIold)*oS.dataMat[i,:]*oS.dataMat[i,:].T-oS.lableMat[j]*(oS.alpha[j]-alphaJold)*oS.dataMat[i,:]*oS.dataMat[j,:].T</span></span><br><span class="line">		<span class="comment">#b2=oS.b-exj-oS.lableMat[i]*(oS.alpha[i]-alphaIold)*oS.dataMat[i,:]*oS.dataMat[j,:].T-oS.lableMat[j]*(oS.alpha[j]-alphaJold)*oS.dataMat[j,:]*oS.dataMat[j,:].T</span></span><br><span class="line">		<span class="comment">#ä½¿ç”¨æ ¸å‡½æ•°ä¹‹åï¼Œä¿®æ­£b1,b2çš„å€¼</span></span><br><span class="line">		b1=oS.b-exi-oS.lableMat[i]*(oS.alpha[i]-alphaIold)*oS.k[i,i]-oS.lableMat[j]*(oS.alpha[j]-alphaJold)*oS.k[i,j]</span><br><span class="line">		b2=oS.b-exj-oS.lableMat[i]*(oS.alpha[i]-alphaIold)*oS.k[i,j]-oS.lableMat[j]*(oS.alpha[j]-alphaJold)*oS.k[j,j]</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> oS.alpha[i]&gt;<span class="number">0</span> <span class="keyword">and</span> oS.alpha[i]&lt;oS.C:</span><br><span class="line">			oS.b=b1</span><br><span class="line">		<span class="keyword">elif</span> oS.alpha[j]&gt;<span class="number">0</span> <span class="keyword">and</span> oS.alpha[j]&lt;oS.C:</span><br><span class="line">			oS.b=b2</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			oS.b=(b1+b2)/<span class="number">2.0</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®Œæ•´çš„platt smo å¤–å¾ªç¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">smoP</span><span class="params">(dataMatIn,labelArr,C,toler,maxIter,kTup=<span class="params">(<span class="string">"lin"</span>,<span class="number">0</span>)</span>)</span>:</span></span><br><span class="line">	<span class="comment">#0.ç›¸å…³å˜é‡åˆå§‹åŒ–</span></span><br><span class="line">	oS=optStruct(mat(dataMatIn),mat(labelArr).transpose(),C,toler,kTup)</span><br><span class="line"></span><br><span class="line">	entireSet=<span class="literal">True</span></span><br><span class="line">	alphaChange=<span class="number">0</span></span><br><span class="line">	iter=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.ä¸»å¾ªç¯</span></span><br><span class="line">	<span class="keyword">while</span> (iter&lt;maxIter) <span class="keyword">and</span> ((alphaChange&gt;<span class="number">0</span>) <span class="keyword">or</span> (entireSet)):</span><br><span class="line">		alphaChange=<span class="number">0</span></span><br><span class="line">		<span class="comment">#1.é€‰æ‹©ç¬¬ä¸€ä¸ªalphaçš„ä¸¤ç§å¾ªç¯</span></span><br><span class="line">		<span class="comment">#1.0å¯¹æ‰€æœ‰æ•°æ®é›†è¿›è¡Œéå†</span></span><br><span class="line">		<span class="keyword">if</span>(entireSet):</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> range(oS.m):</span><br><span class="line">				alphaChange+=innerI(oS,i)</span><br><span class="line">				print(<span class="string">"fullset: iter:"</span>+str(iter)+<span class="string">" i:"</span>+str(i)+<span class="string">" alphaChange:"</span>+str(alphaChange))</span><br><span class="line">			iter+=<span class="number">1</span></span><br><span class="line">		<span class="comment">#1.1å¯¹éè¾¹ç•Œå€¼è¿›è¡Œéå†</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			nonBoundIs=nonzero((oS.alpha.A&gt;<span class="number">0</span>)*(oS.alpha.A&lt;C))[<span class="number">0</span>]</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> nonBoundIs:</span><br><span class="line">				alphaChange+=innerI(oS,i)</span><br><span class="line">				print(<span class="string">"nonbound: iter:"</span>+str(iter)+<span class="string">" i:"</span>+str(i)+<span class="string">" alphaChange:"</span>+str(alphaChange))</span><br><span class="line"></span><br><span class="line">			iter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(entireSet):</span><br><span class="line">			entireSet=<span class="literal">False</span></span><br><span class="line">		<span class="keyword">elif</span>(alphaChange==<span class="number">0</span>):</span><br><span class="line">			entireSet=<span class="literal">True</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> oS.alpha,oS.b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨æ±‚å¾—çš„alphaå€¼æ±‚å¾—åˆ†ç±»çš„è¶…å¹³é¢ï¼Œå…¶ä¸­å¯ä»¥æ±‚å‡ºwçš„å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcW</span><span class="params">(alpha,dataMatIn,labelArr)</span>:</span></span><br><span class="line">	dataMat=mat(dataMatIn)</span><br><span class="line">	lableMat=mat(labelArr).transpose()</span><br><span class="line">	m,n=shape(dataMat)</span><br><span class="line">	w=zeros((n,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		<span class="comment">#å…¶ä¸­èµ·ä½œç”¨çš„åªæœ‰æ”¯æŒå‘é‡ï¼Œå³ä¸ä¸º0çš„alpha</span></span><br><span class="line">		w+=multiply((alpha[i]*lableMat[i]),dataMat[i,:].T)</span><br><span class="line">	<span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨å¤æ‚æ•°æ®ä¸Šä½¿ç”¨æ ¸å‡½æ•°</span></span><br><span class="line"><span class="comment">#å°†æ•°æ®ä»ä¸€ä¸ªç‰¹å¾ç©ºé—´æ˜ å°„åˆ°å¦ä¸€ä¸ªç©ºé—´</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernelTras</span><span class="params">(X,A,kTup)</span>:</span></span><br><span class="line">	m,n=shape(X)</span><br><span class="line">	k=zeros((m,<span class="number">1</span>))</span><br><span class="line">	<span class="comment">#æ ¹æ®ktupçš„ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ±‚æ ¸å‡½æ•°çš„å€¼</span></span><br><span class="line">	<span class="keyword">if</span>(kTup[<span class="number">0</span>]==<span class="string">"lin"</span>):</span><br><span class="line">		k=X*A.T</span><br><span class="line">	<span class="keyword">elif</span>(kTup[<span class="number">0</span>]==<span class="string">"rbf"</span>):</span><br><span class="line">		<span class="comment">#å¯¹æ¯ä¸ªå…ƒç´ è®¡ç®—é«˜æ–¯å€¼</span></span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">			deltaRow=X[j,:]-A</span><br><span class="line">			k[j]=deltaRow*deltaRow.T</span><br><span class="line">		k=exp(k/(<span class="number">-1</span>*kTup[<span class="number">1</span>]**<span class="number">2</span>))</span><br><span class="line">	<span class="comment">#è‹¥å…ƒç¥–æ— æ³•è¯†åˆ«ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">raise</span> NameError(<span class="string">"the keneral name wrong"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> k</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯†åˆ«æ‰‹å†™å­—â€”â€”ä½¿ç”¨svmæ¯”knnæ•ˆç‡é«˜ï¼Œå å†…å­˜å°ï¼Œå› ä¸ºsvmåªéœ€ç”¨åˆ°æ”¯æŒå‘é‡æ¥è¿›è¡Œåˆ†ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.å°†å›¾åƒè½¬æ¢ä¸ºå‘é‡â€”â€”å°†32*32çš„å›¾åƒè½¬æ¢ä¸º1*1024çš„å‘é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">img2vector</span><span class="params">(filename)</span>:</span></span><br><span class="line">	<span class="comment">#0.æ„é€ è½¬æ¢åè¿”å›çš„å‘é‡</span></span><br><span class="line">	returnVect=zeros((<span class="number">1</span>,<span class="number">1024</span>))</span><br><span class="line">	<span class="comment">#1.å¤„ç†å›¾åƒ</span></span><br><span class="line">	fr=open(filename)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):<span class="comment">#å› ä¸ºå›¾åƒæ˜¯32è¡Œçš„</span></span><br><span class="line">		lineArr=fr.readline() <span class="comment">#æ¯æ¬¡è¯»å…¥ä¸€è¡Œ</span></span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>):<span class="comment">#å› ä¸ºå›¾åƒæ˜¯32åˆ—çš„</span></span><br><span class="line">			returnVect[<span class="number">0</span>,<span class="number">32</span>*i+j]=int(lineArr[j])</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> returnVect</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.ä»æ–‡ä»¶å¤¹ä¸­è¯»å…¥æ‰€æœ‰å›¾ç‰‡ä¿¡æ¯å¹¶å­˜å‚¨ä¸ºå‘é‡å’Œæ ‡ç­¾â€”â€”,ä¸ºæ–¹ä¾¿ï¼Œåªä¿ç•™äº†1å’Œ9ä¸¤ä¸ªæ•°å­—ï¼Œå‡ºç°1çš„æ ‡ç­¾è®°ä¸º1ï¼Œå‡ºç°9çš„æ ‡ç­¾è®°ä¸º-1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadImage</span><span class="params">(dirname)</span>:</span></span><br><span class="line">	<span class="keyword">from</span> os <span class="keyword">import</span> listdir</span><br><span class="line">	<span class="comment">#0.ç”¨äºå­˜å‚¨æ ‡ç­¾</span></span><br><span class="line">	hwLabels=[]</span><br><span class="line"></span><br><span class="line">	<span class="comment">#1.ç”¨äºå­˜å‚¨æ•°æ®å‘é‡</span></span><br><span class="line">	<span class="comment">#å¾—åˆ°æ–‡ä»¶å¤¹ä¸‹å›¾åƒåç§°çš„åˆ—è¡¨ ä¾‹ï¼š1_20.txt</span></span><br><span class="line">	trainDirList=listdir(dirname)</span><br><span class="line">	m=len(trainDirList)</span><br><span class="line">	<span class="comment">#ç”¨äºå­˜å‚¨æ•°æ®å‘é‡</span></span><br><span class="line">	trainMat=zeros((m,<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#2.å¤„ç†å›¾åƒæ–‡ä»¶ä¸­çš„å†…å®¹</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		<span class="comment">#å›¾åƒæ–‡ä»¶å®Œæ•´åç§°</span></span><br><span class="line">		fullName=trainDirList[i]</span><br><span class="line">		<span class="comment">#å›¾åƒæ–‡ä»¶å»é™¤åç¼€åçš„åç§°</span></span><br><span class="line">		fileName=fullName.split(<span class="string">"."</span>)[<span class="number">0</span>]</span><br><span class="line">		<span class="comment">#å›¾åƒæ–‡ä»¶å»é™¤ä¸‹åˆ’çº¿åçš„åç§°</span></span><br><span class="line">		className=int(fileName.split(<span class="string">"_"</span>)[<span class="number">0</span>])</span><br><span class="line">		<span class="comment">#ä¸ºæ–¹ä¾¿ï¼Œåªä¿ç•™äº†1å’Œ9ä¸¤ä¸ªæ•°å­—ï¼Œå‡ºç°1çš„æ ‡ç­¾è®°ä¸º1ï¼Œå‡ºç°9çš„æ ‡ç­¾è®°ä¸º-1</span></span><br><span class="line">		<span class="keyword">if</span>(className==<span class="number">1</span>):</span><br><span class="line">			hwLabels.append(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			hwLabels.append(<span class="number">-1</span>)</span><br><span class="line">		<span class="comment">#å°†å›¾åƒæ–‡ä»¶ä¸­çš„å†…å®¹è½¬æ¢ä¸ºå‘é‡è¿›è¡Œå­˜å‚¨</span></span><br><span class="line">		trainMat[i,:]=img2vector(<span class="string">"%s/%s"</span>%(dirname,fullName))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> trainMat,hwLabels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.ä½¿ç”¨æ ¸å‡½æ•°è¿›è¡Œåˆ†ç±»æµ‹è¯•çš„å¾„å‘åŸºå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testDigits</span><span class="params">(kTup=<span class="params">(<span class="string">"rbf"</span>,<span class="number">10</span>)</span>)</span>:</span></span><br><span class="line">	dataMatIn,labelArr=loadImage(<span class="string">"trainingDigits"</span>)</span><br><span class="line">	dataMat=mat(dataMatIn)</span><br><span class="line">	lableMat=mat(labelArr).transpose()</span><br><span class="line">	m,n=shape(dataMat)</span><br><span class="line">	<span class="comment">#æ ¹æ®platt smoç®—æ³•å¾—åˆ°alpha,bçš„å€¼</span></span><br><span class="line">	alpha,b=smoP(dataMatIn,labelArr,<span class="number">200</span>,<span class="number">0.0001</span>,<span class="number">10000</span>,kTup)</span><br><span class="line">	print(alpha[alpha&gt;<span class="number">0</span>])</span><br><span class="line">	print(b)</span><br><span class="line">	<span class="comment">#å¾—åˆ°æ”¯æŒå‘é‡</span></span><br><span class="line">	sVInd=nonzero(alpha.A&gt;<span class="number">0</span>)[<span class="number">0</span>]</span><br><span class="line">	sVs=dataMat[sVInd]</span><br><span class="line">	sVlabel=lableMat[sVInd]</span><br><span class="line">	print(<span class="string">"tere are "</span>+str(shape(sVs)[<span class="number">0</span>])+<span class="string">" support vectors"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#åœ¨è®­ç»ƒé›†ä¸Šä½¿ç”¨æ ¸å‡½æ•°</span></span><br><span class="line">	error=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		kernel=kernelTras(sVs,dataMat[i,:],kTup)</span><br><span class="line">		precdit=kernel.T*multiply(sVlabel,alpha[sVInd])+b</span><br><span class="line">		<span class="keyword">if</span>(sign(precdit)!=sign(lableMat[i])):</span><br><span class="line">			error+=<span class="number">1</span></span><br><span class="line">	print(<span class="string">"train error rate: "</span>+str(float(error)/m)+<span class="string">"â€”â€”â€”â€”â€”â€”"</span>+str(error))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#åœ¨æµ‹è¯•é›†ä¸Šä½¿ç”¨æ ¸å‡½æ•°</span></span><br><span class="line">	dataMatIn,labelArr=loadImage(<span class="string">"testDigits"</span>)</span><br><span class="line">	dataMat=mat(dataMatIn)</span><br><span class="line">	lableMat=mat(labelArr).transpose()</span><br><span class="line">	m=shape(dataMat)[<span class="number">0</span>]</span><br><span class="line">	error=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">		kernel=kernelTras(sVs,dataMat[i,:],kTup)</span><br><span class="line">		precdit=kernel.T*multiply(sVlabel,alpha[sVInd])+b</span><br><span class="line">		<span class="keyword">if</span>(sign(precdit)!=sign(lableMat[i])):</span><br><span class="line">			error+=<span class="number">1</span></span><br><span class="line">	print(<span class="string">"test error rate: "</span>+str(float(error)/m)+<span class="string">"â€”â€”â€”â€”â€”â€”"</span>+str(error))</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>æ”¯æŒå‘é‡æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰â€”â€”åŠ¨æ€è§„åˆ’</title>
    <url>/blogs/movStateNote/</url>
    <content><![CDATA[<h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><h3 id="ä¸€èˆ¬æ€è·¯"><a href="#ä¸€èˆ¬æ€è·¯" class="headerlink" title="ä¸€èˆ¬æ€è·¯"></a>ä¸€èˆ¬æ€è·¯</h3><p>ï¼ˆ1ï¼‰æ˜ç¡®çŠ¶æ€å«ä¹‰</p><p>é¦–å…ˆè¦æ˜ç¡®dp[i]çš„å«ä¹‰ï¼Œä¾‹å¦‚åœ¨æ±‚åˆ†å‰²å›æ–‡å­—ç¬¦ä¸²çš„æ¬¡æ•°ä¸­ï¼Œdp[i]è¡¨ç¤ºiä¸ªå›æ–‡å­—ç¬¦ä¸²çš„åˆ†å‰²æ¬¡æ•°</p><p>ï¼ˆ2ï¼‰ç¡®å®šåˆå§‹çŠ¶æ€</p><p>å¯ä»¥è€ƒè™‘æœ€å¤šâ€¦çš„æ—¶å€™dpçš„çŠ¶æ€</p><p>ä¾‹å¦‚æ±‚åˆ†å‰²å›æ–‡å­—ç¬¦ä¸²çš„æ¬¡æ•°ï¼Œåˆå§‹çŠ¶æ€å³ä¸ºiä¸ªå­—ç¬¦ä¸²æœ€å¤šåˆ†å‰²iæ¬¡</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ±‚åˆ†å‰²å›æ–‡å­—ç¬¦ä¸²çš„æ¬¡æ•°</span></span><br><span class="line"><span class="comment">//åˆå§‹çŠ¶æ€</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">  dp[i]=i;</span><br><span class="line"><span class="comment">//iä¸ªå­—ç¬¦ä¸²ï¼Œæœ€å¤šåˆ†å‰²iæ¬¡</span></span><br></pre></td></tr></table></figure><a id="more"></a>






<p>ï¼ˆ3ï¼‰ç¡®å®šçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<p>å‡è®¾å·²çŸ¥dp[i]çš„çŠ¶æ€ï¼Œåˆ—å‡ºdp[i+1]å’Œdp[i]ä¹‹é—´çš„å…³ç³»å¼ï¼Œå³ä¸ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<p>æ˜ç¡®ç›®æ ‡ï¼šè¦æ±‚dp{i]çš„å€¼</p>
<p>ä¾‹å¦‚æ±‚åˆ†å‰²å›æ–‡å­—ç¬¦ä¸²çš„æ¬¡æ•°ï¼Œå…¶ä¸­çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<p>å½“iä»1å˜åŒ–åˆ°lenä¹‹é—´ï¼Œæ±‚dp[i]ã€‚å½“0~iæœ¬èº«æ˜¯å›æ–‡æ—¶ï¼Œä¸éœ€è¦åˆ†å‰²ï¼Œå³dp[i]=0ã€‚è¯¥é¢˜dp[i+1]å’Œdp[i]ä¹‹é—´æ²¡æœ‰æ˜ç¡®è”ç³»ï¼Œå¯ä»¥ä»åˆ†å‰²è¾¹ç•Œè€ƒè™‘ã€‚å‡è®¾åˆ†å‰²è¾¹ç•Œä¸ºjï¼Œå·²çŸ¥dp[j]ï¼Œæ±‚dp[i]ï¼Œå°±éœ€è¦åˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘</p>
<p>aï¼‰j+1~iä¹‹é—´æ˜¯å›æ–‡ï¼Œé‚£ä¹ˆdp[j]å†åˆ†å‰²ä¸€æ¬¡å°±å¯ä»¥å¾—åˆ°jä¹‹å‰çš„å­—ç¬¦ä¸²å’Œåé¢çš„å›æ–‡ï¼Œå³dp[i]=dp[j]+1ï¼Œä½†dp[i]æœ‰å¯èƒ½æ›´å°ï¼Œæ‰€ä»¥dp[i]åœ¨dp[i]å’Œdp[j]+1ä¹‹é—´å–å°çš„</p>
<p>bï¼‰j+1~iä¹‹é—´ä¸æ˜¯å›æ–‡ï¼Œç»§ç»­ç§»åŠ¨jï¼Œæ‰¾åˆ°ç¬¦åˆå›æ–‡çš„å­ä¸²</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="number">0</span>~iæ˜¯å›æ–‡)</span><br><span class="line">    dp[i]=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(j+<span class="number">1</span>~iæ˜¯å›æ–‡)</span><br><span class="line">      dp[i]=<span class="built_in">min</span>(dp[i],dp[j]+<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰æœ€ç»ˆè¾“å‡º</p>
<p>ä¸€èˆ¬è¾“å‡ºä¸ºdp[len-1]ï¼Œä¾‹å¦‚åœ¨æ±‚åˆ†å‰²å›æ–‡å­—ç¬¦ä¸²çš„æ¬¡æ•°ä¸­ï¼Œæœ€ç»ˆæ˜¯æ±‚lenä¸ªå­—ç¬¦ä¸²çš„åˆ†å‰²æ¬¡æ•°ï¼Œå³æ±‚dp[len-1]</p>
<h3 id="è‚¡ç¥¨é—®é¢˜"><a href="#è‚¡ç¥¨é—®é¢˜" class="headerlink" title="è‚¡ç¥¨é—®é¢˜"></a>è‚¡ç¥¨é—®é¢˜</h3><p>ï¼ˆ1ï¼‰æ˜ç¡®çŠ¶æ€å«ä¹‰</p>
<p>è‚¡ç¥¨æœ‰ä¸‰ç§çŠ¶æ€ï¼šä¹°å…¥ï¼Œå–å‡ºï¼Œä¼‘æ¯ï¼ˆä¸ä¹°å…¥ä¹Ÿä¸å–å‡ºï¼‰    æœ€ç»ˆçŠ¶æ€ä¸ºæŒæœ‰è‚¡ç¥¨è®¾ç½®ä¸º0ï¼Œä¸æŒæœ‰è‚¡ç¥¨1</p>
<p>è½¬æ¢å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200304222109.png" alt="stock"></p>
<p>è®¾ç½®dp[i] [k] [s]è¡¨ç¤ºç¬¬å¤©è‚¡ç¥¨çš„æŒæœ‰æƒ…å†µï¼Œkè¡¨ç¤ºè‡³ä»Šæœ€å¤šè¿›è¡Œkç¬”äº¤æ˜“ï¼Œæ•´ä¸ªæ•°ç»„è¡¨ç¤ºå¯ä»¥å¾—åˆ°çš„æœ€å¤§åˆ©æ¶¦</p>
<p>ï¼ˆ2ï¼‰ç¡®å®šçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<p>è½¬æ¢å…³ç³»ä¸­å°±ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤åˆ†åˆ«è€ƒè™‘ä¸¤ç§æƒ…å†µä¸‹çš„è½¬ç§»æ–¹ç¨‹ï¼š</p>
<p>aï¼‰ä»Šå¤©æŒæœ‰è‚¡ç¥¨ï¼Œå³æ±‚dp[i] [k] [1]</p>
<p>æŒæœ‰è‚¡ç¥¨æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å‰ä¸€å¤©æœ¬æ¥å°±æœ‰è‚¡ç¥¨ï¼Œå¹¶ä¸”ä»Šå¤©ä¼‘æ¯ï¼Œå³dp[i-1] [k] [1]ï¼›å¦ä¸€ç§æ˜¯å‰ä¸€å¤©æ²¡æœ‰è‚¡ç¥¨ï¼Œä»Šå¤©è´­å…¥äº†ï¼Œæ­¤æ—¶å‰ä¸€å¤©è¿›è¡Œäº†k-1ç¬”äº¤æ˜“ï¼Œä¹°å…¥è‚¡ç¥¨ï¼Œè¯´æ˜åˆ©æ¶¦å‡å°‘ï¼Œéœ€è¦å‡æ‰ä¹°å…¥çš„ä»·æ ¼,å³dp[i-1] [k-1] [0]-price[i]</p>
<p>ç»¼ä¸Šï¼Œæ±‚åˆ©æ¶¦æœ€å¤§ï¼Œå³æ±‚ä¸¤ç§æƒ…å†µçš„æœ€å¤§è€…ï¼Œdp[i] [k] [1]=max(dp[i-1] [k] [1]ï¼Œdp[i-1] [k-1] [0]-price[i])</p>
<p>bï¼‰ä»Šå¤©ä¸æŒæœ‰è‚¡ç¥¨ï¼Œå³æ±‚dp[i] [k] [0]</p>
<p>ä¸æŒæœ‰è‚¡ç¥¨ä¹Ÿæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å‰ä¸€å¤©æœ¬æ¥å°±æ²¡æœ‰è‚¡ç¥¨ï¼Œå¹¶ä¸”ä»Šå¤©ä¼‘æ¯ï¼Œå³dp[i-1] [k] [0]ï¼›å¦ä¸€ç§æ˜¯å‰ä¸€å¤©æœ‰è‚¡ç¥¨ï¼Œä»Šå¤©å–å‡ºäº†ï¼Œå–å‡ºè‚¡ç¥¨ï¼Œè¯´æ˜åˆ©æ¶¦å¢åŠ ï¼Œéœ€è¦åŠ ä¸Šå–å‡ºçš„ä»·æ ¼,å³dp[i-1] [k] [1]+price[i]</p>
<p>ç»¼ä¸Šï¼Œæ±‚åˆ©æ¶¦æœ€å¤§ï¼Œå³æ±‚ä¸¤ç§æƒ…å†µçš„æœ€å¤§è€…ï¼Œdp[i] [k] [0]=max(dp[i-1] [k] [0]]ï¼Œdp[i-1] [k] [1]+price[i])</p>
<p>ç»¼åˆaå’Œbï¼Œå¯ä»¥å¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<p>ï¼ˆ3ï¼‰ç¡®å®šåˆå§‹çŠ¶æ€</p>
<p>å› ä¸ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­åªæœ‰ä¸¤ä¸ªæœ€ç»ˆçŠ¶æ€ï¼Œæ‰€ä»¥å¯¹ä¸¤ä¸ªæœ€ç»ˆçŠ¶æ€çš„åˆå§‹æƒ…å†µè¿›è¡Œè®¨è®ºï¼š</p>
<p>aï¼‰åˆšå¼€å§‹æ²¡æœ‰æŒæœ‰è‚¡ç¥¨æ—¶ï¼Œæ²¡æœ‰åˆ©æ¶¦ï¼Œå³dp[0] [0]=0</p>
<p>bï¼‰åˆšå¼€å››æŒæœ‰è‚¡ç¥¨ï¼Œä¹‹å‰æ²¡æœ‰åˆ©æ¶¦ï¼ŒäºæŸä¹°å…¥çš„ä»·æ ¼ï¼Œå³dp[0] [1]=-price[0]</p>
<p>ï¼ˆ4ï¼‰æœ€ç»ˆè¾“å‡º</p>
<p>æœ€åä¸€å¤©åˆ©æ¶¦æ˜¯æœ€å¤§çš„ï¼Œæ­¤æ—¶ä¸æŒæœ‰è‚¡ç¥¨çš„åˆ©æ¶¦è‚¯å®šå¤§äºæŒæœ‰çš„ï¼Œå³dp[len-1] [k] [0]&gt;dp[len-1] [k] [1]ï¼Œæ‰€ä»¥é€‰æ‹©dp[len-1] [k] [1]</p>
<p>ï¼ˆ5ï¼‰å®é™…åº”ç”¨</p>
<p>aï¼‰ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚å¦‚æœä½ æœ€å¤šåªå…è®¸å®Œæˆä¸€ç¬”äº¤æ˜“ï¼ˆå³ä¹°å…¥å’Œå–å‡ºä¸€æ”¯è‚¡ç¥¨ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚æ³¨æ„ä½ ä¸èƒ½åœ¨ä¹°å…¥è‚¡ç¥¨å‰å–å‡ºè‚¡ç¥¨ã€‚</p>
<p>æ­¤æ—¶k=1ï¼Œä»£å…¥æ–¹ç¨‹å¾—</p>
<p>dp[i] [1] [1]=max(dp[i-1] [1] [1]ï¼Œdp[i-1] [0] [0]-price[i]) å…¶ä¸­dp[i-1] [0] [0]=0</p>
<p>dp[i] [1] [0]=max(dp[i-1] [1] [0]ï¼Œdp[i-1] [1] [1]+price[i])</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œæ–¹ç¨‹ä¸­k=1å¯¹è½¬æ¢æ— å½±å“ï¼Œæ‰€ä»¥çœå»k</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹çŠ¶æ€</span></span><br><span class="line">dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">dp[<span class="number">0</span>][<span class="number">1</span>]=-price[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//è½¬ç§»æ–¹ç¨‹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;i++)</span><br><span class="line">&#123;</span><br><span class="line">  dp[i][<span class="number">1</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>]ï¼Œ-price[i]);</span><br><span class="line">  dp[i][<span class="number">0</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>]ï¼Œdp[i<span class="number">-1</span>][<span class="number">1</span>]+price[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>bï¼‰ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰ã€‚æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p>
<p>æ­¤æ—¶k=æ— ç©·ï¼Œé‚£ä¹ˆkçš„å€¼å’Œk-1çš„å€¼è¿‘ä¼¼ä¸€æ ·ï¼Œå› æ­¤kåŒæ ·å¯ä»¥çœç•¥ï¼Œæ­¤æ—¶çš„æ–¹ç¨‹ä¸º</p>
<p>dp[i] [1]=max(dp[i-1] [1]ï¼Œdp[i-1] [0]-price[i]) å…¶ä¸­dp[i-1] [0]ä¸å¯ä»¥çœç•¥ï¼Œå› ä¸ºå…¶å€¼å·²ç»ä¸ç­‰äº0</p>
<p>dp[i] [0]=max(dp[i-1] [0]ï¼Œdp[i-1]  [1]+price[i])</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹çŠ¶æ€</span></span><br><span class="line">dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">dp[<span class="number">0</span>][<span class="number">1</span>]=-price[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//è½¬ç§»æ–¹ç¨‹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;i++)</span><br><span class="line">&#123;</span><br><span class="line">  dp[i][<span class="number">1</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>]ï¼Œdp[i<span class="number">-1</span>][<span class="number">0</span>]-price[i]);</span><br><span class="line">  dp[i][<span class="number">0</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>]ï¼Œdp[i<span class="number">-1</span>][<span class="number">1</span>]+price[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>cï¼‰ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ ä¸¤ç¬” äº¤æ˜“ã€‚æ³¨æ„: ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p>
<p>æ­¤æ—¶kä»1å˜æ¢åˆ°2ï¼Œä¸ä¸º0æ˜¯å› ä¸ºè¦æœ‰åˆ©æ¶¦è‡³å°‘ä¼šæœ‰ä¸€ç¬”äº¤æ˜“ï¼Œæ­¤æ—¶ä»£ç ä¸­å°†å¤šä¸€é‡å¾ªç¯</p>
<p>dp[i] [k] [1]=max(dp[i-1] [k] [1]ï¼Œdp[i-1] [k-1] [0]-price[i]) å…¶ä¸­dp[i-1] [0] [0]=0</p>
<p>dp[i] [k] [0]=max(dp[i-1] [k] [0]ï¼Œdp[i-1] [k] [1]+price[i])</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è½¬ç§»æ–¹ç¨‹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=<span class="number">2</span>;k++)</span><br><span class="line">  &#123;</span><br><span class="line">     <span class="comment">//å®šä¹‰åˆå§‹çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//åˆšå¼€å§‹æ—¶ï¼Œä¸æŒæœ‰è‚¡ç¥¨ï¼Œåˆ©æ¶¦ä¸º0</span></span><br><span class="line">      dp[i][k][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">      <span class="comment">//åˆšå¼€å§‹æ—¶ï¼ŒæŒæœ‰è‚¡ç¥¨ï¼Œåˆ©æ¶¦ä¸ºäºæŸä¹°å…¥å¯¹åº”çš„è‚¡ç¥¨</span></span><br><span class="line">      dp[i][k][<span class="number">1</span>]=-price[i];</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[i][k][<span class="number">1</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][k][<span class="number">1</span>]ï¼Œdp[i<span class="number">-1</span>][k<span class="number">-1</span>][<span class="number">0</span>]-price[i]);</span><br><span class="line">    dp[i][k][<span class="number">0</span>]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][k][<span class="number">0</span>]ï¼Œdp[i<span class="number">-1</span>][k][<span class="number">1</span>]+price[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p>åŠ¨æ€è§„åˆ’é¢˜ï¼š</p>
<p>ä¸€èˆ¬éƒ½æ˜¯å½“å‰çŠ¶æ€å’Œä¹‹å‰çš„çŠ¶æ€æœ‰å…³ï¼Œæˆ–è€…å’Œå…¶ä»–çš„ä½ç½®æœ‰å…³ï¼Œè¿™æ—¶å€™éœ€è¦è€ƒè™‘åŠ¨æ€è§„åˆ’ã€‚å¸¸è§äºå­—ç¬¦ä¸²é—®é¢˜ã€‚</p>
<p>1ï¼š221. æœ€å¤§æ­£æ–¹å½¢</p>
<p>ï¼ˆ0ï¼‰ç¡®å®šçŠ¶æ€æ–¹ç¨‹çš„å«ä¹‰</p>
<p>dp[i] [j]ä»£è¡¨å½“å‰ä½ç½®æœ€å¤§æ­£æ–¹å½¢çš„è¾¹é•¿ï¼Œæ˜ç¡®ä¸€ç‚¹å½“å‰ä½ç½®çš„è¾¹é•¿å–å†³äºå·¦è¾¹ï¼Œä¸Šè¾¹å’Œæ–œå¯¹è§’ï¼Œå¯ä»¥ç†è§£å½“å‰ä½ç½®ä¸ºå³ä¸‹è§’ä½ç½®ï¼Œè¿™ä¸‰ä¸ªä½ç½®çš„æœ€å°å€¼å†åŠ ä¸Š1å°±æ˜¯å½“å‰ä½ç½®çš„è¾¹é•¿ã€‚åŠ ä¸Šè¿™ä¸‰ä¸ªä½ç½®çš„å€¼ä¸€æ ·ï¼Œé‚£ä¹ˆç›´æ¥åŠ 1ï¼Œä¹Ÿæ— éœ€æ¯”è¾ƒï¼Œä½†æ˜¯å‡è®¾æœ‰ä¸€ä¸ªæ¯”è¾ƒå°ï¼Œå°±è¯´æ˜æœ‰ä¸€è¾¹ç¼ºä¸€ä¸ªè§’ï¼Œæ‰€ä»¥è¿™æ—¶å€™éœ€è¦å–æœ€å°å€¼ã€‚</p>
<p>åˆå§‹è¾¹é•¿è®¾ä¸º-1ï¼Œæ¯æ¬¡ä¸å½“å‰ä½ç½®è¾¹é•¿æ¯”è¾ƒï¼Œæ‰¾åˆ°æœ€å¤§çš„è¾¹é•¿</p>
<p>ï¼ˆ1ï¼‰åˆå§‹çŠ¶æ€ï¼š</p>
<p>ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—æ— æ³•å½¢æˆä¸‰è§’å½¢ï¼Œå³è‡ªèº«çš„å€¼å°±æ˜¯å½“å‰æ­£æ–¹å½¢çš„è¾¹é•¿</p>
<p>å› ä¸ºè¿™é‡Œå­˜å‚¨çš„æ˜¯å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡â€œ-â€™0â€˜â€å–å¾—å®é™…æ•°å€¼</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(m,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n));</span><br><span class="line">dp[<span class="number">0</span>][<span class="number">0</span>]=matrix[<span class="number">0</span>][<span class="number">0</span>]-<span class="string">'0'</span>;</span><br><span class="line">res=dp[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line"><span class="comment">//ç¬¬0è¡Œ</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    dp[<span class="number">0</span>][i]=matrix[<span class="number">0</span>][i]-<span class="string">'0'</span>;</span><br><span class="line">    res=<span class="built_in">max</span>(res, dp[<span class="number">0</span>][i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬0åˆ—</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">&#123;</span><br><span class="line">    dp[i][<span class="number">0</span>]=matrix[i][<span class="number">0</span>]-<span class="string">'0'</span>;</span><br><span class="line">    res=<span class="built_in">max</span>(res, dp[i][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<p>åªæœ‰å½“å‰ä½ç½®æ˜¯1æ‰æ›´æ–°è¾¹é•¿ï¼Œå¦åˆ™å¦‚æœæ˜¯â€™0â€˜ï¼Œè¯´æ˜å½“å‰ä½ç½®ä¸å¯èƒ½æœ‰æ­£æ–¹å½¢å½¢æˆ</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//2.çŠ¶æ€è½¬ç§»æ–¹ç¨‹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;n;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æ³¨æ„è¾“å…¥çš„å­—ç¬¦ï¼Œä¸æ˜¯æ•°å­—</span></span><br><span class="line">        <span class="comment">//1.dp[i][j]è¡¨ç¤ºå³ä¸‹è§’å…ƒç´ çš„æœ€å¤§æ­£æ–¹å½¢ï¼Œå½“å½“å‰ä½ç½®æ˜¯1æ—¶ï¼Œå¯ä»¥æ›´æ–°æ­£æ–¹å½¢å¤§å°,æ‰¾ä¸Šå·¦æ–œå¯¹è§’çš„æœ€å°å€¼å†åŠ ä¸€ï¼ˆå› ä¸ºå½“å‰ä½ç½®æ˜¯1ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span>(matrix[i][j]==<span class="string">'1'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[i][j]=<span class="built_in">min</span>(dp[i<span class="number">-1</span>][j],<span class="built_in">min</span>(dp[i<span class="number">-1</span>][j<span class="number">-1</span>], dp[i][j<span class="number">-1</span>]))+<span class="number">1</span>;</span><br><span class="line">            res=<span class="built_in">max</span>(res, dp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2.å½“å‰ä½ç½®ä¸º0ï¼Œé‚£æ­£æ–¹å½¢å¤§å°ä¸º0</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            dp[i][j]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>åŠ¨æ€è§„åˆ’</tag>
      </tags>
  </entry>
  <entry>
    <title>macä¸‹æ­å»ºå’Œä½¿ç”¨mve</title>
    <url>/blogs/useMVE/</url>
    <content><![CDATA[<p>mveå¯ä»¥å°†å¤šè§’åº¦çš„å›¾ç‰‡åºåˆ—é‡æ„æˆä¸‰ç»´ç‚¹äº‘</p><h2 id="æ­å»ºmve"><a href="#æ­å»ºmve" class="headerlink" title="æ­å»ºmve"></a>æ­å»ºmve</h2><p>æ­å»ºè¿‡ç¨‹å‚ç…§å®˜æ–¹æ–‡æ¡£<a href="https://github.com/simonfuhrmann/mve" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/simonfuhrmann/mve</a></p><p>ä»¥ä¸‹å‡åœ¨ç»ˆç«¯è¿›è¡Œæ“ä½œ</p><p>1.ä»githubä¸Šä¸‹è½½ä»£ç </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/simonfuhrmann/mve.git</span><br></pre></td></tr></table></figure><p>ä¸‹è½½ä¹‹åä¼šåœ¨æ ¹ç›®å½•å»ºç«‹mveæ–‡ä»¶å¤¹</p><a id="more"></a>






<p>2.è¿›å…¥mveæ–‡ä»¶å¤¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd mve</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œç¼–è¾‘</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">make -j8</span><br></pre></td></tr></table></figure>

<p>3.æ·»åŠ ä¾èµ–åº“</p>
<p>ç¼–è¯‘è¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œæ˜¯å› ä¸ºç¼ºå°‘ä¾èµ–åº“ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ã€‚ä¸»è¦æ˜¯å¯¹å›¾ç‰‡å¤„ç†çš„å‡½æ•°åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install libjpeg</span><br><span class="line">brew install libpng</span><br><span class="line">brew install libtiff</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å°±èƒ½æˆåŠŸç¼–è¯‘ï¼Œæ‰“å¼€mveä¸‹çš„appsæ–‡ä»¶å¤¹ï¼Œå½“æ‰€æœ‰çš„æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†â€.oâ€åç¼€çš„æ–‡ä»¶ï¼Œè¯´æ˜ç¯å¢ƒå·²ç»æ­å»ºå¥½ã€‚</p>
<h2 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h2><p>1.åœ¨å®˜ç½‘ä¸‹è½½æ•°æ®é›†</p>
<p><a href="http://download.hrz.tu-darmstadt.de/media/FB20/GCC/mve_datasets/" target="_blank" rel="external nofollow noopener noreferrer">http://download.hrz.tu-darmstadt.de/media/FB20/GCC/mve_datasets/</a></p>
<p>æˆ‘é€‰æ‹©çš„æ˜¯der_hass-20140923æ•°æ®é›†ï¼Œé‡Œé¢åŒ…å«é›•åƒä¸åŒè§’åº¦çš„79å¼ å›¾åƒï¼Œä¸‹è½½åè¿›è¡Œè§£å‹</p>
<p>2.è®¾ç½®ç¯å¢ƒå˜é‡</p>
<p>ç”Ÿæˆç‚¹äº‘è¿‡ç¨‹ä¸­æ˜¯ä½¿ç”¨appsä¸‹ä¸­çš„å­æ–‡ä»¶å¤¹å®ç°ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#è¿›å…¥æ ¹ç›®å½•</span><br><span class="line">cd ~</span><br><span class="line">#ç»™ä»»æ„ä¸€ä¸ªæ–‡ä»¶æ·»åŠ ç¯å¢ƒå˜é‡</span><br><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥vimå‘½ä»¤åï¼Œè¿›å…¥è¾“å…¥ç¯å¢ƒå˜é‡é¡µé¢ï¼Œè¾“å…¥â€œOâ€ï¼Œè¿›å…¥å†™æ¨¡å¼ï¼Œå°†appsä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡ä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export PATH=/Users/mve/apps/bundle2pset:$PATH</span><br><span class="line">#ä»¥ä¸‹çœç•¥</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥ç»“æŸåï¼ŒæŒ‰escï¼Œåœ¨æ–‡æœ«è¾“å…¥â€:wqâ€ï¼Œé€€å‡ºå¹¶ä¿å­˜ç¯å¢ƒå˜é‡</p>
<p>ç”Ÿæ•ˆç¯å¢ƒå˜é‡ï¼Œå°†ç¯å¢ƒå˜é‡åº”ç”¨åˆ°ä¸‹è½½å¥½çš„æ•°æ®é›†ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">source æ•°æ®é›†è·¯å¾„åç§°</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆï¼Œåœ¨æ•°æ®é›†æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo $PATH</span><br></pre></td></tr></table></figure>

<p>å½“ç¯å¢ƒå˜é‡ä¸­åŒ…å«äº†appsä¸‹æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œè¯´æ˜ç¯å¢ƒå˜é‡è®¾ç½®æˆåŠŸ</p>
<p>3.é‡å»ºä¸‰ç»´ç”Ÿæˆç‚¹äº‘</p>
<p>der_hass-20140923æ˜¯ä¸‹è½½çš„æ•°æ®é›†ï¼Œder_hassæ˜¯ç”Ÿæˆæ•°æ®æ‰€åœ¨çš„æ–‡ä»¶å¤¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">makescene -i der_hass-20140923 der_hass</span><br></pre></td></tr></table></figure>

<p>æŒ‰ä»¥ä¸‹å‘½ä»¤ä¸€ä¸ªä¸ªè¿è¡Œï¼Œder_hassæ˜¯ç”Ÿæˆçš„æ•£æ–‡å›¾æ‰€åœ¨çš„æ–‡ä»¶å¤¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sfmrecon der_hass</span><br><span class="line">dmrecon -s2 der_hass</span><br><span class="line">scene2pset -F2 der_hass der_hass/pset-L2.ply</span><br><span class="line">fssrecon der_hass/pset-L2.ply der_hass/surface-L2.ply</span><br><span class="line">meshclean -t10 der_hass/surface-L2.ply der_hass/surface-L2-clean.ply</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ï¼Œå¤§çº¦éœ€3å°æ—¶å·¦å³ï¼Œæœ€ç»ˆç”Ÿæˆçš„ç‚¹äº‘æ–‡ä»¶ä¸ºsurface-L2-clean.ply</p>
<p>4.æ•ˆæœå±•ç¤º</p>
<p>ä½¿ç”¨meshlabæ‰“å¼€ç‚¹äº‘æ–‡ä»¶ï¼Œæ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200120193729.png" alt="æ•ˆæœå›¾"></p>
<p>å¯ä»¥çœ‹å‡ºç”Ÿæˆçš„ç‚¹äº‘å®Œæ•´ï¼Œä¸å­˜åœ¨ä¸è¿ç»­çš„éƒ¨åˆ†ï¼Œå®ç°äº†ä»å›¾åƒ-&gt;ç¨€ç–ç‚¹äº‘-&gt;ç¨ å¯†ç‚¹äº‘-&gt;ç‚¹äº‘è¡¨é¢é‡å»ºçš„å…¨è¿‡ç¨‹ã€‚</p>
]]></content>
      <categories>
        <category>ç‚¹äº‘</category>
      </categories>
      <tags>
        <tag>mve</tag>
        <tag>ç‚¹äº‘</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰</title>
    <url>/blogs/listbNote/</url>
    <content><![CDATA[<h2 id="å…³äºé“¾è¡¨çš„ç®—æ³•"><a href="#å…³äºé“¾è¡¨çš„ç®—æ³•" class="headerlink" title="å…³äºé“¾è¡¨çš„ç®—æ³•"></a>å…³äºé“¾è¡¨çš„ç®—æ³•</h2><p>é“¾è¡¨èŠ‚ç‚¹çš„å®šä¹‰</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">int</span> val;</span><br><span class="line">  ListNode* next;</span><br><span class="line">  ListNode(<span class="keyword">int</span> x):val(x),next(<span class="literal">NULL</span>)&#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é“¾è¡¨å¸¸ç”¨ç®—æ³•æ€æƒ³åŒ…æ‹¬ï¼šå¿«æ…¢æŒ‡é’ˆï¼ˆå¯¹ç©ºé—´å¤æ‚åº¦æœ‰è¦æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼‰</p><a id="more"></a>



<h3 id="å¿«æ…¢æŒ‡é’ˆ"><a href="#å¿«æ…¢æŒ‡é’ˆ" class="headerlink" title="å¿«æ…¢æŒ‡é’ˆ"></a>å¿«æ…¢æŒ‡é’ˆ</h3><p>æ–°å»ºä¸¤ä¸ªæŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆèµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆèµ°ä¸€æ­¥</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¿«æ…¢æŒ‡é’ˆæ³•åªä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç©ºé—´å¤æ‚åº¦å¾ˆå°ï¼Œåªæœ‰O(1)</span></span><br><span class="line">ListNode* fast=head;<span class="comment">//å¿«æŒ‡é’ˆ</span></span><br><span class="line">ListNode* slow=head;<span class="comment">//æ…¢æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">while</span>(fast!=<span class="literal">NULL</span>&amp;&amp;fast-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//æ…¢æŒ‡é’ˆèµ°ä¸€æ­¥</span></span><br><span class="line">  slow=slow-&gt;next;</span><br><span class="line">  <span class="comment">//å¿«æŒ‡é’ˆèµ°ä¸¤æ­¥</span></span><br><span class="line">  fast=fast-&gt;next-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>ç¯å½¢é“¾è¡¨ï¼ˆåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨ç¯ï¼‰ï¼š</p>
<p>ï¼ˆ1ï¼‰åˆ¤æ–­æœ‰æ— ç¯ï¼šå¯ä»¥åˆ©ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œå¦‚æœå­˜åœ¨ç¯ï¼Œé‚£ä¹ˆåœ¨æŸä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹å¿«æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹å°±ç­‰äºæ…¢æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ï¼ˆæ˜¯èŠ‚ç‚¹æ•´ä½“ç›¸ç­‰ï¼ŒåŒ…æ‹¬valå’Œnextï¼Œä¸èƒ½åªç”¨valåˆ¤æ–­ï¼‰ï¼Œåä¹‹ï¼Œåˆ™ä¸å­˜åœ¨ç¯ï¼Œæ•´ä½“é—®é¢˜æŠ½è±¡æˆè¿½èµ¶é—®é¢˜ï¼Œå› ä¸ºå­˜åœ¨ç¯ï¼Œæ‰€ä»¥ä¸€å®šèƒ½è¿½èµ¶ä¸Šã€‚</p>
<p>ï¼ˆ2ï¼‰æ±‚ç¯çš„å…¥å£èŠ‚ç‚¹ï¼šå½“éœ€è¦æ±‚ç¯å½¢å…¥å£èŠ‚ç‚¹çš„æ—¶å€™ï¼Œé¦–å…ˆå°†åˆ¤æ–­æœ‰æ— ç¯ï¼Œåœ¨ç›¸é‡çš„æ—¶å€™breakï¼Œæ­¤æ—¶å‡è®¾é“¾è¡¨ä¸­æ— ç¯éƒ¨åˆ†é•¿åº¦ä¸ºaï¼Œç¯é•¿åº¦bï¼Œç›¸é‡æ—¶å¿«æŒ‡é’ˆæ¯”æ…¢æŒ‡é’ˆèµ°äº†nä¸ªç¯é•¿åº¦ï¼Œf=s+nbï¼Œåˆå› ä¸ºf=2sï¼Œæ‰€ä»¥s=nbï¼Œæ…¢æŒ‡é’ˆè¦èµ°åˆ°ç¯å…¥å£ï¼Œéœ€è¦é•¿åº¦ä¸ºa+nbï¼Œæ‰€ä»¥æ…¢æŒ‡é’ˆéœ€è¦å†èµ°aä¸ªé•¿åº¦ï¼Œæ­¤æ—¶å°†fastè®¾ç½®ä¸ºheadï¼Œä»headèµ°åˆ°ç¯å…¥å£é•¿åº¦æ­£å¥½ä¸ºaï¼Œå½“ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘ç›¸åŒé“¾èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå°±åˆ°è¾¾äº†ç¯çš„å…¥å£</p>
<h2 id="å…³äºæ‹¬å·çš„ç®—æ³•"><a href="#å…³äºæ‹¬å·çš„ç®—æ³•" class="headerlink" title="å…³äºæ‹¬å·çš„ç®—æ³•"></a>å…³äºæ‹¬å·çš„ç®—æ³•</h2><h3 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">[<span class="comment">//ç”¨mapå­˜å‚¨æ‹¬å·çš„é”®å€¼å¯¹</span></span><br><span class="line">unorder_map&lt;<span class="keyword">char</span>&gt; <span class="built_in">map</span>&#123;&#123;<span class="string">')'</span>,<span class="string">'('</span>&#125;,&#123;&#125;&#125;;</span><br><span class="line">]</span><br><span class="line"><span class="comment">//ç”¨æ ˆå­˜å‚¨è¯»å…¥çš„å­—ç¬¦</span></span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt; s;</span><br><span class="line"><span class="keyword">while</span>(å­—ç¬¦ä¸²ä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>(å½“å­—ç¬¦æ˜¯å·¦åŠè¾¹æ‹¬å·æ—¶)</span><br><span class="line">    å·¦æ‹¬å·å…¥æ ˆï¼›</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ...</span><br><span class="line">    [</span><br><span class="line">    <span class="comment">//å–æ ˆé¡¶å…ƒç´ </span></span><br><span class="line">    q=s.top();</span><br><span class="line">    <span class="keyword">if</span>(æ ˆé¡¶å…ƒç´ ==<span class="built_in">map</span>[q])</span><br><span class="line">      å‡ºæ ˆ</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      æœªèƒ½åŒ¹é…ä¸Š</span><br><span class="line">    ]</span><br><span class="line">    [</span><br><span class="line">      <span class="comment">//å…ˆå‡ºæ ˆï¼Œå½“å‡ºæ ˆåæ ˆä¸ºç©ºï¼Œè¯´æ˜å½“å‰å³æ‹¬å·å‰é¢æ²¡æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼Œæ­¤æ—¶å³æ‹¬å·å…¥æ ˆä½œä¸ºä¸€ä¸ªä½ç½®æ ‡è®°ï¼Œè®¡ç®—åé¢çš„é•¿åº¦ï¼Œå¦‚æœåœ¨elseé‡Œå‡ºæ ˆï¼Œé‚£ä¹ˆä¼šé¢ä¸´å‡ºæ ˆåï¼Œs.top()ä¸å­˜åœ¨çš„ç°è±¡</span></span><br><span class="line">      s.pop();</span><br><span class="line">      <span class="comment">//æ ˆä¸ºç©ºï¼Œå­˜å…¥å½“å‰æ‹¬å·</span></span><br><span class="line">      <span class="keyword">if</span>(s.empty())</span><br><span class="line">      	s.push(i)</span><br><span class="line">      <span class="comment">//æ ˆä¸ä¸ºç©ºï¼Œè·å¾—é•¿åº¦</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        length=<span class="built_in">max</span>(length,i-s.top())</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>æœ‰æ•ˆçš„æ‹¬å·ï¼ˆç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ <code>&#39;(&#39;</code>ï¼Œ<code>&#39;)&#39;</code>ï¼Œ<code>&#39;{&#39;</code>ï¼Œ<code>&#39;}&#39;</code>ï¼Œ<code>&#39;[&#39;</code>ï¼Œ<code>&#39;]&#39;</code> çš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚ï¼‰ï¼šåœ¨mapä¸­å­˜å‚¨æ‹¬å·çš„é”®å€¼å¯¹ï¼Œåˆ©ç”¨map[å€¼]=é”®ï¼Œæ¯æ¬¡è¯»å…¥å­—ç¬¦ä¸²çš„å­—ç¬¦æ—¶ï¼Œå¦‚æœæ˜¯å·¦è¾¹æ‹¬å·å°±å…¥æ ˆï¼Œå¦åˆ™å°±æ˜¯å³è¾¹æ‹¬å·ï¼Œéœ€è¦è¿›è¡Œæ£€æµ‹æ˜¯å¦é…å¯¹ï¼Œå–è¿™æ—¶æ ˆé¡¶çš„æ‹¬å·ï¼Œå¦‚æœé”®å€¼å¯¹åŒ¹é…ä¸Šï¼Œåˆ™å‡ºæ ˆï¼Œæ£€æµ‹ä¸‹ä¸€ä¸ªï¼Œå¦åˆ™æ˜¯æ²¡æœ‰åŒ¹é…ä¸Šã€‚</p>
<p>æœ€é•¿æœ‰æ•ˆæ‹¬å·ï¼ˆç»™å®šä¸€ä¸ªåªåŒ…å« <code>&#39;(&#39;</code> å’Œ <code>&#39;)&#39;</code> çš„å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿çš„åŒ…å«æœ‰æ•ˆæ‹¬å·çš„å­ä¸²çš„é•¿åº¦ã€‚ï¼‰ï¼š</p>
<p>ï¼ˆ1ï¼‰åˆå§‹åŒ–ï¼šç”¨æ ˆæ¥å­˜å‚¨æ‹¬å·ï¼Œæ ˆé‡Œä¿å­˜æ‹¬å·ä½ç½®çš„ä¸‹æ ‡ï¼Œä¸ºäº†ä¿è¯è·å–é•¿åº¦ï¼Œåˆå§‹åŒ–æ ˆä¸º-1ã€‚</p>
<p>ï¼ˆ2ï¼‰å½“æ‰«æåˆ°å·¦æ‹¬å·çš„æ—¶å€™ï¼Œå…¥æ ˆï¼Œå½“æ‰«æåˆ°å³æ‹¬å·çš„æ—¶å€™ï¼Œæ­¤æ—¶å°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å½“æ ˆä¸ºç©ºçš„æ—¶å€™ï¼Œè¯´æ˜ä¹‹å‰æ²¡æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼ŒæŠŠå½“å‰æ‹¬å·å…¥æ ˆï¼Œå¦ä¸€ç§æ ˆä¸ä¸ºç©ºï¼Œè¯´æ˜æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼Œç”¨å½“å‰ä½ç½®å‡å»æ ˆé¡¶çš„ä½ç½®ï¼Œå¹¶æ›´æ–°é•¿åº¦</p>
<h3 id="æ·±åº¦éå†-å‰ªæ"><a href="#æ·±åº¦éå†-å‰ªæ" class="headerlink" title="æ·±åº¦éå†+å‰ªæ"></a>æ·±åº¦éå†+å‰ªæ</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¾“å…¥å‚æ•°ä¸ºå½“å‰ç”±æ‹¬å·ç»„æˆçš„è·¯å¾„ï¼Œå·¦å­æ ‘æ‹¬å·çš„ä¸ªæ•°ï¼Œå³å­æ ‘æ‹¬å·çš„ä¸ªæ•°ï¼Œä»¥åŠæœ€ç»ˆç»“æœ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">string</span> str,<span class="keyword">int</span> left,<span class="keyword">int</span> right,<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&gt;&gt; res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//ç»“æŸçš„æ¡ä»¶,æ­¤æ—¶å‡ºç°äº†ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è·¯å¾„:å·¦å³å­æ ‘çš„æ‹¬å·ä¸ªæ•°éƒ½ä¸º0</span></span><br><span class="line">  <span class="keyword">if</span>(left==<span class="number">0</span>&amp;&amp;right==<span class="number">0</span>)</span><br><span class="line">    res.push(str)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">//å‰ªæï¼šå·¦å­æ ‘çš„æ‹¬å·ä¸ªæ•°å¤§äºå³å­æ ‘çš„æ‹¬å·ä¸ªæ•°,å‡ºç°ä¸åŒ¹é…</span></span><br><span class="line">  <span class="keyword">if</span>(left&gt;right)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">//å·¦è¾¹æ‹¬å·å¤šï¼Œå…ˆç”Ÿæˆå·¦æ‹¬å·</span></span><br><span class="line">  <span class="keyword">if</span>(left&gt;<span class="number">0</span>)</span><br><span class="line">    dfs(str+<span class="string">'('</span>,left<span class="number">-1</span>,right,res)</span><br><span class="line">  <span class="comment">//å³è¾¹æ‹¬å·å¤šï¼Œå†ç”Ÿæˆå³æ‹¬å·</span></span><br><span class="line">  <span class="keyword">if</span>(right&gt;<span class="number">0</span>)</span><br><span class="line">    dfs(str+<span class="string">'ï¼‰'</span>,left<span class="number">-1</span>,right,res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>æ‹¬å·çš„ç”Ÿæˆï¼ˆç»™å‡º n ä»£è¡¨ç”Ÿæˆæ‹¬å·çš„å¯¹æ•°ï¼Œå†™å‡ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿å…¶èƒ½å¤Ÿç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„å¹¶ä¸”æœ‰æ•ˆçš„æ‹¬å·ç»„åˆï¼‰ï¼šå®è´¨æ˜¯å¯¹æ‹¬å·åšå‡æ³•ï¼Œå½“å·¦æ‹¬å·æ•°é‡å¤§äº0ï¼Œå°±ä¸æ–­ç”Ÿæˆå·¦æ‹¬å·ï¼Œå³æ‹¬å·æ•°é‡å¤§äº0ï¼Œç”Ÿæˆå³æ‹¬å·ï¼Œä½†æ˜¯å­˜åœ¨ä¸æ»¡è¶³æ‹¬å·åŒ¹é…çš„æ¡ä»¶ï¼Œå½“å·¦æ‹¬å·æ•°é‡å¤§äºå³æ‹¬å·ï¼Œæ­¤æ—¶éœ€è¦å‰ªæï¼ˆåŠ ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œreturnï¼‰,å½“å·¦å³æ‹¬å·æ•°é‡éƒ½ä¸º0ï¼Œè¯´æ˜æ‰¾åˆ°äº†ä¸€ä¸ªåˆé€‚çš„è·¯å¾„ï¼Œå°†å…¶å­˜å‚¨ä¸‹æ¥ã€‚</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>é“¾è¡¨</tag>
        <tag>æ‹¬å·</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰</title>
    <url>/blogs/backTrackNote/</url>
    <content><![CDATA[<h2 id="å›æº¯æ³•"><a href="#å›æº¯æ³•" class="headerlink" title="å›æº¯æ³•"></a>å›æº¯æ³•</h2><p>å›æº¯ä¸€èˆ¬ç”¨äºæ‰¾åˆ°æ»¡è¶³è¦æ±‚çš„çš„æ‰€æœ‰è§£ï¼Œå³ç›¸å½“äºæ„é€ ä¸€æ£µæ ‘ï¼Œä»è·ŸèŠ‚ç‚¹å‡ºå‘ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰è·¯å¾„ï¼Œå¹¶è¿›è¡Œä¿å­˜ï¼Œå½“ç›®å‰çš„è·¯å¾„ä¸ç¬¦åˆæ¡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦å›æº¯ï¼Œå³å‰ªæï¼Œåˆ é™¤ä¸ç¬¦åˆçš„åˆ†æ”¯ï¼Œå½“åˆ°è¾¾ç»“æŸçš„æ¡ä»¶æ—¶ï¼Œå³æ‰¾åˆ°äº†ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è§£ï¼Œå†ç»§ç»­æ„é€ ä¸‹ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚</p><p>å¸¸ç”¨äºè§£å†³æ ‘ç§æ±‚å¾—æ‰€æœ‰è§£çš„é—®é¢˜å’Œæ’åˆ—ç»„åˆä¸­æ±‚è§£é—®é¢˜ï¼Œæˆ–è€…é—®é¢˜å¯ä»¥è½¬æ¢ä¸ºæ±‚æ ‘ä¸­ä¸€æ¡è·¯å¾„çš„é—®é¢˜ï¼Œå¯ä»¥ç”»å›¾ã€‚</p><a id="more"></a>

<h3 id="å…³äºæ ‘çš„å›æº¯"><a href="#å…³äºæ ‘çš„å›æº¯" class="headerlink" title="å…³äºæ ‘çš„å›æº¯"></a>å…³äºæ ‘çš„å›æº¯</h3><p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//resultå­˜å‚¨æœ€ç»ˆç»“æœï¼Œreså­˜å‚¨ä¸­é—´ç»“æœ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode* root,<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&gt; result,<span class="built_in">vector</span> resï¼Œâ€¦.)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">//å¤„ç†å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">   res.push(root-&gt;val)</span><br><span class="line"></span><br><span class="line">   â€¦</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç»“æŸçš„æ¡ä»¶</span></span><br><span class="line">  <span class="keyword">if</span>(æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼ˆä¸€èˆ¬æ˜¯å€¼ç›¸ç­‰ï¼‰å¹¶ä¸”åˆ°è¾¾æ ¹èŠ‚ç‚¹)</span><br><span class="line">  	result.push(res)</span><br><span class="line">  <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">  &#123;</span><br><span class="line">    doTree(root-&gt;left,å…¶ä»–å‚æ•°)</span><br><span class="line">    <span class="comment">//ä¸æ»¡è¶³æ¡ä»¶ï¼Œéœ€è¦å›æº¯</span></span><br><span class="line">    res.pop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">  &#123;</span><br><span class="line">    doTree(root-&gt;right,å…¶ä»–å‚æ•°)</span><br><span class="line">    <span class="comment">//ä¸æ»¡è¶³æ¡ä»¶ï¼Œéœ€è¦å›æº¯</span></span><br><span class="line">    res.pop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>æ‰¾åˆ°æ‰€æœ‰æ»¡è¶³ç›®æ ‡èŠ‚ç‚¹çš„è·¯å¾„ï¼šæ¯æ¬¡æŠŠå½“å‰èŠ‚ç‚¹åŠ å…¥ï¼Œå¹¶å°†ç›®æ ‡å€¼å‡å»å½“å‰èŠ‚ç‚¹çš„å€¼ï¼Œåˆ¤æ–­å½“å‰å¶å­èŠ‚ç‚¹å€¼ï¼ˆå·¦å³å­æ ‘ä¸ºç©ºï¼‰ä¸0æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰ï¼Œåˆ™æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³çš„ç»“æœï¼Œå¦åˆ™ï¼Œç»§ç»­å¯¹å·¦å³å­æ ‘é€’å½’ï¼Œæ­¤æ—¶è‹¥å­˜åœ¨ä¸æ»¡è¶³æ¡ä»¶çš„ï¼Œéœ€è¦å›æº¯ï¼ˆpopï¼‰</p>
<h3 id="æ’åˆ—ç»„åˆ"><a href="#æ’åˆ—ç»„åˆ" class="headerlink" title="æ’åˆ—ç»„åˆ"></a>æ’åˆ—ç»„åˆ</h3><p>æ’åˆ—ç»„åˆæ±‚æ‰€æœ‰ç¬¦åˆé—®é¢˜çš„è§£ï¼ŒåŸºæœ¬æ¡†æ¶ï¼š</p>
<p>ç»„åˆé—®é¢˜æŒ‰é¡ºåºè¯»å–ï¼Œä¸éœ€è¦è®¾ç½®usedæ•°ç»„ï¼Œæ’åˆ—é—®é¢˜åˆ™éœ€è¦è®¾ç½®</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> start,<span class="keyword">int</span> target)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//ç»“æŸçš„æ¡ä»¶ï¼šæ‰¾åˆ°æ»¡è¶³è¦æ±‚çš„ä¸€ä¸ªè§£</span></span><br><span class="line">  <span class="keyword">if</span>(æ»¡è¶³å€¼ä¸º<span class="number">0</span>æˆ–è€…å…¶ä»–æ¡ä»¶)</span><br><span class="line">  &#123;</span><br><span class="line">    result.push(res);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//å¾ªç¯çš„æ¡ä»¶</span></span><br><span class="line">  <span class="keyword">for</span>(i&lt;æ•°ç»„é•¿åº¦&amp;&amp;target-num[i]&gt;=<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    [</span><br><span class="line">      <span class="comment">//é¿å…é‡å¤å…ƒç´ å¾—å‡ºé‡å¤ç»„åˆ</span></span><br><span class="line">      <span class="keyword">if</span>(i&gt;start&amp;&amp;num[i]==num[i<span class="number">-1</span>])</span><br><span class="line">      	<span class="keyword">continue</span>;</span><br><span class="line">    ]</span><br><span class="line">    [</span><br><span class="line">      <span class="comment">//å…¨æ’åˆ—ä¸­ä¸èƒ½ä½¿ç”¨ä¸Šä¸€å±‚ä½¿ç”¨çš„å…ƒç´ </span></span><br><span class="line">      <span class="comment">//è®¾ç½®æ ‡å¿—ä½æˆ–è€…å…¶ä»–åˆ¤æ–­æ¡ä»¶</span></span><br><span class="line">      <span class="keyword">if</span>(!use[i])&#123;&#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment">//å½“æ—¶æ’åˆ—é—®é¢˜ï¼Œå¹¶ä¸”æœ‰é‡å¤æ•°å­—çš„æ—¶å€™ï¼Œéœ€è¦å°†ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ç»“åˆ</span></span><br><span class="line">    <span class="comment">//é€‰æ‹©å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">    res.push(num[i]);</span><br><span class="line">    [</span><br><span class="line">      <span class="comment">//é€‰æ‹©äº†è¯¥èŠ‚ç‚¹ï¼Œéœ€è¦è®¾ç½®æ ‡å¿—ä½</span></span><br><span class="line">      used[i]=<span class="literal">true</span>;</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment">//[å¯ä»¥é‡å¤ä½¿ç”¨]</span></span><br><span class="line">    dfs(i,target-num[i]);</span><br><span class="line">    [<span class="comment">//ä¸å¯ä»¥é‡å¤ä½¿ç”¨</span></span><br><span class="line">    [dfs(i+<span class="number">1</span>,target-num[i]);</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment">//å›æº¯ï¼Œå–æ¶ˆå½“å‰é€‰æ‹©ï¼Œè¿”å›ä¸Šä¸€å±‚</span></span><br><span class="line">    res.pop();</span><br><span class="line">    [</span><br><span class="line">      <span class="comment">//æ’¤é”€é€‰æ‹©ï¼Œéœ€è¦è¿˜åŸæ ‡å¿—ä½</span></span><br><span class="line">      used[i]=<span class="literal">true</span>;</span><br><span class="line">    ]</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> åº”ç”¨åœºæ™¯ï¼š</p>
<p>ç»„åˆæ±‚å’Œï¼ˆæ•°ç»„å…ƒç´ å†…éƒ¨ä¸é‡å¤ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼‰ï¼šé¦–å…ˆå¯¹æ•°ç»„æ’åºï¼Œæ’åºèƒ½æ›´æ–¹ä¾¿å»é‡ã€‚åœ¨dfså‡½æ•°ä¸­ï¼Œæ¯æ¬¡ä¼ å…¥æ•°ç»„ä¸­æ•°æ®çš„ä½ç½®å’Œç›®æ ‡å€¼ï¼Œå½“å‰©ä½™å€¼å¤§äºç­‰äº0ï¼Œè¿›å…¥å¾ªç¯ï¼Œå°†å½“å‰æ•°ç»„å€¼å­˜å…¥è·¯å¾„ä¸­ï¼Œå†ç»§ç»­é€’å½’ï¼Œåšä¸‹ä¸€æ¬¡å†³ç­–ï¼Œç”±äºå¯é‡å¤ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡å¯ä»¥ä»ç„¶ä»iå¼€å§‹ï¼Œå½“æ»¡è¶³æ¡ä»¶æ—¶ï¼Œå°†å½“å‰è·¯å¾„å­˜å…¥ç»“æœï¼Œæ­¤æ—¶å›æº¯åˆ°ä¸Šä¸€å±‚ï¼Œç»§ç»­å¯»æ‰¾åˆé€‚çš„è·¯å¾„ã€‚</p>
<p>ç»„åˆæ±‚å’Œï¼ˆæ•°ç»„å…ƒç´ å†…éƒ¨å¯èƒ½æœ‰é‡å¤ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼Œæ­¤æ—¶ä¸èƒ½é‡å¤ä½¿ç”¨æ•°ç»„çš„å…ƒç´ ï¼Œè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆï¼‰ï¼šæ€è·¯åŒä¸Šï¼Œå› ä¸ºä¸èƒ½é‡å¤ä½¿ç”¨æ•°ç»„å…ƒç´ ï¼Œæ‰€ä»¥åœ¨forå¾ªç¯ä¸­dfså‡½æ•°ä¼ å€¼åªé¥ä»i+1å¼€å§‹ã€‚ä¸æ­¤åŒæ—¶ï¼Œç”±äºè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆï¼Œæ‰€ä»¥åœ¨æ’åºåæ•°ç»„ï¼Œå½“å‰ä¸€ä¸ªæ•°ç»„å…ƒç´ å’Œå½“å‰æ•°ç»„å…ƒç´ ç›¸åŒï¼Œé‚£ä¹ˆå½“å‰å…ƒç´ å¾—å‡ºçš„è·¯å¾„å’Œä¸Šä¸€ä¸ªå…ƒç´ å¿…å®šç›¸åŒï¼Œå› æ­¤è¿™æ—¶éœ€è¦è·³è¿‡å½“å‰å…ƒç´ ï¼Œå¯¹ä¸‹ä¸€ä¸ªå…ƒç´ å¤„ç†ã€‚</p>
<p>å…¨æ’åˆ—ï¼ˆç»™å®šä¸€ä¸ªæ²¡æœ‰é‡å¤æ•°å­—çš„åºåˆ—ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ï¼‰ï¼šæ’åˆ—é¢˜æ˜¯ä¸Šä¸€æ¬¡é€‰æ‹©çš„èŠ‚ç‚¹ï¼Œè¿™æ¬¡ä¸èƒ½å†é€‰æ‹©ã€‚æ¯ä¸€å±‚éƒ½å¯ä»¥é€‰æ‹©ä¸€ä¸ªæœªå‡ºç°çš„å…ƒç´ ï¼Œéœ€è¦å¯¹æ•°ç»„å…ƒç´ è®¾ç½®æ ‡å¿—ä½ï¼Œå½“ä½¿ç”¨è¿‡ï¼Œå°±å°†æ ‡å¿—ä½ç½®ä¸º1ï¼Œæ­¤æ—¶ä¹Ÿéœ€è¦åœ¨forå¾ªç¯ä¸­åŠ ä¸€å±‚åˆ¤æ–­ï¼ŒæŸ¥çœ‹å½“å‰æ•°ç»„æ˜¯å¦è¢«ä½¿ç”¨ï¼Œå½“ä½¿ç”¨è¿‡æ—¶ï¼Œéœ€è¦è·³è¿‡è¯¥å…ƒç´ ï¼Œä¸‹ä¸€å±‚ç»§ç»­é€‰æ‹©ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ç»“æœåå­˜å‚¨ä¸‹æ¥ï¼Œæ¥ç€æ’¤é”€æœ¬æ¬¡é€‰æ‹©ï¼Œè¿”å›ä¸Šä¸€å±‚æŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–ç»“æœã€‚</p>
<p>å…¨æ’åˆ—ï¼ˆç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ—ï¼Œè¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ï¼‰ï¼šæ€è·¯åŒä¸Šï¼Œæ­¤æ—¶éœ€è¦é¢å¤–åŠ ä¸ªåˆ¤æ–­ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„æ•°å­—ï¼Œæœ‰é‡å¤çš„æ•°å­—åˆ™è·³è¿‡ã€‚å…·ä½“ä¸ºï¼šæœ¬æ¬¡èŠ‚ç‚¹ä¸å‰ä¸€ä¸ªç›¸åŒï¼Œå¹¶ä¸”å‰ä¸€ä¸ªå·²ä½¿ç”¨è¿‡ï¼Œè¯´æ˜å·²æœ‰ç›¸åŒçš„æ’åˆ—ï¼Œåˆ™æœ¬æ¬¡æ’åˆ—è·³è¿‡ã€‚</p>
<p>nçš‡åé—®é¢˜ï¼šè½¬æ¢ä¸ºå…¨æ’åˆ—é—®é¢˜ï¼Œåœ¨æ¯ä¸€ä¸ªçš„nä¸ªä½ç½®ä¸­é€‰ä¸€ä¸ªä½œä¸ºå½“å‰é€‰æ‹©ï¼Œnè¡Œåšnä¸ªé€‰æ‹©ï¼Œå¹¶ä¸”æ˜¯åšåšä¸é‡å¤çš„é€‰æ‹©ï¼Œæ­£å¥½æ„æˆä¸€ä¸ªæ’åˆ—ï¼Œæ­¤æ—¶çš„æ’åˆ—æ»¡è¶³ä¸åœ¨åŒä¸€è¡Œä¸åœ¨åŒä¸€åˆ—ï¼Œåªè¦å¯¹å½“å‰çš„æ’åˆ—éœ€è¦å†æ»¡è¶³é¢˜è®¾æ¡ä»¶å³å¯ï¼Œå³ä¸åœ¨ä¸»å¯¹è§’çº¿ï¼Œä¸åœ¨å‰¯å¯¹è§’çº¿ï¼Œvector<bool> master1;//å‰¯å¯¹è§’çº¿å’Œç›¸åŒï¼Œéƒ½ä¸ºi+j iä¸ºè¡Œï¼Œjä¸ºåˆ—ï¼Œä¸¤è€…ç›¸åŠ å’Œæ˜¯å½“å‰è¡Œï¼Œvector<bool> master2;//ä¸»å¯¹è§’çº¿å·®ç›¸åŒï¼Œä¸ºi-j+n-1 iä¸ºè¡Œï¼Œjä¸ºåˆ—ï¼Œå†è®¾ç½®ä¸¤ä¸ªæ ‡å¿—ä½è¿›è¡Œåˆ¤æ–­ï¼Œæœ€åå°†å¾—åˆ°çš„æ’åˆ—ç”¨é¢˜ç›®ä¸­æ ¼å¼æ‰“å°å‡ºæ¥ä½œä¸ºç»“æœã€‚</bool></bool></p>
<p>å­é›†ï¼ˆç»™å®šä¸€ç»„ä¸å«é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ï¼‰ï¼šå¯¹ä¸åŒå­é›†ä¸ªæ•°è¿›è¡Œæ·±åº¦éå†ï¼Œæ­¤æ—¶éœ€è¦åœ¨ä¸»å‡½æ•°ä¸­åŠ ä¸€ä¸ªå¾ªç¯</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>()+<span class="number">1</span>;i++)<span class="comment">//içš„é•¿åº¦ä¸º0~nums.size(),æ‰€ä»¥éœ€è¦åŠ ä¸€</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//----é€šè¿‡iæ§åˆ¶å­é›†å¤§å°</span></span><br><span class="line">  dfs(start,i);</span><br><span class="line">  <span class="comment">//startæ˜¯ä»æ•°ç»„ä¸­å–å…ƒç´ çš„å¼€å§‹çš„ä½ç½®ï¼Œiæ˜¯æ·±åº¦ï¼Œå³å­é›†ä¸­å…ƒç´ çš„ä¸ªæ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åˆ†å‰²å­—ç¬¦ä¸²ï¼ˆç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <em>s</em>ï¼Œå°† <em>s</em> åˆ†å‰²æˆä¸€äº›å­ä¸²ï¼Œä½¿æ¯ä¸ªå­ä¸²éƒ½æ˜¯å›æ–‡ä¸²ï¼‰ï¼šæ¯æ¬¡åˆ¤æ–­å½“å‰çš„èµ·å§‹è‡³æœ«å°¾ä½ç½®æ˜¯å¦æ˜¯å›æ–‡ï¼Œå¦‚æœæ˜¯å°±å°†ç»“æœå‹å…¥resï¼Œç»§ç»­é€’å½’ã€‚é€šè¿‡ä¸æ–­å˜æ¢åˆ†å‰²çš„ä½ç½®ï¼Œæ¥æ„é€ å†³ç­–æ ‘ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=start;i&lt;len;i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>(start~iä¹‹é—´ä¸æ˜¯å›æ–‡)</span><br><span class="line">    ç»§ç»­æ‰¾ä¸‹ä¸€ä¸ªå›æ–‡çš„ä½ç½®</span><br><span class="line">    </span><br><span class="line">   <span class="comment">//start~iä¹‹é—´æ˜¯å›æ–‡ï¼Œå‹å…¥ç»“æœå†…</span></span><br><span class="line">    res.push(s.substr(start,start+i+<span class="number">1</span>))</span><br><span class="line">    <span class="comment">//ç»§ç»­çœ‹ä¸‹ä¸€ä¸ªåˆ†å‰²ä½ç½®</span></span><br><span class="line">    dfs(i+<span class="number">1</span>,depth)</span><br><span class="line">    <span class="comment">//æ’¤é”€é€‰æ‹©ï¼Œå›åˆ°ä¸Šä¸€å±‚å†³ç­–</span></span><br><span class="line">    res.pop()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>å›æº¯</tag>
      </tags>
  </entry>
  <entry>
    <title>Leecodeç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰</title>
    <url>/blogs/treeNote/</url>
    <content><![CDATA[<h2 id="å…³äºæ ‘çš„ç®—æ³•"><a href="#å…³äºæ ‘çš„ç®—æ³•" class="headerlink" title="å…³äºæ ‘çš„ç®—æ³•"></a>å…³äºæ ‘çš„ç®—æ³•</h2><p>é™¤äº†åŸºæœ¬çš„éå†ï¼Œå…¶ä½™å…³äºæ ‘çš„å¤„ç†åŸºæœ¬éƒ½æ˜¯ä¾èµ–é€’å½’ç®—æ³•ï¼Œæ€»ä½“æ€è·¯ï¼Œæ˜¯å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡Œå¤„ç†ï¼Œå†å°†å‰©ä½™çš„äº¤ç»™å·¦å­æ ‘å’Œå³å­æ ‘åˆ†åˆ«é€’å½’å¤„ç†ã€‚</p><h3 id="å±‚æ¬¡éå†"><a href="#å±‚æ¬¡éå†" class="headerlink" title="å±‚æ¬¡éå†"></a>å±‚æ¬¡éå†</h3><p>é˜Ÿåˆ—ï¼šæ¯æ¬¡æŠŠåŒä¸€å±‚çš„èŠ‚ç‚¹å…¥é˜Ÿï¼Œæ ¹æ®å…ˆè¿›å…ˆå‡ºçš„ç‰¹ç‚¹ï¼Œä¾æ¬¡è¯»å–é˜Ÿé¦–èŠ‚ç‚¹ï¼Œå†æŠŠå½“å‰èŠ‚ç‚¹çš„å·¦å³å­æ ‘å…¥é˜Ÿï¼Œä½œä¸ºä¸‹ä¸€å±‚éœ€è¦éå†çš„èŠ‚ç‚¹</p><p>ä¼ªä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é˜Ÿåˆ—å­˜å‚¨æ ¹èŠ‚ç‚¹</span></span><br><span class="line">p.push(root)</span><br><span class="line"><span class="keyword">while</span>(é˜Ÿåˆ—ä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//è·å–è¯¥å±‚èŠ‚ç‚¹ä¸ªæ•°</span></span><br><span class="line">  <span class="built_in">width</span>=p.<span class="built_in">size</span>()</span><br><span class="line">  <span class="comment">//è¯»å–è¯¥å±‚æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶å­˜å‚¨ä¸‹ä¸€å±‚èŠ‚ ç‚¹</span></span><br><span class="line">  <span class="keyword">for</span>(i&lt;<span class="built_in">width</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//è¯»å–é˜Ÿé¦–èŠ‚ç‚¹</span></span><br><span class="line">    r=p.front()</span><br><span class="line">    å‡ºé˜Ÿ</span><br><span class="line">    <span class="keyword">if</span>(rçš„å·¦å­æ ‘å­˜åœ¨) å·¦å­æ ‘å…¥é˜Ÿ</span><br><span class="line">    <span class="keyword">if</span>(rçš„å³å­æ ‘å­˜åœ¨) å³å­æ ‘å…¥é˜Ÿ</span><br><span class="line">  &#125;</span><br><span class="line">  å­˜å‚¨æ¯å±‚çš„ç»“æœ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a>




<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>é”¯é½¿å½¢å±‚æ¬¡éå†ï¼šéœ€è¦æŠŠå¶æ•°è¡Œååºæ’åˆ—</p>
<p>æ±‚æœ€å¤§æ·±åº¦ï¼šæ¯å±‚å…¥é˜Ÿæ—¶ï¼Œå¢åŠ ä¸€ä¸ªå±‚æ•°</p>
<p>æ±‚æœ€å°æ·±åº¦ï¼ˆä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿‘å¶å­èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°é‡ï¼‰ï¼šæ¯å±‚é‡åˆ°å·¦å³èŠ‚ç‚¹å‡ä¸ºç©ºçš„èŠ‚ç‚¹æ—¶ï¼Œè¾“å‡ºæ­¤æ—¶çš„å±‚æ•°</p>
<h3 id="å‰ã€ä¸­ã€ååºéå†"><a href="#å‰ã€ä¸­ã€ååºéå†" class="headerlink" title="å‰ã€ä¸­ã€ååºéå†"></a>å‰ã€ä¸­ã€ååºéå†</h3><p>a.å‰åº éå†ç‰¹ç‚¹ï¼šæ ¹-å·¦-å³</p>
<p>æ ˆï¼šæ¯æ¬¡å…ˆè®¿é—®å½“å‰èŠ‚ç‚¹ï¼Œå¹¶ä¾æ¬¡å°†å³å­æ ‘å‹å…¥æ ˆï¼Œå†å¾ªç¯éå†å·¦å­æ ‘ï¼Œæ ¹æ®å…ˆè¿›åå‡ºçš„ç‰¹ç‚¹ï¼Œå¾ªç¯ç»“æŸåï¼Œä¸‹æ¬¡å°†ä»æœ€å·¦è¾¹å­æ ‘çš„å³å­æ ‘å¼€å§‹å¾ªç¯</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ–°å»ºä¸€ä¸ªæ ‘èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">p=root</span><br><span class="line"><span class="comment">//pä¸ä¸ºç©ºè¯´æ˜è¿˜æœ‰æœªéå†åˆ°çš„èŠ‚ç‚¹ï¼Œsä¸ä¸ºç©ºè¯´æ˜æ ˆé‡Œè¿˜æœ‰å­˜å‚¨çš„å­æ ‘</span></span><br><span class="line"><span class="keyword">while</span>(pä¸ä¸ºç©º||sä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span>(pä¸ä¸ºç©º)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//è®¿é—®å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">    res.push(p-&gt;val)</span><br><span class="line">    <span class="comment">//å³å­æ ‘å…¥æ ˆ</span></span><br><span class="line">    s.push(p-&gt;right)</span><br><span class="line">    <span class="comment">//ä¸æ–­éå†å·¦å­æ ‘</span></span><br><span class="line">    p=p-&gt;left</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">  p=s.top();</span><br><span class="line">  å‡ºæ ˆ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b.ååº éå†ç‰¹ç‚¹ï¼šå·¦-å³-æ ¹</p>
<p>æ ˆï¼šå› ä¸ºå…ˆå¯¹æ ¹èŠ‚ç‚¹è®¿é—®è¾ƒä¸ºç®€å•ï¼ŒåŸç†ç±»ä¼¼å‰åºéå†ï¼Œå› æ­¤ï¼Œå¯ä»¥å…ˆè®¿é—®å½“å‰æ ¹èŠ‚ç‚¹ï¼Œå°†å·¦å­æ ‘å‹å…¥æ ˆï¼Œå†å¾ªç¯éå†å³å­æ ‘ã€‚å¾ªç¯ç»“æŸï¼Œä¸‹ä¸€æ¬¡æ˜¯å¯¹æœ€å³è¾¹çš„å·¦å­æ ‘å¼€å§‹å¾ªç¯ã€‚å½¢æˆç»“æœæ˜¯æ ¹-å³-å·¦ï¼Œæœ€åå°†ç»“æœé€†åºå³å¯</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ–°å»ºä¸€ä¸ªæ ‘èŠ‚ç‚¹</span></span><br><span class="line">p=root</span><br><span class="line"><span class="comment">//pä¸ä¸ºç©ºè¯´æ˜è¿˜æœ‰æœªéå†åˆ°çš„èŠ‚ç‚¹ï¼Œsä¸ä¸ºç©ºè¯´æ˜æ ˆé‡Œè¿˜æœ‰å­˜å‚¨çš„å­æ ‘</span></span><br><span class="line"><span class="keyword">while</span>(pä¸ä¸ºç©º||sä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span>(pä¸ä¸ºç©º)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//è®¿é—®å½“å‰æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    res.push(p-&gt;val)</span><br><span class="line">    <span class="comment">//å·¦å­æ ‘å…¥æ ˆ</span></span><br><span class="line">    s.push(p-&gt;left)</span><br><span class="line">    <span class="comment">//éå†å³å­æ ‘</span></span><br><span class="line">    p=p-&gt;right</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">  p=s.top;</span><br><span class="line">  å‡ºæ ˆ</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å°†æœ€ç»ˆç»“æœé€†åº</span></span><br><span class="line">reverse(res.<span class="built_in">begin</span>(),res.<span class="built_in">end</span>())</span><br></pre></td></tr></table></figure>

<p>c.ä¸­åº éå†ç‰¹ç‚¹ï¼šå·¦-æ ¹-å³</p>
<p>æ ˆï¼šä¸­åºå¤„ç†æ–¹æ³•å’Œä¸Šä¸¤ç§æœ‰æ‰€ä¸åŒï¼Œéœ€è¦ä¸æ–­å¾ªç¯å…ˆæ‰¾åˆ°æœ€å·¦è¾¹å¶å­èŠ‚ç‚¹ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­éœ€è¦ä¸æ–­æŠŠå½“å‰éå†åˆ°çš„æ ¹èŠ‚ç‚¹å…¥æ ˆï¼Œæ ˆä¸­å­˜å‚¨æ ¹èŠ‚ç‚¹å’Œå·¦å­æ ‘èŠ‚ç‚¹ï¼Œå½“å¾ªç¯ç»“æŸæ—¶ï¼Œä»æ ˆå°¾ä¸­å–å‡ºèŠ‚ç‚¹ï¼Œå†ä¸æ–­å¯¹è¯¥èŠ‚ç‚¹çš„å³å­æ ‘å¾ªç¯ï¼Œ</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ–°å»ºä¸€ä¸ªæ ‘èŠ‚ç‚¹</span></span><br><span class="line">p=root</span><br><span class="line"><span class="comment">//pä¸ä¸ºç©ºè¯´æ˜è¿˜æœ‰æœªéå†åˆ°çš„èŠ‚ç‚¹ï¼Œsä¸ä¸ºç©ºè¯´æ˜æ ˆé‡Œè¿˜æœ‰å­˜å‚¨çš„å­æ ‘</span></span><br><span class="line"><span class="keyword">while</span>(pä¸ä¸ºç©º||sä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//å¾ªç¯è¿‡ç¨‹ä¸­ä¸æ–­å°†æ ¹èŠ‚ç‚¹å’Œå·¦å­æ ‘èŠ‚ç‚¹å…¥æ ˆ</span></span><br><span class="line">  <span class="keyword">while</span>(pä¸ä¸ºç©º)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//æ ¹èŠ‚ç‚¹å…¥æ ˆ</span></span><br><span class="line">    s.push(p)</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°æœ€å·¦è¾¹çš„å­æ ‘èŠ‚ç‚¹</span></span><br><span class="line">    p=p-&gt;left</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//è®¿é—®å½“å‰æ ˆå°¾èŠ‚ç‚¹ï¼Œ</span></span><br><span class="line">  p=s,top();</span><br><span class="line">  res.push(p-&gt;val)</span><br><span class="line">  <span class="comment">//ä»æ ˆä¸­å–å‡ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">  å‡ºæ ˆ</span><br><span class="line">  <span class="comment">//å¾ªç¯å³å­æ ‘</span></span><br><span class="line">  p=p-&gt;right</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>éªŒè¯ä¸€æ£µæ ‘æ˜¯å¦æ˜¯äºŒå‰æœç´¢æ ‘ï¼ˆäºŒå‰æœç´¢æ ‘çš„ç‰¹ç‚¹æ˜¯å·¦å­æ ‘å°äºæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹å°äºå³å­æ ‘ï¼‰ï¼šå¯ä»¥é€šè¿‡ä¸­åºéå†æ¯”è¾ƒèŠ‚ç‚¹å€¼æ¥åˆ¤æ–­</p>
<h3 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h3><p>æ€»ä½“æ¡†æ¶ï¼šæ˜ç¡®ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦åšçš„äº‹ï¼Œå‰©ä½™çš„åˆ†åˆ«æ‰”ç»™å·¦å­æ ‘å’Œå³å­æ ‘å¤„ç†</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TreeNode* <span class="title">doTree</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//é€’å½’ç»“æŸçš„æ¡ä»¶ï¼šä¸€ä¸ªèŠ‚ç‚¹éœ€è¦åšçš„äº‹ï¼ˆå¯èƒ½æœ‰å¤šä¸ªç»“æŸæ¡ä»¶ï¼‰</span></span><br><span class="line">  <span class="keyword">if</span>(åˆ°è¾¾æ ‘çš„æœ«å°¾)</span><br><span class="line">  	<span class="keyword">do</span>â€¦.</span><br><span class="line">  <span class="comment">//é€’å½’å¾ªç¯çš„æ¡ä»¶å‰©ä½™çš„äº¤ç»™å·¦å³å­æ ‘å¤„ç†</span></span><br><span class="line">  doTree(root-&gt;left,å…¶ä»–å‚æ•°)</span><br><span class="line">  doTree(root-&gt;right,å…¶ä»–å‚æ•°)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹        </p>
<p>å…·ä½“è€Œè¨€ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p>
<p>æ ¹æ®å‰åºã€ä¸­åºéå†æˆ–è€…ä¸­åºã€ååºéå†æ„é€ äºŒå‰æ ‘ï¼šæ ¹æ®å‰åºæ ¹èŠ‚ç‚¹åœ¨é¦–ä½ï¼Œå¯ä»¥åœ¨ä¸­åºéå†ç¡®å®šå·¦å³å­æ ‘ï¼›æ ¹æ®ååºæ ¹èŠ‚ç‚¹åœ¨å°¾éƒ¨ï¼Œå¯ä»¥åœ¨ä¸­åºéå†ç¡®å®šå·¦å³å­æ ‘</p>
<p> ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TreeNode* <span class="title">getTree</span><span class="params">(<span class="built_in">vector</span> p, <span class="keyword">int</span> pl,<span class="keyword">int</span> pr, <span class="built_in">vector</span> i, <span class="keyword">int</span> il,<span class="keyword">int</span> ir)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//ç»“æŸçš„æ¡ä»¶</span></span><br><span class="line">  <span class="keyword">if</span>(å·¦ä½ç½®å¤§äºå³ä½ç½®)</span><br><span class="line">  	<span class="keyword">return</span> null</span><br><span class="line">  <span class="comment">//å¾ªç¯çš„æ¡ä»¶</span></span><br><span class="line">  <span class="comment">//æ ¹æ®å‰åºæˆ–è€…ååºéå†çš„ç‰¹ç‚¹æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span></span><br><span class="line">  pivot=p[pl]</span><br><span class="line">  <span class="comment">//æ ¹æ®æ ¹èŠ‚ç‚¹ç”Ÿæˆæ ‘èŠ‚ç‚¹</span></span><br><span class="line">  TreeNode root=<span class="keyword">new</span> TreeNode(pivot)</span><br><span class="line">  <span class="comment">//åœ¨ä¸­åºéå†ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®</span></span><br><span class="line">  pivotindex=il</span><br><span class="line">  <span class="keyword">while</span>(i[pivotindex]!=pivot)</span><br><span class="line">  &#123;</span><br><span class="line">  	pivotindex++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¡®å®šå·¦å­æ ‘</span></span><br><span class="line">  root-&gt;left= getTree(p,I,å·¦å­æ ‘çš„ä½ç½®)</span><br><span class="line">  <span class="comment">//ç¡®å®šå³å­æ ‘</span></span><br><span class="line">  root-&gt;right= getTree(p,I,å³å­æ ‘çš„ä½ç½®)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TreeNode* <span class="title">doTree</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(é€’å½’åˆ°æ ‘çš„æœ€åï¼Œå³æŸä¸€ç»“æŸçš„æ¡ä»¶)</span><br><span class="line">  â€¦.</span><br><span class="line">  <span class="keyword">if</span>(æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼ˆè¾¾åˆ°æŸä¸€ä¸ªå€¼ï¼‰&amp;&amp; doTreeï¼ˆroot-&gt;leftï¼‰&amp;&amp; doTreeï¼ˆroot-&gt;rightï¼‰(å·¦å³å­æ ‘åˆ†åˆ«æ»¡è¶³æ¡ä»¶ï¼Œæ­¤æ—¶é€’å½’ï¼Œä½ç½®ä¹Ÿå¯æ”¾åˆ°<span class="keyword">return</span>åé¢))</span><br><span class="line">    â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>åˆ¤æ–­æ ‘çš„ç»“æ„å’Œå€¼æ˜¯å¦ç›¸åŒï¼Œå³æ˜¯å¦æ˜¯ç›¸åŒçš„æ ‘ï¼šä¸€ä¸ªèŠ‚ç‚¹åˆ¤æ–­å€¼æ˜¯å¦ç›¸åŒï¼Œä¸”å·¦å³å­æ ‘çš„å€¼å’Œç»“æ„æ˜¯å¦ä¸€è‡´ï¼ˆè°ƒç”¨å‡½æ•°ï¼Œå³é€’å½’ï¼‰</p>
<p>å¯¹ç§°äºŒå‰æ ‘ï¼šå…‹éš†ä¸€ä¸ªæ•°ï¼Œå’ŒåŸæ¥çš„æ ‘æ¯”è¾ƒç»“æ„æ˜¯å¦ä¸€è‡´ï¼Œæ€è·¯åŒä¸Š</p>
<p>å¹³è¡¡äºŒå‰æ ‘ï¼ˆæ¯ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦å·®ç»å¯¹å€¼å°äº1ï¼‰ï¼šåˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„é«˜åº¦ï¼Œä¸”å·¦å³å­æ ‘çš„é«˜åº¦æ˜¯å¦æ»¡è¶³é«˜åº¦å·®å°äº1ï¼ˆè°ƒç”¨å‡½æ•°ï¼Œå³é€’å½’ï¼‰  æ³¨ï¼šé‡Œé¢åŒ…å«æ±‚æ ‘çš„é«˜åº¦ï¼Œå¯ä»¥æ‰¾å‡ºå·¦å³å­æ ‘é«˜çš„é‚£è¾¹å†åŠ 1ï¼ˆä¹Ÿæ˜¯ä½¿ç”¨é€’å½’ï¼‰</p>
<p>åˆ¤æ–­ä¸€ä¸ªæ ‘çš„è·¯å¾„å’Œæ˜¯å¦å’Œç›®æ ‡å€¼ç›¸åŒï¼šæ¯æ¬¡åˆ¤æ–­å½“å‰å¶å­èŠ‚ç‚¹å€¼ï¼ˆå·¦å³å­æ ‘ä¸ºç©ºï¼‰ä¸ç›®æ ‡å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦åˆ™ï¼Œå°†ç›®æ ‡å€¼å‡å»å½“å‰èŠ‚ç‚¹å€¼ç»§ç»­å¯¹å·¦å³å­æ ‘é€’å½’</p>
<p>è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ï¼šéœ€è¦åˆ©ç”¨ä¸­ç‚¹ï¼Œå°†åŸæœ‰æ•°æ®è¿›è¡Œæ’åº,æ¯æ¬¡éœ€è¦ç¡®å®šæ„é€ çš„æ•°æ®çš„å·¦å³ä½ç½®</p>
<p>ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transBTS</span><span class="params">(<span class="built_in">vector</span> numï¼Œ<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//ç»“æŸçš„æ¡ä»¶</span></span><br><span class="line">  <span class="keyword">if</span>(left&gt;right)</span><br><span class="line">  	<span class="keyword">return</span> null</span><br><span class="line">  <span class="comment">//æ‰¾åˆ°ä¸­ç‚¹,æ„é€ æ ¹èŠ‚ç‚¹</span></span><br><span class="line">  <span class="comment">//(1)æ•°ç»„å¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•çš„1/2</span></span><br><span class="line">  <span class="comment">//(2)é“¾è¡¨éœ€è¦åˆ©ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆèµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆèµ°ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆåˆ°æœ«å°¾çš„æ—¶å€™ï¼Œæ…¢æŒ‡é’ˆæ­£å¥½åˆ°ä¸­ç‚¹</span></span><br><span class="line">  mid=â€¦</span><br><span class="line">  TreeNode* root=<span class="keyword">new</span> TreeNode(num(mid))</span><br><span class="line">  <span class="comment">//é€’å½’æ„é€ å·¦å­æ ‘</span></span><br><span class="line">  root-&gt;left= transBTS(root-&gt;left,left,mid<span class="number">-1</span>)</span><br><span class="line">  <span class="comment">//é€’å½’æ„é€ å³å­æ ‘</span></span><br><span class="line">  root-&gt;right= transBTS(root-&gt;right, mid<span class="number">-1</span>,right)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å…³äºäºŒå‰æœç´¢æ ‘çš„æ¡†æ¶ï¼šåˆ©ç”¨å·¦å°å³å¤§çš„ç‰¹ç‚¹ï¼ˆç±»ä¼¼äºŒåˆ†æŸ¥æ‰¾ï¼‰</p>
<p>â€‹    ä¼ªä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TreeNode* <span class="title">BTS</span><span class="params">(TreeNode* root,<span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//ç»“æŸæ¡ä»¶</span></span><br><span class="line">  <span class="keyword">if</span>(root-&gt;val==num)</span><br><span class="line">  	<span class="keyword">do</span>..(å¯ä»¥åšå¢åˆ æ”¹ä¹‹ç±»çš„æ“ä½œ)</span><br><span class="line">  <span class="comment">//å¾ªç¯æ¡ä»¶</span></span><br><span class="line">  <span class="comment">//å¤§äºï¼šå¯¹å·¦å­æ ‘</span></span><br><span class="line">  <span class="keyword">if</span>(root-&gt;val&gt;num)</span><br><span class="line">  	<span class="keyword">return</span> BTS(root-&gt;left,num)</span><br><span class="line">  <span class="comment">//å°äºï¼šå¯¹å³å­æ ‘</span></span><br><span class="line">  <span class="keyword">if</span>(root-&gt;val&lt;num)</span><br><span class="line">  	<span class="keyword">return</span> BTS(root-&gt;right,num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ±‚â€œæ ‘çš„é«˜åº¦â€ç±»å‹é¢˜"><a href="#æ±‚â€œæ ‘çš„é«˜åº¦â€ç±»å‹é¢˜" class="headerlink" title="æ±‚â€œæ ‘çš„é«˜åº¦â€ç±»å‹é¢˜"></a>æ±‚â€œæ ‘çš„é«˜åº¦â€ç±»å‹é¢˜</h3><p>1.æ±‚æ ‘çš„é«˜åº¦</p>
<p>é‡‡ç”¨é€’å½’ï¼Œè‡ªåº•å‘ä¸Š</p>
<p>æ‰¾åˆ°æœ€åº•å±‚èŠ‚ç‚¹ï¼Œæ¯æ¬¡è¿”å›å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘é«˜åº¦å’Œå³å­æ ‘é«˜åº¦çš„è¾ƒå¤§å€¼ï¼Œåˆ™å½“å‰èŠ‚ç‚¹çš„é«˜åº¦ä¸ºmax(left,right)+1ï¼Œä¸€ç›´å‘ä¸Šé€’å½’ã€‚å¦‚å›¾æ‰€ç¤ºçš„äºŒå‰æ ‘ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226110659.png" alt="äºŒå‰æ ‘"></p>
<p>ä»æ ¹èŠ‚ç‚¹é€’å½’ï¼Œä¸€ç›´æ‰¾åˆ°æœ€å·¦è¾¹çš„èŠ‚ç‚¹1ï¼Œæ­¤æ—¶å®ƒçš„å·¦å³å­æ ‘å‡ä¸ºç©ºï¼Œleft=0,right=0,æ‰€ä»¥å®ƒçš„é«˜åº¦ä¸º1ï¼Œæ¥ç€è¿”å›ä¸Šä¸€å±‚èŠ‚ç‚¹7çš„å³å­æ ‘4çš„é«˜åº¦ï¼ŒåŒç†ï¼ŒèŠ‚ç‚¹4çš„é«˜åº¦ä¸º1ï¼Œå› æ­¤7çš„é«˜åº¦ä¸ºmax(depth(1),depth(4))+1ï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´å‘ä¸Šæ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„é«˜åº¦å³ä¸ºæ ‘çš„é«˜åº¦ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root==null)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘é«˜åº¦</span></span><br><span class="line">  <span class="keyword">int</span> l=depth(root-&gt;left);</span><br><span class="line">  <span class="comment">//å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘é«˜åº¦</span></span><br><span class="line">  <span class="keyword">int</span> r=depth(root-&gt;left);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//è¿”å›å½“å‰èŠ‚ç‚¹çš„é«˜åº¦ä¸ºä¸¤è€…ä¸­å¤§çš„é‚£ä¸ªå†åŠ ä¸€</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>(l,r)+<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.æ±‚äºŒå‰æ ‘ç›´å¾„ï¼Œå³ä»»æ„ä¸¤ä¸ªç»“ç‚¹è·¯å¾„é•¿åº¦ä¸­çš„æœ€å¤§å€¼</p>
<p>æ€è·¯åŒæ±‚æ ‘çš„é«˜åº¦ï¼šä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»æ˜¯å½“å‰èŠ‚ç‚¹å·¦å­æ ‘åŠ ä¸Šå³å­æ ‘çš„é«˜åº¦ï¼Œå› ä¸ºæ˜¯æ±‚æœ€å¤§è·¯å¾„å’Œï¼Œåˆ™æœ€å¤§ä¸å¯èƒ½å‡ºç°åœ¨ä¸­é—´èŠ‚ç‚¹ï¼Œåªå¯èƒ½æ˜¯ä»»æ„ä¸¤ä¸ªå¶å­èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œè¯¥è·ç¦»å¯ä»¥é€šè¿‡ä¸¤ä¸ªå¶å­èŠ‚ç‚¹ä¹‹é—´è¿çº¿ç»è¿‡çš„æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦ç›¸åŠ æ¥æ±‚è§£ï¼Œå¦‚å›¾äºŒå‰æ ‘</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20200310165729.jpg" alt="äºŒå‰æ ‘"></p>
<p>èŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2ä¹‹é—´çš„è·¯å¾„ä¸º3ï¼Œå³ä¸ºç»è¿‡çš„æ ¹èŠ‚ç‚¹3çš„å·¦å³å­æ ‘çš„é«˜åº¦å’Œï¼ŒåŒç†ï¼Œå§å¼Ÿå•Š1å’ŒèŠ‚ç‚¹9ä¹‹é—´çš„è·ç¦»ä¸º5ï¼Œå³ä¸ºå³ä¸ºç»è¿‡çš„æ ¹èŠ‚ç‚¹6çš„å·¦å³å­æ ‘çš„é«˜åº¦å’Œ.</p>
<p>æ‰€ä»¥é—®é¢˜è½¬æ¢ä¸ºï¼šæ±‚äºŒå‰æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å·¦å³å­æ ‘é«˜åº¦å’Œçš„æœ€å¤§å€¼ï¼Œå› æ­¤ï¼Œå¯ä»¥å°†â€œæ±‚äºŒå‰æ ‘é«˜åº¦â€çš„ä»£ç ç¨å¾®è¿›è¡Œæ”¹åŠ¨å³å¯ã€‚</p>
<p>æ³¨ï¼šå› ä¸ºæ¯æ¬¡è¦æ¯”è¾ƒå„ä¸ªèŠ‚ç‚¹çš„é«˜åº¦å’Œï¼Œæ‰€ä»¥éœ€è¦ä¼ å…¥ä¸€ä¸ªmaxvalueçš„å€¼(ä¼ å…¥çš„æ—¶å€™è¦åŠ ä¸Šå–åœ°å€ç¬¦å·)ï¼Œæ¯æ¬¡è¿›è¡Œæ¯”è¾ƒï¼Œä¸€ç›´æ›´æ–°ï¼Œæœ€ç»ˆå¾—å‡ºæœ€å¤§è·¯å¾„å’Œã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxTrack</span><span class="params">(TreeNode* root,<span class="keyword">int</span>&amp; maxValue)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root==null)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//æ±‚å·¦å³å­æ ‘çš„é«˜åº¦</span></span><br><span class="line">  <span class="keyword">int</span> l=maxTrack(root-&gt;left,maxValue);</span><br><span class="line">  <span class="keyword">int</span> r=maxTrack(root-&gt;right,maxValue);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//å¯¹å½“å‰çš„é«˜åº¦å’Œå³è·¯å¾„å’Œè¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">  maxValue=<span class="built_in">max</span>(maxValue,l+r);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è¿”å›å·¦å³å­æ ‘é«˜åº¦è¾ƒå¤§çš„é‚£ä¸ª</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>(l,r)+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—å‡ºmaxValueä¸ºæœ€å¤§è·¯å¾„å’Œï¼ŒmaxTrackå‡½æ•°çš„æœ€ç»ˆè¿”å›å€¼æ˜¯æ ¹èŠ‚ç‚¹å·¦å³å­æ ‘çš„é«˜åº¦å’Œã€‚</p>
<p>3.æ±‚äºŒå‰æ ‘çš„æœ€å¤§è·¯å¾„å’Œï¼Œå³ä»ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘ï¼Œåˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„å’Œçš„æœ€å¤§å€¼ã€‚</p>
<p>æ€è·¯åŒæ±‚äºŒå‰æ ‘çš„é«˜åº¦ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’ï¼Œä¸€ç›´æ‰¾åˆ°æœ€å·¦è¾¹çš„èŠ‚ç‚¹ï¼Œè®¡ç®—æ­¤æ—¶çš„èŠ‚ç‚¹çš„å·¦å³å­æ ‘è¾ƒå¤§çš„è·¯å¾„å’Œï¼Œå°†å€¼ä¼ é€’ç»™å½“å‰çˆ¶èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹å°†è‡ªèº«å€¼åŠ ä¸Šè¯¥å€¼ï¼Œç»§ç»­ä¼ å€¼ç»™ä¸Šä¸€å±‚èŠ‚ç‚¹ï¼Œä¸Šä¸€å±‚çš„çˆ¶èŠ‚ç‚¹ä¹Ÿæ˜¯åœ¨å·¦å³å­æ ‘çš„è¾ƒå¤§å€¼ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚ä¿è¯æ¯æ¬¡éƒ½æ˜¯åœ¨å½“å‰èŠ‚ç‚¹çš„å·¦å³å­æ ‘ä¸­é€‰æ‹©å¤§çš„å€¼è¿›è¡Œå›ä¼ ï¼Œè¿™æ ·çš„ä¿è¯è·¯å¾„å’Œå¾€å¤§çš„æ–¹å‘èµ°ã€‚</p>
<p>å¦‚å›¾äºŒå‰æ ‘</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226110659.png" alt="äºŒå‰æ ‘"></p>
<p>èŠ‚ç‚¹1çš„è·¯å¾„å’Œæ˜¯1,æ­¤æ—¶maxPath=0,æ›´æ–°ä¸º1ï¼ŒèŠ‚ç‚¹4çš„è·¯å¾„å’Œæ˜¯4ï¼Œæ­¤æ—¶maxPath=1,æ›´æ–°ä¸º4ï¼Œå½“æ±‚åˆ°èŠ‚ç‚¹7çš„è·¯å¾„å’Œæ—¶ï¼Œåœ¨å®ƒçš„å·¦å­æ ‘ï¼ˆèŠ‚ç‚¹1ï¼‰å’Œå³å­æ ‘ï¼ˆèŠ‚ç‚¹4ï¼‰çš„è·¯å¾„å’Œä¹‹é—´é€‰æ‹©å¤§çš„ï¼Œå³é€‰æ‹©èŠ‚ç‚¹4ï¼Œæ­¤æ—¶è·¯å¾„ä¸º7+4=11ï¼Œæ­¤æ—¶maxPath=4,æ›´æ–°ä¸º11ã€‚å†å¯¹èŠ‚ç‚¹3å¤„ç†ï¼Œå·¦å­æ ‘ï¼ˆ11ï¼‰ï¼Œå³å­æ ‘ï¼ˆ2ï¼‰ï¼Œé€‰æ‹©å·¦å­æ ‘ï¼Œæ­¤æ—¶è·¯å¾„å’Œæ˜¯11+3,æ­¤æ—¶maxPath=11,æ›´æ–°ä¸º14ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå¾—åˆ°maxPathã€‚</p>
<p>æ³¨ï¼šå½“å½“å‰å·¦å³å­æ ‘åŠ ä¸Šå½“å‰èŠ‚ç‚¹å€¼æ˜¯è´Ÿæ•°ï¼Œè¯´æ˜è¯¥æ¡è·¯å¾„å‡ºç°äº†â€œè´Ÿè´¡çŒ®â€ï¼Œæ­¤æ—¶è·¯å¾„å½’0</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxPath</span><span class="params">(TreeNode* root,<span class="keyword">int</span>&amp; maxValue)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root==null)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//æ±‚å·¦å³å­æ ‘çš„è·¯å¾„å’Œ</span></span><br><span class="line">  <span class="keyword">int</span> l=maxPath(root-&gt;left,maxValue);</span><br><span class="line">  <span class="keyword">int</span> r=maxPath(root-&gt;right,maxValue);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//æ›´æ–°å½“å‰æœ€å¤§è·¯å¾„</span></span><br><span class="line">  maxValue=<span class="built_in">max</span>(maxValue,l+r+root-&gt;value);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//åˆ¤æ–­è·¯å¾„æœ‰æ— å‡ºç°è´Ÿè´¡çŒ®</span></span><br><span class="line">  <span class="keyword">int</span> temp=<span class="built_in">max</span>(l,r)+root-&gt;val;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//æ¯æ¬¡é€‰æ‹©å·¦å³å­æ ‘ä¸­å¤§çš„å’Œè‡ªèº«ç›¸åŠ ï¼ï¼ï¼ï¼</span></span><br><span class="line">  <span class="comment">//è¿”å›å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å’Œï¼Œä½œä¸ºä¸Šä¸€æ¬¡çš„å­æ ‘å€¼</span></span><br><span class="line">  <span class="keyword">return</span> temp&lt;<span class="number">0</span>?<span class="number">0</span>:temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—åˆ°maxValueæ˜¯æœ€å¤§è·¯å¾„å’Œï¼ŒmaxPathè¿”å›å€¼æ˜¯æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘åŠ ä¸Šè‡ªèº«çš„è·¯å¾„å’Œã€‚</p>
<h3 id="å¸¸è§„æ€è·¯â€”â€”bfså’Œdfs"><a href="#å¸¸è§„æ€è·¯â€”â€”bfså’Œdfs" class="headerlink" title="å¸¸è§„æ€è·¯â€”â€”bfså’Œdfs"></a>å¸¸è§„æ€è·¯â€”â€”bfså’Œdfs</h3><p>äºŒå‰æ ‘çš„é¢˜ç›®å¤§å¤šæ•°æ˜¯éå†çš„å˜å½¢é¢˜ï¼Œå¾€ä¸¤ä¸ªæ–¹å‘è€ƒè™‘ï¼šä½¿ç”¨bfsâ€”â€”å±‚æ¬¡éå†è¿˜æ˜¯dfsâ€”â€”æ·±åº¦éå†/å›æº¯ã€é€’å½’ï¼Œå½“ä½¿ç”¨éé€’å½’ï¼Œå³å±‚æ¬¡éå†çš„æ—¶å€™æ³¨æ„å¶å­èŠ‚ç‚¹çš„åˆ¤æ–­ã€‚</p>
<p>ä¾‹å¦‚æ±‚äºŒå‰æ ‘ä»æ ¹èŠ‚ç‚¹å‡ºå‘çš„è·¯å¾„å’Œï¼Œå¯ä»¥ä½¿ç”¨å±‚æ¬¡éå†ï¼Œä½¿ç”¨ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªç”¨æ¥å­˜å‚¨æ¯å±‚çš„èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªç”¨æ¥å­˜å‚¨æ¯å±‚ç›¸åŠ çš„å’Œï¼Œå½“å‡ºç°å¶å­èŠ‚ç‚¹çš„æ—¶å€™å°±æŠŠç›¸åŠ çš„å’Œç´¯åŠ ä¸Šå»ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(æ ˆä¸ä¸ºç©º)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> <span class="built_in">width</span>=p.<span class="built_in">size</span>();</span><br><span class="line">  <span class="comment">//å­˜å‚¨æ¯å±‚ç´¯åŠ çš„å’Œ</span></span><br><span class="line">  <span class="keyword">int</span> val=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">width</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    r=p.front();</span><br><span class="line">    <span class="comment">//æŠŠå½“å‰èŠ‚ç‚¹çš„å€¼åŠ ä¸Šä¸Šä¸€æ¬¡çš„å’Œçš„10å€</span></span><br><span class="line">    val=numQue.front()*<span class="number">10</span>+r-&gt;val;<span class="comment">//numQueä¸­å­˜å‚¨æ¯å±‚èŠ‚ç‚¹ç´¯åŠ çš„å’Œ</span></span><br><span class="line">    p.pop();</span><br><span class="line">    numQue.pop();</span><br><span class="line">    <span class="keyword">if</span>(å¶å­èŠ‚ç‚¹)</span><br><span class="line">      res+=val;</span><br><span class="line">    <span class="keyword">if</span>(å·¦å­æ ‘å­˜åœ¨)</span><br><span class="line">    &#123;</span><br><span class="line">      p.push(å·¦å­æ ‘)</span><br><span class="line">      <span class="comment">//ä¹‹å‰ç´¯åŠ çš„å’Œå…¥æ ˆ</span></span><br><span class="line">      numQue.push(val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(å³å­æ ‘å­˜åœ¨)</span><br><span class="line">    &#123;</span><br><span class="line">      p.push(å³<span class="number">2</span>å­æ ‘)</span><br><span class="line">      <span class="comment">//ä¹‹å‰ç´¯åŠ çš„å’Œå…¥æ ˆ</span></span><br><span class="line">      numQue.push(val);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>æ’åºç®—æ³•</title>
    <url>/blogs/sort/</url>
    <content><![CDATA[<p>å‡ ç§æ’åºç®—æ³•çš„æ¯”è¾ƒï¼Œå¯¹åŸå§‹åºåˆ—ï¼š6ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ2ï¼Œ9ï¼Œ8ï¼Œ1ï¼Œ4  è¿›è¡Œæ’åº</p><h6 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h6><p>ç¬¬ä¸€æ¬¡ï¼šä»ç¬¬ä¸€ä¸ªæ•°å­—å¼€å§‹ï¼Œä¾æ¬¡ç›¸é‚»æ¯”è¾ƒï¼Œå‰é¢å¤§äºåé¢åˆ™è°ƒæ¢ä½ç½®ï¼Œæ¯”åˆ°æœ€åä¸€ä½ï¼Œåˆ™é€‰å‡ºäº†æœ€å¤§å€¼æ”¾åœ¨æœ€å</p><p>â€‹        ç¬¬ä¸€æ¬¡æ’åºåï¼š3ï¼Œ5ï¼Œ6ï¼Œ2ï¼Œ7ï¼Œ8ï¼Œ1ï¼Œ4ï¼Œ9</p><p>â€‹        ç¬¬äºŒæ¬¡æ’åºåï¼š3ï¼Œ5ï¼Œ2ï¼Œ6ï¼Œ7ï¼Œ1ï¼Œ4ï¼Œ8ï¼Œ9</p><a id="more"></a>



<p>â€‹        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)</p>
<h6 id="ç®€å•é€‰æ‹©æ’åº"><a href="#ç®€å•é€‰æ‹©æ’åº" class="headerlink" title="ç®€å•é€‰æ‹©æ’åº"></a>ç®€å•é€‰æ‹©æ’åº</h6><p>ç¬¬ä¸€æ¬¡ï¼šé¦–å…ˆæ’ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå…ˆè®¾min=0è®°å½•æœ€å°å€¼ä½ç½®ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå°†6ä¸3æ¯”è¾ƒï¼Œ3æ¯”6å°ï¼Œåˆ™min=1(ä»£è¡¨3çš„ä½ç½®)ï¼›å†å°†3ä¸5æ¯”è¾ƒï¼Œ3æ¯”5å°ï¼Œä¸æ”¹å˜minå€¼ï¼›ä¾æ¬¡å°†minä½ç½®çš„æ•°å€¼ä¾æ¬¡ä¸åç»­æ•°å­—æ¯”è¾ƒï¼Œæ¯”minå°åˆ™æ›´æ”¹minä¸ºæ›´å°å€¼çš„ä½ç½®ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ•°å­—æ¯”å®Œã€‚æ­¤æ—¶min=7(1çš„ä½ç½®)ï¼Œå°†6ä¸7å¯¹æ¢ï¼Œåˆ™ç¬¬ä¸€æ¬¡æ’åºå®Œæˆã€‚</p>
<p>â€‹        ç¬¬ä¸€æ¬¡æ’åºåé¡ºåºæ˜¯ï¼š1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ2ï¼Œ9ï¼Œ8ï¼Œ6ï¼Œ4</p>
<p>ç¬¬äºŒæ¬¡ï¼šæ’ç¬¬äºŒä¸ªä½ç½®ï¼Œæ–¹æ³•åŒä¸Šï¼Œè®¾min=1ä»£è¡¨é»˜è®¤ç¬¬äºŒä¸ªä½ç½®ï¼Œå³æ•°å€¼3é»˜è®¤æœ€å°å€¼ï¼Œå°†3ä¾æ¬¡ä¸åç»­æ¯”è¾ƒï¼Œæ‰¾å‡ºæœ€å°å€¼ï¼Œmin=æœ€å°å€¼çš„ä½ç½®ï¼Œäº¤æ¢ç¬¬äºŒä¸ªä½ç½®çš„å€¼3ä¸minä½ç½®çš„å€¼2ï¼Œå®Œæˆç¬¬äºŒæ¬¡æ’åºã€‚</p>
<p>â€‹        ç¬¬äºŒæ¬¡æ’åºåï¼š1ï¼Œ2ï¼Œ5ï¼Œ7ï¼Œ3ï¼Œ9ï¼Œ8ï¼Œ6ï¼Œ4</p>
<p>â€‹        ç¬¬ä¸‰æ¬¡æ’åºåï¼š1ï¼Œ2ï¼Œ3ï¼Œ7ï¼Œ5ï¼Œ9ï¼Œ8ï¼Œ6ï¼Œ4</p>
<p>â€‹        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)</p>
<p>â€‹        ç¬¬äº”æ¬¡æ’åºåé¡ºåºä¸ºï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ9ï¼Œ8ï¼Œ6ï¼Œ7</p>
<p>â€‹        ç¬¬å…­æ¬¡æ’åºåé¡ºåºä¸ºï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ8ï¼Œ9ï¼Œ7</p>
<p>â€‹        ç¬¬ä¸ƒæ¬¡æ’åºåé¡ºåºä¸ºï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ9ï¼Œ8</p>
<p>â€‹        ç¬¬å…«æ¬¡æ’åºåé¡ºåºä¸ºï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ8ï¼Œ9</p>
<h6 id="ç›´æ¥æ’å…¥æ’åº"><a href="#ç›´æ¥æ’å…¥æ’åº" class="headerlink" title="ç›´æ¥æ’å…¥æ’åº"></a>ç›´æ¥æ’å…¥æ’åº</h6><p>â€‹        ç¬¬ä¸€æ¬¡æ’åºåï¼š6</p>
<p>â€‹        ç¬¬äºŒæ¬¡æ’åºåï¼š3ï¼Œ6</p>
<p>â€‹        ç¬¬ä¸‰æ¬¡æ’åºåï¼š3ï¼Œ5ï¼Œ6</p>
<p>â€‹        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)</p>
<h6 id="æŠ˜åŠæ’å…¥æ’åº"><a href="#æŠ˜åŠæ’å…¥æ’åº" class="headerlink" title="æŠ˜åŠæ’å…¥æ’åº"></a>æŠ˜åŠæ’å…¥æ’åº</h6><p>åŒç›´æ¥æ’å…¥æ’åºï¼Œä½†æ˜¯åœ¨æ¯”è¾ƒçš„æ—¶å€™ï¼Œæ˜¯æŠ˜åŠæ¯”è¾ƒï¼Œæ€æƒ³åŒæŠ˜åŠæŸ¥æ‰¾</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)</p>
<h6 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h6><p>ç¬¬ä¸€æ¬¡ï¼šè®¾æ­¥é•¿d=5ï¼Œåˆ™6å’Œ9ï¼›3å’Œ8ï¼›5å’Œ1ï¼›7å’Œ4ï¼›ç›´æ¥æ’å…¥æ’åº</p>
<p>â€‹        ç¬¬ä¸€æ¬¡æ’åºåï¼š6ï¼Œ3ï¼Œ1ï¼Œ4ï¼Œ2ï¼Œ9ï¼Œ8ï¼Œ5ï¼Œ7</p>
<p>ç¬¬äºŒæ¬¡ï¼šd = d/2 = 2ï¼Œåˆ™6ï¼Œ1ï¼Œ2ï¼Œ8ï¼Œ7ï¼›3ï¼Œ4ï¼Œ9ï¼Œ5ï¼›ç›´æ¥æ’å…¥æ’åº</p>
<p>â€‹        ç¬¬äºŒæ¬¡æ’åºåï¼š1ï¼Œ3ï¼Œ2ï¼Œ4ï¼Œ6ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œ8</p>
<p>ç¬¬ä¸‰æ¬¡ï¼šd = d/2 = 1ï¼Œåˆ™æ‰€æœ‰æ•°æ®ç›´æ¥æ’å…¥æ’åº</p>
<p>â€‹        ç¬¬ä¸‰æ¬¡æ’åºåï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ8ï¼Œ9</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(nlog2^n)</p>
<h6 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h6><p>ç¬¬ä¸€æ¬¡ï¼šé€‰å–ç¬¬ä¸€ä¸ªæ•°6ä¸ºè½´ï¼Œå°†ç¬¬ä¸€ä¸ª6ä¸æœ€åä¸€ä¸ªæ•°å­—4æ¯”è¾ƒï¼ˆä»åå¾€å‰æ¯”ï¼‰ï¼Œå¦‚æœå¤§äºæ¯”è¾ƒçš„æ•°å­—ï¼Œåˆ™è°ƒæ¢ï¼Œç„¶åä¸åŸä½ç½®åé¢å¼€å§‹æ¯”ï¼ˆä»å‰å¾€åæ¯”ï¼‰ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç¬¬ä¸€æ¬¡æ’å®Œåï¼Œè½´6çš„å·¦è¾¹éƒ½å°äº6ï¼Œå³è¾¹éƒ½å¤§äº6ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226160921.png" alt="å¿«é€Ÿæ’åºi,jå˜åŒ–"></p>
<p>â€‹        ç¬¬ä¸€æ¬¡æ’åºåï¼š4ï¼Œ3ï¼Œ5ï¼Œ1ï¼Œ2ï¼Œ6ï¼Œ8ï¼Œ9ï¼Œ7</p>
<p>ç¬¬äºŒæ¬¡ï¼šåˆ™å°†ä¸Šä¸ªæ¯”è¾ƒåçš„è½´çš„å·¦å³ä¾æ¬¡åšå¿«é€Ÿæ’åºï¼Œç›´åˆ°æ‰€æœ‰å­è¡¨çš„è¡¨é•¿ä¸è¶…è¿‡1</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(nlog2^n)</p>
<h6 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h6><p>é¦–å…ˆå»ºç«‹åˆå§‹å †ï¼ŒæŒ‰ç…§é¡ºåºæ–¹å¼å»ºç«‹å®Œå…¨äºŒå‰æ ‘</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226110659.png" alt="äºŒå‰æ ‘"></p>
<p>ç„¶åå»ºç«‹å¤§é¡¶å †ï¼Œåˆ†åˆ«å°†æœ‰å­èŠ‚ç‚¹çš„7ï¼Œ3ï¼Œ5ï¼Œ6ä»åº•å±‚å¼€å§‹ï¼Œåˆ†åˆ«ä¸å­èŠ‚ç‚¹æ¯”è¾ƒï¼Œé€‰å¤§çš„ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼Œå³å¯å¾—åˆ°æœ€å¤§çš„æ ¹èŠ‚ç‚¹çš„äºŒå‰æ ‘ï¼Œå³å¤§é¡¶å †</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226140326.png" alt="å¤§é¡¶å †"></p>
<p>ç„¶åï¼Œå°†å †é¡¶æ‹¿ä¸‹æ¥ï¼Œå°†å¶å­èŠ‚ç‚¹æ”¾ä¸Šå»ï¼Œå†æ¬¡æŒ‰ç…§å¤§é¡¶å †æ–¹æ³•ï¼Œå¾—åˆ°æ ¹èŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå¾—åˆ°æœ‰åºæ•°åˆ—</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(nlog2^n)</p>
<h6 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h6><p>å¯¹æ•°ç»„é€’å½’æŠ˜åŠåˆ†å‰²ï¼Œç›´åˆ°åˆ†å‰²æˆå•ä¸ªï¼Œç„¶åé€’å½’åˆå¹¶æ¯”è¾ƒï¼Œç›´åˆ°åˆå¹¶ä¸ºæ•´ä¸ªæ•°ç»„</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191226142419.png" alt="å½’å¹¶æ’åº"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(nlog2^n)</p>
<p>æ€»ç»“ï¼šæ—¶é—´å¤æ‚åº¦æ˜¯nlog2^nçš„æ˜¯ï¼šå¿«äº›(å¸Œ)å½’é˜Ÿ(å †)ï¼Œä¸ç¨³å®šçš„æ˜¯ï¼šå¿«äº›(å¸Œ)é€‰é˜Ÿ(å †)</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>æ’åº</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/blogs/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external nofollow noopener noreferrer">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external nofollow noopener noreferrer">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external nofollow noopener noreferrer">GitHub</a>.</p><a id="more"></a>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external nofollow noopener noreferrer">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external nofollow noopener noreferrer">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external nofollow noopener noreferrer">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="external nofollow noopener noreferrer">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>hexoéƒ¨ç½²æ—¶ç”¨æˆ·åå¯†ç è®¾ç½®</title>
    <url>/blogs/hexo-deploy/</url>
    <content><![CDATA[<p>hexoéƒ¨ç½²æ—¶ç”¨æˆ·åå¯†ç é—®é¢˜ï¼š</p><p>è®°ä½ç”¨æˆ·åå¯†ç ï¼Œä¸ç”¨æ¯æ¬¡éƒ½è¾“å…¥ç”¨æˆ·åå¯†ç </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global credential.helper store</span><br></pre></td></tr></table></figure><p>æ¸…é™¤ç”¨æˆ·åå¯†ç ï¼Œé˜²æ­¢ç”¨æˆ·åå¯†ç è¾“å…¥é”™è¯¯</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --system --<span class="built_in">unset</span> credential.helper</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>dockerç®€æ˜“æ•™ç¨‹</title>
    <url>/blogs/docker/</url>
    <content><![CDATA[<h2 id="Dockerï¼šè™šæ‹ŸåŒ–å®¹å™¨æŠ€æœ¯"><a href="#Dockerï¼šè™šæ‹ŸåŒ–å®¹å™¨æŠ€æœ¯" class="headerlink" title="Dockerï¼šè™šæ‹ŸåŒ–å®¹å™¨æŠ€æœ¯"></a>Dockerï¼šè™šæ‹ŸåŒ–å®¹å™¨æŠ€æœ¯</h2><p>ä¸‰å¤§ç»„ä»¶ï¼šé•œåƒï¼Œå®¹å™¨ï¼Œä»“åº“</p><pre><code>é•œåƒï¼šæƒ³è±¡æˆç³»ç»Ÿisoæˆ–è€…ghosté•œåƒ

å®¹å™¨ï¼šæƒ³è±¡æˆä¸€ä¸ªç³»ç»Ÿç¯å¢ƒ

ä»“åº“ï¼šæƒ³è±¡æˆGitHub</code></pre><p>ä¼˜ç‚¹ï¼šéš”ç¦»æ€§   ä¾¿æ·æ€§â€“ç§»æ¤å’Œé›†ç¾¤     è½»é‡çº§   äº‘æ”¯æŒ</p><h2 id="å®‰è£…Docker"><a href="#å®‰è£…Docker" class="headerlink" title="å®‰è£…Docker"></a>å®‰è£…Docker</h2><p>Cenos7ä¸‹å®‰è£…docker</p><p>1.æŠŠyumåŒ…æ›´æ–°åˆ°æœ€æ–°</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update</span><br></pre></td></tr></table></figure><a id="more"></a>





<p>2.å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>

<p>3.è®¾ç½®yumæº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<p>4.å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä»“åº“ä¸­æ‰€æœ‰dockerç‰ˆæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r</span><br></pre></td></tr></table></figure>

<p>5.å®‰è£…Docker</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install docker-ce-17.12.1.ce</span><br></pre></td></tr></table></figure>

<p>6.å¯åŠ¨Dockerï¼ŒåŠ å…¥å¼€æœºå¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line"></span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure>

<p>7.éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>



<h2 id="ç¼–è¾‘å®¹å™¨"><a href="#ç¼–è¾‘å®¹å™¨" class="headerlink" title="ç¼–è¾‘å®¹å™¨"></a>ç¼–è¾‘å®¹å™¨</h2><p>ä»ä»“åº“ä¸­æ‹‰å»ä¸€ä¸ªcentos7çš„é•œåƒ </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">doucker pull centos:7</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨é•œåƒç”Ÿæˆå®¹å™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d -i -t &lt;IMAGE ID&gt; bash</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥å®¹å™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it &lt;CONTAINER ID&gt; bash</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å°±æ˜¯è¿›å…¥äº†centos7çš„linuxç³»ç»Ÿï¼Œå¯ä»¥åœ¨é‡Œå®‰è£…jdk,tomcatç­‰ï¼Œç„¶åéƒ¨ç½²waråï¼Œæ‰§è¡Œ</p>
<p><code>curl localhost:ç«¯å£å·</code>    çœ‹çœ‹æ˜¯å¦å¯ä»¥è®¿é—®ã€‚</p>
<p>ä¸ºäº†å¯ä»¥å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œè‡ªåŠ¨å¯åŠ¨tomcatï¼Œå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œå¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œå¯åŠ¨æ­¤è„šæœ¬ã€‚<br>ä¾‹å¦‚æˆ‘åœ¨æœ€æ ¹ç›®å½•åˆ›å»ºäº†runtomcat.shçš„è„šæœ¬<br>è„šæœ¬å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/soft/jdk1.5.0_22</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line">sh /soft/apache-tomcat-5.5.25/bin/catalina.sh run</span><br></pre></td></tr></table></figure>



<h2 id="åˆ¶ä½œé•œåƒ"><a href="#åˆ¶ä½œé•œåƒ" class="headerlink" title="åˆ¶ä½œé•œåƒ"></a>åˆ¶ä½œé•œåƒ</h2><p>å°†åŸæ¥çš„å®¹å™¨åˆ¶æˆé•œåƒâ€“docker commit containerid new_image:tag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker commit centos7_base centos:7.1</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ–°çš„é•œåƒåˆ¶æˆå®¹å™¨â€“docker run -d -p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£/tcp â€“name å®¹å™¨å é•œåƒå:tag  </p>
<p>å¹¶æ‰§è¡Œdockerå†…è„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d -p 18080:8080 --name centos7_1 centos:7.1 /runtomcat.sh</span><br></pre></td></tr></table></figure>

<p>å®¿ä¸»æœºç«¯å£æ˜¯18080æ˜ å°„äº†å®¹å™¨å†…çš„8080tomcatç«¯å£ï¼Œç°åœ¨ç›´æ¥è®¿é—®å®¿ä¸»æœºçš„ip:18080/cvbså°±å¯ä»¥è®¿é—®å®¹å™¨çš„webæœåŠ¡äº†ã€‚<br>æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144010.png" alt="æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µ"></p>
<p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶æ–°çš„å®¹å™¨å·²ç»å¯åŠ¨äº†</p>
<p>å†æ¬¡åˆ¶æˆä¸€ä¸ªå®¹å™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d -p 28080:8080 --name centos7_2 centos:7.1 /runtomcat.sh</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µâ€“<code>docker ps â€“a</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144100.png" alt="æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µ"></p>
<p>æ­¤æ—¶å¯ä»¥çœ‹åˆ°å·²ç»éƒ¨ç½²äº†ä¸¤ä¸ªæœåŠ¡äº†ï¼Œåˆ†åˆ«æ˜ å°„åœ¨å®¿ä¸»æœºçš„18080å’Œ28080ç«¯å£</p>
<p>å¤–éƒ¨æµè§ˆå™¨è®¿é—®ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144117.png" alt="æµè§ˆå™¨åŒç«¯å£è®¿é—®"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç«¯å£éƒ½å¯ä»¥è®¿é—®äº†</p>
<p>å› ä¸ºæˆ‘æ˜¯åœ¨è™šæ‹Ÿæœºé‡Œå®‰è£…ï¼Œæ‰€ä»¥å±€åŸŸç½‘ä¸­å…¶ä»–æœºå™¨æ— æ³•è®¿é—®åˆ°æ­¤ipï¼Œ</p>
<p>æ‰€ä»¥ä¸ºäº†çœç•¥é…ç½®è™šæ‹Ÿæœºå¯¹å¤–æš´éœ²çš„ipç­‰æ­¥éª¤ï¼Œç›´æ¥åœ¨ä¸»æœºä¸­é€šè¿‡é…ç½®nginxåšä»£ç†ï¼Œé…ç½®å¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144141.png" alt="nginxé…ç½®"></p>
<p>æ­¤æ—¶å¤–éƒ¨è®¿é—®å³å¯<code>http://10.45.12.120/cvbs</code>ï¼ˆæˆ‘çš„å±€åŸŸç½‘å†…ipï¼‰å³å¯è®¿é—®åˆ°dockerä¸­éƒ¨ç½²ä¸¤ä¸ªçš„åº”ç”¨ã€‚</p>
<p>æ³¨æ„ï¼šå› ä¸ºæœ‰äº›é¡¹ç›®æ²¡æœ‰åšåˆ†å¸ƒå¼sessionå¤„ç†ï¼Œæ‰€ä»¥ç®€å•ä½¿ç”¨ip_hashç­–ç•¥è§£å†³sessioné—®é¢˜</p>
<h2 id="IDEAä¸­é…ç½®docker"><a href="#IDEAä¸­é…ç½®docker" class="headerlink" title="IDEAä¸­é…ç½®docker"></a>IDEAä¸­é…ç½®docker</h2><p>1.åœ¨æ ¹ç›®å½•å†™Dockerfileæ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŒ‡å®šåŸºç¡€é•œåƒï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶FROM java:8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿™é‡Œçš„ /tmp ç›®å½•å°±ä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œä»»ä½•å‘ /data ä¸­å†™å…¥çš„ä¿¡æ¯éƒ½ä¸ä¼šè®°å½•è¿›å®¹å™¨å­˜å‚¨å±‚</span></span><br><span class="line">VOLUME /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤åˆ¶ä¸Šä¸‹æ–‡ç›®å½•ä¸‹çš„target/demo-1.0.0.jar åˆ°å®¹å™¨é‡Œ</span></span><br><span class="line">ADD target/spring-boot-0.0.1-SNAPSHOT.jar test.jar</span><br><span class="line"></span><br><span class="line"><span class="comment">#bashæ–¹å¼æ‰§è¡Œï¼Œä½¿test.jarå¯è®¿é—®</span></span><br><span class="line"><span class="comment">#RUNæ–°å»ºç«‹ä¸€å±‚ï¼Œåœ¨å…¶ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæ‰§è¡Œç»“æŸåï¼Œ commit è¿™ä¸€å±‚çš„ä¿®æ”¹ï¼Œæ„æˆæ–°çš„é•œåƒã€‚</span></span><br><span class="line">RUN bash -c <span class="string">"touch /test.jar"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å£°æ˜è¿è¡Œæ—¶å®¹å™¨æä¾›æœåŠ¡ç«¯å£ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œåœ¨è¿è¡Œæ—¶å¹¶ä¸ä¼šå› ä¸ºè¿™ä¸ªå£°æ˜åº”ç”¨å°±ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡</span></span><br><span class="line">EXPOSE 8088</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°   &lt;ENTRYPOINT&gt; "&lt;CMD&gt;"</span></span><br><span class="line">ENTRYPOINT [<span class="string">"java"</span>,<span class="string">"-jar"</span>,<span class="string">"test.jar"</span>]</span><br></pre></td></tr></table></figure>

<p>2.åœ¨å¯åŠ¨é…ç½®ä¸­é…ç½®dockerfile,image,container,port(å®¿ä¸»æœºå’Œdockerçš„ç«¯å£æ˜ å°„)</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144221.png" alt="é…ç½®dockerfile"></p>
<p>3.Mavenæ‰“åŒ…</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144237.png" alt="mavenæ‰“åŒ…"></p>
<p>4.Dockeréƒ¨ç½²</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144250.png" alt="dockeréƒ¨ç½²"></p>
<p>5.å¯åŠ¨Docker</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144304.png" alt="å¯åŠ¨docker"></p>
<p>6.æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144319.png" alt="æŸ¥çœ‹dockerè¿è¡Œæƒ…å†µ3"></p>
<p>7.æµè§ˆå™¨è®¿é—®æˆåŠŸ</p>
<p><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/20191212144335.png" alt="æµè§ˆå™¨è®¿é—®"></p>
<h2 id="k8s"><a href="#k8s" class="headerlink" title="k8s"></a>k8s</h2><p>k8sæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥å®ç°å®¹å™¨é›†ç¾¤çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€è‡ªåŠ¨æ‰©ç¼©å®¹ã€ç»´æŠ¤ç­‰åŠŸèƒ½ã€‚</p>
<p>å¯ä»¥å¯¹å„ç§è™šæ‹ŸåŒ–å®¹å™¨æŠ€æœ¯åšç»Ÿä¸€çš„ç®¡ç†</p>
<p>å®é™…é¡¹ç›®ä¸­å¤§é‡ç”¨åˆ°dockeræ—¶ï¼Œå¯ä»¥åœ¨ç ”ç©¶k8sçš„å®é™…ä½¿ç”¨ã€‚</p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>futureä¸futuretaskç”¨æ³•åŒºåˆ«</title>
    <url>/blogs/future-futuretask/</url>
    <content><![CDATA[<h6 id="Futureå’ŒFutureTaskæ–¹æ³•åŒºåˆ«ï¼Œä¸»è¦åœ¨äºè·å–è¿”å›ç»“æœä¸Šã€‚"><a href="#Futureå’ŒFutureTaskæ–¹æ³•åŒºåˆ«ï¼Œä¸»è¦åœ¨äºè·å–è¿”å›ç»“æœä¸Šã€‚" class="headerlink" title="Futureå’ŒFutureTaskæ–¹æ³•åŒºåˆ«ï¼Œä¸»è¦åœ¨äºè·å–è¿”å›ç»“æœä¸Šã€‚"></a>Futureå’ŒFutureTaskæ–¹æ³•åŒºåˆ«ï¼Œä¸»è¦åœ¨äºè·å–è¿”å›ç»“æœä¸Šã€‚</h6><p>Futureæ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test7</span> <span class="keyword">implements</span> <span class="title">Callable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"1"</span>);</span><br><span class="line">        ExecutorService executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">3</span>,<span class="number">3</span>,<span class="number">0</span>,TimeUnit.SECONDS,<span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Future&lt;?&gt; submit = executor.submit(<span class="keyword">new</span> Test7());</span><br><span class="line">            Object o = submit.get();</span><br><span class="line">            System.out.println(o);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line">        System.out.println(<span class="string">"4"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        test();</span><br><span class="line">        System.out.println(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a>


<p>submité‡Œæ”¾çš„æ˜¯å®ç°callableæ¥å£çš„ç±»ï¼Œé€šè¿‡è¿”å›å€¼submit.get()ï¼Œè·å–è¿”å›ç»“æœ6ï¼Œå¦‚æœtestæŠ›å‡ºå¼‚å¸¸ï¼Œæ­¤æ—¶ï¼Œä¸»çº¿ç¨‹ä¼šæ•è·ï¼Œæ‰“å°3ï¼Œä¸è°ƒç”¨submit.get()ï¼Œå°†ä¸ä¼šæ•è·å¼‚å¸¸ã€‚</p>
<p>FutureTaskæ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test8</span> <span class="keyword">implements</span> <span class="title">Callable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"1"</span>);</span><br><span class="line">        FutureTask ft = <span class="keyword">new</span> FutureTask(<span class="keyword">new</span> Test8());</span><br><span class="line">        ExecutorService executor = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">3</span>,<span class="number">3</span>,<span class="number">0</span>,TimeUnit.SECONDS,<span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Future&lt;?&gt; submit = executor.submit(ft);</span><br><span class="line">            Object o = submit.get();</span><br><span class="line">            System.out.println(o);</span><br><span class="line">            Object o1 = ft.get();</span><br><span class="line">            System.out.println(o1);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line">        System.out.println(<span class="string">"4"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        test();</span><br><span class="line">        System.out.println(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>executoré‡Œæ”¾çš„æ˜¯futuretaskï¼ŒfuturetaskåŒ…è£…äº†ä¸€å±‚callableå¯¹è±¡ï¼Œæ­¤æ—¶è¦è·å–è¿”å›ç»“æœéœ€è¦ä½¿ç”¨futuretaskçš„get()æ–¹æ³•ï¼Œä¸èƒ½ä½¿ç”¨submit.get(),submit.get()ä¼šè¿”å›null;åªç”¨ft.get()ä¼šæ•è·å¼‚å¸¸ã€‚</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>å¤šçº¿ç¨‹</tag>
        <tag>java</tag>
        <tag>future</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨bpç½‘ç»œé¢„æµ‹ç»¿èå¶ç‰‡é¢ç§¯</title>
    <url>/blogs/bp-net/</url>
    <content><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><blockquote>
<p>æµ‹é‡ç»¿èå¶ç‰‡ä½¿ç”¨kinectç›¸æœºå¯¹å›¾åƒåšæ ‡å®šï¼Œå°†å›¾åƒæ˜ å°„åˆ°åæ ‡ç³»ä¸­ï¼Œä½¿ç”¨matlabç¨‹åºè®¡ç®—å¶ç‰‡æ•´ä½“å å›¾åƒçš„åƒç´ ä»è€Œè®¡ç®—é¢ç§¯ï¼Œå¯¹ç»¿èæ¯å±‚çš„å¶ç‰‡éƒ½éœ€è¦åˆ†æ¬¡è¿›è¡Œæ ‡å®šæ±‚è§£è¿‡ç¨‹è¾ƒä¸ºå¤æ‚ï¼Œå› æ­¤é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œé‡‡ç”¨bpç½‘ç»œæ¥é¢„æµ‹ç»¿èå¶ç‰‡é¢ç§¯ã€‚</p>
</blockquote><hr><h1 id="æ•°æ®é‡‡é›†"><a href="#æ•°æ®é‡‡é›†" class="headerlink" title="æ•°æ®é‡‡é›†"></a>æ•°æ®é‡‡é›†</h1><p><em>æµ‹é‡9ç›†ç»¿èå¶ç‰‡ï¼Œå®æµ‹æ•°æ®å…±557ç‰‡ã€‚è®­ç»ƒé›†1-7ç›†ï¼Œå…±449ç‰‡ï¼Œæµ‹è¯•é›†8-9ç›†ï¼Œå…±108ç‰‡ã€‚<br>æ•°æ®é›†ä¸­å…±å››ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯å®½åº¦ä¸ºwï¼Œé•¿è¾¹ä¸ºL1,çŸ­è¾¹ä¸ºL2ï¼Œé¢ç§¯areaã€‚</em><br><strong>å…¶ä¸­å®½åº¦ï¼Œé•¿è¾¹ï¼ŒçŸ­è¾¹ä¸ºæ‰‹åŠ¨å®æµ‹ï¼Œé¢ç§¯æ ¹æ®å¶ç‰‡åƒç´ ç‚¹å å›¾ç‰‡æ•´ä½“åƒç´ ç‚¹è®¡ç®—å¾—å‡ºã€‚</strong></p><a id="more"></a>


<ul>
<li>è®¡ç®—é¢ç§¯çš„MATLABç¨‹åº<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%% åˆ†å‰²</span><br><span class="line">k=graythresh(I);              %å¾—åˆ°æœ€ä¼˜é˜ˆå€¼</span><br><span class="line">j=im2bw(I,k);                  %è½¬æ¢æˆäºŒå€¼å›¾ï¼Œkä¸ºåˆ†å‰²é˜ˆå€¼</span><br><span class="line">%imshow(j); </span><br><span class="line">f = bwmorph(j,&apos;open&apos;);  %å¼€è¿ç®—</span><br><span class="line">figure, imshow(f)</span><br><span class="line">%% åƒç´ ç‚¹ç»Ÿè®¡</span><br><span class="line">[m,n]=size(f);</span><br><span class="line">k=0;</span><br><span class="line">for i=1:1:m</span><br><span class="line">    for j=1:1:n</span><br><span class="line">        if f(i,j)==0</span><br><span class="line">            k=k+1;</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line">p=k/(m*n);</span><br><span class="line">s=21*29.7*p;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h1 id="bpç½‘ç»œè®¾è®¡"><a href="#bpç½‘ç»œè®¾è®¡" class="headerlink" title="bpç½‘ç»œè®¾è®¡"></a>bpç½‘ç»œè®¾è®¡</h1><p>bpç½‘ç»œç¤ºæ„å›¾åŠå„å˜é‡å«ä¹‰<br><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/bp%E7%BD%91%E7%BB%9C%E7%A4%BA%E6%84%8F%E5%9B%BE%E5%8F%8A%E5%90%84%E5%8F%98%E9%87%8F%E5%90%AB%E4%B9%89.png" alt="bpç»“æ„å›¾ç‰‡"></p>
<ol>
<li><p>ç»“æ„é€‰å–<br>a.éšå«å±‚æ•°é‡é€‰å–ï¼šå•éšå±‚ç»“æ„é€‰æ‹©ï¼Œå½“ä»…æœ‰ä¸€å±‚éšå«å±‚æ—¶ï¼Œæµ‹è¯•æ•°æ®æ­£ç¡®ç‡å·²è¾¾100%ï¼Œä¸ºé™ä½ç½‘ç»œå¤æ‚åº¦ï¼Œæ‰€ä»¥é€‰æ‹©å•éšå±‚ç»“æ„ã€‚<br>b.éšå«å±‚ç¥ç»å…ƒä¸ªæ•°é€‰å–</p>
<table>
<thead>
<tr>
<th align="left">éšå«å±‚ç¥ç»å…ƒä¸ªæ•°</th>
<th align="left">è¾¾åˆ°æœ€å°è¯¯å·®æ—¶éœ€è¦è¿­ä»£çš„æ¬¡æ•°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">5</td>
<td align="left">1873</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">2009</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">2259</td>
</tr>
</tbody></table>
<p>æ ¹æ®ç¨‹åºè¿è¡Œæ¥çœ‹ï¼Œå½“éšè—å±‚ç¥ç»å…ƒä¸ªæ•°é€‰æ‹©è¿‡å°ï¼ˆå°äº5ï¼‰æ”¶æ•›é€Ÿåº¦å¾ˆæ…¢ï¼Œå½“åˆ°è¾¾æœ€å¤§è¿­ä»£æ¬¡æ•°æ—¶ï¼Œè¯¯å·®ä»å¾ˆå¤§ï¼Œå½“ä¸ªæ•°é€‰æ‹©è¿‡å¤§ï¼ˆå¤§äº15ï¼‰ï¼Œç½‘ç»œå‡ºç°æŒ¯è¡ï¼Œå› æ­¤ï¼Œè€ƒè™‘éšè—å±‚ç¥ç»å…ƒä¸ªæ•°åœ¨5-15ä¹‹é—´ï¼Œå› ä¸ºæœ¬å®éªŒæ•°æ®é›†å±æ€§å°‘ï¼Œå› æ­¤é€‰æ‹©éšè—å±‚ç¥ç»å…ƒä¸ªæ•°ä¸º5ä¸ªï¼Œå‡å°‘å¤æ‚åº¦ã€‚<br> c.è¯¯å·®å‡½æ•°é€‰æ‹©å‡æ–¹å·®å…¬å¼ï¼š$[    {E_{k} } =1/2*( \hat{y}-y) ]$<br> d.ç»“æŸæ¡ä»¶ï¼š<br> è®­ç»ƒç»“æŸæ¡ä»¶ï¼šå½“è¯¯å·®å‡½æ•°å€¼å°äº1e-3æˆ–è€…è¿­ä»£æ¬¡æ•°å¤§äº50000æ¬¡æ—¶ç»“æŸè®­ç»ƒ<br> æµ‹è¯•è¯¯å·®åˆ¤æ–­ï¼šå½“æµ‹è¯•é›†è¾“å‡ºé¢ç§¯å’Œå®é™…é¢ç§¯è¯¯å·®å‡½æ•°å€¼å¤§äº1e-5æ—¶ï¼Œé¢„æµ‹é”™è¯¯ï¼Œåä¹‹é¢„æµ‹æ­£ç¡®ã€‚</p>
</li>
<li><p>åˆå§‹å€¼è®¾ç½®<br>a.æƒå€¼çŸ©é˜µçš„åˆå§‹å€¼<br>äº§ç”Ÿ0-1ä¹‹é—´çš„éšæœºæ•°ä½œä¸ºæƒå€¼çš„åˆå§‹å€¼<br>ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">srand(time(NULL));//è®¾ç½®éšæœºæ•°ç§å­ï¼Œä½¿æ¯æ¬¡äº§ç”Ÿçš„éšæœºåºåˆ—ä¸åŒ</span><br><span class="line">for (int i = 0; i &lt; n; i++)</span><br><span class="line">    w[i] = rand() % (N + 1) / (float)(N + 1);//Nä¸ºè®¾ç½®çš„ç²¾åº¦</span><br></pre></td></tr></table></figure>
<p>b.å­¦ä¹ ç‡çš„åˆå§‹å€¼<br>å­¦ä¹ ç‡æ§åˆ¶ç€ç®—æ³•æ¯ä¸€è½®çš„è¿­ä»£çš„æ›´æ–°æ­¥é•¿ï¼Œè‹¥å¤ªå¤§åˆ™å®¹æ˜“æŒ¯è¡ï¼Œå¤ªå°åˆ™æ”¶æ•›é€Ÿåº¦åˆè¿‡æ…¢å› æ­¤éœ€è¦é€‰æ‹©é€‚åˆçš„åˆå§‹å€¼ã€‚<br><img src="https://cdn.jsdelivr.net/gh/iamxpf/pageImage/images/bp%E5%AD%A6%E4%B9%A0%E7%8E%87%E5%8F%98%E5%8C%96.png" alt="å­¦ä¹ ç‡å˜åŒ–å›¾ç‰‡"><br>ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œå½“å­¦ä¹ ç‡å°äº1æ—¶ï¼Œç½‘ç»œè®­ç»ƒæ¬¡æ•°å¤šé›†ä¸­åœ¨1000ä»¥ä¸Šï¼Œä½†å½“å­¦ä¹ ç‡å¤§äº5æ—¶ï¼Œæµ‹è¯•é›†æ•°æ®ä¼šå‡ºç°é”™è¯¯ï¼Œå› æ­¤é€‰æ‹©è®­ç»ƒæ¬¡æ•°å°‘å¹¶ä¸”è¯¯å·®ä½çš„å­¦ä¹ ç‡=5.</p>
</li>
<li><p>æ•°æ®å½’ä¸€åŒ–<br>å‰ä¸‰åˆ—å±æ€§å–å€¼âˆˆ[2,9]ï¼Œå› æ­¤é‡‡ç”¨å¯¹æ•°å‡½æ•°y=log10(x) ä»¥10ä¸ºåº•çš„å¯¹æ•°å‡½æ•°è½¬æ¢ã€‚<br>æœ€åä¸€åˆ—å±æ€§å–å€¼âˆˆ[10,100]ï¼Œå› æ­¤é‡‡ç”¨åä½™å¼¦å‡½æ•°y=atan(x)*2/PIï¼Œä¿è¯è¾“å…¥çš„æ•°æ®åœ¨0-1ä¹‹é—´ï¼Œè®©ç½‘ç»œæ›´å¿«çš„æ”¶æ•›ã€‚</p>
</li>
<li><p>å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­<br>a.å‰å‘ä¼ æ’­<br>æ¿€æ´»å‡½æ•°é€‰æ‹©sigmodå‡½æ•°ï¼Œç¬¬iä¸ªè¾“å…¥å±‚ç¥ç»å…ƒåˆ°ç¬¬hä¸ªéšè—å±‚ç¥ç»å…ƒçš„æƒå€¼ä¸ºVih,ç¬¬hä¸ªéšè—å±‚ç¥ç»å…ƒè¾“å…¥ä¸ºÎ±=âˆ‘Vih<em>Xiï¼Œè¾“å‡ºä¸ºbh;ç¬¬hä¸ªè¾“å…¥å±‚ç¥ç»å…ƒåˆ°ç¬¬jä¸ªéšè—å±‚ç¥ç»å…ƒçš„æƒå€¼ä¸ºWhj,ç¬¬jä¸ªè¾“å‡ºå±‚ç¥ç»å…ƒçš„è¾“å…¥Î²=âˆ‘Whj</em>bh,è¾“å‡ºä¸º<br>æ±‚å‡ºæ¿€æ´»å€¼ï¼Œä»£å…¥sigmodå‡½æ•°ä¸­ï¼Œæ±‚å¾—è¾“å‡ºå€¼<br>ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for(int j=0;j&lt;hideSum;j++)</span><br><span class="line">&#123;</span><br><span class="line">   o1[j]=0.0;</span><br><span class="line">   for(int i=0;i&lt;inSum;i++)</span><br><span class="line">   //æ¿€æ´»å€¼</span><br><span class="line">   o1[j]=o1[j]+w[i][j]*x[i];</span><br><span class="line">   //å®é™…è¾“å‡º</span><br><span class="line">   x1[j]=1.0/(1+exp(-o1[j]-b1[j])); //b1ä¸ºåç½®é‡</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>b.åå‘ä¼ æ’­<br>ç½‘ç»œåœ¨ï¼ˆXk,Yk)ä¸Šçš„å‡æ–¹å·®ä¸ºï¼ŒBPç®—æ³•åŸºäºæ¢¯åº¦ä¸‹é™çš„ç­–ç•¥ï¼Œä»¥ç›®æ ‡çš„è´Ÿæ¢¯åº¦æ–¹å‘è¿›è¡Œè°ƒæ•´åœ¨å­¦ä¹ ç‡ä¸‹ï¼Œé‡‡ç”¨é“¾å¼æ³•åˆ™å¯¹æƒå€¼è¿›è¡Œæ›´æ–°ï¼š<br>ä»è¾“å‡ºå±‚åˆ°éšè—å±‚ï¼Œæœ‰:<br>ä»éšè—å±‚åˆ°è¾“å…¥å±‚ï¼Œæœ‰:</p>
</li>
</ol>
<ul>
<li>ç®—æ³•æè¿°:<blockquote>
<p>åœ¨ï¼ˆ0ï¼Œ1ï¼‰èŒƒå›´å†…åˆå§‹åŒ–æƒå€¼å’Œå­¦ä¹ ç‡<br>REPEAT<br>FOR allï¼ˆXk,Yk)ï¼š<br>è¾“å…¥æ­£å‘ä¼ æ’­å…¬å¼è®¡ç®—è¾“å‡º<br>è®¡ç®—è¾“å‡ºå±‚éœ€ä¿®æ”¹çš„æ¢¯åº¦é¡¹gj<br>è®¡ç®—éšè—å±‚å±‚éœ€ä¿®æ”¹çš„æ¢¯åº¦é¡¹eh<br>æ ¹æ®å…¬å¼æ›´æ–°æƒå€¼wjh,vij<br>END FOR<br>UNTIL è¾¾åˆ°åœæ­¢æ¡ä»¶</p>
</blockquote>
</li>
</ul>
<p>æ ‡å‡†BPç®—æ³•ï¼šä¸Šè¿°ç®—æ³•æ˜¯å¯¹æ¯ä¸ªæ ·æœ¬æ›´æ–°æƒå€¼ï¼Œå±äºæ ‡å‡†BPç®—æ³•ï¼Œå‚æ•°æ›´æ–°çš„é¢‘ç¹<br>ç´¯ç§¯BPç®—æ³•ï¼šå½“è¯»å–å®Œæ‰€æœ‰æ ·æœ¬ä¹‹åæ‰æ›´æ–°å‚æ•°ï¼Œå‚æ•°æ›´æ–°çš„é¢‘ç‡ä½<br>åŒºåˆ«ï¼šç´¯ç§¯BPç®—æ³•åœ¨è¯¯å·®ä¸‹é™åˆ°ä¸€å®šé˜¶æ®µï¼Œä¸‹é™å›éå¸¸ç¼“æ…¢ï¼Œæ‰€ä»¥å¾€å¾€æ ‡å‡†BPç®—æ³•èƒ½æ›´å¿«å¾—åˆ°è¾ƒå¥½è§£ã€‚<br><em>ä½¿ç”¨æ ‡å‡†BPç®—æ³•ï¼šå¯¹æ¯ä¸ªæ ·æœ¬æ›´æ–°æƒå€¼</em></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//è¾“å‡ºå±‚</span><br><span class="line">for(int k=0;k&lt;outSum;k++)</span><br><span class="line">&#123;</span><br><span class="line">    //ä¸å®é™…è¾“å‡ºçš„åå·®</span><br><span class="line">    qq[k]=(yd[k]-x2[k])*x2[k]*(1-x2[k]);</span><br><span class="line">    for (int j = 0; j&lt; hideSum; ++j)</span><br><span class="line">        //è°ƒæ•´éšè—å±‚åˆ°è¾“å‡ºå±‚ä¹‹é—´çš„è¿æ¥æƒ</span><br><span class="line">        w1[j][k]+=rate_w1*qq[k]*x1[j];</span><br><span class="line">&#125;</span><br><span class="line">//éšè—å±‚</span><br><span class="line">for(int j=0;j&lt;hideSum;j++)</span><br><span class="line">&#123;</span><br><span class="line">    pp[j]=0;</span><br><span class="line">    //éšè—å±‚çš„åå·®</span><br><span class="line">    for (int k = 0; k&lt; outSum; k++)</span><br><span class="line">        pp[j]=pp[j]+qq[k]*w1[j][k];  //éšè—å±‚çš„åå·®å’Œåé¢æ‰€æœ‰è¿æ¥çš„å¯¹åº”è¾“å‡ºå±‚éƒ½æœ‰å…³ç³»</span><br><span class="line">    pp[j]=pp[j]*x1[j]*(1-x1[j]);</span><br><span class="line">   for (int i = 0; i &lt; inSum; ++i)</span><br><span class="line">        //è°ƒæ•´è¾“å…¥å±‚åˆ°éšè—å±‚ä¹‹é—´çš„è¿æ¥æƒ</span><br><span class="line">        w[i][j]+=rate_w*pp[j]*x[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>ä½¿ç”¨ç´¯ç§¯BPç®—æ³•ï¼šéå†å®Œæ‰€æœ‰æ ·æœ¬å†æ›´æ–°æƒå€¼<br>å¢åŠ æƒå€¼ä¿®æ”¹çŸ©é˜µï¼Œå°†è¯¯å·®è¿›è¡Œç´¯åŠ </em></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//è¾“å‡ºå±‚</span><br><span class="line">for(int k=0;k&lt;outSum;k++)</span><br><span class="line">&#123;</span><br><span class="line">    //ä¸å®é™…è¾“å‡ºçš„åå·®</span><br><span class="line">    qq[k]=(yd[k]-x2[k])*x2[k]*(1-x2[k]);</span><br><span class="line">    for (int j = 0; j&lt; hideSum; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">        //è°ƒæ•´éšè—å±‚åˆ°è¾“å‡ºå±‚ä¹‹é—´çš„è¿æ¥æƒ</span><br><span class="line">        chg_w2[j][k]+=rate_w1*qq[k]*x1[j];</span><br><span class="line">        chg_b2[k]+=rate_b2*qq[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//éšè—å±‚</span><br><span class="line">for(int j=0;j&lt;hideSum;j++)</span><br><span class="line">&#123;</span><br><span class="line">    pp[j]=0;</span><br><span class="line">    //éšè—å±‚çš„åå·®</span><br><span class="line">    for (int k = 0; k&lt; outSum; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        pp[j]=pp[j]+qq[k]*w1[j][k];  //éšè—å±‚çš„åå·®å’Œåé¢æ‰€æœ‰è¿æ¥çš„å¯¹åº”è¾“å‡ºå±‚éƒ½æœ‰å…³ç³»</span><br><span class="line">    &#125;</span><br><span class="line">    pp[j]=pp[j]*x1[j]*(1-x1[j]);</span><br><span class="line">   for (int i = 0; i &lt; inSum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        //è°ƒæ•´è¾“å…¥å±‚åˆ°éšè—å±‚ä¹‹é—´çš„è¿æ¥æƒ</span><br><span class="line">        chg_w1[i][j]=chg_w1[i][j]+rate_w1*pp[j]*x[i];</span><br><span class="line">        chg_b1[j]+=rate_b1*pp[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="ç»“æœåˆ†æ"><a href="#ç»“æœåˆ†æ" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h1><table>
<thead>
<tr>
<th align="left">å¯¹æ¯”</th>
<th align="left">æ ‡å‡†BPç®—æ³•</th>
<th align="left">ç´¯ç§¯BPç®—æ³•</th>
</tr>
</thead>
<tbody><tr>
<td align="left">è¿­ä»£æ¬¡æ•°</td>
<td align="left">548</td>
<td align="left">348</td>
</tr>
<tr>
<td align="left">è®­ç»ƒå¹³å‡è¯¯å·®</td>
<td align="left">å°äº1e-5</td>
<td align="left">å°äº1e-5</td>
</tr>
<tr>
<td align="left">è¯†åˆ«ç»“æœ</td>
<td align="left">100%</td>
<td align="left">100%</td>
</tr>
</tbody></table>
<p>ä½¿ç”¨æ ‡å‡†BPç®—æ³•å’Œç´¯ç§¯BPç®—æ³•è¯†åˆ«ç‡éƒ½èƒ½è¾¾åˆ°100%ï¼Œä½†æ˜¯å› æ•°æ®é‡å°ï¼Œä½¿ç”¨ç´¯ç§¯BP ç®—æ³•è®­ç»ƒæ—¶é—´æ›´çŸ­ã€‚</p>
<hr>
<h1 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h1><ul>
<li>å¦‚æœå°†é•¿è¾¹çŸ­è¾¹åˆæˆä¸€æ¡è¾¹ï¼Œæ•ˆæœè¿˜æ˜¯ä¸€æ ·å—ï¼Ÿ<br>å°†æ•°æ®é›†ä¸­é•¿è¾¹L1å’ŒçŸ­è¾¹L2ç›¸åŠ å¾—åˆ°å¶å­çš„é•¿ä¸ºLï¼Œè¾“å…¥çš„å±æ€§åˆ—å˜ä¸ºé•¿L,å®½W,é¢ç§¯area<br>ç½‘ç»œç»“æ„é‡‡å–ä¸Šè¿°ç»“æ„ï¼Œè®­ç»ƒæ•ˆæœå¦‚ä¸‹å›¾ï¼š<table>
<thead>
<tr>
<th align="left">å¯¹æ¯”</th>
<th align="left">æ ‡å‡†BPç®—æ³•</th>
<th align="left">ç´¯ç§¯BPç®—æ³•</th>
</tr>
</thead>
<tbody><tr>
<td align="left">è¿­ä»£æ¬¡æ•°</td>
<td align="left">566</td>
<td align="left">717</td>
</tr>
<tr>
<td align="left">è®­ç»ƒå¹³å‡è¯¯å·®</td>
<td align="left">å°äº1e-5</td>
<td align="left">å°äº1e-5</td>
</tr>
<tr>
<td align="left">è¯†åˆ«ç»“æœ</td>
<td align="left">94.5%</td>
<td align="left">97.3%</td>
</tr>
</tbody></table>
</li>
</ul>
<p>å› å®éªŒæ‰€ç”¨çš„å¶ç‰‡æœ‰ç ´æŸå­˜åœ¨ï¼Œç›´æ¥ç”¨é•¿è¾¹åŠ ä¸ŠçŸ­è¾¹å¾—åˆ°çš„å¶ç‰‡é•¿åº¦å­˜åœ¨ä¸€å®šè¯¯å·®ï¼Œå› æ­¤ä½¿ç”¨BPç®—æ³•æ—¶ï¼Œè¯†åˆ«ç»“æœç•¥æœ‰ä¸‹é™.<br>ä½¿ç”¨æ ‡å‡†BPç®—æ³•å’Œç´¯ç§¯BPç®—æ³•è¯†åˆ«ç‡éƒ½èƒ½è¾¾åˆ°100%ï¼Œä½†æ˜¯å› æ•°æ®é‡å°ï¼Œä½¿ç”¨ç´¯ç§¯BP ç®—æ³•è®­ç»ƒæ—¶é—´æ›´çŸ­ã€‚</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
</search>
